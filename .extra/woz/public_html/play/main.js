!function(){var e,t,n;!function(i){function o(e,t){return k.call(e,t)}function r(e,t){var n,i,o,r,a,s,l,c,u,d,p=t&&t.split("/"),h=y.map,f=h&&h["*"]||{};if(e&&"."===e.charAt(0))if(t){for(p=p.slice(0,p.length-1),e=p.concat(e.split("/")),c=0;c<e.length;c+=1)if(d=e[c],"."===d)e.splice(c,1),c-=1;else if(".."===d){if(1===c&&(".."===e[2]||".."===e[0]))break;c>0&&(e.splice(c-1,2),c-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((p||f)&&h){for(n=e.split("/"),c=n.length;c>0;c-=1){if(i=n.slice(0,c).join("/"),p)for(u=p.length;u>0;u-=1)if(o=h[p.slice(0,u).join("/")],o&&(o=o[i])){r=o,a=c;break}if(r)break;!s&&f&&f[i]&&(s=f[i],l=c)}!r&&s&&(r=s,a=l),r&&(n.splice(0,a,r),e=n.join("/"))}return e}function a(e,t){return function(){return f.apply(i,_.call(arguments,0).concat([e,t]))}}function s(e){return function(t){return r(t,e)}}function l(e){return function(t){v[e]=t}}function c(e){if(o(b,e)){var t=b[e];delete b[e],w[e]=!0,h.apply(i,t)}if(!o(v,e)&&!o(w,e))throw new Error("No "+e);return v[e]}function u(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function d(t,n,i){e.onResourceLoad&&t&&e.onResourceLoad({defined:n},{id:t},i)}function p(e){return function(){return y&&y.config&&y.config[e]||{}}}var h,f,g,m,v={},b={},y={},w={},k=Object.prototype.hasOwnProperty,_=[].slice;g=function(e,t){var n,i=u(e),o=i[0];return e=i[1],o&&(o=r(o,t),n=c(o)),o?e=n&&n.normalize?n.normalize(e,s(t)):r(e,t):(e=r(e,t),i=u(e),o=i[0],e=i[1],o&&(n=c(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:n}},m={require:function(e){return a(e)},exports:function(e){var t=v[e];return"undefined"!=typeof t?t:v[e]={}},module:function(e){return{id:e,uri:"",exports:v[e],config:p(e)}}},h=function(e,t,n,r){var s,u,p,h,f,y,k=[];if(r=r||e,"function"==typeof n){for(t=!t.length&&n.length?["require","exports","module"]:t,f=0;f<t.length;f+=1)if(h=g(t[f],r),u=h.f,"require"===u)k[f]=m.require(e);else if("exports"===u)k[f]=m.exports(e),y=!0;else if("module"===u)s=k[f]=m.module(e);else if(o(v,u)||o(b,u)||o(w,u))k[f]=c(u);else{if(!h.p)throw new Error(e+" missing "+u);h.p.load(h.n,a(r,!0),l(u),{}),k[f]=v[u]}p=n.apply(v[e],k),e&&(s&&s.exports!==i&&s.exports!==v[e]?v[e]=s.exports:p===i&&y||(v[e]=p))}else e&&(v[e]=n);d(e,v,k)},e=t=f=function(e,t,n,o,r){return"string"==typeof e?m[e]?m[e](t):c(g(e,t).f):(e.splice||(y=e,t.splice?(e=t,t=n,n=null):e=i),t=t||function(){},"function"==typeof n&&(n=o,o=r),o?h(i,e,t,n):setTimeout(function(){h(i,e,t,n)},4),f)},f.config=function(e){return y=e,y.deps&&f(y.deps,y.callback),f},e._defined=v,n=function(e,t,n){t.splice||(n=t,t=[]),o(v,e)||o(b,e)||(b[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("durandal/system",["require","jquery"],function(t,n){function i(e){var t="[object "+e+"]";o["is"+e]=function(e){return l.call(e)==t}}var o,r=!1,a=Object.keys,s=Object.prototype.hasOwnProperty,l=Object.prototype.toString,c=!1,u=Array.isArray,d=Array.prototype.slice;if(Function.prototype.bind&&("object"==typeof console||"function"==typeof console)&&"object"==typeof console.log)try{["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(e){console[e]=this.call(console[e],console)},Function.prototype.bind)}catch(p){c=!0}t.on&&t.on("moduleLoaded",function(e,t){o.setModuleId(e,t)}),"undefined"!=typeof e&&(e.onResourceLoad=function(e,t){o.setModuleId(e.defined[t.id],t.id)});var h=function(){},f=function(){try{if("undefined"!=typeof console&&"function"==typeof console.log)if(window.opera)for(var e=0;e<arguments.length;)console.log("Item "+(e+1)+": "+arguments[e]),e++;else 1==d.call(arguments).length&&"string"==typeof d.call(arguments)[0]?console.log(d.call(arguments).toString()):console.log.apply(console,d.call(arguments));else Function.prototype.bind&&!c||"undefined"==typeof console||"object"!=typeof console.log||Function.prototype.call.call(console.log,console,d.call(arguments))}catch(t){}},g=function(e){if(e instanceof Error)throw e;throw new Error(e)};o={version:"2.0.1",noop:h,getModuleId:function(e){return e?"function"==typeof e?e.prototype.__moduleId__:"string"==typeof e?null:e.__moduleId__:null},setModuleId:function(e,t){return e?"function"==typeof e?void(e.prototype.__moduleId__=t):void("string"!=typeof e&&(e.__moduleId__=t)):void 0},resolveObject:function(e){return o.isFunction(e)?new e:e},debug:function(e){return 1==arguments.length&&(r=e,r?(this.log=f,this.error=g,this.log("Debug:Enabled")):(this.log("Debug:Disabled"),this.log=h,this.error=h)),r},log:h,error:h,assert:function(e,t){e||o.error(new Error(t||"Assert:Failed"))},defer:function(e){return n.Deferred(e)},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})},acquire:function(){var e,n=arguments[0],i=!1;return o.isArray(n)?(e=n,i=!0):e=d.call(arguments,0),this.defer(function(n){t(e,function(){var e=arguments;setTimeout(function(){n.resolve(e.length>1||i?d.call(e,0):e[0])},1)},function(e){n.reject(e)})}).promise()},extend:function(e){for(var t=d.call(arguments,1),n=0;n<t.length;n++){var i=t[n];if(i)for(var o in i)e[o]=i[o]}return e},wait:function(e){return o.defer(function(t){setTimeout(t.resolve,e)}).promise()}},o.keys=a||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)s.call(e,n)&&(t[t.length]=n);return t},o.isElement=function(e){return!(!e||1!==e.nodeType)},o.isArray=u||function(e){return"[object Array]"==l.call(e)},o.isObject=function(e){return e===Object(e)},o.isBoolean=function(e){return"boolean"==typeof e},o.isPromise=function(e){return e&&o.isFunction(e.then)};for(var m=["Arguments","Function","String","Number","Date","RegExp"],v=0;v<m.length;v++)i(m[v]);return o}),n("durandal/viewEngine",["durandal/system","jquery"],function(e,t){var n;return n=t.parseHTML?function(e){return t.parseHTML(e)}:function(e){return t(e).get()},{viewExtension:".html",viewPlugin:"text",isViewUrl:function(e){return-1!==e.indexOf(this.viewExtension,e.length-this.viewExtension.length)},convertViewUrlToViewId:function(e){return e.substring(0,e.length-this.viewExtension.length)},convertViewIdToRequirePath:function(e){return this.viewPlugin+"!"+e+this.viewExtension},parseMarkup:n,processMarkup:function(e){var t=this.parseMarkup(e);return this.ensureSingleElement(t)},ensureSingleElement:function(e){if(1==e.length)return e[0];for(var n=[],i=0;i<e.length;i++){var o=e[i];if(8!=o.nodeType){if(3==o.nodeType){var r=/\S/.test(o.nodeValue);if(!r)continue}n.push(o)}}return n.length>1?t(n).wrapAll('<div class="durandal-wrapper"></div>').parent().get(0):n[0]},createView:function(t){var n=this,i=this.convertViewIdToRequirePath(t);return e.defer(function(o){e.acquire(i).then(function(e){var i=n.processMarkup(e);i.setAttribute("data-view",t),o.resolve(i)}).fail(function(e){n.createFallbackView(t,i,e).then(function(e){e.setAttribute("data-view",t),o.resolve(e)})})}).promise()},createFallbackView:function(t,n){var i=this,o='View Not Found. Searched for "'+t+'" via path "'+n+'".';return e.defer(function(e){e.resolve(i.processMarkup('<div class="durandal-view-404">'+o+"</div>"))}).promise()}}}),n("durandal/viewLocator",["durandal/system","durandal/viewEngine"],function(e,t){function n(e,t){for(var n=0;n<e.length;n++){var i=e[n],o=i.getAttribute("data-view");if(o==t)return i}}function i(e){return(e+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")}return{useConvention:function(e,t,n){e=e||"viewmodels",t=t||"views",n=n||t;var o=new RegExp(i(e),"gi");this.convertModuleIdToViewId=function(e){return e.replace(o,t)},this.translateViewIdToArea=function(e,t){return t&&"partial"!=t?n+"/"+t+"/"+e:n+"/"+e}},locateViewForObject:function(t,n,i){var o;if(t.getView&&(o=t.getView()))return this.locateView(o,n,i);if(t.viewUrl)return this.locateView(t.viewUrl,n,i);var r=e.getModuleId(t);return r?this.locateView(this.convertModuleIdToViewId(r),n,i):this.locateView(this.determineFallbackViewId(t),n,i)},convertModuleIdToViewId:function(e){return e},determineFallbackViewId:function(e){var t=/function (.{1,})\(/,n=t.exec(e.constructor.toString()),i=n&&n.length>1?n[1]:"";return"views/"+i},translateViewIdToArea:function(e){return e},locateView:function(i,o,r){if("string"==typeof i){var a;if(a=t.isViewUrl(i)?t.convertViewUrlToViewId(i):i,o&&(a=this.translateViewIdToArea(a,o)),r){var s=n(r,a);if(s)return e.defer(function(e){e.resolve(s)}).promise()}return t.createView(a)}return e.defer(function(e){e.resolve(i)}).promise()}}}),n("durandal/binder",["durandal/system","knockout"],function(e,t){function n(t){return void 0===t?{applyBindings:!0}:e.isBoolean(t)?{applyBindings:t}:(void 0===t.applyBindings&&(t.applyBindings=!0),t)}function i(i,c,u,d){if(!c||!u)return void(o.throwOnErrors?e.error(r):e.log(r,c,d));if(!c.getAttribute)return void(o.throwOnErrors?e.error(a):e.log(a,c,d));var p=c.getAttribute("data-view");try{var h;return i&&i.binding&&(h=i.binding(c)),h=n(h),o.binding(d,c,h),h.applyBindings?(e.log("Binding",p,d),t.applyBindings(u,c)):i&&t.utils.domData.set(c,l,{$data:i}),o.bindingComplete(d,c,h),i&&i.bindingComplete&&i.bindingComplete(c),t.utils.domData.set(c,s,h),h}catch(f){f.message=f.message+";\nView: "+p+";\nModuleId: "+e.getModuleId(d),o.throwOnErrors?e.error(f):e.log(f.message)}}var o,r="Insufficient Information to Bind",a="Unexpected View Type",s="durandal-binding-instruction",l="__ko_bindingContext__";return o={binding:e.noop,bindingComplete:e.noop,throwOnErrors:!1,getBindingInstruction:function(e){return t.utils.domData.get(e,s)},bindContext:function(e,t,n){return n&&e&&(e=e.createChildContext(n)),i(n,t,e,n||(e?e.$data:null))},bind:function(e,t){return i(e,t,e,e)}}}),n("durandal/activator",["durandal/system","knockout"],function(e,t){function n(e){return void 0==e&&(e={}),e.closeOnDeactivate||(e.closeOnDeactivate=c.defaults.closeOnDeactivate),e.beforeActivate||(e.beforeActivate=c.defaults.beforeActivate),e.afterDeactivate||(e.afterDeactivate=c.defaults.afterDeactivate),e.affirmations||(e.affirmations=c.defaults.affirmations),e.interpretResponse||(e.interpretResponse=c.defaults.interpretResponse),e.areSameItem||(e.areSameItem=c.defaults.areSameItem),e}function i(t,n,i){return e.isArray(i)?t[n].apply(t,i):t[n](i)}function o(t,n,i,o,r){if(t&&t.deactivate){e.log("Deactivating",t);var a;try{a=t.deactivate(n)}catch(s){return e.error(s),void o.resolve(!1)}a&&a.then?a.then(function(){i.afterDeactivate(t,n,r),o.resolve(!0)},function(t){e.log(t),o.resolve(!1)}):(i.afterDeactivate(t,n,r),o.resolve(!0))}else t&&i.afterDeactivate(t,n,r),o.resolve(!0)}function r(t,n,o,r){if(t)if(t.activate){e.log("Activating",t);var a;try{a=i(t,"activate",r)}catch(s){return e.error(s),void o(!1)}a&&a.then?a.then(function(){n(t),o(!0)},function(t){e.log(t),o(!1)}):(n(t),o(!0))}else n(t),o(!0);else o(!0)}function a(t,n,i){return i.lifecycleData=null,e.defer(function(o){if(t&&t.canDeactivate){var r;try{r=t.canDeactivate(n)}catch(a){return e.error(a),void o.resolve(!1)}r.then?r.then(function(e){i.lifecycleData=e,o.resolve(i.interpretResponse(e))},function(t){e.error(t),o.resolve(!1)}):(i.lifecycleData=r,o.resolve(i.interpretResponse(r)))}else o.resolve(!0)}).promise()}function s(t,n,o,r){return o.lifecycleData=null,e.defer(function(a){if(t==n())return void a.resolve(!0);if(t&&t.canActivate){var s;try{s=i(t,"canActivate",r)}catch(l){return e.error(l),void a.resolve(!1)}s.then?s.then(function(e){o.lifecycleData=e,a.resolve(o.interpretResponse(e))},function(t){e.error(t),a.resolve(!1)}):(o.lifecycleData=s,a.resolve(o.interpretResponse(s)))}else a.resolve(!0)}).promise()}function l(i,l){var c,u=t.observable(null);l=n(l);var d=t.computed({read:function(){return u()},write:function(e){d.viaSetter=!0,d.activateItem(e)}});return d.__activator__=!0,d.settings=l,l.activator=d,d.isActivating=t.observable(!1),d.canDeactivateItem=function(e,t){return a(e,t,l)},d.deactivateItem=function(t,n){return e.defer(function(e){d.canDeactivateItem(t,n).then(function(i){i?o(t,n,l,e,u):(d.notifySubscribers(),e.resolve(!1))})}).promise()},d.canActivateItem=function(e,t){return s(e,u,l,t)},d.activateItem=function(t,n){var i=d.viaSetter;return d.viaSetter=!1,e.defer(function(a){if(d.isActivating())return void a.resolve(!1);d.isActivating(!0);var s=u();return l.areSameItem(s,t,c,n)?(d.isActivating(!1),void a.resolve(!0)):void d.canDeactivateItem(s,l.closeOnDeactivate).then(function(p){p?d.canActivateItem(t,n).then(function(p){p?e.defer(function(e){o(s,l.closeOnDeactivate,l,e)}).promise().then(function(){t=l.beforeActivate(t,n),r(t,u,function(e){c=n,d.isActivating(!1),a.resolve(e)},n)}):(i&&d.notifySubscribers(),d.isActivating(!1),a.resolve(!1))}):(i&&d.notifySubscribers(),d.isActivating(!1),a.resolve(!1))})}).promise()},d.canActivate=function(){var e;return i?(e=i,i=!1):e=d(),d.canActivateItem(e)},d.activate=function(){var e;return i?(e=i,i=!1):e=d(),d.activateItem(e)},d.canDeactivate=function(e){return d.canDeactivateItem(d(),e)},d.deactivate=function(e){return d.deactivateItem(d(),e)},d.includeIn=function(e){e.canActivate=function(){return d.canActivate()},e.activate=function(){return d.activate()},e.canDeactivate=function(e){return d.canDeactivate(e)},e.deactivate=function(e){return d.deactivate(e)}},l.includeIn?d.includeIn(l.includeIn):i&&d.activate(),d.forItems=function(t){l.closeOnDeactivate=!1,l.determineNextItemToActivate=function(e,t){var n=t-1;return-1==n&&e.length>1?e[1]:n>-1&&n<e.length-1?e[n]:null},l.beforeActivate=function(e){var n=d();if(e){var i=t.indexOf(e);-1==i?t.push(e):e=t()[i]}else e=l.determineNextItemToActivate(t,n?t.indexOf(n):0);return e},l.afterDeactivate=function(e,n){n&&t.remove(e)};var n=d.canDeactivate;d.canDeactivate=function(i){return i?e.defer(function(e){function n(){for(var t=0;t<r.length;t++)if(!r[t])return void e.resolve(!1);e.resolve(!0)}for(var o=t(),r=[],a=0;a<o.length;a++)d.canDeactivateItem(o[a],i).then(function(e){r.push(e),r.length==o.length&&n()})}).promise():n()};var i=d.deactivate;return d.deactivate=function(n){return n?e.defer(function(e){function i(i){d.deactivateItem(i,n).then(function(){r++,t.remove(i),r==a&&e.resolve()})}for(var o=t(),r=0,a=o.length,s=0;a>s;s++)i(o[s])}).promise():i()},d},d}var c,u={closeOnDeactivate:!0,affirmations:["yes","ok","true"],interpretResponse:function(n){return e.isObject(n)&&(n=n.can||!1),e.isString(n)?-1!==t.utils.arrayIndexOf(this.affirmations,n.toLowerCase()):n},areSameItem:function(e,t){return e==t},beforeActivate:function(e){return e},afterDeactivate:function(e,t,n){t&&n&&n(null)}};return c={defaults:u,create:l,isActivator:function(e){return e&&e.__activator__}}}),n("durandal/composition",["durandal/system","durandal/viewLocator","durandal/binder","durandal/viewEngine","durandal/activator","jquery","knockout"],function(e,t,n,i,o,r,a){function s(e){for(var t=[],n={childElements:t,activeView:null},i=a.virtualElements.firstChild(e);i;)1==i.nodeType&&(t.push(i),i.getAttribute(k)&&(n.activeView=i)),i=a.virtualElements.nextSibling(i);return n.activeView||(n.activeView=t[0]),n}function l(){x--,0===x&&setTimeout(function(){for(var t=_.length;t--;)try{_[t]()}catch(n){e.error(n)}_=[]},1)}function c(e){delete e.activeView,delete e.viewElements}function u(t,n,i){if(i)n();else if(t.activate&&t.model&&t.model.activate){var o;try{o=e.isArray(t.activationData)?t.model.activate.apply(t.model,t.activationData):t.model.activate(t.activationData),o&&o.then?o.then(n,function(t){e.error(t),n()}):o||void 0===o?n():(l(),c(t))}catch(r){e.error(r)}}else n()}function d(){var t=this;if(t.activeView&&t.activeView.removeAttribute(k),t.child)try{t.model&&t.model.attached&&(t.composingNewView||t.alwaysTriggerAttach)&&t.model.attached(t.child,t.parent,t),t.attached&&t.attached(t.child,t.parent,t),t.child.setAttribute(k,!0),t.composingNewView&&t.model&&t.model.detached&&a.utils.domNodeDisposal.addDisposeCallback(t.child,function(){try{t.model.detached(t.child,t.parent,t)}catch(n){e.error(n)}})}catch(n){e.error(n)}t.triggerAttach=e.noop}function p(t){if(e.isString(t.transition)&&t.model&&t.model.noTransite!==!0){if(t.activeView){if(t.activeView==t.child)return!1;if(!t.child)return!0;if(t.skipTransitionOnSameViewId){var n=t.activeView.getAttribute("data-view"),i=t.child.getAttribute("data-view");return n!=i}}return!0}return!1}function h(e){for(var t=0,n=e.length,i=[];n>t;t++){var o=e[t].cloneNode(!0);i.push(o)}return i}function f(e){var t=h(e.parts),n=y.getParts(t,null,!0),i=y.getParts(e.child);for(var o in n)r(i[o]).replaceWith(n[o])}function g(t){var n,i,o=a.virtualElements.childNodes(t.parent);if(!e.isArray(o)){var r=[];for(n=0,i=o.length;i>n;n++)r[n]=o[n];o=r}for(n=1,i=o.length;i>n;n++)a.removeNode(o[n])}function m(e){a.utils.domData.set(e,T,e.style.display),e.style.display="none"}function v(e){e.style.display=a.utils.domData.get(e,T)}function b(e){var t=e.getAttribute("data-bind");if(!t)return!1;for(var n=0,i=P.length;i>n;n++)if(t.indexOf(P[n])>-1)return!0;return!1}var y,w={},k="data-active-view",_=[],x=0,S="durandal-composition-data",C="data-part",I=["model","view","transition","area","strategy","activationData"],T="durandal-visibility-data",P=["compose:"],E={complete:function(e){_.push(e)}};return y={composeBindings:P,convertTransitionToModuleId:function(e){return"transitions/"+e},defaultTransitionName:null,current:E,addBindingHandler:function(e,t,n){var i,o,r="composition-handler-"+e;t=t||a.bindingHandlers[e],n=n||function(){return void 0},o=a.bindingHandlers[e]={init:function(e,i,o,s,l){if(x>0){var c={trigger:a.observable(null)};y.current.complete(function(){t.init&&t.init(e,i,o,s,l),t.update&&(a.utils.domData.set(e,r,t),c.trigger("trigger"))}),a.utils.domData.set(e,r,c)}else a.utils.domData.set(e,r,t),t.init&&t.init(e,i,o,s,l);return n(e,i,o,s,l)},update:function(e,t,n,i,o){var s=a.utils.domData.get(e,r);return s.update?s.update(e,t,n,i,o):void(s.trigger&&s.trigger())}};for(i in t)"init"!==i&&"update"!==i&&(o[i]=t[i])},getParts:function(e,t,n){if(t=t||{},!e)return t;void 0===e.length&&(e=[e]);for(var i=0,o=e.length;o>i;i++){var r=e[i];if(r.getAttribute){if(!n&&b(r))continue;var a=r.getAttribute(C);a&&(t[a]=r),!n&&r.hasChildNodes()&&y.getParts(r.childNodes,t)}}return t},cloneNodes:h,finalize:function(t){if(void 0===t.transition&&(t.transition=this.defaultTransitionName),t.child||t.activeView)if(p(t)){var i=this.convertTransitionToModuleId(t.transition);e.acquire(i).then(function(e){t.transition=e,e(t).then(function(){if(t.cacheViews){if(t.activeView){var e=n.getBindingInstruction(t.activeView);e&&void 0!=e.cacheViews&&!e.cacheViews&&a.removeNode(t.activeView)}}else t.child?g(t):a.virtualElements.emptyNode(t.parent);t.triggerAttach(),l(),c(t)})}).fail(function(t){e.error("Failed to load transition ("+i+"). Details: "+t.message)})}else{if(t.child!=t.activeView){if(t.cacheViews&&t.activeView){var o=n.getBindingInstruction(t.activeView);!o||void 0!=o.cacheViews&&!o.cacheViews?a.removeNode(t.activeView):m(t.activeView)}t.child?(t.cacheViews||g(t),v(t.child)):t.cacheViews||a.virtualElements.emptyNode(t.parent)}t.triggerAttach(),l(),c(t)}else t.cacheViews||a.virtualElements.emptyNode(t.parent),t.triggerAttach(),l(),c(t)},bindAndShow:function(e,t,o){t.child=e,t.composingNewView=t.cacheViews?-1==a.utils.arrayIndexOf(t.viewElements,e):!0,u(t,function(){if(t.binding&&t.binding(t.child,t.parent,t),t.preserveContext&&t.bindingContext)t.composingNewView&&(t.parts&&f(t),m(e),a.virtualElements.prepend(t.parent,e),n.bindContext(t.bindingContext,e,t.model));else if(e){var o=t.model||w,r=a.dataFor(e);if(r!=o){if(!t.composingNewView)return a.removeNode(e),void i.createView(e.getAttribute("data-view")).then(function(e){y.bindAndShow(e,t,!0)});t.parts&&f(t),m(e),a.virtualElements.prepend(t.parent,e),n.bind(o,e)}}y.finalize(t)},o)},defaultStrategy:function(e){return t.locateViewForObject(e.model,e.area,e.viewElements)},getSettings:function(t){var n,r=t(),s=a.utils.unwrapObservable(r)||{},l=o.isActivator(r);if(e.isString(s))return s=i.isViewUrl(s)?{view:s}:{model:s,activate:!0};if(n=e.getModuleId(s))return s={model:s,activate:!0};!l&&s.model&&(l=o.isActivator(s.model));for(var c in s)s[c]=-1!=a.utils.arrayIndexOf(I,c)?a.utils.unwrapObservable(s[c]):s[c];return l?s.activate=!1:void 0===s.activate&&(s.activate=!0),s},executeStrategy:function(e){e.strategy(e).then(function(t){y.bindAndShow(t,e)})},inject:function(n){return n.model?n.view?void t.locateView(n.view,n.area,n.viewElements).then(function(e){y.bindAndShow(e,n)}):(n.strategy||(n.strategy=this.defaultStrategy),void(e.isString(n.strategy)?e.acquire(n.strategy).then(function(e){n.strategy=e,y.executeStrategy(n)}).fail(function(t){e.error("Failed to load view strategy ("+n.strategy+"). Details: "+t.message)}):this.executeStrategy(n))):void this.bindAndShow(null,n)},compose:function(n,i,o,r){x++,r||(i=y.getSettings(function(){return i},n)),i.compositionComplete&&_.push(function(){i.compositionComplete(i.child,i.parent,i)}),_.push(function(){i.composingNewView&&i.model&&i.model.compositionComplete&&i.model.compositionComplete(i.child,i.parent,i)});var a=s(n);i.activeView=a.activeView,i.parent=n,i.triggerAttach=d,i.bindingContext=o,i.cacheViews&&!i.viewElements&&(i.viewElements=a.childElements),i.model?e.isString(i.model)?e.acquire(i.model).then(function(t){i.model=e.resolveObject(t),y.inject(i)}).fail(function(t){e.error("Failed to load composed module ("+i.model+"). Details: "+t.message)}):y.inject(i):i.view?(i.area=i.area||"partial",i.preserveContext=!0,t.locateView(i.view,i.area,i.viewElements).then(function(e){y.bindAndShow(e,i)})):this.bindAndShow(null,i)}},a.bindingHandlers.compose={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t,n,o,r){var s=y.getSettings(t,e);if(s.mode){var l=a.utils.domData.get(e,S);if(!l){var c=a.virtualElements.childNodes(e);l={},"inline"===s.mode?l.view=i.ensureSingleElement(c):"templated"===s.mode&&(l.parts=h(c)),a.virtualElements.emptyNode(e),a.utils.domData.set(e,S,l)}"inline"===s.mode?s.view=l.view.cloneNode(!0):"templated"===s.mode&&(s.parts=l.parts),s.preserveContext=!0}y.compose(e,s,r,!0)}},a.virtualElements.allowedBindings.compose=!0,y}),n("durandal/events",["durandal/system"],function(e){var t=/\s+/,n=function(){},i=function(e,t){this.owner=e,this.events=t};return i.prototype.then=function(e,t){return this.callback=e||this.callback,this.context=t||this.context,this.callback?(this.owner.on(this.events,this.callback,this.context),this):this},i.prototype.on=i.prototype.then,i.prototype.off=function(){return this.owner.off(this.events,this.callback,this.context),this},n.prototype.on=function(e,n,o){var r,a,s;if(n){for(r=this.callbacks||(this.callbacks={}),e=e.split(t);a=e.shift();)s=r[a]||(r[a]=[]),s.push(n,o);return this}return new i(this,e)},n.prototype.off=function(n,i,o){var r,a,s,l;if(!(a=this.callbacks))return this;if(!(n||i||o))return delete this.callbacks,this;for(n=n?n.split(t):e.keys(a);r=n.shift();)if((s=a[r])&&(i||o))for(l=s.length-2;l>=0;l-=2)i&&s[l]!==i||o&&s[l+1]!==o||s.splice(l,2);else delete a[r];return this},n.prototype.trigger=function(e){var n,i,o,r,a,s,l,c;if(!(i=this.callbacks))return this;for(c=[],e=e.split(t),r=1,a=arguments.length;a>r;r++)c[r-1]=arguments[r];for(;n=e.shift();){if((l=i.all)&&(l=l.slice()),(o=i[n])&&(o=o.slice()),o)for(r=0,a=o.length;a>r;r+=2)o[r].apply(o[r+1]||this,c);if(l)for(s=[n].concat(c),r=0,a=l.length;a>r;r+=2)l[r].apply(l[r+1]||this,s)}return this},n.prototype.proxy=function(e){var t=this;return function(n){t.trigger(e,n)}},n.includeIn=function(e){e.on=n.prototype.on,e.off=n.prototype.off,e.trigger=n.prototype.trigger,e.proxy=n.prototype.proxy},n}),n("durandal/app",["durandal/system","durandal/viewEngine","durandal/composition","durandal/events","jquery"],function(e,t,n,i,o){function r(){return e.defer(function(t){return 0==s.length?void t.resolve():void e.acquire(s).then(function(n){for(var i=0;i<n.length;i++){var o=n[i];if(o.install){var r=l[i];e.isObject(r)||(r={}),o.install(r),e.log("Plugin:Installed "+s[i])}else e.log("Plugin:Loaded "+s[i])}t.resolve()}).fail(function(t){e.error("Failed to load plugin(s). Details: "+t.message)})}).promise()}var a,s=[],l=[];return a={title:"Application",configurePlugins:function(t,n){var i=e.keys(t);n=n||"plugins/",-1===n.indexOf("/",n.length-1)&&(n+="/");for(var o=0;o<i.length;o++){var r=i[o];s.push(n+r),l.push(t[r])}},start:function(){return e.log("Application:Starting"),this.title&&(document.title=this.title),e.defer(function(t){o(function(){r().then(function(){t.resolve(),e.log("Application:Started")})})}).promise()},setRoot:function(i,o,r){var a,s={activate:!0,transition:o};a=!r||e.isString(r)?document.getElementById(r||"applicationHost"):r,e.isString(i)&&t.isViewUrl(i)?s.view=i:s.model=i,n.compose(a,s)}},i.includeIn(a),a}),n("plugins/history",["durandal/system","jquery"],function(e,t){function n(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}var i=/^[#\/]|\s+$/g,o=/^\/+|\/+$/g,r=/msie [\w.]+/,a=/\/$/,s={interval:50,active:!1};return"undefined"!=typeof window&&(s.location=window.location,s.history=window.history),s.getHash=function(e){var t=(e||s).location.href.match(/#(.*)$/);return t?t[1]:""},s.getFragment=function(e,t){if(null==e)if(s._hasPushState||!s._wantsHashChange||t){e=s.location.pathname+s.location.search;var n=s.root.replace(a,"");e.indexOf(n)||(e=e.substr(n.length))}else e=s.getHash();return e.replace(i,"")},s.activate=function(n){s.active&&e.error("History has already been activated."),s.active=!0,s.options=e.extend({},{root:"/"},s.options,n),s.root=s.options.root,s._wantsHashChange=s.options.hashChange!==!1,s._wantsPushState=!!s.options.pushState,s._hasPushState=!!(s.options.pushState&&s.history&&s.history.pushState);var a=s.getFragment(),l=document.documentMode,c=r.exec(navigator.userAgent.toLowerCase())&&(!l||7>=l);s.root=("/"+s.root+"/").replace(o,"/"),c&&s._wantsHashChange&&(s.iframe=t('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,s.navigate(a,!1)),s._hasPushState?t(window).on("popstate",s.checkUrl):s._wantsHashChange&&"onhashchange"in window&&!c?t(window).on("hashchange",s.checkUrl):s._wantsHashChange&&(s._checkUrlInterval=setInterval(s.checkUrl,s.interval)),s.fragment=a;var u=s.location,d=u.pathname.replace(/[^\/]$/,"$&/")===s.root;if(s._wantsHashChange&&s._wantsPushState){if(!s._hasPushState&&!d)return s.fragment=s.getFragment(null,!0),s.location.replace(s.root+s.location.search+"#"+s.fragment),!0;s._hasPushState&&d&&u.hash&&(this.fragment=s.getHash().replace(i,""),this.history.replaceState({},document.title,s.root+s.fragment+u.search))}return s.options.silent?void 0:s.loadUrl()},s.deactivate=function(){t(window).off("popstate",s.checkUrl).off("hashchange",s.checkUrl),clearInterval(s._checkUrlInterval),s.active=!1},s.checkUrl=function(){var e=s.getFragment();return e===s.fragment&&s.iframe&&(e=s.getFragment(s.getHash(s.iframe))),e===s.fragment?!1:(s.iframe&&s.navigate(e,!1),void s.loadUrl())},s.loadUrl=function(e){var t=s.fragment=s.getFragment(e);return s.options.routeHandler?s.options.routeHandler(t):!1},s.navigate=function(t,i){if(!s.active)return!1;if(void 0===i?i={trigger:!0}:e.isBoolean(i)&&(i={trigger:i}),t=s.getFragment(t||""),s.fragment!==t){s.fragment=t;var o=s.root+t;if(""===t&&"/"!==o&&(o=o.slice(0,-1)),s._hasPushState)s.history[i.replace?"replaceState":"pushState"]({},document.title,o);else{if(!s._wantsHashChange)return s.location.assign(o);n(s.location,t,i.replace),s.iframe&&t!==s.getFragment(s.getHash(s.iframe))&&(i.replace||s.iframe.document.open().close(),n(s.iframe.location,t,i.replace))}return i.trigger?s.loadUrl(t):void 0}},s.navigateBack=function(){s.history.back()},s}),n("plugins/router",["durandal/system","durandal/app","durandal/activator","durandal/events","durandal/composition","plugins/history","knockout","jquery"],function(e,t,n,i,o,r,a,s){function l(e){return e=e.replace(v,"\\$&").replace(f,"(?:$1)?").replace(g,function(e,t){return t?e:"([^/]+)"}).replace(m,"(.*?)"),new RegExp("^"+e+"$")}function c(e){var t=e.indexOf(":"),n=t>0?t-1:e.length;return e.substring(0,n)}function u(e,t){return-1!==e.indexOf(t,e.length-t.length)}function d(e,t){if(!e||!t)return!1;if(e.length!=t.length)return!1;for(var n=0,i=e.length;i>n;n++)if(e[n]!=t[n])return!1;return!0}var p,h,f=/\((.*?)\)/g,g=/(\(\?)?:\w+/g,m=/\*\w+/g,v=/[\-{}\[\]+?.,\\\^$|#\s]/g,b=/\/$/,y=function(){function o(e){return e.router&&e.router.parent==R}function s(e){E&&E.config.isActive&&E.config.isActive(e)}function f(t,n){e.log("Navigation Complete",t,n);var i=e.getModuleId(P);i&&R.trigger("router:navigation:from:"+i),P=t,s(!1),E=n,s(!0);var r=e.getModuleId(P);r&&R.trigger("router:navigation:to:"+r),o(t)||R.updateDocumentTitle(t,n),h.explicitNavigation=!1,h.navigatingBack=!1,R.trigger("router:navigation:complete",t,n,R)}function g(t,n){e.log("Navigation Cancelled"),R.activeInstruction(E),E&&R.navigate(E.fragment,!1),D(!1),h.explicitNavigation=!1,h.navigatingBack=!1,R.trigger("router:navigation:cancelled",t,n,R)}function m(t){e.log("Navigation Redirecting"),D(!1),h.explicitNavigation=!1,h.navigatingBack=!1,R.navigate(t,{trigger:!0,replace:!0})}function v(t,n,i){h.navigatingBack=!h.explicitNavigation&&P!=i.fragment,R.trigger("router:route:activating",n,i,R),t.activateItem(n,i.params).then(function(e){if(e){var r=P;if(f(n,i),o(n)){var a=i.fragment;i.queryString&&(a+="?"+i.queryString),n.router.loadUrl(a)}r==n&&(R.attached(),R.compositionComplete())}else t.settings.lifecycleData&&t.settings.lifecycleData.redirect?m(t.settings.lifecycleData.redirect):g(n,i);p&&(p.resolve(),p=null)}).fail(function(t){e.error(t)})}function w(t,n,i){var o=R.guardRoute(n,i);o?o.then?o.then(function(o){o?e.isString(o)?m(o):v(t,n,i):g(n,i)}):e.isString(o)?m(o):v(t,n,i):g(n,i)}function k(e,t,n){R.guardRoute?w(e,t,n):v(e,t,n)}function _(e){return E&&E.config.moduleId==e.config.moduleId&&P&&(P.canReuseForRoute&&P.canReuseForRoute.apply(P,e.params)||!P.canReuseForRoute&&P.router&&P.router.loadUrl)}function x(){if(!D()){var t=A.shift();A=[],t&&(D(!0),R.activeInstruction(t),_(t)?k(n.create(),P,t):e.acquire(t.config.moduleId).then(function(n){var i=e.resolveObject(n);k(O,i,t)}).fail(function(n){e.error("Failed to load routed module ("+t.config.moduleId+"). Details: "+n.message)}))}}function S(e){A.unshift(e),x()}function C(e,t,n){for(var i=e.exec(t).slice(1),o=0;o<i.length;o++){var r=i[o];i[o]=r?decodeURIComponent(r):null}var a=R.parseQueryString(n);return a&&i.push(a),{params:i,queryParams:a}}function I(t){R.trigger("router:route:before-config",t,R),e.isRegExp(t)?t.routePattern=t.route:(t.title=t.title||R.convertRouteToTitle(t.route),t.moduleId=t.moduleId||R.convertRouteToModuleId(t.route),t.hash=t.hash||R.convertRouteToHash(t.route),t.routePattern=l(t.route)),t.isActive=t.isActive||a.observable(!1),R.trigger("router:route:after-config",t,R),R.routes.push(t),R.route(t.routePattern,function(e,n){var i=C(t.routePattern,e,n);S({fragment:e,queryString:n,config:t,params:i.params,queryParams:i.queryParams})})}function T(t){if(e.isArray(t.route))for(var n=t.isActive||a.observable(!1),i=0,o=t.route.length;o>i;i++){var r=e.extend({},t);r.route=t.route[i],r.isActive=n,i>0&&delete r.nav,I(r)}else I(t);return R}var P,E,A=[],D=a.observable(!1),O=n.create(),R={handlers:[],routes:[],navigationModel:a.observableArray([]),activeItem:O,isNavigating:a.computed(function(){var e=O(),t=D(),n=e&&e.router&&e.router!=R&&e.router.isNavigating()?!0:!1;return t||n}),activeInstruction:a.observable(null),__router__:!0};return i.includeIn(R),O.settings.areSameItem=function(e,t,n,i){return e==t?d(n,i):!1},R.parseQueryString=function(e){var t,n;if(!e)return null;if(n=e.split("&"),0==n.length)return null;t={};for(var i=0;i<n.length;i++){var o=n[i];if(""!==o){var r=o.split("=");t[r[0]]=r[1]&&decodeURIComponent(r[1].replace(/\+/g," "))}}return t},R.route=function(e,t){R.handlers.push({routePattern:e,callback:t})},R.loadUrl=function(t){var n=R.handlers,i=null,o=t,a=t.indexOf("?");if(-1!=a&&(o=t.substring(0,a),i=t.substr(a+1)),R.relativeToParentRouter){var s=this.parent.activeInstruction();o=s.params.join("/"),o&&"/"==o.charAt(0)&&(o=o.substr(1)),o||(o=""),o=o.replace("//","/").replace("//","/")
}o=o.replace(b,"");for(var l=0;l<n.length;l++){var c=n[l];if(c.routePattern.test(o))return c.callback(o,i),!0}return e.log("Route Not Found"),R.trigger("router:route:not-found",t,R),E&&r.navigate(E.fragment,{trigger:!1,replace:!0}),h.explicitNavigation=!1,h.navigatingBack=!1,!1},R.updateDocumentTitle=function(e,n){n.config.title?document.title=t.title?n.config.title+" | "+t.title:n.config.title:t.title&&(document.title=t.title)},R.navigate=function(e,t){return e&&-1!=e.indexOf("://")?(window.location.href=e,!0):(h.explicitNavigation=!0,r.navigate(e,t))},R.navigateBack=function(){r.navigateBack()},R.attached=function(){R.trigger("router:navigation:attached",P,E,R)},R.compositionComplete=function(){D(!1),R.trigger("router:navigation:composition-complete",P,E,R),x()},R.convertRouteToHash=function(e){if(R.relativeToParentRouter){var t=R.parent.activeInstruction(),n=t.config.hash+"/"+e;return r._hasPushState&&(n="/"+n),n=n.replace("//","/").replace("//","/")}return r._hasPushState?e:"#"+e},R.convertRouteToModuleId=function(e){return c(e)},R.convertRouteToTitle=function(e){var t=c(e);return t.substring(0,1).toUpperCase()+t.substring(1)},R.map=function(t,n){if(e.isArray(t)){for(var i=0;i<t.length;i++)R.map(t[i]);return R}return e.isString(t)||e.isRegExp(t)?(n?e.isString(n)&&(n={moduleId:n}):n={},n.route=t):n=t,T(n)},R.buildNavigationModel=function(t){for(var n=[],i=R.routes,o=t||100,r=0;r<i.length;r++){var a=i[r];a.nav&&(e.isNumber(a.nav)||(a.nav=++o),n.push(a))}return n.sort(function(e,t){return e.nav-t.nav}),R.navigationModel(n),R},R.mapUnknownRoutes=function(t,n){var i="*catchall",o=l(i);return R.route(o,function(a,s){var l=C(o,a,s),c={fragment:a,queryString:s,config:{route:i,routePattern:o},params:l.params,queryParams:l.queryParams};if(t)if(e.isString(t))c.config.moduleId=t,n&&r.navigate(n,{trigger:!1,replace:!0});else if(e.isFunction(t)){var u=t(c);if(u&&u.then)return void u.then(function(){R.trigger("router:route:before-config",c.config,R),R.trigger("router:route:after-config",c.config,R),S(c)})}else c.config=t,c.config.route=i,c.config.routePattern=o;else c.config.moduleId=a;R.trigger("router:route:before-config",c.config,R),R.trigger("router:route:after-config",c.config,R),S(c)}),R},R.reset=function(){return E=P=void 0,R.handlers=[],R.routes=[],R.off(),delete R.options,R},R.makeRelative=function(t){return e.isString(t)&&(t={moduleId:t,route:t}),t.moduleId&&!u(t.moduleId,"/")&&(t.moduleId+="/"),t.route&&!u(t.route,"/")&&(t.route+="/"),t.fromParent&&(R.relativeToParentRouter=!0),R.on("router:route:before-config").then(function(e){t.moduleId&&(e.moduleId=t.moduleId+e.moduleId),t.route&&(e.route=""===e.route?t.route.substring(0,t.route.length-1):t.route+e.route)}),R},R.createChildRouter=function(){var e=y();return e.parent=R,e},R};return h=y(),h.explicitNavigation=!1,h.navigatingBack=!1,h.targetIsThisWindow=function(e){var t=s(e.target).attr("target");return!t||t===window.name||"_self"===t||"top"===t&&window===window.top?!0:!1},h.activate=function(t){return e.defer(function(n){if(p=n,h.options=e.extend({routeHandler:h.loadUrl},h.options,t),r.activate(h.options),r._hasPushState)for(var i=h.routes,o=i.length;o--;){var a=i[o];a.hash=a.hash.replace("#","")}s(document).delegate("a","click",function(e){if(r._hasPushState){if(!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&h.targetIsThisWindow(e)){var t=s(this).attr("href");null==t||"#"===t.charAt(0)||/^[a-z]+:/i.test(t)||(h.explicitNavigation=!0,e.preventDefault(),r.navigate(t))}}else h.explicitNavigation=!0}),r.options.silent&&p&&(p.resolve(),p=null)}).promise()},h.deactivate=function(){r.deactivate()},h.install=function(){a.bindingHandlers.router={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t,n,i,r){var s=a.utils.unwrapObservable(t())||{};if(s.__router__)s={model:s.activeItem(),attached:s.attached,compositionComplete:s.compositionComplete,activate:!1};else{var l=a.utils.unwrapObservable(s.router||i.router)||h;s.model=l.activeItem(),s.attached=l.attached,s.compositionComplete=l.compositionComplete,s.activate=!1}o.compose(e,s,r)}},a.virtualElements.allowedBindings.router=!0},h}),n("api/helper/Log",[],function(){function e(e){void 0==e&&(e={}),this.log=function(t,n,i){void 0==i&&(i=e)}}var t={black:"background: #222; color: #bada55",green:"background: green; color: white",red:"background: red; color: white",warn:"background: orange; color: white",sound:"background: blue; color: white"};return{themes:t,createLog:function(t){return new e(t)},instance:new e}}),n("sounds/manifest",[],function(){return{click:{command:[],action:["Activity menu click/Activity_menu_click-01.ogg"],button:["Click button/click_button-01.ogg"]},dialog:{closing:["Closing a dialogue/Closing_a_dialogue-03.ogg","Closing a dialogue/Closing_a_dialogue-04.ogg"],notice:["When a paper dialogue shows/When_a_paper_dialogue_shows-02.ogg"],help:["Dialog Help Open/dialog_help_Open-01.ogg"],helpClosing:["Dialog help Closing/dialog_help_Closing-01.ogg"],menu:["Dialog Menu/Dialog_Menu-01.ogg"],confirm:["Confirm Dialog/Confirm_dialog-01.ogg"],confirmClosing:["Confirm Dialog Closing/confirm_dialog_closing-01.ogg"],slipper:["Drop down dialogue/Drop_down_dialogue-01.ogg"],login:["Login dialogue/Login_dialogue-01.ogg"]},action:{success:["Action success/Action_success-01.ogg"],fail:[],functionFailed:["Action Failed/action_functionFailed-01.ogg"]},game:{levelUp:["Level Up Small/level_up_small-01.ogg"],levelUpTitle:["Level Up Big/level_up_big-01.ogg"],loading:["Loading a game/Loading_a_game-01.ogg","Loading a game/Loading_a_game-02.ogg","Loading a game/Loading_a_game-03.ogg"],unfolding:["Unfolding game board/Unfolding_game_board-01.ogg","Unfolding game board/Unfolding_game_board-02.ogg"],overWin:["Game over win/Game_over_win-01.ogg"],overLose:["Game over lose/Game_over_lose-01.ogg"],overResigned:["Game over lose/Game_over_lose-01.ogg"],del:["Delete Game/Delete_game-01.ogg","Delete Game/Delete_game-02.ogg"]},enlargeTile:["Enlarge picture tiles/Enlarge_picture_tiles-01.ogg","Enlarge picture tiles/Enlarge_picture_tiles-02.ogg","Enlarge picture tiles/Enlarge_picture_tiles-03.ogg","Enlarge picture tiles/Enlarge_picture_tiles-04.ogg"],shrinkTile:["Shrink picture tiles/Shrink_picture_tiles-01.ogg","Shrink picture tiles/Shrink_picture_tiles-02.ogg"],word:{lift:["Lift word/Lift_word-01.ogg","Lift word/Lift_word-02.ogg","Lift word/Lift_word-03.ogg","Lift word/Lift_word-04.ogg"],place:["Place word on game board/Place_word_on_game_board-01.ogg","Place word on game board/Place_word_on_game_board-02.ogg","Place word on game board/Place_word_on_game_board-03.ogg","Place word on game board/Place_word_on_game_board-04.ogg","Place word on game board/Place_word_on_game_board-05.ogg"],placeBack:["Place word back on workspace/Place_word_back_on_workspace-01.ogg","Place word back on workspace/Place_word_back_on_workspace-02.ogg","Place word back on workspace/Place_word_back_on_workspace-03.ogg","Place word back on workspace/Place_word_back_on_workspace-04.ogg","Place word back on workspace/Place_word_back_on_workspace-05.ogg","Place word back on workspace/Place_word_back_on_workspace-06.ogg"],select:["Word Select/word_select-01.ogg"],show:["New words appearing-01/New_words_appearing-01.ogg","New words appearing-01/New_words_appearing-02.ogg","New words appearing-01/New_words_appearing-03.ogg","New words appearing-01/New_words_appearing-04.ogg","New words appearing-01/New_words_appearing-05.ogg","New words appearing-01/New_words_appearing-06.ogg"],wiggling:["Wiggly Word/wiggly_word-01.ogg"],related:["Wiggly Word/wiggly_word-01.ogg"]},scoring:{word:["Scoring for words/Scoring_for_words-01.ogg"],bonus:["Scoring bonus normal/Scoring_bonus_normal-01.ogg"],bonusMult:["Scoring bonus multiplyer/Scoring_bonus_multiplyer-01.ogg"],message:["score_result_message/score_result_message-01.ogg"]},selectTool:["Using the select tool/Using_the_select_tool-01.ogg","Using the select tool/Using_the_select_tool-02.ogg","Using the select tool/Using_the_select_tool-03.ogg","Using the select tool/Using_the_select_tool-04.ogg","Using the select tool/Using_the_select_tool-05.ogg","Using the select tool/Using_the_select_tool-06.ogg","Using the select tool/Using_the_select_tool-07.ogg","Using the select tool/Using_the_select_tool-08.ogg","Using the select tool/Using_the_select_tool-09.ogg"],phraseCompleted:["Sentence completed/Sentence_completed-01.ogg"],pageTransition:["Enlarge picture tiles/Enlarge_picture_tiles-05.ogg","Enlarge picture tiles/Enlarge_picture_tiles-06.ogg","Enlarge picture tiles/Enlarge_picture_tiles-07.ogg","Enlarge picture tiles/Enlarge_picture_tiles-08.ogg"],lobbyLoading:["Lobby Loading/lobby_loading-01.ogg","Lobby Loading/lobby_loading-02.ogg","Lobby Loading/lobby_loading-03.ogg"],notification:["Getting a notification/Getting_a_notification-01.ogg"],poem:{phraseDrag:["Lift word/Lift_word-01.ogg","Lift word/Lift_word-02.ogg","Lift word/Lift_word-03.ogg","Lift word/Lift_word-04.ogg"],phraseSwap:["Move phrase up and down/move_phrase_up_and_down-01.ogg"],phraseDrop:["Place word on game board/Place_word_on_game_board-01.ogg","Place word on game board/Place_word_on_game_board-02.ogg","Place word on game board/Place_word_on_game_board-03.ogg","Place word on game board/Place_word_on_game_board-04.ogg","Place word on game board/Place_word_on_game_board-05.ogg"],range:["Slider Tick/slider_tick-01.ogg"],imageSwip:["Image swipe/image_swipe-01.ogg","Image swipe/image_swipe-02.ogg","Image swipe/image_swipe-03.ogg","Image swipe/image_swipe-04.ogg"]}}}),n("sounds/manifest.meta",[],function(){return{actionfail0:{delay:0,volumn:"0.25"},actionfunctionFailed0:{delay:0,src:"Action Failed/action_functionFailed-01.ogg",volumn:"0.1"},actionsuccess0:{delay:0,src:"Action success/Action_success-01.ogg",volumn:"0.4"},clickaction0:{delay:"50",src:"Activity menu click/Activity_menu_click-01.ogg",volumn:"0.15"},clickaction1:{delay:0,volumn:"0.2"},clickaction2:{delay:0,volumn:"0.2"},clickaction3:{delay:"50",volumn:"0.25"},clickbutton0:{delay:"50",src:"Click button/click_button-01.ogg",volumn:"0.25"},clickbutton1:{delay:0,volumn:"0.35"},clickcommand0:{delay:"0",volumn:"0.25"},dialogclosing0:{delay:0,src:"Closing a dialogue/Closing_a_dialogue-03.ogg",volumn:"0.25"},dialogclosing1:{delay:0,src:"Closing a dialogue/Closing_a_dialogue-04.ogg",volumn:"0.2"},dialogconfirm0:{delay:0,src:"Confirm Dialog/Confirm_dialog-01.ogg",volumn:"0.45"},dialogconfirmClosing0:{delay:0,src:"Confirm Dialog Closing/confirm_dialog_closing-01.ogg",volumn:"0.3"},dialoghelp0:{delay:0,src:"Dialog Help Open/dialog_help_Open-01.ogg",volumn:"0.2"},dialoghelp1:{delay:0,volumn:"0.2"},dialoghelp2:{delay:0,volumn:"0.45"},dialoghelp3:{delay:0,volumn:"0.35"},dialoghelpClosing0:{delay:0,src:"Dialog help Closing/dialog_help_Closing-01.ogg",volumn:"0.3"},dialoglogin0:{delay:0,src:"Login dialogue/Login_dialogue-01.ogg",volumn:"0.4"},dialogmenu0:{delay:0,src:"Dialog Menu/Dialog_Menu-01.ogg",volumn:"0.35"},dialognotice0:{delay:0,src:"When a paper dialogue shows/When_a_paper_dialogue_shows-02.ogg",volumn:"0.3"},dialognotice1:{delay:0,volumn:"0.35"},dialognotice2:{delay:0,volumn:"0.3"},dialognotice3:{delay:0,volumn:"0.35"},dialogslipper0:{delay:0,src:"Drop down dialogue/Drop_down_dialogue-01.ogg",volumn:"0.25"},enlargeTile0:{delay:0,src:"Enlarge picture tiles/Enlarge_picture_tiles-01.ogg",volumn:"0.3"},enlargeTile1:{delay:0,src:"Enlarge picture tiles/Enlarge_picture_tiles-02.ogg",volumn:"0.25"},enlargeTile2:{delay:0,src:"Enlarge picture tiles/Enlarge_picture_tiles-03.ogg",volumn:"0.25"},enlargeTile3:{delay:0,src:"Enlarge picture tiles/Enlarge_picture_tiles-04.ogg",volumn:"0.3"},enlargeTile4:{delay:0,volumn:"0.2"},enlargeTile5:{delay:0,volumn:"0.2"},enlargeTile6:{delay:0,volumn:"0.3"},enlargeTile7:{delay:0,volumn:"0.2"},gamedel0:{delay:0,src:"Delete Game/Delete_game-01.ogg",volumn:"0.1"},gamedel1:{delay:0,src:"Delete Game/Delete_game-02.ogg",volumn:"0.05"},gamelevelUp0:{delay:0,src:"Level Up Small/level_up_small-01.ogg",volumn:"0.15"},gamelevelUpTitle0:{delay:0,src:"Level Up Big/level_up_big-01.ogg",volumn:"0.2"},gameloading0:{delay:0,src:"Loading a game/Loading_a_game-01.ogg",volumn:"0.2"},gameloading1:{delay:0,src:"Loading a game/Loading_a_game-02.ogg",volumn:"0.2"},gameloading2:{delay:0,src:"Loading a game/Loading_a_game-03.ogg",volumn:"0.2"},gameoverLose0:{delay:0,src:"Game over lose/Game_over_lose-01.ogg",volumn:"0.2"},gameoverResigned0:{delay:0,src:"Game over lose/Game_over_lose-01.ogg",volumn:"0.15"},gameoverWin0:{delay:0,src:"Game over win/Game_over_win-01.ogg",volumn:"0.35"},gameoverWin1:{delay:0,volumn:"0.35"},gameoverWin2:{delay:0,volumn:"0.35"},gameoverWin3:{delay:0,volumn:"0.4"},gameunfolding0:{delay:0,src:"Unfolding game board/Unfolding_game_board-01.ogg",volumn:"0.1"},gameunfolding1:{delay:0,src:"Unfolding game board/Unfolding_game_board-02.ogg",volumn:"0.15"},lobbyLoading0:{delay:0,src:"Lobby Loading/lobby_loading-01.ogg",volumn:"0.15"},lobbyLoading1:{delay:0,src:"Lobby Loading/lobby_loading-02.ogg",volumn:"0.15"},lobbyLoading2:{delay:0,src:"Lobby Loading/lobby_loading-03.ogg",volumn:"0.15"},lobbyLoading3:{delay:0,volumn:"0.1"},notification0:{delay:0,src:"Getting a notification/Getting_a_notification-01.ogg",volumn:"0.15"},pageTransition0:{delay:0,src:"Enlarge picture tiles/Enlarge_picture_tiles-05.ogg",volumn:"0.2"},pageTransition1:{delay:0,src:"Enlarge picture tiles/Enlarge_picture_tiles-06.ogg",volumn:"0.15"},pageTransition2:{delay:0,src:"Enlarge picture tiles/Enlarge_picture_tiles-07.ogg",volumn:"0.25"},pageTransition3:{delay:0,src:"Enlarge picture tiles/Enlarge_picture_tiles-08.ogg",volumn:"0.1"},phraseCompleted0:{delay:"50",src:"Sentence completed/Sentence_completed-01.ogg",volumn:"0.1"},poemimageSwip0:{delay:0,src:"Image swipe/image_swipe-01.ogg",volumn:"0.15"},poemimageSwip1:{delay:0,src:"Image swipe/image_swipe-02.ogg",volumn:"0.15"},poemimageSwip2:{delay:0,src:"Image swipe/image_swipe-03.ogg",volumn:"0.1"},poemimageSwip3:{delay:0,src:"Image swipe/image_swipe-04.ogg",volumn:"0.15"},poemphraseDrag0:{delay:0,src:"Lift word/Lift_word-01.ogg",volumn:"0.1"},poemphraseDrag1:{delay:0,src:"Lift word/Lift_word-02.ogg",volumn:"0.05"},poemphraseDrag2:{delay:0,src:"Lift word/Lift_word-03.ogg",volumn:"0.05"},poemphraseDrag3:{delay:0,src:"Lift word/Lift_word-04.ogg",volumn:"0.1"},poemphraseDrop0:{delay:0,src:"Place word on game board/Place_word_on_game_board-01.ogg",volumn:"0.05"},poemphraseDrop1:{delay:0,src:"Place word on game board/Place_word_on_game_board-02.ogg",volumn:"0.05"},poemphraseDrop2:{delay:0,src:"Place word on game board/Place_word_on_game_board-03.ogg",volumn:"0.05"},poemphraseDrop3:{delay:0,src:"Place word on game board/Place_word_on_game_board-04.ogg",volumn:"0.05"},poemphraseDrop4:{delay:0,src:"Place word on game board/Place_word_on_game_board-05.ogg",volumn:"0.05"},poemphraseSwap0:{delay:0,src:"Move phrase up and down/move_phrase_up_and_down-01.ogg",volumn:"0.1"},poemrange0:{delay:0,src:"Slider Tick/slider_tick-01.ogg",volumn:"0.05"},scoringbonus0:{delay:0,src:"Scoring bonus normal/Scoring_bonus_normal-01.ogg",volumn:"0.3"},scoringbonusMult0:{delay:0,src:"Scoring bonus multiplyer/Scoring_bonus_multiplyer-01.ogg",volumn:"0.4"},scoringmessage0:{delay:"150",src:"score_result_message/score_result_message-01.ogg",volumn:"0.15"},scoringword0:{delay:0,src:"Scoring for words/Scoring_for_words-01.ogg",volumn:"0.25"},selectTool0:{delay:0,src:"Using the select tool/Using_the_select_tool-01.ogg",volumn:"0.1"},selectTool1:{delay:0,src:"Using the select tool/Using_the_select_tool-02.ogg",volumn:"0.2"},selectTool2:{delay:0,src:"Using the select tool/Using_the_select_tool-03.ogg",volumn:"0.05"},selectTool3:{delay:0,src:"Using the select tool/Using_the_select_tool-04.ogg",volumn:"0.1"},selectTool4:{delay:0,src:"Using the select tool/Using_the_select_tool-05.ogg",volumn:"0.05"},selectTool5:{delay:0,src:"Using the select tool/Using_the_select_tool-06.ogg",volumn:"0.05"},selectTool6:{delay:0,src:"Using the select tool/Using_the_select_tool-07.ogg",volumn:"0.25"},selectTool7:{delay:0,src:"Using the select tool/Using_the_select_tool-08.ogg",volumn:"0.05"},selectTool8:{delay:0,src:"Using the select tool/Using_the_select_tool-09.ogg",volumn:"0.1"},shrinkTile0:{delay:0,src:"Shrink picture tiles/Shrink_picture_tiles-01.ogg",volumn:"0.3"},shrinkTile1:{delay:0,src:"Shrink picture tiles/Shrink_picture_tiles-02.ogg",volumn:"0.25"},wordlift0:{delay:0,src:"Lift word/Lift_word-01.ogg",volumn:"0.1"},wordlift1:{delay:0,src:"Lift word/Lift_word-02.ogg",volumn:"0.2"},wordlift2:{delay:0,src:"Lift word/Lift_word-03.ogg",volumn:"0.05"},wordlift3:{delay:0,src:"Lift word/Lift_word-04.ogg",volumn:"0.2"},wordplace0:{delay:0,src:"Place word on game board/Place_word_on_game_board-01.ogg",volumn:"0.2"},wordplace1:{delay:0,src:"Place word on game board/Place_word_on_game_board-02.ogg",volumn:"0.2"},wordplace2:{delay:0,src:"Place word on game board/Place_word_on_game_board-03.ogg",volumn:"0.15"},wordplace3:{delay:0,src:"Place word on game board/Place_word_on_game_board-04.ogg",volumn:"0.15"},wordplace4:{delay:0,src:"Place word on game board/Place_word_on_game_board-05.ogg",volumn:"0.2"},wordplaceBack0:{delay:0,src:"Place word back on workspace/Place_word_back_on_workspace-01.ogg",volumn:"0.2"},wordplaceBack1:{delay:0,src:"Place word back on workspace/Place_word_back_on_workspace-02.ogg",volumn:"0.15"},wordplaceBack2:{delay:0,src:"Place word back on workspace/Place_word_back_on_workspace-03.ogg",volumn:"0.15"},wordplaceBack3:{delay:0,src:"Place word back on workspace/Place_word_back_on_workspace-04.ogg",volumn:"0.1"},wordplaceBack4:{delay:0,src:"Place word back on workspace/Place_word_back_on_workspace-05.ogg",volumn:"0.15"},wordplaceBack5:{delay:0,src:"Place word back on workspace/Place_word_back_on_workspace-06.ogg",volumn:"0.25"},wordrelated0:{delay:0,src:"Wiggly Word/wiggly_word-01.ogg",volumn:"0.1"},wordselect0:{delay:"200",src:"Word Select/word_select-01.ogg",volumn:"0.2"},wordselect1:{delay:0,volumn:"0.35"},wordselect2:{delay:0,volumn:"0.45"},wordselect3:{delay:0,volumn:"0.35"},wordshow0:{delay:0,src:"New words appearing-01/New_words_appearing-01.ogg",volumn:"0.25"},wordshow1:{delay:0,src:"New words appearing-01/New_words_appearing-02.ogg",volumn:"0.35"},wordshow2:{delay:0,src:"New words appearing-01/New_words_appearing-03.ogg",volumn:"0.1"},wordshow3:{delay:0,src:"New words appearing-01/New_words_appearing-04.ogg",volumn:"0.15"},wordshow4:{delay:0,src:"New words appearing-01/New_words_appearing-05.ogg",volumn:"0.2"},wordshow5:{delay:0,src:"New words appearing-01/New_words_appearing-06.ogg",volumn:"0.25"},wordwiggling0:{delay:0,src:"Wiggly Word/wiggly_word-01.ogg",volumn:"0.15"}}}),n("api/Sound",["api/helper/Log","sounds/manifest","sounds/manifest.meta","firebase"],function(e,t,n){function i(e){function t(){c++,f.onLoad(c/a.length),c==a.length&&u.resolve(c)}function i(e,t,n){var i=e[t],o=s;n&&(o=s[n]),o[t]=[];for(var r=0;r<i.length;r++)"string"==typeof i[r]&&(i[r]={src:i[r],volumn:1,delay:0}),"number"!=typeof i[r].volumn&&(i[r].volumn=1),"number"!=typeof i[r].delay&&(i[r].delay=0),a.push({id:n+t+r,src:i[r].src}),o[t].push(n+t+r),l[n+t+r]=i[r]}var a=[],s={},l={},c=0,u=$.Deferred(),d=$.Deferred();for(var p in e)if(!p.match("__"))if(e[p].push)i(e,p,"");else{s[p]={};for(var h in e[p])i(e[p],h,p)}createjs.Sound.addEventListener("fileload",t);var f=this;this.sounds=s,this.metaSounds=l,this.load=function(){function e(e){for(var t in e)l[t]||(l[t]={volumn:1,delay:0}),l[t].volumn=e[t].volumn,l[t].delay=e[t].delay;d.resolve()}r?(createjs.Sound.alternateExtensions=["mp3"],createjs.Sound.registerManifest(a,"sounds/"),o?o.on("value",function(t){console.log(JSON.stringify(t.val())),t.val()&&e(t.val())}):e(n)):(f.onLoad(1),u.resolve(),d.resolve())},this.onLoad=function(){},this.loaded=$.when(u,d)}var o=null,r=!0;return i.prototype.save=function(e){o.set(this.metaSounds,e)},i.prototype.play=function(t,n){if(e.instance.log("Play Sound",t,e.themes.sound),r&&t&&(!t.push||0!=t.length)){var i,o;if(t.push){var a=0;do a=Math.floor(Math.random()*t.length);while(t.prev==a&&t.length>1);t.prev=a,i=t[a]}else i=t;var o=createjs.Sound.play(i);o.setVolume(this.metaSounds[i].volumn);var s=this.metaSounds[i].delay;return s&&(o.stop(),Task.run(function(){o.play()},s)),n||"niklas"!=app.ctx.username||toastr.success(o.src.split(/\//gi)[2],null,{timeOut:5e3}),o}},i.prototype.fade=function(e){function t(){e.setVolume(9*e.getVolume()/10)}if(r){for(var n=new Task.Queue,i=0;20>i;i++)n.runAfter(t,50);n.runAfter(function(){e.stop()})}},new i(t)}),n("dialogs/_builder",["durandal/system","durandal/app","durandal/composition","durandal/activator"],function(e,t,n,i){function o(e){var t=document.getElementById(e?"fixed":"app"),n=t.querySelector("."+d);return n||(n=document.createElement("div"),n.className=d,t.appendChild(n)),n}function r(t,n){var i=t.attributes.fixed;"object"==typeof n&&(i=void 0===n.fixed?i:n.fixed);var r=o(i);return e.defer(function(n){function i(){var i=$("<div/>",{module:t.__moduleId__}).appendTo(r).get(0);p[t.__moduleId__]={ready:e.defer()},n.resolve(i)}if(t.attributes.singleton){c(t.__moduleId__,{msg:"queue"}).then(i)}else i()}).promise()}function a(t){return e.defer(function(n){function i(e){e.attributes=e.attributes||{fixed:!1,singleton:!0},n.resolve(e)}e.isString(t)?e.acquire(t).then(function(t){i(e.resolveObject(t))}):i(t)}).promise()}function s(e,t){var n={model:e,activate:!1};return t&&t.compositionComplete&&(n.compositionComplete=t.compositionComplete),n.bindingComplete=function(){var e=this.model;if(e.images){var t=new Image;t.onload=function(){e.load.apply(e)},t.src=e.el.css("background-image").replace(/url|[\'\"\(\)]/g,"")}},n}function l(t,o,l){return e.defer(function(e){a(t).then(function(a){r(a,o).then(function(r){var c=i.create();c.activateItem(a,o).then(function(t){t||e.reject()}).then(function(){var i=a.__dialog__={owner:a,context:l,activator:c,host:r,settings:s(a,l)};i.close=function(){var n=arguments,o=n.length?n[n.length-1]:{};return delete p[t],o&&o.forced&&e.resolve.apply(e,n),c.deactivateItem(i.owner,!0).then(function(){ko.removeNode(i.host),delete i.owner.__dialog__,o&&o.forced||e.resolve.apply(e,n)})},a.onClose=a.forceClose=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);e.push({forced:!0}),i.close.apply(this,e)},p[t].ready.resolve(i),p[t]&&n.compose(i.host,i.settings)})})}).promise()})}function c(e,t){return e in p?$.Deferred(function(n){p[e].ready.then(function(e){e.close(t).then(function(){n.resolve()})},function(){n.resolve()})}):h}function u(){return e.defer(function(e){var t=[];for(var n in p)t.push(c(n,{force:!0}));$.when.apply(this,t).always(function(){e.resolve()})}).promise()}var d="dialogs",p={},h=$.Deferred(function(e){e.resolve()}).promise();return{_dialogs:p,show:function(e,t,n){return l("dialogs/templates/"+e,t,n)},close:function(e,t){return c("dialogs/templates/"+e,t)},closeAll:u}}),n("api/helper/history",[],function(){var e=[],t={pushHistory:function(t){return t.time=(new Date).toUTCString(),t.hash=location.hash,e.push(t)},pushIssue:function(n){n.time=(new Date).toUTCString(),n.hash=location.hash,n.event="issue",n.index=e.length,e.push(n),t.onError(n)},onError:function(){},getHistory:function(){return e},getIssues:function(){return e.filter(function(e){return"issue"==e.event})}};return t}),n("api/server/connection",["durandal/app","api/helper/history","api/helper/Log"],function(e,t,n){function i(i,r){i="server:"+i,e.on(i).then(function(a,c){return o(i,a)?void l.connected.then(function(){n.instance.log(i+" sent",a,n.themes.black),t.pushHistory({event:i,send:!0}),r(a,function(o){t.pushHistory({event:i,received:!0}),n.instance.log(i+" received",o,n.themes.black),o.success!==!0&&(n.instance.log(i,"success failed",n.themes.warn),403==o.code&&(n.instance.log(i,"403 forbidden",n.themes.red),e.trigger("access:forbidden",i),t.pushHistory({forbidden:!0,event:i,request:a,response:o}))),c&&(o.success!==!1||403!==o.code||"server:user:info"==i)&&c(o)},s)}):void n.instance.log(i,"invalid request!",n.themes.warn)})}function o(t,i){return e.ctx?("username"in i||(i.username=e.ctx.username),void 0==i.username?!1:(i.token=e.ctx.token,!0)):(n.instance.log("* "+t,i,n.themes.warn),!1)}var r,a="http://wozbeta.herokuapp.com:80",s=io.connect(a);s.on("connect",function(){n.instance.log("connected",null,n.themes.green),e.trigger("socket:status","connect"),e.trigger("socket:server",a.match(/devel/gi)),r=!0,t.pushHistory({event:"connected"})}),s.on("disconnect",function(){n.instance.log("disconnected",null,n.themes.red),e.trigger("socket:status","disconnect"),r=!1,t.pushHistory({event:"disconnected"})});var l={addEvent:i,addEmission:function(e){i(e,function(t,n,i){i.emit(e,t,n)})},addToken:o,socket:s,connected:$.Deferred(function(t){function n(i){"connect"==i&&t.resolve(),e.off("socket:status",n,t)}r&&t.resolve(),e.on("socket:status",n,t)}).promise()};return l}),n("api/server/events",["durandal/app","api/helper/history","api/helper/Log"],function(e,t,n){return{emission:["account:login","account:sign-up","account:recover-password","account:logout","game:move-word","game:place-phrase","game:more-words","game:skip-turn","game:resign","game:versions","game:search-word","game:add-word","lobby","friends","tutorial:place-phrase","tutorial:skip","user:collections","shop:collections","user:info","user:email","user:poem","shop:besoz","shop:storage","account:fb","account:delete","foes","user:suggest","payment:paypal-token","payment:paypal-confirm"],init:function(i){i.on("game:update",function(i){n.instance.log("game:update",i,n.themes.black),e.trigger("game:update",i),t.pushHistory({event:"game:update",received:!0})}),i.on("lobby:update",function(i){n.instance.log("lobby:update",i,n.themes.black),e.trigger("lobby:update",i),t.pushHistory({event:"lobby:update",received:!0})})},custom:{"game:swap-words":function(t,n,i){i.emit("game:swap-words",t,function(i){i.oldWords=t.words,e.trigger("game:swap-words",i),n&&n(i)})},"game:resume":function(t,n,i){i.emit("game:resume",t,function(t){t.resumedGame=!0,n(t),e.trigger("game:start",t)})},"game:queue":function(i,o,r){r.once("game:start",function(i){n.instance.log("game:start",i,n.themes.black),e.trigger("game:start",i),t.pushHistory({event:"game:start",received:!0})}),i.friendUsername?i.type="friend":(i.type=1==i.playerCount?"single":"random",delete i.friendUsername),delete i.playerCount,r.emit("game:request",i,o)},"tutorial:start":function(t,n,i){i.emit("tutorial:start",t,function(t){ko.utils.arrayForEach(t.tiles,function(e){e.instruction=e.instruction||e.shortDescription||"",e.description=e.description||e.longDescription||""}),t.title=t.id+1+". "+t.title,t.page=t.id+1+" / "+t.total,e.trigger("game:start",t),n(t)})}}}}),n("api/server/setup",["./connection","./events"],function(e,t){for(var n=0;n<t.emission.length;n++)e.addEmission(t.emission[n]);for(var i in t.custom)e.addEvent(i,t.custom[i]);t.init(e.socket)}),n("api/constants",[],function(){var e={bigImageURL:function(e,t){return"images/tiles/"+e+"/"+t+".jpg"},salt:"!XXX.666.ozma,is,awesome.666.XXX!"};return e}),n("dialogs/_constants",[],function(){return{YOUR_TURN_FIRST_ROUND:{heading:"IT'S YOUR TURN!",content:"Place a phrase on the game board to score. Use action buttons to the left."},YOUR_TURN:{heading:"IT'S YOUR TURN!",content:"Place a phrase on the game board to score. Use action buttons to the left."},THEIR_TURN:{heading:"IT'S YOUR OPPONENT'S TURN!",content:"Work on your masterpiece while you wait for your opponent to place a phrase."},CIRCLE_WORDS:{heading:"SELECT A PHRASE",content:'Place a whole phrase on the game board, <br/> by circling it and then choose a path to place it. <div class="select-pic"></div>'},CHOOSE_PATH:{heading:"CHOOSE A PATH",content:"Choose a path to place your phrase."},SWAP_WORDS:{heading:"SWAP WORDS",content:"Select the words you like to swap to exchange them for new ones."},TUT:{BONUS:{heading:"Bonus points",content:"Each phrase can<br>receive up to<br>two bonuses<br>by fulfilling the<br>bonus rules linked<br>to the images<br>it is placed in between."},RELATED:{heading:"Related words",content:"Marked words will<br>score 15 extra points<br>when put in a phrase<br>connected to the<br>right image."},ACTIONS:{heading:"Actions",content:"These are the<br>actions you can do<br>during your turn."},SWAP_WORDS:{heading:"Swap words",content:"Use this function to<br> swap any number of words<br> for random new ones."},ADD_WORDS:{heading:"Add word",content:"Add a word of<br>your choice."},WORD_ENDING:{heading:"Word ending",content:"Change a word to<br>the form of your<br>choice."},SELECT_PHRASE:{heading:"Select phrase",content:"Use this function to <br> circle a whole phrase <br> to place it all at once. <br> Words can also be placed <br> one by one."},WORKSPACE:{heading:"Workspace",content:"Scroll down to see<br>the whole of your<br>workspace."},GAMEBOARD:{heading:"Game board",content:"Place a phrase on<br>the game board to<br>score."},PLACE_PHRASE:{heading:"Place a phrase",content:"To score in this game<br>you need to <br>fill the paths <br>on the game board, <br> one at the time."},FILL_PATH:{heading:"Fill in the path",content:"Once the path is full,<br>the phrase will be accepted."},ARCHIVE_GAMES:{heading:"Game Archive",content:'To find your finished <br>games go to "My Games" <br> and check out the tab<br>called:<br>"Game Archive".'}}}}),n("api/model/Path",["durandal/app","api/constants","paper"],function(e){function n(e,t){for(var n in t)if(e[n]!=t[n])return!1;return!0}function i(n,i,r,a,s,l,c){var u=this;u.id=i,u.nWords=r,u.startTile=o.find(n.tiles(),{id:a}),u.endTile=o.find(n.tiles(),{id:s}),u.cw=void 0===l?!0:l,u.phrase={_complete:ko.observable(!1),playerId:0,score:0,words:ko.observableArray()},u.phrase.toString=function(){for(var e="",t=u.phrase.words().length,n=0;t>n;n++)e+=n+(n==t-1?"":" ");for(var n=0;t>n;n++)e=e.replace(u.phrase.words()[n].index,u.phrase.words()[n].word.lemma);return e},u.phrase.update=function(e){u.completeSub.dispose(),u.phrase.complete.immediate()||(0==u.nWords&&e&&e.length>=3&&u.phrase._complete(!0),ko.utils.arrayForEach(e||[],function(e){e._noPlaceSound=!0,u.addWord(e,void 0,!0)}))};var d=function(){return this.phrase._complete()===!0||0==this.nWords&&6==this.phrase.words().length||0!=this.nWords&&this.phrase.words().length==this.nWords};u.phrase.complete=ko.computed(d,u).extend({throttle:1}),u.phrase.complete.immediate=function(){return d.call(u)},u.completeSub=u.phrase.complete.subscribe(function(i){i&&(e.dialog.close("slipper"),e.Sound.play(e.Sound.sounds.phraseCompleted),e.dialog.show("confirm",{modal:!0,content:'Do you want to place <br/><b>"'+u.phrase.toString()+'"</b>?',doneText:"YES",cancelText:"NO"}).then(function(i){if(n.activeWords(null),paper.tool.remove(),"done"==i){e.loading(!0),n.player.active(!1),u.phrase.words().sort(function(e,t){return e.index-t.index});var o={gameID:n.gameID,pathID:u.id,username:n.player.username,words:ko.utils.arrayMap(u.phrase.words(),function(e){return e.word.id})};n.lastPath=u,e.ctx.tutorialMode()?(o.words=ko.utils.arrayMap(u.phrase.words(),function(e){return e.word.lemma}),e.trigger("server:tutorial:place-phrase",o,function(i){var o=t("game/tutorial");o.closeAll();var r=function(t){"string"==typeof t&&e.dialog.show("notice",{view:"dialogs/pages/alert",model:{message:t}}),n.player.active(!0),e.loading(!1),u.removeAll()},a=ko.utils.arrayFirst(n.unplayedWords(),function(e){return e.isRelated});if(a)return setTimeout(function(){r(o.showOne(o.relatedWords()))},500);if(""!=u.startTile.instruction&&!i.score.startTile.satisfied||""!=u.endTile.instruction&&!i.score.endTile.satisfied){var s=""==u.startTile.instruction||i.score.startTile.satisfied?u.endTile:u.startTile;return setTimeout(function(){r(o.showOne(o.bonusFor(s,s.bubble||null)))},500)}if(3==n.gameID&&ctx.paths()[0].phrase.complete.immediate()!=ctx.paths()[1].phrase.complete.immediate()){var s=n.tiles()[1],l=n.words().filter(function(e){return"s"==e.lemma[0]&&e.isPlayed});if(l.length>1)return setTimeout(function(){r(o.showOne(o.bonusFor(s,"You need words starting with <br> 'S' in both phrases to get <br> all the bonuses.")))
},500)}if(5==n.gameID&&n.tickets.versions()&&n.tickets.addWords()&&n.tickets.swapWords())return r("Please use at least one of the action items from the left menu to complete this tutorial.");if(ctx.player.scored=i.score.total,ctx.player.score(ctx.player.score()+i.score.total),ctx.player.active(!0),ko.utils.arrayForEach(i.score.words,function(e){e.id=ko.utils.arrayFirst(ctx.words(),function(t){return e.lemma==t.lemma}).id}),null==ko.utils.arrayFirst(ctx.paths(),function(e){return!e.phrase.complete.immediate()})){ctx._gameOver(!0);var c;c=e.on("game:stars:done").then(function(){e.trigger("game:tiles:visible",!1),ctx.tutorialObject().id>=ctx.tutorialObject().total-1?(e.trigger("server:tutorial:skip",{username:n.username}),e.dialog.show("notice",{view:"dialogs/pages/TutorialEnd"}).then(function(){e.navigate("newGame")})):e.dialog.show("notice",{view:"dialogs/pages/TutorialNext"}).then(function(){e.navigate("nextTutorial")}),c.off()})}e.trigger("game:updated",{path:{score:i.score}}),e.loading(!1)})):(u.completeSub.dispose(),e.trigger("server:game:place-phrase",o)),e.scrollUp()}else u.phrase._complete(!1),u.removeAll()})),ko.utils.arrayForEach(u.phrase.words(),function(e){e.word.isPlayed=i?2:1})}),u.hasWordAt=function(e){var t=u._getEntityAt(e);return null!=t?!0:!1},u.getWordAt=function(e){var t=u._getEntityAt(e);return null!=t?t.word:null},u._getEntityAt=function(e){return ko.utils.arrayFirst(u.phrase.words(),function(t){return t.index==e})},u._lastEmptyIndex=function(){for(var e=0;10>e;e++)if(null==ko.utils.arrayFirst(u.phrase.words(),function(t){return t.index===e}))return e},u.addWords=function(e){u.removeAll();for(var t=0;t<e.length;t++)if(!u.addWord(e[t]))return!1;return u.phrase._complete(!0),u.phrase.words.valueHasMutated(),!0},u.addWord=function(e,t,i){return n.player.active()||i===!0?(void 0===t&&(t=u._lastEmptyIndex()),0==u.nWords&&t>=9||0!=u.nWords&&t>=u.nWords?!1:(u.hasWordAt(t)&&(u.removeWordAt(t),console.log("%cWhen?","background: red; color: white")),e.isPlayed&&0==u.nWords&&e.lastBox.pathModel==u?!1:(e.isSelected&&e.isSelected(!1),e.isPlayed=1,n.words.valueHasMutated(),u.phrase.words.push({word:e,index:t}),!0))):!1},u.removeAll=function(){for(var e=u.phrase.words(),t=0;t<e.length;t++)e[t].word.isPlayed=0,delete e[t].word.lastBox,delete e[t].word.soundPlayed;u.phrase._complete(!1),u.phrase.words.removeAll(),n.words.valueHasMutated()},u._removeEntity=function(e,t){if(null==e)return!1;if(t=t||{},t.keepUnplayed||(e.word.isPlayed=0),0==u.nWords){var i=u.phrase.words().indexOf(e);u.phrase.words().splice(i,1)}else delete e.word.lastBox,u.phrase.words.remove(e);return n.words.valueHasMutated(),!0},u.removeWordAt=function(e,t){var n=u._getEntityAt(e);if(u._removeEntity(n,t)&&0==u.nWords){n.word.lastBox.index=u.phrase.words().length,delete n.word.lastBox;for(var i=n.index+1;10>i&&null!=(n=u._getEntityAt(i));i++)n.index--,n.word.lastBox&&n.word.lastBox.index--;u.phrase.words.valueHasMutated()}},c&&(u.phrase.update(c.words),u.phrase.id=c.id)}var o={find:function(e,t){for(var i=0;i<e.length;i++)if(n(e[i],t))return e[i]}};return i}),n("api/context/storage",[],function(){function e(e,t,n){function i(){localStorage.removeItem(o());for(var e in n)localStorage.removeItem(o(e))}function o(t){return e()+(t?"."+t:"")}function r(e){return JSON.parse(JSON.stringify(e))}function a(e,t){localStorage.setItem(o(e),JSON.stringify(t)),c[e]=r(t)}function s(e,t){if(!t&&c[e])return c[e];var i=localStorage.getItem(o(e));return c[e]=i?JSON.parse(i):n[e],c[e]}function l(e){return r(s(e))}var c={};"function"!=typeof e&&(e=function(e){return function(){return e}}(e)),n=n||{"null":null},t=t||1;var u=localStorage.getItem(o("ver"));u!=t&&i(),localStorage.setItem(o("ver"),t);var d={};for(var p in n)!function(e){d[e]={save:function(t){return a(e,t)},load:function(t){return s(e,t)},loadCopy:function(){return l(e)}}}(p);return d.save=function(e){return a(null,e)},d.load=function(e){return s(null,e)},d.removeAll=i,d}return window.STG=e}),n("api/context/lobby",["durandal/app","./storage"],function(e,t){function n(){function n(){if(f){var t=f.since.load();t&&!g.games().length&&g.games(p(f.games.loadCopy())),g.loading(!0),e.trigger("server:lobby",{username:h.username,modDate:t},function(e){e.success&&(a(e.deletedIDs),e.games.length&&s(e.games)),g.loading(!1)})}}function o(e){g.games.removeAll(),g.notifications.removeAll(),h=e,h.online&&(f=new t("lobby["+h.username+"]",i,{games:[],since:0}))}function r(e){return e.sort(function(e,t){return t.modDate===e.modDate?t.gameID-e.gameID:t.modDate-e.modDate})}function a(e){if(e&&0!=e.length){for(var t=f.games.load(),n=!1;e.length;)for(var i=e.pop(),o=0;o<t.length;o++)if(t[o].gameID==i){t.splice(o,1),n=!0;break}f.games.save(t),n&&(g.games.removeAll(),g.notifications.removeAll(),g.games(p(f.games.loadCopy())))}}function s(t){var n=f.games.load(),i=!1;r(t);for(var o,a=0;o=t[a++];){var s=n.some(function(e){return e.gameID==o.gameID&&e.modDate==o.modDate&&!e.local});if(!s){var c=!1;i=!0,u(o);var p=ko.utils.arrayFirst(n,function(e){return e.gameID==o.gameID});p?(c=p.seen,d(p,o)):(p=o,n.push(o)),p.over||(p.seen=c),e.trigger("lobby:changed",p)}}i&&(r(n),f.games.save(n),f.since.save(n.length?n[0].modDate:0),l(n))}function l(e){for(var t,n=g.games(),i=e.length-1;t=e[i--];){var o=ko.utils.arrayFirst(n,function(e){return e.gameID===t.gameID});o?d(o,t):n.unshift(t)}p(n),r(n),g.games.valueHasMutated(),g.notifications.valueHasMutated()}function c(){if(f){for(var e=f.games.load(),t=g.games(),n=0;n<e.length;n++){var i=ko.utils.arrayFirst(t,function(t){return t.gameID==e[n].gameID});i&&d(e[n],i)}f.games.save(e)}}function u(e){e.changed=!0}function d(e,t){e.players=t.players,e.over=t.over,e.modDate=t.modDate,e.lastPhrase=t.lastPhrase,e.seen=!!t.seen,e.seenOngoing=!!t.seenOngoing,t.changed?e.changed=!0:delete e.changed}function p(e){for(var t=0;t<e.length;t++){var n=e[t];for(var i in v)n[i]=v[i];n.playerCount>1&&1==n.players.length&&n.players.push({username:"unknown",active:!n.players[0].active,resigned:!1,score:0}),n.winner=v.getWinner.call(n),n.player=v.getPlayer.call(n),n.opponent=v.getOpponent.call(n),n.loser=v.getLoser.call(n),n.won=n.getWinner().username==h.username,n.resigned=n.players[0].resigned||n.players.length>1&&n.players[1].resigned,n.creator=n.creator||n.players[0].username,n.isPlayerCreator=n.creator==h.username,n.newGame=!!n.newGame,n.seen=!!n.seen,n.seenOngoing=!!n.seenOngoing,n.changed&&(n.seen&&n.over&&(n.seen=!1),n.seenOngoing=!1,delete n.summary,delete n.notificationSummary,delete n.changed)}return e}var h,f,g=this;this.games=ko.observableArray(),this.notifications=ko.observableArray(),this.loading=ko.observable(!1);var m=ko.observable(0);this.unseens=ko.computed(function(){var e=g.notifications();return m(),ko.utils.arrayFilter(e,function(e){return!e.seen&&(e.over||!e.over&&e.newGame)}).length}),this.seenAll=function(){ko.utils.arrayForEach(g.notifications(),function(e){e.seen=!0,delete e.changed}),c(),m(m()+1)},this.seenAllOngoing=function(){ko.utils.arrayForEach(g.games(),function(e){e.seenOngoing=!0,delete e.changed}),c()},this.games.subscribe(function(t){for(var n,i=g.notifications(),o=0;n=t[o++];)if(2==n.playerCount){var a=ko.utils.arrayFirst(i,function(e){return e.gameID==n.gameID});if(!a&&(n.seen||e.Sound.play(e.Sound.sounds.notification),i.push(n),!n.isPlayerCreator)){var s=Object.beget(n);s.newGame=!0,s.seen=!!n.seen,s.modDate=s.creationDate,i.push(s)}}r(i),g.notifications.valueHasMutated()}),e.on("user:authenticated").then(o),e.on("account:login").then(function(e){o({username:e.username,online:1}),n()}),e.on("lobby:update").then(function(){n()}),e.on("game:update").then(function(e){var t=ko.utils.arrayFirst(g.games(),function(t){return t.gameID==e.gameID});if(t){var n=t.seen;t.over=e.over,t.players=e.players,t.modDate=+new Date,t.local=!0,u(t),p([t]),t.resigned||(t.lastPhrase={phrase:ko.utils.arrayMap(e.path.phrase,function(e){return e.lemma}).join(" "),score:e.path.score.total,username:e.path.username},t.seenOngoing=e.path.username==h.username),t.over||(t.seen=n);var i=g.games.indexOf(t);g.games().splice(i,1),g.games().unshift(t),c(),g.games.valueHasMutated(),t.over&&2==t.players.length&&g.notifications.valueHasMutated()}}),e.on("game:started").then(function(e){var t=ko.utils.arrayFirst(g.games(),function(t){return t.gameID==e.id});t?(t.seen=!0,t.seenOngoing=!0,c(),g.games.valueHasMutated()):n()});var v={getPlayer:function(){return this.players[0].username===h.username?this.players[0]:this.players[1]},getOpponent:function(){return this.players[0].username===h.username?this.players[1]:this.players[0]},getWinner:function(){return 1==this.players.length?this.players[0]:this.resigned?this.players[0].resigned?this.players[1]:this.players[0]:this.players[0].score>this.players[1].score?this.players[0]:this.players[1]},getLoser:function(){return 1==this.players.length?this.players[0]:this.resigned?this.players[0].resigned?this.players[0]:this.players[1]:this.players[0].score<this.players[1].score?this.players[0]:this.players[1]}}}var i=.54;return Object.beget=function(e){return function(t){return e.prototype=t,new e}}(function(){}),new n}),n("api/context/shop",["durandal/app","./storage"],function(e){function t(){var t=this;this.loading=ko.observable(!1),this.collections=ko.observableArray(),this.collections.load=function(){return t.collections().length?!0:(t.loading(!0),void e.trigger("server:shop:collections",{username:ctx.username},function(e){ko.utils.arrayForEach(e,function(e){e.price=+e.price,e.shortDescription=e.shortDescription||e.description,e.longDescription=e.longDescription||e.description,e.example='"'+(e.example||"")+'"',e.example='""'==e.example?"":e.example,e.description=e.description||e.shortDescription||"",ko.utils.arrayForEach(e.boosters,function(e){e.shortDescription=e.shortDescription||e.description,e.longDescription=e.longDescription||e.description,e.description=e.description||e.shortDescription||"",e.example='"'+(e.example||"")+'"',e.example='""'==e.example?"":e.example})}),t.collections(e),t.loading(!1)}))},this.collections.buy=function(n,i){return $.Deferred(function(o){t.loading(!0),i.command="buy",i.username=n.username,e.trigger("server:shop:collections",i,function(e){e.success?o.resolve(i):o.reject(i),t.loading(!1)})})},this.besozes=ko.observableArray(),this.besozes.load=function(){return t.besozes().length?n:$.Deferred(function(n){t.loading(!0),e.trigger("server:shop:besoz",{},function(e){t.besozes(e),t.loading(!1),n.resolve(e)})})},this.besozes.buy=function(n,i){return $.Deferred(function(o){t.loading(!0),i.command="buy",i.username=n.username,e.trigger("server:shop:besoz",i,function(e){e.success?o.resolve(i):o.reject(i),t.loading(!1)})})},this.storageSpaceList=ko.observableArray(),this.storageSpaceList.load=function(){t.storageSpaceList().length||(t.loading(!0),e.trigger("server:shop:storage",{},function(e){for(var n=0;n<e.length;n++)e[n].text=e[n].storage+" games",0==e[n].storage&&(e[n].text="unlimited games");t.storageSpaceList(e),t.loading(!1)}))},this.storageSpaceList.buy=function(n,i){return $.Deferred(function(o){t.loading(!0);var r={amount:i.storage,command:"buy",username:n.username};e.trigger("server:shop:storage",r,function(e){e.success?o.resolve(r):o.reject(r),t.loading(!1)})})}}var n=$.Deferred().resolve().promise();return new t}),n("api/context/user.friends",["durandal/app"],function(e){function t(e){u.removeAll(),c=e.username,e.online&&n()}function n(){return u.loading(!0),s("getAll").then(function(e){return e.success&&(e.friends.sort(function(e,t){return e.username>t.username}),e.friends.forEach(function(e){e.isFriend=!0}),u(e.friends)),u.loading(!1),e.friends||[]})}function i(e){return s("search",e).then(function(e){return e.users&&e.users.forEach(function(e){e.isFriend=l(e.username)?!0:!1}),e.users||[]})}function o(e){return e.success&&n(),e}function r(e){return s("add",e).then(o)}function a(e){return s("delete",e).then(o)}function s(t,n){return $.Deferred(function(i){e.trigger("server:friends",{username:c,command:t,friendUsername:n},function(e){i.resolve(e)})})}function l(e){return u().some(function(t){return t.username==e})}var c,u=ko.observableArray();return u.load=n,u.has=l,u.search=i,u.add=r,u.del=a,u.loading=ko.observable(!1),e.on("account:login").then(function(e){t({username:e.username,online:1})}),e.on("user:authenticated").then(t),u}),n("api/context/user.block",["durandal/app"],function(e){function t(e){c.removeAll(),l=e.username,e.online&&n()}function n(){return c.loading(!0),a("getAll").then(function(e){e.success&&(e.foes.sort(function(e,t){return e.username>t.username}),c(e.foes)),c.loading(!1)})}function i(e){return e.success&&n(),e}function o(e){return a("add",e).then(i)}function r(e){return a("delete",e).then(i)}function a(t,n){return $.Deferred(function(i){e.trigger("server:foes",{username:l,command:t,foeUsername:n},function(e){i.resolve(e)})})}function s(e){return c().some(function(t){return t.username==e})}var l,c=ko.observableArray();return c.load=n,c.has=s,c.add=o,c.del=r,c.loading=ko.observable(!1),e.on("account:login").then(function(e){t({username:e.username,online:1})}),e.on("user:authenticated").then(t),c}),n("api/context/user.poems",["durandal/app"],function(e){function t(){c.mine.removeAll(),c.friends.removeAll()}function n(e,t,n){var i=ko.unwrap(e),o=!1;t=t.reverse(),t.forEach(function(e){var t=i.filter(function(t){return t.id===e.id});if(t.length){var r=t[0];for(var a in e)ko.isObservable(r[a])?r[a](ko.unwrap(e[a])):r[a]=-1!=n.indexOf(a)?ko.observable(e[a]):e[a]}else n.forEach(function(t){e[t]=ko.observable(e[t])}),i.unshift(e),o=!0});for(var r=0;r<i.length;r++)t.some(function(e){return e.id==i[r].id})||(i.splice(r--,1),o=!0);o&&ko.isObservable(e)&&e.valueHasMutated()}function i(e){return c.loading(!0),l(e?"getAll":"friends").then(function(t){t.success&&(t.poems.forEach(function(e){e.imageName=e.imageID?"images/tiles/"+e.collection+"/"+e.imageID+".jpg":void 0,e.likes=e.likes||0,e.liked=e.liked||!1,e.creationDate=e.creationDate||0,e.opponent=e.opponent||""}),t.poems.sort(function(e,t){return t.creationDate-e.creationDate}),e?n(c.mine,t.poems,["likes","liked"]):n(c.friends,t.poems,["likes","liked"])),c.loading(!1)})}function o(e){return l("add",e)}function r(e){return l("delete",{id:e})}function a(e){return l("like",{id:e}).then(function(t){if(t.success){var n=c.friends().filter(function(t){return t.id==e});n[0].likes(t.likes),n[0].liked(!0)}})}function s(e){return l("unlike",{id:e}).then(function(t){if(t.success){var n=c.friends().filter(function(t){return t.id==e});n[0].likes(t.likes),n[0].liked(!1)}})}function l(t,n){var i=$.extend({command:t},n);return $.Deferred(function(t){e.trigger("server:user:poem",i,function(e){t.resolve(e)})})}var c={mine:ko.observableArray(),friends:ko.observableArray(),load:i,add:o,del:r,like:a,unlike:s,loading:ko.observable(!1)};return e.on("account:login").then(t),e.on("user:authenticated").then(t),c}),n("api/context/user",["durandal/app","./shop","api/context/user.friends","api/context/user.block","api/context/user.poems"],function(e,t,n,i,o){function r(){function r(e){l.collections.removeAll(),l.username=e.username,s=e,s.online&&a()}function a(){l.loading(!0),e.trigger("server:user:info",{username:l.username,targetUsername:l.username},function(e){e.success&&(ko.utils.arrayForEach(e.collections,function(e){e.desc=e.boosters&&e.boosters.length?"+ "+e.boosters.map(function(e){return e.longName}):"No boosters"}),l.collections(e.collections),l.besoz(e.besoz),l.email(e.email),l.emailNew(e.emailNew),l.emailEnd(e.emailEnd),l.emailPhrase(e.emailPhrase),l.level(e.level),l.storage(e.storage),l.xp(e.xp),l.xpMax(e.xpMax||100),l.title(e.title),l.ready.resolve()),l.loading(!1)})}var s,l=this;this.username="",this.besoz=ko.observable(0),this.email=ko.observable(""),this.emailEnd=ko.observable(!1),this.emailNew=ko.observable(!1),this.emailPhrase=ko.observable(!1),this.storage=ko.observable(0),this.level=ko.observable(0),this.xp=ko.observable(0),this.xpMax=ko.observable(100),this.title=ko.observable(""),this.collections=ko.observableArray(),this.friends=n,this.poems=o,this.ready=$.Deferred(),this.loading=ko.observable(!1),this.buyBesoz=function(n){return t.besozes.buy(s,{amount:n}).then(function(){l.besoz(l.besoz()+n)}).fail(function(){e.dialog.show("alert",{content:"rejected"})})},this.buyCollection=function(e,n){return t.collections.buy(s,{type:e,name:n}).then(function(){a()}).fail(function(){})},this.buyStorageSpace=function(n){return t.storageSpaceList.buy(s,n).then(function(){a()}).fail(function(){e.dialog.showNoBesoz(n.price)})},this.block=i,this.refresh=function(){a()},e.on("account:login").then(function(e){r({username:e.username,online:1})}),e.on("user:authenticated").then(r)}return new r}),n("api/datacontext",["durandal/system","plugins/router","durandal/app","api/constants","dialogs/_constants","api/model/Path","api/context/lobby","api/context/user","api/context/shop"],function(e,t,n,i,o,r,a,s,l){function c(e,t){function n(e,t){for(var n in t)if(e[n]!==t[n])return!1;return!0}for(var i=0;i<e.length;i++)if(n(e[i],t))return e[i]}n.on("game:update").then(function(e){n.trigger("game:update:ctx",e)});var u={lobby:a,user:s,shop:l,gameID:0,player:{active:ko.observable()},players:ko.observableArray(),tiles:ko.observableArray(),paths:ko.observableArray(),words:ko.observableArray(),loading:ko.observable(null),loadingStatus:ko.observable(""),loadingBox:ko.observable(!1),activeWord:ko.observable(null),activeWords:ko.observable(null),playerCount:1,tickets:{swapWords:ko.observable(1),versions:ko.observable(1),addWords:ko.observable(1),reset:function(e){u.tickets.swapWords(e.swapWords),u.tickets.addWords(e.addWords),u.tickets.versions(e.versions)}},allowCircle:ko.observable(!0)};return u.collection={name:ko.observable("woz"),size:ko.observable(30)},n.ctx=u,u.username=localStorage.getItem("username"),u.token=localStorage.getItem("token"),u.auth=$.Deferred(function(e){n.trigger("server:user:info",{targetUsername:u.username},function(t){if(t.success)n.trigger("user:authenticated",{username:u.username,online:1}),e.resolve();else{{location.hash.substr(1)}u.logout(),e.reject()}n.on("access:forbidden",function(){console.log("access forbidden called"),u.auth=$.Deferred(function(e){e.reject()}).promise(),n.navigate("account/logout")})})}).promise(),u.logout=function(){u.auth=$.Deferred(function(e){e.reject(),n.loading(!1),u.loading(!1),u.token=null,localStorage.removeItem("token"),console.log("redirecting to login"),window.location="http://"+location.host}).promise()},n.on("toContext:account:login",function(e){u.auth=$.Deferred(function(t){e.success?(u.username=e.username,u.token=e.token,sessionStorage.removeItem("lobby"),localStorage.setItem("username",u.username),localStorage.setItem("token",u.token),t.resolve()):t.reject()}).promise()}),u._gameOver=ko.observable(!1),u.gameOver=ko.computed(function(){var e=ko.utils.arrayFilter(this.paths(),function(e){return e.phrase.complete()===!0});return 0!==e.length&&e.length===this.paths().length?!0:this._gameOver()},u),u.mode=ko.observable(""),u.words.immovable=ko.computed(function(){return"swapWords"===u.mode()}),u.tutorialMode=ko.observable(!1),u.tutorialObject=ko.observable(),n.on("lobby:changed",function(e){if(e.gameID==u.gameID){var t=ko.utils.arrayFirst(ctx.players(),function(e){return"unknown"==e.username});if(t){var i=ko.utils.arrayFirst(e.players,function(e){return e.username!=u.username});i&&n.trigger("game:random-player:update",i.username)}}}),n.on("game:random-player:update",function(e){for(var t,n=0;t=u.players()[n++];)"unknown"==t.username&&(t.username=e,ctx.players.splice(n-1,1),ctx.players.splice(n-1,0,t))}),u.load=function(t){var a=n.Sound.play(n.Sound.sounds.game.loading);if(console.log("loading game.."),n.off("game:start game:update:ctx game:swap-words"),u.loading(!0),n.dialog.show("loading"),(""===t||void 0===t)&&(t=-1),location.hash.match(/tutorial/gi)){u.tutorialMode(!0),"next"==t.toString().toLowerCase()?t=+localStorage.getItem("tutorial-index")+1:"new"==t.toString().toLowerCase()&&(t=+localStorage.getItem("tutorial-index"),t>=5&&(t=0)),t=isNaN(t)?0:1*t;var s=u.tutorialObject();s&&(s.title="",s.description="")}else u.tutorialMode(!1),t=isNaN(t)?-1:1*t;u.activeWord(null),u.activeWords(null);var l=$.Deferred();return n.on("game:start",function(e){if(0!=e.success){if(n.Sound.fade(a),n.Sound.play(n.Sound.sounds.game.unfolding),u.tutorialMode()?(history.replaceState(null,"","#tutorial/"+e.id),e.skip=function(){n.dialog.show("confirm",{modal:!0,content:"Do you want to skip all tutorials?",doneText:"YES",cancelText:"NO"}).then(function(e){"done"==e&&(n.trigger("server:tutorial:skip",{username:u.username}),n.navigate("newGame"))})},e.description=e.description.replace("<b>select tool</b>",'<b>select tool </b><i class="action circleWords inline"></i>'),u.tutorialObject(e),localStorage.setItem("tutorial-index",e.id)):history.replaceState(null,"","#game/"+e.id),u.loadingStatus("Starting The Game..."),u.gameID=e.id,u.playerCount=e.playerCount,u.collection.name(e.collection&&e.collection.shortName?e.collection.shortName:"woz"),u.collection.size(e.collection&&e.collection.size?e.collection.size:30),u.resumedGame=e.resumedGame||!1,ko.utils.arrayForEach(e.players,function(e){e.username===u.username?(u.player.active(e.active),e.active=u.player.active):e.active=ko.observable(e.active),e.resigned=ko.observable(e.resigned||!1),e.score=ko.observable(e.score)}),u.player=c(e.players,{username:u.username}),u.players(e.players),u.playerCount>1&&!e.over){1==u.players().length&&u.players.unshift({active:ko.observable(!1),resigned:ko.observable(!1),score:ko.observable(0),username:"unknown"});var t;t=u.player.active()?o.YOUR_TURN_FIRST_ROUND:o.THEIR_TURN;var s=n.on("game:started:ready").then(function(){location.hash.match(/#game/gi)&&n.dialog.show("slipper-fixed",t),s.off()})}void 0==e.allowCircle&&(e.allowCircle=!0),void 0==e.tickets&&(e.tickets={swapWords:e.swapWord,versions:e.version,addWords:e.addWord}),u.tickets.reset(e.tickets),u.allowCircle(e.allowCircle),ko.utils.arrayForEach(e.words,function(t){t.isSelected=ko.observable(!1),t.css="",ko.utils.arrayFilter(e.words,function(e){return t.id===e.id}).length>1&&(t.isPlayed=!0)}),u.words(e.words);for(var d=0;d<e.tiles.length;d++)e.tiles[d].imageId=e.tiles[d].imageID,e.tiles[d].imageName=i.bigImageURL(u.collection.name(),e.tiles[d].imageId),e.tiles[d].info=0!==e.tiles[d].bonus?"+"+e.tiles[d].bonus:"X"+e.tiles[d].mult,e.tiles[d].active=ko.observable(!1);u.tiles(e.tiles),e.paths=ko.utils.arrayMap(e.paths,function(e){return new r(u,e.id,e.nWords,e.startTile,e.endTile,e.cw,e.phrase)}),u.paths(e.paths),u._gameOver(e.over),u.winner=function(){if(u.gameOver()){var e=-1,t=null;return ko.utils.arrayForEach(u.players(),function(n){e<n.score()&&!n.resigned()&&(t=n,e=n.score())}),t}return null},u.loading(!1),u.loadingStatus("Ready"),n.dialog.close("loading"),n.trigger("game:started",e),l.resolve()}}),n.on("game:update:ctx",function(t){if(n.loading(!1),t.success||t.gameID!=u.gameID||(n.dialog.show("alert",{content:"Your phrase has been rejected by the server."}),ctx.lastPath.removeAll(),ctx.player.active(!0)),t.success&&t.gameID==u.gameID){if(void 0==t.allowCircle&&(t.allowCircle=!0),void 0==t.tickets&&(t.tickets={swapWords:void 0===t.swapWord?1:t.swapWord,versions:void 0===t.version?1:t.version,addWords:void 0===t.addWord?1:t.addWord}),u.tickets.reset(t.tickets),u.allowCircle(t.allowCircle),u._gameOver(t.over||!1),u.gameOver()){n.dialog.closeAll();var i,r=$.Deferred(function(t){e.acquire("dialogs/pages/GameOver").then(function(e){var i,o=u.winner();return i=o===u.player?1==u.playerCount?e.SOLO():e.WON():e.LOST(),u.player.resigned()?void n.navigate("lobby"):((u.players()[0].resigned()||2==u.playerCount&&u.players()[1].resigned())&&(i=e.RESIGNED()),void t.resolve(i))})});i=n.on("game:score:done").then(function(){r.then(function(e){n.trigger("game:tiles:visible",!1),t.stats=t.stats||{xp:-1,levelUp:!1},e.xp=t.stats.xp,n.dialog.show("notice",{model:e,view:"dialogs/pages/GameOver",closeOnClick:!1}).then(function(e){t.stats.levelUp?(t.stats.title?(t.stats.imageName="images/game/level/"+t.stats.title.toLowerCase()+".png",n.Sound.play(n.Sound.sounds.game.levelUpTitle)):n.Sound.play(n.Sound.sounds.game.levelUp),n.dialog.show("notice",{model:t.stats,view:t.stats.title?"dialogs/pages/LevelUpTitle":"dialogs/pages/LevelUp"}).then(function(){"function"==typeof e&&e()})):"function"==typeof e&&e()}),i.off(),n.Sound.play("won"==e.stats?n.Sound.sounds.game.overWin:"lost"==e.stats?n.Sound.sounds.game.overLose:n.Sound.sounds.game.overResigned)})})}for(var a=!1,s=0;s<t.players.length;s++){var l=t.players[s],d=c(u.players(),{username:l.username});d||n.trigger("game:random-player:update",l.username);var p=l.score-d.score();d.scored=p,d.score(l.score),d.active(l.active),d.resigned(l.resigned||!1),d.username===u.player.username&&p&&(a=!0,function(e){var t;t=n.on("game:stars:done").then(function(){n.Sound.play(n.Sound.sounds.scoring.message),n.dialog.show("alert",{content:"You scored <b>"+e+"</b> points!",delay:3e3}).then(function(){n.trigger("game:score:done")}),t.off()})}(p))}if(!a&&u.gameOver()&&n.trigger("game:score:done"),t.path){var h=ko.utils.arrayFirst(u.paths(),function(e){return e.id==t.path.id});h.phrase.update(t.path.phrase),h.phrase.id=t.path.phraseID}if(t.words)for(var f=0;f<t.words.length;f++)t.words[f].isSelected=ko.observable(!1),t.words[f].css="",u.words.push(t.words[f]);u.playerCount>1&&!u.gameOver()&&location.hash.match(/#game/gi)&&(u.player.active()?n.dialog.show("slipper-fixed",o.YOUR_TURN):n.dialog.show("slipper-fixed",o.THEIR_TURN)),u.players.valueHasMutated(),n.trigger("game:updated",t)}}),n.on("game:swap-words",function(e){if(e.success&&e.words){for(var t=0;t<e.oldWords.length;t++){var n=ko.utils.arrayFirst(u.words(),function(n){return n.id===e.oldWords[t]});u.words.remove(n)}for(var t=0;t<e.words.length;t++)e.words[t].isSelected=ko.observable(!1),e.words[t].css=e.words[t].css||"",u.words.push(e.words[t])}}),u.loadingStatus("Waiting for the server..."),u.tutorialMode()?(u.loadingStatus("Gathering learning materials..."),n.trigger("server:tutorial:start",{username:u.username,level:t})):t>=0?(u.loadingStatus("Waiting for awesomeness..."),n.trigger("server:game:resume",{username:u.username,id:t})):n.trigger("server:game:queue",{username:u.username,playerCount:u.playerCount,friendUsername:u.friendUsername,collection:u.collection.name()||"woz"},function(){u.loadingStatus("Waiting for awesomeness...")}),l.promise()},u.unload=function(){u._gameOver(!1),n.off("game:start game:update:ctx game:swap-words"),u.words.removeAll();for(var e=ctx.paths(),t=0;t<e.length;t++)e[t].dispose();u.paths.removeAll(),u.tiles.removeAll()},u.playedWords=ko.computed(function(){return ko.utils.arrayFilter(u.words(),function(e){return e.isPlayed||!1})}),u.unplayedWords=ko.computed(function(){return ko.utils.arrayFilter(u.words(),function(e){return!e.isPlayed})}),u.selectedWords=ko.computed(function(){return ko.utils.arrayFilter(u.words(),function(e){return e.isSelected()})}),window.ctx=u}),n("api/ui/palette",[],function(){function e(){var t=this;this.items=ko.observableArray([new e.Icon("currency","command","fixed",0),new e.Icon("menu","command","fixed",null,"menu"),new e.Icon("fullscreen","command","fixed")]),this.fixedItemsCount=3,this.fixedItems=ko.computed(function(){return ko.utils.arrayFilter(t.items(),function(e){return"fixed"==e.place})}),this.rightItems=ko.computed(function(){return ko.utils.arrayFilter(t.items(),function(e){return"right"==e.place})}),this.leftItems=ko.computed(function(){return ko.utils.arrayFilter(t.items(),function(e){return"left"==e.place})}),this.get=function(e){return ko.utils.arrayFirst(t.items(),function(t){return t.name==e})},this.visible=ko.observable(!0),this.hide=function(e){e&&(t.visible.duration=e.duration),t.visible(!1),delete t.visible.duration},this.show=function(){t.visible(!0),t.adjustPalettes()},this.add=function(){var n=new e.Icon(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);return t.items.push(n),t.adjustPalettes(),n},this.dispose=function(){this.items.splice(this.fixedItemsCount)}}e.prototype.adjustPalettes=function(e){$(".palette:not(.fixed)").each(function(){var t=$(this);void 0===e?t.css("y",(window.innerHeight-t.outerHeight())/2):t.css("y",e)})},e.prototype.compositionComplete=function(){var e=this;e.adjustPalettes(),app.on("app:resized").then(function(){e.adjustPalettes()})},e.Icon=function(e,t,n,i,o){var r=this;this.name=e,this.type=t||"command",this.place=n||"fixed",this.title=ko.observable(o||""),this.content=ko.observable(i||"");var a,s=ko.observable(!0),l=ko.observable(this.type+" "+this.name);this.click=function(e){return"function"==typeof e?(a=e,a.owner=this,r):void(a&&(app.Sound.play("command"==r.type?app.Sound.sounds.click.command:app.Sound.sounds.click.action),a.apply(a.owner,arguments)))},this.editTitle=function(e){r.title(e)},this.visible=ko.computed({read:s,write:function(e){return ko.isSubscribable(e)?e.subscribe(function(e){s(e)}):s(e),r},owner:this}),this.css=ko.computed({read:l,write:function(e){return ko.isObservable(e)||(e[r.type]=!0,e[r.name]=!0,l(e)),r}}),this.hide=function(){r.visible(!1)},this.show=function(){r.visible(!0)}};var t=new e;return t.get("fullscreen").click(function(){app.trigger("app:fullscreen")}).hide(),t}),function(e){function t(e){if(e in h.style)return e;for(var t=["Moz","Webkit","O","Ms","ms"],n=e.charAt(0).toUpperCase()+e.substr(1),i=0;i<t.length;++i){var o=t[i]+n;if(o in h.style)return o}}function n(){return h.style[f.transform]="",h.style[f.transform]="rotateY(90deg)",""!==h.style[f.transform]}function i(){function t(t){p=f.transitionEnd=e.support.transitionEnd=t.type,document.body.removeChild(i),i=null}var n={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"};p=f.transitionEnd=e.support.transitionEnd=n[f.transition]||null;var i=document.createElement("div");document.body.appendChild(i);for(var o=["transitionend","transitionEnd","oTransitionEnd","webkitTransitionEnd","MSTransitionEnd"],r=0;r<o.length;r++)i.addEventListener(o[r],t);i.style[f.transition]="all .01s",setTimeout(function(){i.style[f.transform]="translateX(1px)"},0)}function o(e){return"string"==typeof e&&this.parse(e),this}function r(e,t,n){t===!0?e.queue(n):t?e.queue(t,n):n()}function a(t){var n=[];return e.each(t,function(t){t=e.camelCase(t),t=e.transit.propertyMap[t]||e.cssProps[t]||t,t=c(t),f[t]&&(t=c(f[t])),-1===e.inArray(t,n)&&n.push(t)}),n}function s(t,n,i,o){var r=a(t);e.cssEase[i]&&(i=e.cssEase[i]);var s=""+d(n)+" "+i;parseInt(o,10)>0&&(s+=" "+d(o));var l=[];return e.each(r,function(e,t){l.push(t+" "+s)}),l.join(", ")}function l(t,n){n||(e.cssNumber[t]=!0),e.transit.propertyMap[t]=f.transform,e.cssHooks[t]={get:function(n){var i=e(n).css("transit:transform");return i.get(t)},set:function(n,i){var o=e(n).css("transit:transform");o.setFromString(t,i),e(n).css({"transit:transform":o})}}}function c(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function u(e,t){return"string"!=typeof e||e.match(/^[\-0-9\.]+$/)?""+e+t:e}function d(t){var n=t;return"string"!=typeof n||n.match(/^[\-0-9\.]+/)||(n=e.fx.speeds[n]||e.fx.speeds._default),u(n,"ms")}e.transit={version:"0.9.9",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var p,h=document.createElement("div"),f={},g=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;f.transition=t("transition"),f.transitionDelay=t("transitionDelay"),f.transform=t("transform"),f.transformOrigin=t("transformOrigin"),f.filter=t("Filter"),f.transform3d=n(),i();for(var m in f)f.hasOwnProperty(m)&&"undefined"==typeof e.support[m]&&(e.support[m]=f[m]);h=null,e.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"},e.cssHooks["transit:transform"]={get:function(t){return e(t).data("transform")||new o
},set:function(t,n){var i=n;i instanceof o||(i=new o(i)),t.style[f.transform]=i.toString("WebkitTransform"!==f.transform||g?!0:!0),e(t).data("transform",i)}},e.cssHooks.transform={set:e.cssHooks["transit:transform"].set},e.cssHooks.filter={get:function(e){return e.style[f.filter]},set:function(e,t){e.style[f.filter]=t}},e.fn.jquery<"1.8"&&(e.cssHooks.transformOrigin={get:function(e){return e.style[f.transformOrigin]},set:function(e,t){e.style[f.transformOrigin]=t}},e.cssHooks.transition={get:function(e){return e.style[f.transition]},set:function(e,t){e.style[f.transition]=t}}),l("scale"),l("translate"),l("rotate"),l("rotateX"),l("rotateY"),l("rotate3d"),l("perspective"),l("skewX"),l("skewY"),l("x",!0),l("y",!0),o.prototype={setFromString:function(e,t){var n="string"==typeof t?t.split(","):t.constructor===Array?t:[t];n.unshift(e),o.prototype.set.apply(this,n)},set:function(e){var t=Array.prototype.slice.apply(arguments,[1]);this.setter[e]?this.setter[e].apply(this,t):this[e]=t.join(",")},get:function(e){return this.getter[e]?this.getter[e].apply(this):this[e]||0},setter:{rotate:function(e){this.rotate=u(e,"deg")},rotateX:function(e){this.rotateX=u(e,"deg")},rotateY:function(e){this.rotateY=u(e,"deg")},scale:function(e,t){void 0===t&&(t=e),this.scale=e+","+t},skewX:function(e){this.skewX=u(e,"deg")},skewY:function(e){this.skewY=u(e,"deg")},perspective:function(e){this.perspective=u(e,"px")},x:function(e){this.set("translate",e,null)},y:function(e){this.set("translate",null,e)},translate:function(e,t){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==e&&void 0!==e&&(this._translateX=u(e,"px")),null!==t&&void 0!==t&&(this._translateY=u(t,"px")),this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var e=(this.scale||"1,1").split(",");return e[0]&&(e[0]=parseFloat(e[0])),e[1]&&(e[1]=parseFloat(e[1])),e[0]===e[1]?e[0]:e},rotate3d:function(){for(var e=(this.rotate3d||"0,0,0,0deg").split(","),t=0;3>=t;++t)e[t]&&(e[t]=parseFloat(e[t]));return e[3]&&(e[3]=u(e[3],"deg")),e}},parse:function(e){var t=this;e.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(e,n,i){t.setFromString(n,i)})},toString:function(e){var t=[];for(var n in this)if(this.hasOwnProperty(n)){if(!f.transform3d&&("rotateX"===n||"rotateY"===n||"perspective"===n||"transformOrigin"===n))continue;"_"!==n[0]&&t.push(e&&"scale"===n?n+"3d("+this[n]+",1)":e&&"translate"===n?n+"3d("+this[n]+",0)":n+"("+this[n]+")")}return t.join(" ")}},e.fn.transition=e.fn.transit=function(t,n,i,o){var a=this,l=0,c=!0,u=jQuery.extend(!0,{},t);"function"==typeof n&&(o=n,n=void 0),"object"==typeof n&&(i=n.easing,l=n.delay||0,c=n.queue||!0,o=n.complete,n=n.duration),"function"==typeof i&&(o=i,i=void 0),"undefined"!=typeof u.easing&&(i=u.easing,delete u.easing),"undefined"!=typeof u.duration&&(n=u.duration,delete u.duration),"undefined"!=typeof u.complete&&(o=u.complete,delete u.complete),"undefined"!=typeof u.queue&&(c=u.queue,delete u.queue),"undefined"!=typeof u.delay&&(l=u.delay,delete u.delay),"undefined"==typeof n&&(n=e.fx.speeds._default),"undefined"==typeof i&&(i=e.cssEase._default),n=d(n);var h=s(u,n,i,l),g=e.transit.enabled&&f.transition,m=g?parseInt(n,10)+parseInt(l,10):0;if(0===m){var v=function(e){a.css(u),o&&o.apply(a),e&&e()};return r(a,c,v),a}var b={},y=function(n){var i=!1,r=function(){i&&a.unbind(p,r),m>0&&a.each(function(){this.style[f.transition]=b[this]||null}),"function"==typeof o&&o.apply(a),"function"==typeof n&&n()};m>0&&p&&e.transit.useTransitionEnd?(i=!0,a.bind(p,r)):window.setTimeout(r,m),a.each(function(){m>0&&(this.style[f.transition]=h),e(this).css(t)})},w=function(e){this.offsetWidth,y(e)};return r(a,c,w),this},e.transit.getTransitionValue=s}(jQuery),n("../lib/jquery.transit",function(){}),function(e){function t(e,t){if(!(e.originalEvent.touches.length>1)){if(e.currentTarget.onlyClick||self._clickOnly)return void("click"==t&&(e.preventDefault(),e.currentTarget.onlyClick(e)));e.preventDefault();var n=e.originalEvent.changedTouches[0],i=document.createEvent("MouseEvents");i.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}}if(e.support.touch="ontouchend"in document,e.support.touch){var n,i={};i._touchStart=function(e){var i=this;n||(n=!0,i._touchMoved=!1,e.currentTarget.immovable&&(i._clickOnly=e.currentTarget.immovable()?!0:!1),t(e,"mouseover"),t(e,"mousedown"))},i._touchMove=function(e){n&&(this._touchMoved=!0,t(e,"mousemove"))},i._touchEnd=function(e){n&&(t(e,"mouseup"),t(e,"mouseout"),this._touchMoved||(t(e,"click"),e.preventDefault()),n=!1)},i.touchInit=function(t){var n=this;t.bind("touchstart",e.proxy(n,"_touchStart")).bind("touchcancel",e.proxy(n,"_touchEnd")).bind("touchmove",e.proxy(n,"_touchMove")).bind("touchend",e.proxy(n,"_touchEnd"))},e.fn.touchPunch=function(t){return this.each(function(){i.touchInit(e(this),t)})}}}(jQuery),n("../lib/jquery.touch-punch",function(){});var i=i||function(e,t){var n={},i=n.lib={},o=function(){},r=i.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=i.WordArray=r.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes;if(e=e.sigBytes,this.clamp(),i%4)for(var o=0;e>o;o++)t[i+o>>>2]|=(n[o>>>2]>>>24-8*(o%4)&255)<<24-8*((i+o)%4);else if(65535<n.length)for(o=0;e>o;o+=4)t[i+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-8*(n%4),t.length=e.ceil(n/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],i=0;t>i;i+=4)n.push(4294967296*e.random()|0);return new a.init(n,t)}}),s=n.enc={},l=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],i=0;e>i;i++){var o=t[i>>>2]>>>24-8*(i%4)&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],i=0;t>i;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-4*(i%8);return new a.init(n,t/2)}},c=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],i=0;e>i;i++)n.push(String.fromCharCode(t[i>>>2]>>>24-8*(i%4)&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],i=0;t>i;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-8*(i%4);return new a.init(n,t)}},u=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},d=i.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=u.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,i=n.words,o=n.sigBytes,r=this.blockSize,s=o/(4*r),s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0);if(t=s*r,o=e.min(4*t,o),t){for(var l=0;t>l;l+=r)this._doProcessBlock(i,l);l=i.splice(0,t),n.sigBytes-=o}return new a.init(l,o)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=d.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}});var p=n.algo={};return n}(Math);!function(e){var t=i,n=t.lib,o=n.Base,r=n.WordArray,t=t.x64={};t.Word=o.extend({init:function(e,t){this.high=e,this.low=t}}),t.WordArray=o.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=n!=e?n:8*t.length},toX32:function(){for(var e=this.words,t=e.length,n=[],i=0;t>i;i++){var o=e[i];n.push(o.high),n.push(o.low)}return r.create(n,this.sigBytes)},clone:function(){for(var e=o.clone.call(this),t=e.words=this.words.slice(0),n=t.length,i=0;n>i;i++)t[i]=t[i].clone();return e}})}(),function(e){for(var t=i,n=t.lib,o=n.WordArray,r=n.Hasher,a=t.x64.Word,n=t.algo,s=[],l=[],c=[],u=1,d=0,p=0;24>p;p++){s[u+5*d]=(p+1)*(p+2)/2%64;var h=(2*u+3*d)%5,u=d%5,d=h}for(u=0;5>u;u++)for(d=0;5>d;d++)l[u+5*d]=d+5*((2*u+3*d)%5);for(u=1,d=0;24>d;d++){for(var f=h=p=0;7>f;f++){if(1&u){var g=(1<<f)-1;32>g?h^=1<<g:p^=1<<g-32}u=128&u?u<<1^113:u<<1}c[d]=a.create(p,h)}for(var m=[],u=0;25>u;u++)m[u]=a.create();n=n.SHA3=r.extend({cfg:r.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;25>t;t++)e[t]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,i=this.blockSize/2,o=0;i>o;o++){var r=e[t+2*o],a=e[t+2*o+1],r=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),u=n[o];u.high^=a,u.low^=r}for(i=0;24>i;i++){for(o=0;5>o;o++){for(var d=r=0,p=0;5>p;p++)u=n[o+5*p],r^=u.high,d^=u.low;u=m[o],u.high=r,u.low=d}for(o=0;5>o;o++)for(u=m[(o+4)%5],r=m[(o+1)%5],a=r.high,p=r.low,r=u.high^(a<<1|p>>>31),d=u.low^(p<<1|a>>>31),p=0;5>p;p++)u=n[o+5*p],u.high^=r,u.low^=d;for(a=1;25>a;a++)u=n[a],o=u.high,u=u.low,p=s[a],32>p?(r=o<<p|u>>>32-p,d=u<<p|o>>>32-p):(r=u<<p-32|o>>>64-p,d=o<<p-32|u>>>64-p),u=m[l[a]],u.high=r,u.low=d;for(u=m[0],o=n[0],u.high=o.high,u.low=o.low,o=0;5>o;o++)for(p=0;5>p;p++)a=o+5*p,u=n[a],r=m[a],a=m[(o+1)%5+5*p],d=m[(o+2)%5+5*p],u.high=r.high^~a.high&d.high,u.low=r.low^~a.low&d.low;u=n[0],o=c[i],u.high^=o.high,u.low^=o.low}},_doFinalize:function(){var t=this._data,n=t.words,i=8*t.sigBytes,r=32*this.blockSize;n[i>>>5]|=1<<24-i%32,n[(e.ceil((i+1)/r)*r>>>5)-1]|=128,t.sigBytes=4*n.length,this._process();for(var t=this._state,n=this.cfg.outputLength/8,i=n/8,r=[],a=0;i>a;a++){var s=t[a],l=s.high,s=s.low,l=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8),s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8);r.push(s),r.push(l)}return new o.init(r,n)},clone:function(){for(var e=r.clone.call(this),t=e._state=this._state.slice(0),n=0;25>n;n++)t[n]=t[n].clone();return e}}),t.SHA3=r._createHelper(n),t.HmacSHA3=r._createHmacHelper(n)}(Math),n("../lib/crypto.sha3",function(){}),n("api/knockout",["durandal/system"],function(e){function t(e,t,n,i){function o(e){for(var n in t.rules){var i=t.rules[n],o=i.validate(t,e,i.data);if(o)return t.hasError(!0),void t.validationMessage(o)}t.hasError(!1),t.validationMessage("")}t.hasOwnProperty("validate")||(t.rules={},t.hasError=ko.observable(),t.validationMessage=ko.observable(),t.validate=function(){o(t())},t.subscribe(o)),t.rules[e]={validate:n,data:i}}ko.bindingHandlers.fadeVisible={init:function(e,t){var n=t();$(e).toggle(ko.unwrap(n))},update:function(e,t,n){var i,o,r=t();others=n(),void 0===others.duration&&(others.duration=r.duration),void 0!==others.duration&&("number"==typeof others.duration?i=o=others.duration:(i=others.duration.fadeIn||200,o=others.duration.fadeOut||500)),others.duration&&"transition"==others.duration.type?ko.unwrap(r)?$(e).stop().show().transition({opacity:1},i,"ease",function(){}):$(e).stop().transition({opacity:0},o,"ease",function(){$(this).hide()}):ko.unwrap(r)?$(e).fadeIn(i):$(e).fadeOut(o)}},ko.bindingHandlers.dVisible={init:function(e,t){var n=t();$(e).toggle(ko.unwrap(n))},update:function(e,t,n){var i,o,r=t();others=n(),void 0===others.duration&&(others.duration=r.duration),void 0!==others.duration?"number"==typeof others.duration?i=o=others.duration:(i=others.duration.fadeIn||0,o=others.duration.fadeOut||500):i=o=0;var a=ko.unwrap(r);setTimeout(function(){$(e).toggle(a)},a?i:o)}},ko.bindingHandlers.timeAgo={init:function(e,t){function n(e,t,n){return e+" "+t+(e>1?n||"s":"")+" "}function i(e){var t="",i=0;return e/864e5>1&&(t+=n(Math.floor(e/864e5),"day"),i++),e%=864e5,(t||e/36e5>1)&&(t+=n(Math.floor(e/36e5),"hour"),i++),e%=36e5,2==i?t:((t||e/6e4>1)&&(t+=n(Math.floor(e/6e4),"min"," "),i++),e%=6e4,2==i||t?t:"few seconds ")}var o=setInterval(function(e){if(ko.dataFor(e.element)){var t=(new Date).getTime()-e.time;$(e.element).text(i(t)+"ago")}else clearInterval(o)},5e3,{element:e,time:t()}),r=new Date((new Date).getTime()-t());$(e).text(i(r)+"ago")}},ko.bindingHandlers.date={init:function(e,t){var n=new Date(t()),i="";i+=ko.bindingHandlers.date.months[n.getMonth()]+" ",i+=("0"+n.getDate()).substr(-2)+" ",i+=("0"+n.getHours()).substr(-2)+":"+("0"+n.getUTCMinutes()).substr(-2),$(e).text(i)},months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},ko.bindingHandlers.dropdown={init:function(e,t){var n=t(),i=$(e).hide(),o={};"function"!=typeof n.selected&&(n.selected=ko.observable(n.selected||i.find("option[selected]").text())),n.options=n.options||i.find("option").map(function(){return $(this).text()}).get(),o.selectedItem=n.selected();for(var r=$("<ul/>",{"class":"container y scroll"}).hide(),a=0;a<n.options.length;a++){var s=$("<li/>",{text:n.options[a]}).on("click",function(){var e=$(this).text();n.selected()!=e&&(n.selected(e),r.slideUp(200))}).appendTo(r);o[n.options[a]]=s}var l=$("<label/>",{"class":"select"}).on("click",function(){r.slideToggle(200)}).append(o.selectedText=$("<span/>",{"class":"selected",text:n.selected()})).append($("<span/>",{"class":"description",text:n.inst}));l.insertAfter(i),r.insertAfter(l),ko.computed({disposeWhenNodeIsRemoved:e,read:function(){var e=n.selected();o[o.selectedItem].removeClass("active"),o[e].addClass("active"),o.selectedItem=e,o.selectedText.text(e)}})}},ko.bindingHandlers.metaText={update:function(e,t){var n=ko.unwrap(t());"number"==typeof n?ko.bindingHandlers.text.update.call(this,e,function(){return n.toLocaleString()}):ko.bindingHandlers.text.update.apply(this,arguments)}},ko.bindingHandlers.resizeText={init:function(e,t,n){var i=t().maxWidth,o=t().size.max,r=t().size.min,a=o,s=0,l=n().text;ko.isObservable(l)||(l=ko.observable(l));var c=l.subscribe(function(){for(var t,n=(t=$(e)).width();n>i&&a>r;)a-=.025,n=t.css({fontSize:a+"em"}).width(),s=n;if(s>n)for(a=o,n=t.css({fontSize:a+"em"}).width();n>i&&a>r;)a-=.025,n=t.css({fontSize:a+"em"}).width(),s=n});ko.utils.domNodeDisposal.addDisposeCallback(e,function(){c.dispose()})}},ko.bindingHandlers.search={init:function(e,t,n,i){e.addEventListener("search",function(e){t().call(i,e)})}},ko.bindingHandlers.loadMore={init:function(e,t,n,i){var o=ko.unwrap(t()),r=10,a=$(":last",e),s=function(){$(app.el).off("scroll",c)},l=function(){$(app.el).on("scroll",c)},c=function(){if(a.length||(a=$(":last",e),a.length)){var t=app.el.clientHeight+r>a.offset().top;t&&(s(),o.call(i).then(function(e){e&&l()}))}};ko.utils.domNodeDisposal.addDisposeCallback(e,s),l()}},ko.bindingHandlers.tab={init:function(t,n,i,o){var r=n(),a=void 0,s=ko.observable(a),l=$(t).find("li:not(:last)").each(function(e){$(this).data("index",e)}).click(function(){s($(this).data("index")),app.Sound.play(app.Sound.sounds.click.button)});$(t).addClass("anim anim-hidden");var c=500,u=s.subscribe(function(n){for(var i=0;i<l.length;i++)l[i].classList.remove("active");if(l[n].classList.add("active"),"function"==typeof r.nav){var u=$.Deferred();$(t).removeClass("anim-visible").delay(c).promise().then(function(){n!=s()?u.reject():u.resolve(n)});var d=r.nav.call(o,n,u);d.then||$.Deferred(function(t){e.acquire(d.moduleId).then(function(n){var i=e.resolveObject(n),o=i.compositionComplete;i.compositionComplete=function(){o&&o.apply(i,arguments),t.resolve()},u.then(function(){d.acquired(i)})})}).promise(d),d.then(function(){$(t).addClass("anim-visible").delay(c).promise().then(function(){"function"==typeof r.navEnd&&r.navEnd.call(o,n),"function"==typeof r.navSwitch&&r.navSwitch.call(o,a,n),a=n})})}});ko.utils.domNodeDisposal.addDisposeCallback(t,function(){u.dispose(),"function"==typeof r.navSwitch&&r.navSwitch.call(o,s())}),s(r.activeTab||0)}};var n=ko.bindingHandlers.click.init;ko.bindingHandlers.click.init=function(e,t,i,o){$.support.touch?($(e).bind("touchstart",function(e){e.stopPropagation()}),$(e).touchPunch(),e.onlyClick=function(e){t().apply(o,[o,e])!==!0&&e.preventDefault()}):n.apply(this,arguments)},ko.bindingHandlers.pointer={init:function(e,t,n,i){var o=t();o.enter&&e.addEventListener($.support.touch?"touchenter":"mouseenter",function(e){o.enter.call(i,e)}),o.leave&&e.addEventListener($.support.touch?"touchleave":"mouseleave",function(e){o.leave.call(i,e)}),o.drop&&e.addEventListener($.support.touch?"touchend":"mouseup",function(e){o.drop.call(i,e)})}},ko.bindingHandlers.verifiableValue={init:function(e,t,n){ko.bindingHandlers.value.init(e,t,n)},update:function(e,t){ko.bindingHandlers.value.update(e,t),e.setCustomValidity(t().validationMessage()||"")}},ko.bindingHandlers.verifiableSubmit={init:function(e,t,n,i){ko.utils.registerEventHandler(e,"submit",function(n){for(var o in i){var r=i[o];ko.isObservable(r)&&r.validate&&r.validate()}e.checkValidity()&&t().call(i,e)===!0||n.preventDefault()})}},ko.extenders.required=function(e,n){return t("required",e,function(e,t,n){return t?"":n||"This field is required"},n),e},ko.extenders.stringLength=function(e,n){return t("stringLength",e,function(e,t,n){return t.length>=n.minLength?"":n.message||"min length is "+n.minLength},n),e},ko.extenders.customValidation=function(e,n){return t("stringLength",e,function(e,t,n){return n(t)},n),e}}),n("common.modernizer",["durandal/app"],function(e){e.browser={},e.browser.iPad=navigator.userAgent.match(/iPad/i),e.browser.kindle=navigator.vendor.match(/amazon\.com/i),e.browser.android=navigator.userAgent.match(/android/i)||e.browser.kindle,e.browser.tablet=e.browser.iPad||e.browser.android;var t=document.createElement("div");t.style.display="flex",e.support=e.support||{},e.support.flex="flex"==t.style.display,e.el=document.getElementById("app")}),n("common.screen",["durandal/app","./common.modernizer"],function(e){function t(){var t=e.screen.size.width-window.innerWidth,n=e.screen.size.height-window.innerHeight;return e.screen.size.width-=t,e.screen.size.height-=n,t||n}function n(){return $.Deferred(function(t){var n=document.getElementById("shell");$(n).delay(1).promise().then(function(){$(n).css({y:0,transition:"all .5s ease-in-out"}).delay(500).promise().then(function(){$(n).css({transition:"none",transform:"none"}),$("#app, body").trigger("scroll"),e.trigger("app:force-resize"),t.resolve()})})})}var i=null,o=null,r=200,a=600;if(e.screen={size:{width:0,height:0}},t(),window.addEventListener("resize",function(n){t()&&(e.trigger("app:resized:hook",n),clearTimeout(i),i=setTimeout(function(t){e.trigger("app:resized",t)},r,n),clearTimeout(o),o=setTimeout(function(t){e.trigger("app:resized:delayed",t)},a,n))},!1),window.addEventListener("orientationchange",function(n){setTimeout(function(){if(e.browser.android){var i=window.outerHeight-window.innerHeight==54?window.outerHeight:window.innerHeight;$(e.el).css({minHeight:i+"px"})}t()&&(e.trigger("app:resized:hook",n),e.trigger("app:resized",n)),e.trigger("app:force-resize")},600)}),e.browser.android){var s=window.outerHeight-window.innerHeight==54?window.outerHeight:window.innerHeight;$(e.el).css({minHeight:s+"px"})}var l=e.el;e.scrollUp=function(e){if(console.log("Scrolling UP"),e=e||{},e.noAnimate)return void(l.scrollTop=0);var t=document.getElementById("shell");return 0!=l.scrollTop?($(t).css({y:-l.scrollTop}),l.scrollTop=0,n()):void 0},e.scrollDown=function(e){console.log("Scrolling Down");var t=document.getElementById("shell"),i=l.scrollHeight-l.clientHeight;if($("#gameboard").length){var o=$("#gameboard").outerHeight()-100;i>o&&(i=o)}return e=e||i-l.scrollTop,e>i-l.scrollTop&&(e=i-l.scrollTop),0!=e?($(t).css({y:e}),l.scrollTop=e+l.scrollTop,n()):void 0}}),function(){window.Task={run:function(e,t,n,i){var o,r=[],a={then:function(e){return r.push(e),a},thenRun:function(e,t){return o=Task.run(e,t,n,!0)},_start:function(){setTimeout(function(){for(var t=e.call(n),i=0;i<r.length;i++){var a=r[i].call(n,t);void 0!==a&&(t=a)}o&&o._start()},t||1)}};return n=n||this,i||a._start(),a},Queue:function(e){this.timer=0,this.data=e,this.runAfter=function(e,t){return this.timer+=t||1,Task.run(e,this.timer,this).then(function(){this.timer-=t})}}}}(),n("api/helper/Task",function(){}),n("api/helper/issueTracker",["api/helper/history"],function(){var e={log:function(){},updateClient:function(){}};return window.addEventListener("error",function(e){ga("send","exception",{exDescription:e.message||"",exFatal:!1})}),e}),n("common",["durandal/system","durandal/app","plugins/router","dialogs/_builder","api/server/setup","api/datacontext","api/ui/palette","../lib/jquery.transit","../lib/jquery.touch-punch","../lib/crypto.sha3","api/knockout","common.screen","api/helper/Task","api/helper/issueTracker"],function(e,t,n,i,o,r,a){var s=ko.observable(!1);t.inlineLoading=ko.observable(!1),t.loading=ko.computed({read:function(){return s()||r.loading()===!0},write:function(e){s(e)},owner:this}),t.navigate=function(e,t){n.navigate(e,t)},t.ctx=r,t.dialog=i,t.dialog.showCurrency=function(){r.shop.besozes.load().then(function(){t.dialog.show("notice",{model:"dialogs/pages/currency",css:"long",closeOnClick:!1,fixed:!0,centered:!0,modal:!0})})},t.dialog.showNoBesoz=function(e){t.Sound.play(t.Sound.sounds.action.functionFailed),t.dialog.show("notice",{model:{getBesoz:t.dialog.showCurrency,besoz:e},view:"dialogs/pages/noBesoz",closeOnClick:!1,fixed:!0,centered:!0,modal:!0}),t.trigger("game:bubble","zeroBesoz")},t.dialog.showAlertNote=function(e){e.btnText=e.btnText||"Ok!",e.content=e.content||"",e.title=e.title||"",t.dialog.show("notice",{model:e,view:"dialogs/pages/alert-note",closeOnClick:!1,fixed:!0,centered:!0,modal:!0})},t.dialog.showBesozCancel=function(){t.dialog.show("notice",{view:"dialogs/pages/paypalcancel",fixed:!0,centered:!0})},t.dialog.showBesozBought=function(){t.dialog.show("notice",{view:"dialogs/pages/besoz",fixed:!0,centered:!0})},t.dialog.confirm=function(e,n){return n=n||{},n.content=e,$.extend({},{doneText:"YES",cancelText:"NO"},n),$.Deferred(function(e){return t.dialog.show("confirm",n).then(function(t){"done"==t&&e.resolve(!0),e.reject(!1)})}).promise()},t.dialog.showPoem=function(){t.dialog.show("notice",{model:"game/poem/index",css:"long top up",closeOnClick:!1,fixed:!1,centered:!0,modal:!0})},t.dialog.showProfile=function(e){t.dialog.show("slipper-profile",{username:e})},t.dialog.showInvite=function(){t.dialog.show("notice",{model:"dialogs/pages/invite",fixed:!0,centered:!0,modal:!0,closeOnClick:!1}).then(function(){})},t.dialog.showEmail=function(){return t.dialog.show("notice",{model:"dialogs/pages/email",fixed:!0,centered:!0,modal:!0,closeOnClick:!1})},t.palette=a,t.palette.get("menu").click(function(){t.dialog.show("menu")}),t.palette.get("currency").click(t.dialog.showCurrency).content=r.user.besoz,t.browser.tablet&&t.palette.get("fullscreen").hide(),t.console={log:function(e){$("#console").html(e)}};var l=0;t.on("app:fullscreen").then(function(){var e=$("html")[0];l?document.webkitCancelFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.webkitEnterFullScreen&&e.webkitEnterFullscreen(),l^=1})}),e.config({paths:{text:"../lib/requirejs-text/text",durandal:"../lib/durandal",plugins:"../lib/durandal/plugins",transitions:"../lib/durandal/transitions","crypto.sha3":"../lib/crypto.sha3",facebook:"../lib/facebook",sounds:"../sounds"},urlArgs:"t"+(new Date).getTime(),shim:{facebook:{"export":"FB"}}}),n("firebase",function(){return{}}),n("jquery",function(){return jQuery}),n("knockout",ko),n("socket",io),n("paper",paper),n("main",["durandal/system","durandal/app","plugins/router","durandal/viewLocator","api/Sound","common"],function(e,t,n,i,o){function r(e){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href="css/"+e+".css",document.getElementsByTagName("head")[0].appendChild(t)}t.title="Words of Oz",t.configurePlugins({router:!0,widget:{kinds:["list","slider","tile","xp"]}}),t.Sound=o;var a=$("#loadingBar");t.Sound.onLoad=function(e){a.val(e)},t.Sound.load(),t.Sound.loaded.then(function(){t.start().then(function(){i.useConvention(),t.setRoot("shell",null,"app")})}),t.fromSignUp="signup"==localStorage.getItem("login-mode"),navigator&&navigator.splashscreen&&navigator.splashscreen.hide(),void 0===document.body.style.backgroundPositionX&&r("_sprites"),t.support.flex||r("_flex"),void 0!==document.body.style.MozAppearance&&r("_firefox"),t.browser.iPad&&r("_ipad"),$.support.touch&&r("_touch"),t.browser.kindle&&(screen.lockOrientation&&screen.lockOrientation(["landscape-primary","landscape-secondary"]),r("_kindle")),window.app=t});try{window.FB||function(e){var t,n,i=e,o=e.document,r=e.setTimeout,a=e.setInterval,s=e.clearTimeout,l=e.clearInterval;n=function(e){return e[0]},t=function(e){return e};var c,u;!function(e){var t={},n={},i=["global","require","requireDynamic","requireLazy","module","exports"];c=function(i,o){if(n.hasOwnProperty(i))return n[i];if(!t.hasOwnProperty(i)){if(o)return null;throw new Error("Module "+i+" has not been defined")}for(var r,a=t[i],s=a.deps,l=a.factory.length,u=[],d=0;l>d;d++){switch(s[d]){case"module":r=a;break;case"exports":r=a.exports;break;case"global":r=e;break;case"require":r=c;break;case"requireDynamic":r=c;break;case"requireLazy":r=null;break;default:r=c.call(null,s[d])}u.push(r)}return a.factory.apply(e,u),n[i]=a.exports,a.exports},u=function(e,o,r,a){"function"==typeof r?(t[e]={factory:r,deps:i.concat(o),exports:{}},3===a&&c.call(null,e)):n[e]=r}}(this),u("ES5ArrayPrototype",[],function(e,t,n,i,o){var r={};r.map=function(e,t){if("function"!=typeof e)throw new TypeError;var n,i=this.length,o=new Array(i);for(n=0;i>n;++n)n in this&&(o[n]=e.call(t,this[n],n,this));return o},r.forEach=function(e,t){r.map.call(this,e,t)},r.filter=function(e,t){if("function"!=typeof e)throw new TypeError;var n,i,o=this.length,r=[];for(n=0;o>n;++n)n in this&&(i=this[n],e.call(t,i,n,this)&&r.push(i));return r},r.every=function(e,t){if("function"!=typeof e)throw new TypeError;for(var n=new Object(this),i=n.length,o=0;i>o;o++)if(o in n&&!e.call(t,n[o],o,n))return!1;return!0},r.some=function(e,t){if("function"!=typeof e)throw new TypeError;for(var n=new Object(this),i=n.length,o=0;i>o;o++)if(o in n&&e.call(t,n[o],o,n))return!0;return!1},r.indexOf=function(e,t){var n=this.length;for(t|=0,0>t&&(t+=n);n>t;t++)if(t in this&&this[t]===e)return t;return-1},o.exports=r},null),u("ES5FunctionPrototype",[],function(e,t,n,i,o){var r={};r.bind=function(e){function t(){return n.apply(e,i.concat(Array.prototype.slice.call(arguments)))}if("function"!=typeof this)throw new TypeError("Bind must be called on a function");var n=this,i=Array.prototype.slice.call(arguments,1);return t.displayName="bound:"+(n.displayName||n.name||"(?)"),t.toString=function(){return"bound: "+n},t},o.exports=r},null),u("ES5StringPrototype",[],function(e,t,n,i,o){var r={};r.trim=function(){if(null==this)throw new TypeError("String.prototype.trim called on null or undefined");return String.prototype.replace.call(this,/^\s+|\s+$/g,"")},r.startsWith=function(e){var t=String(this);if(null==this)throw new TypeError("String.prototype.startsWith called on null or undefined");var n=arguments.length>1?Number(arguments[1]):0;isNaN(n)&&(n=0);var i=Math.min(Math.max(n,0),t.length);return t.indexOf(String(e),n)==i},r.endsWith=function(e){var t=String(this);if(null==this)throw new TypeError("String.prototype.endsWith called on null or undefined");var n=t.length,i=String(e),o=arguments.length>1?Number(arguments[1]):n;isNaN(o)&&(o=0);var r=Math.min(Math.max(o,0),n),a=r-i.length;return 0>a?!1:t.lastIndexOf(i,a)==a},r.contains=function(e){if(null==this)throw new TypeError("String.prototype.contains called on null or undefined");var t=String(this),n=arguments.length>1?Number(arguments[1]):0;return isNaN(n)&&(n=0),-1!=t.indexOf(String(e),n)},r.repeat=function(e){if(null==this)throw new TypeError("String.prototype.repeat called on null or undefined");var t=String(this),n=e?Number(e):0;if(isNaN(n)&&(n=0),0>n||1/0===n)throw RangeError();if(1===n)return t;if(0===n)return"";for(var i="";n;)1&n&&(i+=t),(n>>=1)&&(t+=t);return i},o.exports=r},null),u("ES5Array",[],function(e,t,n,i,o){var r={};r.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)},o.exports=r},null),u("ie8DontEnum",[],function(e,t,n,i,o){var r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","prototypeIsEnumerable","constructor"],a={}.hasOwnProperty,s=function(){};({toString:!0}).propertyIsEnumerable("toString")&&(s=function(e,t){for(var n=0;n<r.length;n++){var i=r[n];a.call(e,i)&&t(i)}}),o.exports=s},null),u("ES5Object",["ie8DontEnum"],function(e,t,n,i,o,r,a){function s(){}var l={}.hasOwnProperty,c={};c.create=function(e){var t=typeof e;if("object"!=t&&"function"!=t)throw new TypeError("Object prototype may only be a Object or null");return s.prototype=e,new s},c.keys=function(e){var t=typeof e;if("object"!=t&&"function"!=t||null===e)throw new TypeError("Object.keys called on non-object");var n=[];for(var i in e)l.call(e,i)&&n.push(i);return a(e,function(e){return n.push(e)}),n},o.exports=c},null),u("ES5Date",[],function(e,t,n,i,o){var r={};r.now=function(){return(new Date).getTime()},o.exports=r},null),u("JSON3",[],function(e,t,n,i,o){(function(){var e,t,n,i,r,a,s,l,c,u,d,p,h,f,g,m,v,b,y,w,k,_={}.toString,x=o.exports={},S='{"A":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}',C=new Date(-0xc782b5b800cec);try{C=-109252==C.getUTCFullYear()&&0===C.getUTCMonth()&&1==C.getUTCDate()&&10==C.getUTCHours()&&37==C.getUTCMinutes()&&6==C.getUTCSeconds()&&708==C.getUTCMilliseconds()}catch(I){}if(C||(y=Math.floor,w=[0,31,59,90,120,151,181,212,243,273,304,334],k=function(e,t){return w[t]+365*(e-1970)+y((e-1969+(t=+(t>1)))/4)-y((e-1901+t)/100)+y((e-1601+t)/400)}),"object"==typeof JSON&&JSON&&(x.stringify=JSON.stringify,x.parse=JSON.parse),i="function"==typeof x.stringify&&!k){(C=function(){return 1}).toJSON=C;try{i="0"===x.stringify(0)&&"0"===x.stringify(new Number)&&'""'==x.stringify(new String)&&x.stringify(_)===n&&x.stringify(n)===n&&x.stringify()===n&&"1"===x.stringify(C)&&"[1]"==x.stringify([C])&&"[null]"==x.stringify([n])&&"null"==x.stringify(null)&&"[null,null,null]"==x.stringify([n,_,null])&&x.stringify({result:[C,!0,!1,null,"\x00\b\n\f\r	"]})==S&&"1"===x.stringify(null,C)&&"[\n 1,\n 2\n]"==x.stringify([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==x.stringify(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==x.stringify(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==x.stringify(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==x.stringify(new Date(-1))}catch(I){i=!1}}if("function"==typeof x.parse)try{if(0===x.parse("0")&&!x.parse(!1)&&(C=x.parse(S),c=5==C.A.length&&1==C.A[0])){try{c=!x.parse('"	"')}catch(I){}if(c)try{c=1!=x.parse("01")}catch(I){}}}catch(I){c=!1}C=S=null,i&&c||((e={}.hasOwnProperty)||(e=function(t){var n,i={};return(i.__proto__=null,i.__proto__={toString:1},i).toString!=_?e=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(n=i.constructor,e=function(e){var t=(this.constructor||n).prototype;return e in this&&!(e in t&&this[e]===t[e])}),i=null,e.call(this,t)}),t=function(t,n){var i,o,r,a,s=0;(i=function(){this.valueOf=0}).prototype.valueOf=0,o=new i;for(r in o)e.call(o,r)&&s++;return i=o=null,s?a=2==s?function(t,n){var i,o={},r="[object Function]"==_.call(t);for(i in t)r&&"prototype"==i||e.call(o,i)||!(o[i]=1)||!e.call(t,i)||n(i)}:function(t,n){var i,o,r="[object Function]"==_.call(t);
for(i in t)r&&"prototype"==i||!e.call(t,i)||(o="constructor"===i)||n(i);(o||e.call(t,i="constructor"))&&n(i)}:(o=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],a=function(t,n){var i,r,a="[object Function]"==_.call(t);for(i in t)a&&"prototype"==i||!e.call(t,i)||n(i);for(r=o.length;i=o[--r];e.call(t,i)&&n(i));}),a(t,n)},i||(r={"\\":"\\\\",'"':'\\"',"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},a=function(e,t){return("000000"+(t||0)).slice(-e)},s=function(e){for(var t,n='"',i=0;t=e.charAt(i);i++)n+='\\"\b\f\n\r	'.indexOf(t)>-1?r[t]:" ">t?"\\u00"+a(2,t.charCodeAt(0).toString(16)):t;return n+'"'},l=function(i,o,r,c,u,d,p){var h,f,g,m,v,b,w,x,S,C,I,T,P,E,A,D=o[i];if("object"==typeof D&&D)if(h=_.call(D),"[object Date]"!=h||e.call(D,"toJSON"))"function"==typeof D.toJSON&&("[object Number]"!=h&&"[object String]"!=h&&"[object Array]"!=h||e.call(D,"toJSON"))&&(D=D.toJSON(i));else if(D>-1/0&&1/0>D){if(k){for(m=y(D/864e5),f=y(m/365.2425)+1970-1;k(f+1,0)<=m;f++);for(g=y((m-k(f,0))/30.42);k(f,g+1)<=m;g++);m=1+m-k(f,g),v=(D%864e5+864e5)%864e5,b=y(v/36e5)%24,w=y(v/6e4)%60,x=y(v/1e3)%60,S=v%1e3}else f=D.getUTCFullYear(),g=D.getUTCMonth(),m=D.getUTCDate(),b=D.getUTCHours(),w=D.getUTCMinutes(),x=D.getUTCSeconds(),S=D.getUTCMilliseconds();D=(0>=f||f>=1e4?(0>f?"-":"+")+a(6,0>f?-f:f):a(4,f))+"-"+a(2,g+1)+"-"+a(2,m)+"T"+a(2,b)+":"+a(2,w)+":"+a(2,x)+"."+a(3,S)+"Z"}else D=null;if(r&&(D=r.call(o,i,D)),null===D)return"null";if(h=_.call(D),"[object Boolean]"==h)return""+D;if("[object Number]"==h)return D>-1/0&&1/0>D?""+D:"null";if("[object String]"==h)return s(D);if("object"==typeof D){for(P=p.length;P--;)if(p[P]===D)throw TypeError();if(p.push(D),C=[],E=d,d+=u,"[object Array]"==h){for(T=0,P=D.length;P>T;A||(A=!0),T++)I=l(T,D,r,c,u,d,p),C.push(I===n?"null":I);return A?u?"[\n"+d+C.join(",\n"+d)+"\n"+E+"]":"["+C.join(",")+"]":"[]"}return t(c||D,function(e){var t=l(e,D,r,c,u,d,p);t!==n&&C.push(s(e)+":"+(u?" ":"")+t),A||(A=!0)}),A?u?"{\n"+d+C.join(",\n"+d)+"\n"+E+"}":"{"+C.join(",")+"}":"{}"}},x.stringify=function(e,t,n){var i,o,r,a,s,c;if("function"==typeof t||"object"==typeof t&&t)if("[object Function]"==_.call(t))o=t;else if("[object Array]"==_.call(t))for(r={},a=0,s=t.length;s>a;c=t[a++],("[object String]"==_.call(c)||"[object Number]"==_.call(c))&&(r[c]=1));if(n)if("[object Number]"==_.call(n)){if((n-=n%1)>0)for(i="",n>10&&(n=10);i.length<n;i+=" ");}else"[object String]"==_.call(n)&&(i=n.length<=10?n:n.slice(0,10));return l("",(c={},c[""]=e,c),o,r,i,"",[])}),c||(u=String.fromCharCode,d={"\\":"\\",'"':'"',"/":"/",b:"\b",t:"	",n:"\n",f:"\f",r:"\r"},p=function(){throw v=b=null,SyntaxError()},h=function(){for(var e,t,n,i,o,r=b,a=r.length;a>v;)if(e=r.charAt(v),"	\r\n ".indexOf(e)>-1)v++;else{if("{}[]:,".indexOf(e)>-1)return v++,e;if('"'==e){for(t="@",v++;a>v;)if(e=r.charAt(v)," ">e)p();else if("\\"==e)if(e=r.charAt(++v),'\\"/btnfr'.indexOf(e)>-1)t+=d[e],v++;else if("u"==e){for(n=++v,i=v+4;i>v;v++)e=r.charAt(v),e>="0"&&"9">=e||e>="a"&&"f">=e||e>="A"&&"F">=e||p();t+=u("0x"+r.slice(n,v))}else p();else{if('"'==e)break;t+=e,v++}if('"'==r.charAt(v))return v++,t;p()}else{if(n=v,"-"==e&&(o=!0,e=r.charAt(++v)),e>="0"&&"9">=e){for("0"==e&&(e=r.charAt(v+1),e>="0"&&"9">=e)&&p(),o=!1;a>v&&(e=r.charAt(v),e>="0"&&"9">=e);v++);if("."==r.charAt(v)){for(i=++v;a>i&&(e=r.charAt(i),e>="0"&&"9">=e);i++);i==v&&p(),v=i}if(e=r.charAt(v),"e"==e||"E"==e){for(e=r.charAt(++v),("+"==e||"-"==e)&&v++,i=v;a>i&&(e=r.charAt(i),e>="0"&&"9">=e);i++);i==v&&p(),v=i}return+r.slice(n,v)}if(o&&p(),"true"==r.slice(v,v+4))return v+=4,!0;if("false"==r.slice(v,v+5))return v+=5,!1;if("null"==r.slice(v,v+4))return v+=4,null;p()}}return"$"},f=function(e){var t,n;if("$"==e&&p(),"string"==typeof e){if("@"==e.charAt(0))return e.slice(1);if("["==e){for(t=[];e=h(),"]"!=e;n||(n=!0))n&&(","==e?(e=h(),"]"==e&&p()):p()),","==e&&p(),t.push(f(e));return t}if("{"==e){for(t={};e=h(),"}"!=e;n||(n=!0))n&&(","==e?(e=h(),"}"==e&&p()):p()),(","==e||"string"!=typeof e||"@"!=e.charAt(0)||":"!=h())&&p(),t[e.slice(1)]=f(h());return t}p()}return e},m=function(e,t,i){var o=g(e,t,i);o===n?delete e[t]:e[t]=o},g=function(e,n,i){var o,r=e[n];if("object"==typeof r&&r)if("[object Array]"==_.call(r))for(o=r.length;o--;)m(r,o,i);else t(r,function(e){m(r,e,i)});return i.call(e,n,r)},x.parse=function(e,t){v=0,b=e;var n=f(h());return"$"!=h()&&p(),v=b=null,t&&"[object Function]"==_.call(t)?g((C={},C[""]=n,C),"",t):n}))}).call(this)},null),u("ES6Object",["ie8DontEnum"],function(e,t,n,i,o,r,a){var s={}.hasOwnProperty,l={assign:function(e){for(var t=[],n=1,i=arguments.length;i>n;n++)t.push(arguments[n]);if(null==e)throw new TypeError("Object.assign target cannot be null or undefined");e=Object(e);for(var o=0;o<t.length;o++){var r=t[o];if(null!=r){r=Object(r);for(var l in r)s.call(r,l)&&(e[l]=r[l]);a(r,function(t){return e[t]=r[t]})}}return e}};o.exports=l},null),u("ES6ArrayPrototype",[],function(e,t,n,i,o){var r={find:function(e,t){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");var n=r.findIndex.call(this,e,t);return-1===n?void 0:this[n]},findIndex:function(e,t){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var n=Object(this),i=n.length>>>0,o=0;i>o;o++)if(e.call(t,n[o],o,n))return o;return-1}};o.exports=r},null),u("ES6DatePrototype",[],function(e,t,n,i,o){function r(e){return(10>e?"0":"")+e}var a={toISOString:function(){if(!isFinite(this))throw new Error("Invalid time value");var e=this.getUTCFullYear();return e=(0>e?"-":e>9999?"+":"")+("00000"+Math.abs(e)).slice(e>=0&&9999>=e?-4:-6),e+"-"+r(this.getUTCMonth()+1)+"-"+r(this.getUTCDate())+"T"+r(this.getUTCHours())+":"+r(this.getUTCMinutes())+":"+r(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}};o.exports=a},null),u("ES6Number",[],function(e,t,n,i,o){var r={isFinite:function(e){return"number"==typeof e&&isFinite(e)},isNaN:function(e){return"number"==typeof e&&isNaN(e)}};o.exports=r},null),u("ES",["ES5ArrayPrototype","ES5FunctionPrototype","ES5StringPrototype","ES5Array","ES5Object","ES5Date","JSON3","ES6Object","ES6ArrayPrototype","ES6DatePrototype","ES6Number"],function(t,n,i,o,r,a,s,l,c,u,d,p,h,f,g,m,v){function b(t){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n],o=n.split("."),r=2==o.length?e[o[0]][o[1]]:e[n];for(var a in i)if(i.hasOwnProperty(a)){var s=r[a];k[n+"."+a]=s&&/\{\s+\[native code\]\s\}/.test(s)?s:i[a]}}}function y(e,t,n){for(var i=[],o=3,r=arguments.length;r>o;o++)i.push(arguments[o]);var a=n?w.call(e).slice(8,-1)+".prototype":e,s=k[a+"."+t]||e[t];return"function"==typeof s?s.apply(e,i):void 0}var w={}.toString,k={"JSON.stringify":h.stringify,"JSON.parse":h.parse},_={"Array.prototype":s,"Function.prototype":l,"String.prototype":c,Object:d,Array:u,Date:p},x={Object:f,"Array.prototype":g,"Date.prototype":m,Number:v};b(_),b(x),r.exports=y},null);var d=c("ES");u("JSSDKRuntimeConfig",[],{locale:"en_US",rtl:!1,revision:"1468811"}),u("JSSDKConfig",[],{bustCache:!0,tagCountLogRate:.01,errorHandling:{rate:4},usePluginPipe:!0,features:{allow_non_canvas_app_events:!1,event_subscriptions_log:{rate:.01,value:1e4},kill_fragment:!0,xfbml_profile_pic_server:!0,error_handling:{rate:4},e2e_ping_tracking:{rate:1e-6},xd_timeout:{rate:4,value:3e4},use_bundle:!0,launch_payment_dialog_via_pac:{rate:100}},api:{mode:"warn",whitelist:["AppEvents","AppEvents.EventNames","AppEvents.ParameterNames","AppEvents.activateApp","AppEvents.logEvent","AppEvents.logPurchase","Canvas","Canvas.Prefetcher","Canvas.Prefetcher.addStaticResource","Canvas.Prefetcher.setCollectionMode","Canvas.getPageInfo","Canvas.hideFlashElement","Canvas.scrollTo","Canvas.setAutoGrow","Canvas.setDoneLoading","Canvas.setSize","Canvas.setUrlHandler","Canvas.showFlashElement","Canvas.startTimer","Canvas.stopTimer","Event","Event.subscribe","Event.unsubscribe","Music.flashCallback","Music.init","Music.send","Payment","Payment.cancelFlow","Payment.continueFlow","Payment.init","Payment.lockForProcessing","Payment.parse","Payment.setSize","Payment.unlockForProcessing","ThirdPartyProvider","ThirdPartyProvider.init","ThirdPartyProvider.sendData","UA","UA.nativeApp","XFBML","XFBML.RecommendationsBar","XFBML.RecommendationsBar.markRead","XFBML.parse","addFriend","api","getAccessToken","getAuthResponse","getLoginStatus","getUserID","init","login","logout","publish","share","ui"]},initSitevars:{enableMobileComments:1,iframePermissions:{read_stream:!1,manage_mailbox:!1,manage_friendlists:!1,read_mailbox:!1,publish_checkins:!0,status_update:!0,photo_upload:!0,video_upload:!0,sms:!1,create_event:!0,rsvp_event:!0,offline_access:!0,email:!0,xmpp_login:!1,create_note:!0,share_item:!0,export_stream:!1,publish_stream:!0,publish_likes:!0,ads_management:!1,contact_email:!0,access_private_data:!1,read_insights:!1,read_requests:!1,read_friendlists:!0,manage_pages:!1,physical_login:!1,manage_groups:!1,read_deals:!1}}}),u("UrlMapConfig",[],{www:"www.facebook.com",m:"m.facebook.com",connect:"connect.facebook.net",business:"business.facebook.com",api_https:"api.facebook.com",api_read_https:"api-read.facebook.com",graph_https:"graph.facebook.com",fbcdn_http:"static.ak.fbcdn.net",fbcdn_https:"fbstatic-a.akamaihd.net",cdn_http:"static.ak.facebook.com",cdn_https:"s-static.ak.facebook.com"}),u("JSSDKXDConfig",[],{XdUrl:"/connect/xd_arbiter.php?version=41",XdBundleUrl:"/connect/xd_arbiter/2_ZudbRXWRs.js?version=41",Flash:{path:"https://connect.facebook.net/rsrc.php/v1/yR/r/ks_9ZXiQ0GL.swf"},useCdn:!0}),u("JSSDKCssConfig",[],{rules:'.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}\n.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}.fb_dialog_close_icon:active{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}.fb_dialog_loader{background-color:#f2f2f2;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #3b5998;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{max-height:590px;min-height:590px;max-width:500px;min-width:500px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;left:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29447e;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f2f2f2;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}\n.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}\n.fbpluginrecommendationsbarleft,.fbpluginrecommendationsbarright{position:fixed !important;bottom:0;z-index:999}.fbpluginrecommendationsbarleft{left:10px}.fbpluginrecommendationsbarright{right:10px}',components:["css:fb.css.base","css:fb.css.dialog","css:fb.css.iframewidget","css:fb.css.plugin.recommendationsbar"]}),u("ApiClientConfig",[],{FlashRequest:{swfUrl:"https://connect.facebook.net/rsrc.php/v1/yW/r/PvklbuW2Ycn.swf"}}),u("JSSDKCanvasPrefetcherConfig",[],{blacklist:[0x83d70a64a992],sampleRate:500}),u("JSSDKPluginPipeConfig",[],{threshold:0,enabledApps:{209753825810663:1,187288694643718:1}}),u("QueryString",[],function(e,t,n,i,o){function r(e){var t=[];return d(d("Object","keys",!1,e).sort(),"forEach",!0,function(n){var i=e[n];if("undefined"!=typeof i)return null===i?void t.push(n):void t.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}),t.join("&")}function a(e,t){var n={};if(""===e)return n;for(var i=e.split("&"),o=0;o<i.length;o++){var r=i[o].split("=",2),a=decodeURIComponent(r[0]);if(t&&n.hasOwnProperty(a))throw new URIError("Duplicate key: "+a);n[a]=2===r.length?decodeURIComponent(r[1]):null}return n}function s(e,t){return e+(~d(e,"indexOf",!0,"?")?"&":"?")+("string"==typeof t?t:l.encode(t))}var l={encode:r,decode:a,appendToUrl:s};o.exports=l},null),u("ManagedError",[],function(e,t,n,i,o){function r(e,t){Error.prototype.constructor.call(this,e),this.message=e,this.innerError=t}r.prototype=new Error,r.prototype.constructor=r,o.exports=r},null),u("AssertionError",["ManagedError"],function(e,t,n,i,o,r,a){function s(){a.prototype.constructor.apply(this,arguments)}s.prototype=new a,s.prototype.constructor=s,o.exports=s},null),u("sprintf",[],function(e,t,n,i,o){function r(e){for(var t=[],n=1,i=arguments.length;i>n;n++)t.push(arguments[n]);var o=0;return e.replace(/%s/g,function(){return t[o++]})}o.exports=r},null),u("Assert",["AssertionError","sprintf"],function(e,t,n,i,o,r,a,s){function l(e,t){if("boolean"!=typeof e||!e)throw new a(t);return e}function c(e,t,n){var i;if(void 0===t)i="undefined";else if(null===t)i="null";else{var o=Object.prototype.toString.call(t);i=/\s(\w*)/.exec(o)[1].toLowerCase()}return l(-1!==d(e,"indexOf",!0,i),n||s("Expression is of type %s, not %s",i,e)),t}function u(e,t,n){return l(t instanceof e,n||"Expression not instance of type"),t}function p(e,t){h["is"+e]=t,h["maybe"+e]=function(e,n){null!=e&&t(e,n)}}var h={isInstanceOf:u,isTrue:l,isTruthy:function(e,t){return l(!!e,t)},type:c,define:function(e,t){e=e.substring(0,1).toUpperCase()+e.substring(1).toLowerCase(),p(e,function(e,n){l(t(e),n)})}};d(["Array","Boolean","Date","Function","Null","Number","Object","Regexp","String","Undefined"],"forEach",!0,function(e){p(e,d(c,"bind",!0,null,e.toLowerCase()))}),o.exports=h},null),u("Type",["Assert"],function(e,t,n,i,o,r,a){function s(){var e=this.__mixins;if(e)for(var t=0;t<e.length;t++)e[t].apply(this,arguments)}function l(e,t){if(t instanceof e)return!0;if(t instanceof s)for(var n=0;n<t.__mixins.length;n++)if(t.__mixins[n]==e)return!0;return!1}function c(e,t){var n=e.prototype;d("Array","isArray",!1,t)||(t=[t]);for(var i=0;i<t.length;i++){var o=t[i];"function"==typeof o&&(n.__mixins.push(o),o=o.prototype),d(d("Object","keys",!1,o),"forEach",!0,function(e){n[e]=o[e]})}}function u(e,t,n){function i(){}var o=t&&t.hasOwnProperty("constructor")?t.constructor:function(){this.parent.apply(this,arguments)};if(a.isFunction(o),e&&e.prototype instanceof s==!1)throw new Error("parent type does not inherit from Type");return e=e||s,i.prototype=e.prototype,o.prototype=new i,t&&d("Object","assign",!1,o.prototype,t),o.prototype.constructor=o,o.parent=e,o.prototype.__mixins=e.prototype.__mixins?Array.prototype.slice.call(e.prototype.__mixins):[],n&&c(o,n),o.prototype.parent=function(){this.parent=e.prototype.parent,e.apply(this,arguments)},o.prototype.parentCall=function(t){return e.prototype[t].apply(this,Array.prototype.slice.call(arguments,1))},o.extend=function(e,t){return u(this,e,t)},o}d("Object","assign",!1,s.prototype,{instanceOf:function(e){return l(e,this)}}),d("Object","assign",!1,s,{extend:function(e,t){return"function"==typeof e?u.apply(null,arguments):u(null,e,t)},instanceOf:l}),o.exports=s},null),u("ObservableMixin",[],function(e,t,n,i,o){function a(){this.__observableEvents={}}a.prototype={inform:function(e){for(var t=Array.prototype.slice.call(arguments,1),n=Array.prototype.slice.call(this.getSubscribers(e)),i=0;i<n.length;i++)if(null!==n[i])try{n[i].apply(this,t)}catch(o){r(function(){throw o},0)}return this},getSubscribers:function(e){return this.__observableEvents[e]||(this.__observableEvents[e]=[])},clearSubscribers:function(e){return e&&(this.__observableEvents[e]=[]),this},clearAllSubscribers:function(){return this.__observableEvents={},this},subscribe:function(e,t){var n=this.getSubscribers(e);return n.push(t),this},unsubscribe:function(e,t){for(var n=this.getSubscribers(e),i=0;i<n.length;i++)if(n[i]===t){n.splice(i,1);break}return this},monitor:function(e,t){if(!t()){var n=d(function(){t.apply(t,arguments)&&this.unsubscribe(e,n)},"bind",!0,this);this.subscribe(e,n)}return this}},o.exports=a},null),u("sdk.Model",["Type","ObservableMixin"],function(e,t,n,i,o,r,a,s){var l=a.extend({constructor:function(e){this.parent();var t={},n=this;d(d("Object","keys",!1,e),"forEach",!0,function(i){t[i]=e[i],n["set"+i]=function(e){return e===t[i]?this:(t[i]=e,n.inform(i+".change",e),n)},n["get"+i]=function(){return t[i]}})}},s);o.exports=l},null),u("sdk.Runtime",["sdk.Model","JSSDKRuntimeConfig"],function(t,n,i,o,r,a,s,l){var c={UNKNOWN:0,PAGETAB:1,CANVAS:2,PLATFORM:4},u=new s({AccessToken:"",ClientID:"",CookieUserID:"",Environment:c.UNKNOWN,Initialized:!1,IsVersioned:!1,KidDirectedSite:void 0,Locale:l.locale,LoginStatus:void 0,Revision:l.revision,Rtl:l.rtl,Scope:void 0,Secure:void 0,UseCookie:!1,UserID:"",Version:void 0});d("Object","assign",!1,u,{ENVIRONMENTS:c,isEnvironment:function(e){var t=this.getEnvironment();return(e|t)===t},isCanvasEnvironment:function(){return this.isEnvironment(c.CANVAS)||this.isEnvironment(c.PAGETAB)}}),function(){var t=/app_runner/.test(e.name)?c.PAGETAB:/iframe_canvas/.test(e.name)?c.CANVAS:c.UNKNOWN;(t|c.PAGETAB)===t&&(t|=c.CANVAS),u.setEnvironment(t)}(),r.exports=u},null),u("sdk.Cookie",["QueryString","sdk.Runtime"],function(e,t,n,i,r,a,s,l){function c(e,t,n){e+=l.getClientID();var i=d&&"."!==d;i&&(o.cookie=e+"=; expires=Wed, 04 Feb 2004 08:00:00 GMT;",o.cookie=e+"=; expires=Wed, 04 Feb 2004 08:00:00 GMT;domain="+location.hostname+";");var r=new Date(n).toGMTString();o.cookie=e+"="+t+(t&&0===n?"":"; expires="+r)+"; path=/"+(i?"; domain="+d:"")}function u(e){e+=l.getClientID();var t=new RegExp("\\b"+e+"=([^;]*)\\b");return t.test(o.cookie)?RegExp.$1:null}var d=null,p={setDomain:function(e){d=e;var t=s.encode({base_domain:d&&"."!==d?d:""}),n=new Date;n.setFullYear(n.getFullYear()+1),c("fbm_",t,n.getTime())},getDomain:function(){return d},loadMeta:function(){var e=u("fbm_");if(e){var t=s.decode(e);return d||(d=t.base_domain),t}},loadSignedRequest:function(){return u("fbsr_")},setSignedRequestCookie:function(e,t){if(!e)throw new Error("Value passed to Cookie.setSignedRequestCookie was empty.");c("fbsr_",e,t)},clearSignedRequestCookie:function(){c("fbsr_","",0)},setRaw:c};r.exports=p},null),u("guid",[],function(e,t,n,i,o){function r(){return"f"+(Math.random()*(1<<30)).toString(16).replace(".","")}o.exports=r},null),u("UserAgent_DEPRECATED",[],function(e,t,n,i,r){function a(){if(!_){_=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),n=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(b=/\b(iPhone|iP[ao]d)/.exec(e),y=/\b(iP[ao]d)/.exec(e),m=/Android/i.exec(e),w=/FBAN\/\w+;/i.exec(e),k=/Mobile/i.exec(e),v=!!/Win64/.exec(e),t){s=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):0/0,s&&o&&o.documentMode&&(s=o.documentMode);var i=/(?:Trident\/(\d+.\d+))/.exec(e);p=i?parseFloat(i[1])+4:s,l=t[2]?parseFloat(t[2]):0/0,c=t[3]?parseFloat(t[3]):0/0,u=t[4]?parseFloat(t[4]):0/0,u?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),d=t&&t[1]?parseFloat(t[1]):0/0):d=0/0}else s=l=c=d=u=0/0;if(n){if(n[1]){var r=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);h=r?parseFloat(r[1].replace("_",".")):!0}else h=!1;f=!!n[2],g=!!n[3]}else h=f=g=!1}}var s,l,c,u,d,p,h,f,g,m,v,b,y,w,k,_=!1,x={ie:function(){return a()||s},ieCompatibilityMode:function(){return a()||p>s},ie64:function(){return x.ie()&&v},firefox:function(){return a()||l},opera:function(){return a()||c},webkit:function(){return a()||u},safari:function(){return x.webkit()},chrome:function(){return a()||d},windows:function(){return a()||f},osx:function(){return a()||h},linux:function(){return a()||g},iphone:function(){return a()||b},mobile:function(){return a()||b||y||m||k},nativeApp:function(){return a()||w},android:function(){return a()||m},ipad:function(){return a()||y}};r.exports=x},null),u("hasNamePropertyBug",["guid","UserAgent_DEPRECATED"],function(e,t,n,i,r,a,s,l){function c(){var e=o.createElement("form"),t=e.appendChild(o.createElement("input"));return t.name=s(),d=t!==e.elements[t.name],e=t=null,d}function u(){return"undefined"==typeof d?c():d}var d=l.ie()?void 0:!1;r.exports=u},null),u("wrapFunction",[],function(e,t,n,i,o){function r(e,t,n){return t=t||"default",function(){var i=t in a?a[t](e,n):e;return i.apply(this,arguments)}}var a={};r.setWrapper=function(e,t){t=t||"default",a[t]=e},o.exports=r},null),u("DOMEventListener",["wrapFunction"],function(t,n,i,o,r,a,s){var l,c;e.addEventListener?(l=function(e,t,n){n.wrapper=s(n,"entry","DOMEventListener.add "+t),e.addEventListener(t,n.wrapper,!1)},c=function(e,t,n){e.removeEventListener(t,n.wrapper,!1)}):e.attachEvent?(l=function(e,t,n){n.wrapper=s(n,"entry","DOMEventListener.add "+t),e.attachEvent("on"+t,n.wrapper)},c=function(e,t,n){e.detachEvent("on"+t,n.wrapper)}):c=l=function(){};var u={add:function(e,t,n){return l(e,t,n),{remove:function(){c(e,t,n),e=null}}},remove:c};r.exports=u},null),u("sdk.createIframe",["guid","hasNamePropertyBug","DOMEventListener"],function(e,t,n,i,r,a,s,l,c){function u(e){e=d("Object","assign",!1,{},e);var t,n=e.name||s(),i=e.root,r=e.style||{border:"none"},a=e.url,u=e.onload,p=e.onerror;l()?t=o.createElement('<iframe name="'+n+'"/>'):(t=o.createElement("iframe"),t.name=n),delete e.style,delete e.name,delete e.url,delete e.root,delete e.onload,delete e.onerror;var h=d("Object","assign",!1,{frameBorder:0,allowTransparency:!0,scrolling:"no"},e);h.width&&(t.width=h.width+"px"),h.height&&(t.height=h.height+"px"),delete h.height,delete h.width;for(var f in h)h.hasOwnProperty(f)&&t.setAttribute(f,h[f]);if(d("Object","assign",!1,t.style,r),t.src="javascript:false",i.appendChild(t),u)var g=c.add(t,"load",function(){g.remove(),u()});if(p)var m=c.add(t,"error",function(){m.remove(),p()});return t.src=a,t}r.exports=u},null),u("DOMWrapper",[],function(e,t,n,r,a){var s,l,c={setRoot:function(e){s=e},getRoot:function(){return s||o.body},setWindow:function(e){l=e},getWindow:function(){return l||i}};a.exports=c},null),u("sdk.feature",["JSSDKConfig"],function(e,t,n,i,o,r,a){function s(e,t){if(a.features&&e in a.features){var n=a.features[e];return"object"==typeof n&&"number"==typeof n.rate?n.rate&&100*Math.random()<=n.rate?n.value||!0:n.value?null:!1:n}return"undefined"!=typeof t?t:null}o.exports=s},null),u("sdk.getContextType",["UserAgent_DEPRECATED","sdk.Runtime"],function(e,t,n,i,o,r,a,s){function l(){return a.nativeApp()?3:a.mobile()?2:s.isEnvironment(s.ENVIRONMENTS.CANVAS)?5:1}o.exports=l},null),u("sdk.domReady",[],function(t,n,i,a,s){function l(){if(u){for(var e;e=u.shift();)e();u=null}}function c(e){return u?void u.push(e):void e()}var u,d="readyState"in o?/loaded|complete/.test(o.readyState):!!o.body;if(!d&&(u=[],o.addEventListener?(o.addEventListener("DOMContentLoaded",l,!1),e.addEventListener("load",l,!1)):o.attachEvent&&(o.attachEvent("onreadystatechange",l),e.attachEvent("onload",l)),o.documentElement.doScroll&&e==e.top)){var p=function(){try{o.documentElement.doScroll("left")}catch(e){return void r(p,0)}l()};p()}s.exports=c},3),u("Log",["sprintf"],function(t,n,i,o,r,a,s){function l(t,n){var i=Array.prototype.slice.call(arguments,2),o=s.apply(null,i),r=e.console;r&&u.level>=n&&r[t in r?t:"log"](o)}var c={DEBUG:3,INFO:2,WARNING:1,ERROR:0},u={level:-1,Level:c,debug:d(l,"bind",!0,null,"debug",c.DEBUG),info:d(l,"bind",!0,null,"info",c.INFO),warn:d(l,"bind",!0,null,"warn",c.WARNING),error:d(l,"bind",!0,null,"error",c.ERROR)};r.exports=u},null),u("sdk.Content",["sdk.domReady","Log","UserAgent_DEPRECATED"],function(e,t,n,i,r,a,s,l,c){var u,d={append:function(e,t){if(t||(u?t=u:(u=t=o.getElementById("fb-root"),t||(l.warn('The "fb-root" div has not been created, auto-creating'),u=t=o.createElement("div"),t.id="fb-root",c.ie()||!o.body?s(function(){o.body.appendChild(t)}):o.body.appendChild(t)),t.className+=" fb_reset")),"string"==typeof e){var n=o.createElement("div");return t.appendChild(n).innerHTML=e,n}return t.appendChild(e)},appendHidden:function(e){if(!t){var t=o.createElement("div"),n=t.style;n.position="absolute",n.top="-10000px",n.width=n.height=0,t=d.append(t)}return d.append(e,t)},submitToTarget:function(e,t){var n=o.createElement("form");n.action=e.url,n.target=e.target,n.method=t?"GET":"POST",d.appendHidden(n);for(var i in e.params)if(e.params.hasOwnProperty(i)){var r=e.params[i];if(null!==r&&void 0!==r){var a=o.createElement("input");a.name=i,a.value=r,n.appendChild(a)}}n.submit(),n.parentNode.removeChild(n)}};r.exports=d},null),u("dotAccess",[],function(e,t,n,i,o){function r(e,t,n){var i=t.split(".");do{var o=i.shift();e=e[o]||n&&(e[o]={})}while(i.length&&e);return e}o.exports=r},null),u("GlobalCallback",["DOMWrapper","dotAccess","guid","wrapFunction"],function(e,t,n,i,o,r,a,s,l,c){var u,d,p={setPrefix:function(e){u=s(a.getWindow(),e,!0),d=e},create:function(e,t){u||this.setPrefix("__globalCallbacks");var n=l();return u[n]=c(e,"entry",t||"GlobalCallback"),d+"."+n},remove:function(e){var t=e.substring(d.length+1);delete u[t]}};o.exports=p},null),u("insertIframe",["guid","GlobalCallback"],function(e,t,n,i,a,s,l,c){function u(e){e.id=e.id||l(),e.name=e.name||l();var t=!1,n=!1,i=function(){t&&!n&&(n=!0,e.onload&&e.onload(e.root.firstChild))},a=c.create(i);if(o.attachEvent){var s='<iframe id="'+e.id+'" name="'+e.name+'"'+(e.title?' title="'+e.title+'"':"")+(e.className?' class="'+e.className+'"':"")+' style="border:none;'+(e.width?"width:"+e.width+"px;":"")+(e.height?"height:"+e.height+"px;":"")+'" src="javascript:false;" frameborder="0" scrolling="no" allowtransparency="true" onload="'+a+'()"></iframe>';e.root.innerHTML='<iframe src="javascript:false" frameborder="0" scrolling="no" style="height:1px"></iframe>',t=!0,r(function(){e.root.innerHTML=s,e.root.firstChild.src=e.url,e.onInsert&&e.onInsert(e.root.firstChild)},0)}else{var u=o.createElement("iframe");u.id=e.id,u.name=e.name,u.onload=i,u.scrolling="no",u.style.border="none",u.style.overflow="hidden",e.title&&(u.title=e.title),e.className&&(u.className=e.className),void 0!==e.height&&(u.style.height=e.height+"px"),void 0!==e.width&&(u.style.width="100%"==e.width?e.width:e.width+"px"),e.root.appendChild(u),t=!0,u.src=e.url,e.onInsert&&e.onInsert(u)}}a.exports=u},null),u("Miny",[],function(e,t,n,i,o){function r(e){for(var t=c.encode.length;e>t;t++){var n=t.toString(32).split("");n[n.length-1]=u[parseInt(n[n.length-1],32)],n=n.join(""),c.encode[t]=n,c.decode[n]=t}return c
}function a(e){if(/^$|[~\\]|__proto__/.test(e))return e;for(var t=e.match(/\w+|\W+/g),n={},i=0;i<t.length;i++)n[t[i]]=(n[t[i]]||0)+1;var o=d("Object","keys",!1,n);o.sort(function(e,t){return n[e]<n[t]?1:n[t]<n[e]?-1:0});var a=r(o.length).encode;for(i=0;i<o.length;i++)n[o[i]]=a[i];var s=[];for(i=0;i<t.length;i++)s[i]=n[t[i]];return[l,o.length].concat(o).concat(s.join("")).join("~")}function s(e){var t=e.split("~");if(t.shift()!=l)return e;var n=parseInt(t.shift(),10),i=t.pop();i=i.match(/[0-9a-v]*[\-w-zA-Z_]/g);for(var o=t,a=r(n).decode,s=[],c=0;c<i.length;c++)s[c]=o[a[i[c]]];return s.join("")}var l="Miny1",c={encode:[],decode:{}},u="wxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_".split(""),p={encode:a,decode:s};o.exports=p},null),u("UrlMap",["UrlMapConfig"],function(e,t,n,i,o,r,a){var s={resolve:function(e,t){var n="undefined"==typeof t?location.protocol.replace(":",""):t?"https":"http";return e in a?n+"://"+a[e]:"undefined"==typeof t&&e+"_"+n in a?n+"://"+a[e+"_"+n]:t!==!0&&e+"_http"in a?"http://"+a[e+"_http"]:t!==!1&&e+"_https"in a?"https://"+a[e+"_https"]:void 0}};o.exports=s},null),u("sdk.Impressions",["sdk.Content","guid","insertIframe","Miny","QueryString","sdk.Runtime","UrlMap"],function(e,t,n,i,o,r,a,s,l,c,u,p,h){function f(e){var t=p.getClientID();!e.api_key&&t&&(e.api_key=t),e.kid_directed_site=p.getKidDirectedSite();var n=h.resolve("www",!0)+"/impression.php/"+s()+"/",i=u.appendToUrl(n,e);if(i.length>2e3&&e.payload&&"string"==typeof e.payload){var o=c.encode(e.payload);o&&o.length<e.payload.length&&(e.payload=o,i=u.appendToUrl(n,e))}if(i.length<=2e3){var r=new Image;r.src=i}else{var d=s(),f=a.appendHidden("");l({url:"javascript:false",root:f,name:d,className:"fb_hidden fb_invisible",onload:function(){f.parentNode.removeChild(f)}}),a.submitToTarget({url:n,target:d,params:e})}}var g={log:function(e,t){t.source||(t.source="jssdk"),f({lid:e,payload:d("JSON","stringify",!1,t)})},impression:f};o.exports=g},null),u("Base64",[],function(e,t,n,i,o){function r(e){return e=e.charCodeAt(0)<<16|e.charCodeAt(1)<<8|e.charCodeAt(2),String.fromCharCode(s.charCodeAt(e>>>18),s.charCodeAt(e>>>12&63),s.charCodeAt(e>>>6&63),s.charCodeAt(63&e))}function a(e){return e=l.charCodeAt(e.charCodeAt(0)-43)<<18|l.charCodeAt(e.charCodeAt(1)-43)<<12|l.charCodeAt(e.charCodeAt(2)-43)<<6|l.charCodeAt(e.charCodeAt(3)-43),String.fromCharCode(e>>>16,e>>>8&255,255&e)}var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=">___?456789:;<=_______\x00\b	\n\f\r______ !\"#$%&'()*+,-./0123",c={encode:function(e){e=unescape(encodeURI(e));var t=(e.length+2)%3;return e=(e+"\x00\x00".slice(t)).replace(/[\s\S]{3}/g,r),e.slice(0,e.length+t-2)+"==".slice(t)},decode:function(e){e=e.replace(/[^A-Za-z0-9+\/]/g,"");var t=e.length+3&3;e=(e+"AAA".slice(t)).replace(/..../g,a),e=e.slice(0,e.length+t-3);try{return decodeURIComponent(escape(e))}catch(n){throw new Error("Not valid UTF-8")}},encodeObject:function(e){return c.encode(d("JSON","stringify",!1,e))},decodeObject:function(e){return d("JSON","parse",!1,c.decode(e))},encodeNums:function(e){return String.fromCharCode.apply(String,d(e,"map",!0,function(e){return s.charCodeAt((e|-(e>63))&-(e>0)&63)}))}};o.exports=c},null),u("sdk.SignedRequest",["Base64"],function(e,t,n,i,o,r,a){function s(e){if(!e)return null;var t=e.split(".",2)[1].replace(/\-/g,"+").replace(/\_/g,"/");return a.decodeObject(t)}var l={parse:s};o.exports=l},null),u("URIRFC3986",[],function(e,t,n,i,o){var r=new RegExp("^([^:/?#]+:)?(//([^\\\\/?#@]*@)?(\\[[A-Fa-f0-9:.]+\\]|[^\\/?#:]*)(:[0-9]*)?)?([^?#]*)(\\?[^#]*)?(#.*)?"),a={parse:function(e){if(""===d(e,"trim",!0))return null;var t=e.match(r),n={};return n.uri=t[0]?t[0]:null,n.scheme=t[1]?t[1].substr(0,t[1].length-1):null,n.authority=t[2]?t[2].substr(2):null,n.userinfo=t[3]?t[3].substr(0,t[3].length-1):null,n.host=t[2]?t[4]:null,n.port=t[5]&&t[5].substr(1)?parseInt(t[5].substr(1),10):null,n.path=t[6]?t[6]:null,n.query=t[7]?t[7].substr(1):null,n.fragment=t[8]?t[8].substr(1):null,n.isGenericURI=null===n.authority&&!!n.scheme,n}};o.exports=a},null),u("createObjectFrom",[],function(e,t,n,i,o){function r(e,t){var n={},i=d("Array","isArray",!1,t);"undefined"==typeof t&&(t=!0);for(var o=e.length;o--;)n[e[o]]=i?t[o]:t;return n}o.exports=r},null),u("URISchemes",["createObjectFrom"],function(e,t,n,i,o,r,a){var s=a(["fb","fbcf","fbconnect","fb-messenger","fbrpc","file","ftp","http","https","mailto","ms-app","itms","itms-apps","itms-services","market","svn+ssh","fbstaging","tel","sms","pebblejs"]),l={isAllowed:function(e){return e?s.hasOwnProperty(e.toLowerCase()):!0}};o.exports=l},null),u("copyProperties",[],function(e,t,n,i,o){function r(e,t,n,i,o,r){e=e||{};for(var a,s=[t,n,i,o,r],l=0;s[l];){a=s[l++];for(var c in a)e[c]=a[c];a.hasOwnProperty&&a.hasOwnProperty("toString")&&"undefined"!=typeof a.toString&&e.toString!==a.toString&&(e.toString=a.toString)}return e}o.exports=r},null),u("eprintf",[],function(e,t,n,i,o){var r=function(e){var t=d(Array.prototype.slice.call(arguments),"map",!0,function(e){return String(e)}),n=e.split("%s").length-1;if(n!==t.length-1)return r("eprintf args number mismatch: %s",d("JSON","stringify",!1,t));var i=1;return e.replace(/%s/g,function(){return String(t[i++])})};o.exports=r},null),u("ex",["eprintf"],function(e,t,n,i,o){var r=function(){for(var e=[],t=0,n=arguments.length;n>t;t++)e.push(arguments[t]);return e=d(e,"map",!0,function(e){return String(e)}),e[0].split("%s").length!==e.length?r("ex args number mismatch: %s",d("JSON","stringify",!1,e)):r._prefix+d("JSON","stringify",!1,e)+r._suffix};r._prefix="<![EX[",r._suffix="]]>",o.exports=r},null),u("invariant",[],function(e,t,n,i,o){var r=function(e,t,n,i,o,r,a,s){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,i,o,r,a,s],u=0;l=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return c[u++]}))}throw l.framesToPop=1,l}};o.exports=r},null),u("URIBase",["URIRFC3986","URISchemes","copyProperties","ex","invariant"],function(e,t,n,i,o,r,a,s,l,c,u){function p(e,t,n,i){if(!t)return!0;if(t instanceof h)return e.setProtocol(t.getProtocol()),e.setDomain(t.getDomain()),e.setPort(t.getPort()),e.setPath(t.getPath()),e.setQueryData(i.deserialize(i.serialize(t.getQueryData()))),e.setFragment(t.getFragment()),e.setForceFragmentSeparator(t.getForceFragmentSeparator()),!0;t=d(t.toString(),"trim",!0);var o=a.parse(t)||{};if(!n&&!s.isAllowed(o.scheme))return!1;if(e.setProtocol(o.scheme||""),!n&&f.test(o.host))return!1;if(e.setDomain(o.host||""),e.setPort(o.port||""),e.setPath(o.path||""),n)e.setQueryData(i.deserialize(o.query)||{});else try{e.setQueryData(i.deserialize(o.query)||{})}catch(r){return!1}if(e.setFragment(o.fragment||""),""===o.fragment&&e.setForceFragmentSeparator(!0),null!==o.userinfo){if(n)throw new Error(c("URI.parse: invalid URI (userinfo is not allowed in a URI): %s",e.toString()));return!1}if(!e.getDomain()&&-1!==d(e.getPath(),"indexOf",!0,"\\")){if(n)throw new Error(c("URI.parse: invalid URI (no domain but multiple back-slashes): %s",e.toString()));return!1}if(!e.getProtocol()&&g.test(t)){if(n)throw new Error(c("URI.parse: invalid URI (unsafe protocol-relative URLs): %s",e.toString()));return!1}return!0}function h(e,t){u(t),this.$URIBase0=t,this.$URIBase1="",this.$URIBase2="",this.$URIBase3="",this.$URIBase4="",this.$URIBase5="",this.$URIBase6={},this.$URIBase7=!1,p(this,e,!0,t)}var f=new RegExp("[\\x00-\\x2c\\x2f\\x3b-\\x40\\x5c\\x5e\\x60\\x7b-\\x7f\\uFDD0-\\uFDEF\\uFFF0-\\uFFFF\\u2047\\u2048\\uFE56\\uFE5F\\uFF03\\uFF0F\\uFF1F]"),g=new RegExp("^(?:[^/]*:|[\\x00-\\x1f]*/[\\x00-\\x1f]*/)"),m=[];h.prototype.setProtocol=function(e){return u(s.isAllowed(e)),this.$URIBase1=e,this},h.prototype.getProtocol=function(){return this.$URIBase1},h.prototype.setSecure=function(e){return this.setProtocol(e?"https":"http")},h.prototype.isSecure=function(){return"https"===this.getProtocol()},h.prototype.setDomain=function(e){if(f.test(e))throw new Error(c("URI.setDomain: unsafe domain specified: %s for url %s",e,this.toString()));return this.$URIBase2=e,this},h.prototype.getDomain=function(){return this.$URIBase2},h.prototype.setPort=function(e){return this.$URIBase3=e,this},h.prototype.getPort=function(){return this.$URIBase3},h.prototype.setPath=function(e){return this.$URIBase4=e,this},h.prototype.getPath=function(){return this.$URIBase4},h.prototype.addQueryData=function(e,t){return"[object Object]"===Object.prototype.toString.call(e)?l(this.$URIBase6,e):this.$URIBase6[e]=t,this},h.prototype.setQueryData=function(e){return this.$URIBase6=e,this},h.prototype.getQueryData=function(){return this.$URIBase6},h.prototype.removeQueryData=function(e){d("Array","isArray",!1,e)||(e=[e]);for(var t=0,n=e.length;n>t;++t)delete this.$URIBase6[e[t]];return this},h.prototype.setFragment=function(e){return this.$URIBase5=e,this.setForceFragmentSeparator(!1),this},h.prototype.getFragment=function(){return this.$URIBase5},h.prototype.setForceFragmentSeparator=function(e){return this.$URIBase7=e,this},h.prototype.getForceFragmentSeparator=function(){return this.$URIBase7},h.prototype.isEmpty=function(){return!(this.getPath()||this.getProtocol()||this.getDomain()||this.getPort()||d("Object","keys",!1,this.getQueryData()).length>0||this.getFragment())},h.prototype.toString=function(){for(var e=this,t=0;t<m.length;t++)e=m[t](e);return e.$URIBase8()},h.prototype.$URIBase8=function(){var e="",t=this.getProtocol();t&&(e+=t+"://");var n=this.getDomain();n&&(e+=n);var i=this.getPort();i&&(e+=":"+i);var o=this.getPath();o?e+=o:e&&(e+="/");var r=this.$URIBase0.serialize(this.getQueryData());r&&(e+="?"+r);var a=this.getFragment();return a?e+="#"+a:this.getForceFragmentSeparator()&&(e+="#"),e},h.registerFilter=function(e){m.push(e)},h.prototype.getOrigin=function(){var e=this.getPort();return this.getProtocol()+"://"+this.getDomain()+(e?":"+e:"")},h.isValidURI=function(e,t){return p(new h(null,t),e,!1,t)},o.exports=h},null),u("sdk.URI",["Assert","QueryString","URIBase"],function(e,t,n,i,o,r,a,s,l){function c(e){return a.isString(e,"The passed argument was of invalid type."),this instanceof c?void l.call(this,e,p):new c(e)}var u=/\.facebook\.com$/,p={serialize:function(e){return e?s.encode(e):""},deserialize:function(e){return e?s.decode(e):{}}};for(var h in l)l.hasOwnProperty(h)&&(c[h]=l[h]);var f=null===l?null:l.prototype;c.prototype=d("Object","create",!1,f),c.prototype.constructor=c,c.__superConstructor__=l,c.prototype.isFacebookURI=function(){return u.test(this.getDomain())},c.prototype.valueOf=function(){return this.toString()},o.exports=c},null),u("sdk.Event",[],function(e,t,n,i,o){var r={SUBSCRIBE:"event.subscribe",UNSUBSCRIBE:"event.unsubscribe",subscribers:function(){return this._subscribersMap||(this._subscribersMap={}),this._subscribersMap},subscribe:function(e,t){var n=this.subscribers();n[e]?-1==d(n[e],"indexOf",!0,t)&&n[e].push(t):n[e]=[t],e!=this.SUBSCRIBE&&e!=this.UNSUBSCRIBE&&this.fire(this.SUBSCRIBE,e,n[e])},unsubscribe:function(e,t){var n=this.subscribers()[e];n&&d(n,"forEach",!0,function(e,i){e==t&&n.splice(i,1)}),e!=this.SUBSCRIBE&&e!=this.UNSUBSCRIBE&&this.fire(this.UNSUBSCRIBE,e,n)},monitor:function(e,t){if(!t()){var n=this,i=function(){t.apply(t,arguments)&&n.unsubscribe(e,i)};this.subscribe(e,i)}},clear:function(e){delete this.subscribers()[e]},fire:function(e){var t=Array.prototype.slice.call(arguments,1),n=this.subscribers()[e];n&&d(n,"forEach",!0,function(e){e&&e.apply(this,t)})}};o.exports=r},null),u("Queue",["copyProperties"],function(e,t,n,i,o,a,l){function c(e){this._opts=l({interval:0,processor:null},e),this._queue=[],this._stopped=!0}var u={};c.prototype._dispatch=function(){if(!this._stopped&&0!==this._queue.length){if(!this._opts.processor)throw this._stopped=!0,new Error("No processor available");if(this._opts.interval)this._opts.processor.call(this,this._queue.shift()),this._timeout=r(d(this._dispatch,"bind",!0,this),this._opts.interval);else for(;this._queue.length;)this._opts.processor.call(this,this._queue.shift())}},c.prototype.enqueue=function(e){return this._opts.processor&&!this._stopped?this._opts.processor.call(this,e):this._queue.push(e),this},c.prototype.start=function(e){return e&&(this._opts.processor=e),this._stopped=!1,this._dispatch(),this},c.prototype.isStarted=function(){return!this._stopped},c.prototype.dispatch=function(){this._dispatch(!0)},c.prototype.stop=function(e){return this._stopped=!0,e&&s(this._timeout),this},c.prototype.merge=function(e,t){return this._queue[t?"unshift":"push"].apply(this._queue,e._queue),e._queue=[],this._dispatch(),this},c.prototype.getLength=function(){return this._queue.length},c.get=function(e,t){var n;return n=e in u?u[e]:u[e]=new c(t)},c.exists=function(e){return e in u},c.remove=function(e){return delete u[e]},o.exports=c},null),u("JSONRPC",["Log"],function(e,t,n,i,o,a,s){function l(e){this.$JSONRPC0=0,this.$JSONRPC1={},this.remote=d(function(e){return this.$JSONRPC2=e,this.remote},"bind",!0,this),this.local={},this.$JSONRPC3=e}l.prototype.stub=function(e){this.remote[e]=d(function(){for(var t=[],n=0,i=arguments.length;i>n;n++)t.push(arguments[n]);var o={jsonrpc:"2.0",method:e};"function"==typeof t[t.length-1]&&(o.id=++this.$JSONRPC0,this.$JSONRPC1[o.id]=t.pop()),o.params=t,this.$JSONRPC3(d("JSON","stringify",!1,o),this.$JSONRPC2||{method:e})},"bind",!0,this)},l.prototype.read=function(e,t){var n=d("JSON","parse",!1,e),i=n.id;if(!n.method){if(!this.$JSONRPC1[i])return void s.warn("Could not find callback %s",i);var o=this.$JSONRPC1[i];return delete this.$JSONRPC1[i],delete n.id,delete n.jsonrpc,void o(n)}var a,l=this,c=this.local[n.method];if(a=i?function(e,n){var o={jsonrpc:"2.0",id:i};o[e]=n,r(function(){l.$JSONRPC3(d("JSON","stringify",!1,o),t)},0)}:function(){},!c)return s.error('Method "%s" has not been defined',n.method),void a("error",{code:-32601,message:"Method not found",data:n.method});n.params.push(d(a,"bind",!0,null,"result")),n.params.push(d(a,"bind",!0,null,"error"));try{var u=c.apply(t||null,n.params);"undefined"!=typeof u&&a("result",u)}catch(p){s.error("Invokation of RPC method %s resulted in the error: %s",n.method,p.message),a("error",{code:-32603,message:"Internal error",data:p.message})}},o.exports=l},null),u("sdk.RPC",["Assert","JSONRPC","Queue"],function(e,t,n,i,o,r,a,s,l){var c=new l,u=new s(function(e){c.enqueue(e)}),p={local:u.local,remote:u.remote,stub:d(u.stub,"bind",!0,u),setInQueue:function(e){a.isInstanceOf(l,e),e.start(function(e){u.read(e)})},getOutQueue:function(){return c}};o.exports=p},null),u("sdk.Scribe",["QueryString","sdk.Runtime","UrlMap"],function(e,t,n,i,o,r,a,s,l){function c(e,t){"object"==typeof t.extra&&(t.extra.revision=s.getRevision()),(new Image).src=a.appendToUrl(l.resolve("www",!0)+"/common/scribe_endpoint.php",{c:e,m:d("JSON","stringify",!1,t)})}var u={log:c};o.exports=u},null),u("emptyFunction",[],function(e,t,n,i,o){function r(e){return function(){return e}}function a(){}d("Object","assign",!1,a,{thatReturns:r,thatReturnsFalse:r(!1),thatReturnsTrue:r(!0),thatReturnsNull:r(null),thatReturnsThis:function(){return this},thatReturnsArgument:function(e){return e}}),o.exports=a},null),u("htmlSpecialChars",[],function(e,t,n,i,o){function r(e){return"undefined"!=typeof e&&null!==e&&e.toString?e===!1?"0":e===!0?"1":e.toString().replace(a,"&amp;").replace(c,"&quot;").replace(u,"&#039;").replace(s,"&lt;").replace(l,"&gt;"):""}var a=/&/g,s=/</g,l=/>/g,c=/"/g,u=/'/g;o.exports=r},null),u("Flash",["DOMEventListener","DOMWrapper","QueryString","UserAgent_DEPRECATED","copyProperties","guid","htmlSpecialChars"],function(t,n,i,o,r,a,s,l,c,u,d,p,h){function f(e){var t=w.getElementById(e);t&&t.parentNode.removeChild(t),delete y[e]}function g(){for(var e in y)y.hasOwnProperty(e)&&f(e)}function m(e){return e.replace(/\d+/g,function(e){return"000".substring(e.length)+e})}function v(t){b||(u.ie()>=9&&s.add(e,"unload",g),b=!0),y[t]=t}var b,y={},w=l.getWindow().document,k={embed:function(e,t,n,i){var o=p();e=h(e).replace(/&amp;/g,"&"),n=d({allowscriptaccess:"always",flashvars:i,movie:e},n||{}),"object"==typeof n.flashvars&&(n.flashvars=c.encode(n.flashvars));var r=[];for(var a in n)n.hasOwnProperty(a)&&n[a]&&r.push('<param name="'+h(a)+'" value="'+h(n[a])+'">');var s=t.appendChild(w.createElement("span")),l="<object "+(u.ie()?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ':'type="application/x-shockwave-flash"')+'data="'+e+'" '+(n.height?'height="'+n.height+'" ':"")+(n.width?'width="'+n.width+'" ':"")+'id="'+o+'">'+r.join("")+"</object>";s.innerHTML=l;var f=s.firstChild;return v(o),f},remove:f,getVersion:function(){var e,t="Shockwave Flash",n="application/x-shockwave-flash",i="ShockwaveFlash.ShockwaveFlash";if(navigator.plugins&&"object"==typeof navigator.plugins[t]){var o=navigator.plugins[t].description;o&&navigator.mimeTypes&&navigator.mimeTypes[n]&&navigator.mimeTypes[n].enabledPlugin&&(e=o.match(/\d+/g))}if(!e)try{e=new ActiveXObject(i).GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),e=Array.prototype.slice.call(e,1)}catch(r){}return e},checkMinVersion:function(e){var t=k.getVersion();return t?m(t.join("."))>=m(e):!1},isAvailable:function(){return!!k.getVersion()}};r.exports=k},null),u("XDM",["DOMEventListener","DOMWrapper","emptyFunction","Flash","GlobalCallback","guid","Log","UserAgent_DEPRECATED","wrapFunction"],function(e,t,n,i,o,a,l,c,u,d,p,h,f,g,m){function v(e){for(var t={},n=e.length,i=y.transports;n--;)t[e[n]]=1;for(n=i.length;n--;){var o=i[n],r=b[o];if(!t[o]&&r.isAvailable())return o}}var b={},y={transports:[]},w=c.getWindow(),k={register:function(e,t){f.debug("Registering %s as XDM provider",e),y.transports.push(e),b[e]=t},create:function(e){if(!e.whenReady&&!e.onMessage)throw f.error("An instance without whenReady or onMessage makes no sense"),new Error("An instance without whenReady or onMessage makes no sense");e.channel||(f.warn("Missing channel name, selecting at random"),e.channel=h()),e.whenReady||(e.whenReady=u),e.onMessage||(e.onMessage=u);var t=e.transport||v(e.blacklist||[]),n=b[t];return n&&n.isAvailable()?(f.debug("%s is available",t),n.init(e),t):void 0}};k.register("flash",function(){var e,t,n=!1,i=!1,o=15e3;return{isAvailable:function(){return d.checkMinVersion("8.0.24")},init:function(a){f.debug("init flash: "+a.channel);var l={send:function(t,n,i,o){f.debug("sending to: %s (%s)",n,o),e.postMessage(t,n,o)}};if(n)return void a.whenReady(l);var c=a.root.appendChild(w.document.createElement("div")),u=p.create(function(){p.remove(u),s(t),f.info("xdm.swf called the callback");var n=p.create(function(e,t){e=decodeURIComponent(e),t=decodeURIComponent(t),f.debug("received message %s from %s",e,t),a.onMessage(e,t)},"xdm.swf:onMessage");e.init(a.channel,n),a.whenReady(l)},"xdm.swf:load");e=d.embed(a.flashUrl,c,null,{protocol:location.protocol.replace(":",""),host:location.host,callback:u,log:i}),t=r(function(){f.warn("The Flash component did not load within %s ms - verify that the container is not set to hidden or invisible using CSS as this will cause some browsers to not load the components",o)},o),n=!0}}}()),k.register("postmessage",function(){var e=!1;return{isAvailable:function(){return!!w.postMessage},init:function(t){f.debug("init postMessage: "+t.channel);var n="_FB_"+t.channel,i={send:function(e,t,n,i){if(w===n)throw f.error("Invalid windowref, equal to window (self)"),new Error;f.debug("sending to: %s (%s)",t,i);var o=function(){n.postMessage("_FB_"+i+e,t)};8==g.ie()||g.ieCompatibilityMode()?r(o,0):o()}};return e?void t.whenReady(i):(l.add(w,"message",m(function(e){var i=e.data,o=e.origin||"native";return/^(https?:\/\/|native$)/.test(o)?"string"!=typeof i?void f.warn("Received message of type %s from %s, expected a string",typeof i,o):(f.debug("received message %s from %s",i,o),i.substring(0,n.length)==n&&(i=i.substring(n.length)),void t.onMessage(i,o)):void f.debug("Received message from invalid origin type: %s",o)},"entry","onMessage")),t.whenReady(i),void(e=!0))}}}()),o.exports=k},null),u("isFacebookURI",[],function(e,t,n,i,o){function r(e){return a||(a=new RegExp("(^|\\.)facebook\\.com$","i")),e.isEmpty()?!1:e.getDomain()||e.getProtocol()?-1!==d(s,"indexOf",!0,e.getProtocol())&&a.test(e.getDomain()):!0}var a=null,s=["http","https"];r.setRegex=function(e){a=e},o.exports=r},null),u("sdk.XD",["sdk.Content","sdk.Event","Log","QueryString","Queue","sdk.RPC","sdk.Runtime","sdk.Scribe","sdk.URI","UrlMap","JSSDKXDConfig","XDM","isFacebookURI","sdk.createIframe","sdk.feature","guid"],function(e,t,n,i,a,s,l,c,u,p,h,f,g,m,v,b,y,w,k,_,x,S){function C(e){u.info("Remote XD can talk to facebook.com (%s)",e),g.setEnvironment("canvas"===e?g.ENVIRONMENTS.CANVAS:g.ENVIRONMENTS.PAGETAB)}function I(e,t){if(!t)throw u.error("No senderOrigin"),new Error;var n=/^https?/.exec(t)[0];switch(e.xd_action){case"proxy_ready":var i,o;"https"==n?(i=N,o=D):(i=M,o=A),e.registered&&(C(e.registered),R=i.merge(R)),u.info("Proxy ready, starting queue %s containing %s messages",n+"ProxyQueue",i.getLength()),i.start(function(e){O.send("string"==typeof e?e:p.encode(e),t,o.contentWindow,z+"_"+n)});break;case"plugin_ready":if(u.info("Plugin %s ready, protocol: %s",e.name,n),H[e.name]={protocol:n},h.exists(e.name)){var r=h.get(e.name);u.debug("Enqueuing %s messages for %s in %s",r.getLength(),e.name,n+"ProxyQueue"),("https"==n?N:M).merge(r)}}e.data&&T(e.data,t)}function T(e,t){if(!t||"native"===t||k(v(t))){if("string"==typeof e){if(/^FB_RPC:/.test(e))return void V.enqueue(e.substring(7));if("{"==e.substring(0,1))try{e=d("JSON","parse",!1,e)}catch(n){return void u.warn("Failed to decode %s as JSON",e)}else e=p.decode(e)}if(t||e.xd_sig==$&&(t=e.xd_origin),e.xd_action)return void I(e,t);if(e.access_token&&g.setSecure(/^https/.test(U)),e.cb){var i=G._callbacks[e.cb];G._forever[e.cb]||delete G._callbacks[e.cb],i&&i(e)}}}function P(e,t){if("facebook"==e)t.relation="parent.parent",R.enqueue(t);else{t.relation='parent.frames["'+e+'"]';var n=H[e];n?(u.debug("Enqueuing message for plugin %s in %s",e,n.protocol+"ProxyQueue"),("https"==n.protocol?N:M).enqueue(t)):(u.debug("Buffering message for plugin %s",e),h.get(e).enqueue(t))}}function E(e){if(!q){var t=l.appendHidden(o.createElement("div")),n=w.create({blacklist:null,root:t,channel:z,flashUrl:y.Flash.path,whenReady:function(i){O=i;var o={channel:z,origin:location.protocol+"//"+location.host,transport:n,xd_name:e},r="#"+p.encode(o);g.getSecure()!==!0&&(A=_({url:W+r,name:"fb_xdm_frame_http",id:"fb_xdm_frame_http",root:t,"aria-hidden":!0,title:j,tabindex:-1})),D=_({url:L+r,name:"fb_xdm_frame_https",id:"fb_xdm_frame_https",root:t,"aria-hidden":!0,title:j,tabindex:-1})},onMessage:T});n||m.log("jssdk_error",{appId:g.getClientID(),error:"XD_TRANSPORT",extra:{message:"Failed to create a valid transport"}}),q=!0}}var A,D,O,R=new h,M=new h,N=new h,$=S(),B=y.useCdn?"cdn":"www",F=x("use_bundle")?y.XdBundleUrl:y.XdUrl,W=b.resolve(B,!1)+F,L=b.resolve(B,!0)+F,z=S(),U=location.protocol+"//"+location.host,q=!1,j="Facebook Cross Domain Communication Frame",H={},V=new h;f.setInQueue(V),f.getOutQueue().start(function(e){P("facebook","FB_RPC:"+e)});var G={rpc:f,_callbacks:{},_forever:{},_channel:z,_origin:U,onMessage:T,recv:T,init:E,sendToFacebook:P,inform:function(e,t,n,i){P("facebook",{method:e,params:d("JSON","stringify",!1,t||{}),behavior:i||"p",relation:n})},handler:function(e,t,n,i){var o="#"+p.encode({cb:this.registerCallback(e,n,i),origin:U+"/"+z,domain:location.hostname,relation:t||"opener"});return("https:"==location.protocol?L:W)+o},registerCallback:function(e,t,n){return n=n||S(),t&&(G._forever[n]=!0),G._callbacks[n]=e,n}};c.subscribe("init:post",function(e){E(e.xdProxyName);var t=x("xd_timeout");t&&r(function(){var e=D&&!!A==M.isStarted()&&!!D==N.isStarted();e||m.log("jssdk_error",{appId:g.getClientID(),error:"XD_INITIALIZATION",extra:{message:"Failed to initialize in "+t+"ms"}})},t)}),a.exports=G},null),u("sdk.Auth",["sdk.Cookie","sdk.createIframe","DOMWrapper","sdk.feature","sdk.getContextType","guid","sdk.Impressions","Log","ObservableMixin","sdk.Runtime","sdk.SignedRequest","UrlMap","sdk.URI","sdk.XD"],function(e,t,n,i,o,a,l,c,u,p,h,f,g,m,v,b,y,w,k,_){function x(e,t){var n=b.getUserID(),i="";if(e)if(e.userID)i=e.userID;else if(e.signedRequest){var o=y.parse(e.signedRequest);o&&o.user_id&&(i=o.user_id)}var r=b.getLoginStatus(),a="unknown"===r&&e||b.getUseCookie()&&b.getCookieUserID()!==i,s=n&&!e,l=e&&n&&n!=i,c=e!=P,u=t!=(r||"unknown");b.setLoginStatus(t),b.setAccessToken(e&&e.accessToken||null),b.setUserID(i),P=e;var d={authResponse:e,status:t};return(s||l)&&D.inform("logout",d),(a||l)&&D.inform("login",d),c&&D.inform("authresponse.change",d),u&&D.inform("status.change",d),d}function S(){return P}function C(e,t,n){return function(i){var o;if(i&&i.access_token){var r=y.parse(i.signed_request);if(t={accessToken:i.access_token,userID:r.user_id,expiresIn:parseInt(i.expires_in,10),signedRequest:i.signed_request},i.granted_scopes&&(t.grantedScopes=i.granted_scopes),b.getUseCookie()){var a=0===t.expiresIn?0:d("Date","now",!1)+1e3*t.expiresIn,s=l.getDomain();!s&&i.base_domain&&l.setDomain("."+i.base_domain),l.setSignedRequestCookie(i.signed_request,a)}o="connected",x(t,o)}else("logout"===n||"login_status"===n)&&(o=i.error&&"not_authorized"===i.error?"not_authorized":"unknown",x(null,o),b.getUseCookie()&&l.clearSignedRequestCookie());return i&&1==i.https&&b.setSecure(!0),e&&e({authResponse:t,status:b.getLoginStatus()}),t}}function I(e){var t,n=d("Date","now",!1);E&&(s(E),E=null);var i=C(e,P,"login_status"),o=k(w.resolve("www",!0)+"/connect/ping").setQueryData({client_id:b.getClientID(),response_type:"token,signed_request,code",domain:location.hostname,origin:h(),redirect_uri:_.handler(function(e){if(p("e2e_ping_tracking",!0)){var o={init:n,close:d("Date","now",!1),method:"ping"};m.debug("e2e: %s",d("JSON","stringify",!1,o)),g.log(114,{payload:o})}t.parentNode.removeChild(t),i(e)&&(E=r(function(){I(function(){})},12e5))},"parent"),sdk:"joey",kid_directed_site:b.getKidDirectedSite()});t=c({root:u.getRoot(),name:f(),url:o.toString(),style:{display:"none"}})}function T(e,t){if(!b.getClientID())return void m.warn("FB.getLoginStatus() called before calling FB.init().");if(e){if(!t&&"loaded"==A)return void e({status:b.getLoginStatus(),authResponse:S()});D.subscribe("FB.loginStatus",e)}if(t||"loading"!=A){A="loading";var n=function(e){A="loaded",D.inform("FB.loginStatus",e),D.clearSubscribers("FB.loginStatus")};I(n)}}var P,E,A,D=new v;d("Object","assign",!1,D,{getLoginStatus:T,fetchLoginStatus:I,setAuthResponse:x,getAuthResponse:S,parseSignedRequest:y.parse,xdResponseWrapper:C}),o.exports=D},null),u("toArray",["invariant"],function(e,t,n,i,o,r,a){function s(e){var t=e.length;if(a(!d("Array","isArray",!1,e)&&("object"==typeof e||"function"==typeof e)),a("number"==typeof t),a(0===t||t-1 in e),e.hasOwnProperty)try{return Array.prototype.slice.call(e)}catch(n){}for(var i=Array(t),o=0;t>o;o++)i[o]=e[o];return i}o.exports=s},null),u("createArrayFrom",["toArray"],function(e,t,n,i,o,r,a){function s(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"length"in e&&!("setInterval"in e)&&"number"!=typeof e.nodeType&&(d("Array","isArray",!1,e)||"callee"in e||"item"in e)}function l(e){return s(e)?d("Array","isArray",!1,e)?e.slice():a(e):[e]}o.exports=l},null),u("sdk.DOM",["Assert","createArrayFrom","sdk.domReady","UserAgent_DEPRECATED"],function(t,n,i,r,a,s,l,c,u,p){function h(e,t){var n=e.getAttribute(t)||e.getAttribute(t.replace(/_/g,"-"))||e.getAttribute(t.replace(/-/g,"_"))||e.getAttribute(t.replace(/-/g,""))||e.getAttribute(t.replace(/_/g,""))||e.getAttribute("data-"+t)||e.getAttribute("data-"+t.replace(/_/g,"-"))||e.getAttribute("data-"+t.replace(/-/g,"_"))||e.getAttribute("data-"+t.replace(/-/g,""))||e.getAttribute("data-"+t.replace(/_/g,""));return n?String(n):null}function f(e,t){var n=h(e,t);return n?/^(true|1|yes|on)$/.test(n):null}function g(e,t){l.isTruthy(e,"element not specified"),l.isString(t);try{return String(e[t])}catch(n){throw new Error("Could not read property "+t+" : "+n.message)}}function m(e,t){l.isTruthy(e,"element not specified"),l.isString(t);try{e.innerHTML=t}catch(n){throw new Error("Could not set innerHTML : "+n.message)}}function v(e,t){l.isTruthy(e,"element not specified"),l.isString(t);var n=" "+g(e,"className")+" ";return d(n,"indexOf",!0," "+t+" ")>=0}function b(e,t){l.isTruthy(e,"element not specified"),l.isString(t),v(e,t)||(e.className=g(e,"className")+" "+t)}function y(e,t){l.isTruthy(e,"element not specified"),l.isString(t);var n=new RegExp("\\s*"+t,"g");e.className=d(g(e,"className").replace(n,""),"trim",!0)}function w(e,t,n){if(l.isString(e),t=t||o.body,n=n||"*",t.querySelectorAll)return c(t.querySelectorAll(n+"."+e));for(var i=t.getElementsByTagName(n),r=[],a=0,s=i.length;s>a;a++)v(i[a],e)&&(r[r.length]=i[a]);return r}function k(e,t){l.isTruthy(e,"element not specified"),l.isString(t),t=t.replace(/-(\w)/g,function(e,t){return t.toUpperCase()});var n=e.currentStyle||o.defaultView.getComputedStyle(e,null),i=n[t];return/backgroundPosition?/.test(t)&&/top|left/.test(i)&&(i="0%"),i}function _(e,t,n){l.isTruthy(e,"element not specified"),l.isString(t),t=t.replace(/-(\w)/g,function(e,t){return t.toUpperCase()}),e.style[t]=n}function x(e,t){for(var n,i=!0,r=0;n=t[r++];)n in I||(i=!1,I[n]=!0);if(!i)if(p.ie()<11)try{o.createStyleSheet().cssText=e}catch(a){o.styleSheets[0]&&(o.styleSheets[0].cssText+=e)}else{var s=o.createElement("style");s.type="text/css",s.textContent=e,o.getElementsByTagName("head")[0].appendChild(s)}}function S(){var t=o.documentElement&&"CSS1Compat"==o.compatMode?o.documentElement:o.body;return{scrollTop:t.scrollTop||o.body.scrollTop,scrollLeft:t.scrollLeft||o.body.scrollLeft,width:e.innerWidth?e.innerWidth:t.clientWidth,height:e.innerHeight?e.innerHeight:t.clientHeight}}function C(e){l.isTruthy(e,"element not specified");var t=0,n=0;do t+=e.offsetLeft,n+=e.offsetTop;while(e=e.offsetParent);return{x:t,y:n}}var I={},T={containsCss:v,addCss:b,removeCss:y,getByClass:w,getStyle:k,setStyle:_,getAttr:h,getBoolAttr:f,getProp:g,html:m,addCssRules:x,getViewportInfo:S,getPosition:C,ready:u};a.exports=T},null),u("sdk.ErrorHandling",["sdk.feature","ManagedError","sdk.Runtime","sdk.Scribe","UserAgent_DEPRECATED","wrapFunction"],function(t,n,i,o,s,l,c,u,p,h,f,g){function m(e){var t=e._originalError;throw delete e._originalError,h.log("jssdk_error",{appId:p.getClientID(),error:e.name||e.message,extra:e}),t}function v(e){var t={line:e.lineNumber||e.line,message:e.message,name:e.name,script:e.fileName||e.sourceURL||e.script,stack:e.stackTrace||e.stack};t._originalError=e,f.chrome()&&/([\w:\.\/]+\.js):(\d+)/.test(e.stack)&&(t.script=RegExp.$1,t.line=parseInt(RegExp.$2,10));for(var n in t)null==t[n]&&delete t[n];return t}function b(e,t){return function(){if(!k)return e.apply(this,arguments);try{return _=t,e.apply(this,arguments)}catch(n){if(n instanceof u)throw n;var i=v(n);i.entry=t;var o=d(Array.prototype.slice.call(arguments),"map",!0,function(e){var t=Object.prototype.toString.call(e);return/^\[object (String|Number|Boolean|Object|Date)\]$/.test(t)?e:e.toString()});i.args=d("JSON","stringify",!1,o).substring(0,200),m(i)}finally{_=""}}}function y(t){return t.__wrapper||(t.__wrapper=function(){try{return t.apply(this,arguments)}catch(n){return e.setTimeout(function(){throw n},0),!1}}),t.__wrapper}function w(e,t){return function(n,i){var o=t+":"+(_||"[global]")+":"+(n.name||"[anonymous]"+(arguments.callee.caller.name?"("+arguments.callee.caller.name+")":""));return e(g(n,"entry",o),i)}}var k=c("error_handling",!1),_="";k&&(r=w(r,"setTimeout"),a=w(a,"setInterval"),g.setWrapper(b,"entry"));var x={guard:b,unguard:y};s.exports=x},null),u("sdk.Insights",["sdk.Impressions"],function(e,t,n,i,o,r,a){var s={TYPE:{NOTICE:"notice",WARNING:"warn",ERROR:"error"},CATEGORY:{DEPRECATED:"deprecated",APIERROR:"apierror"},log:function(e,t,n){var i={source:"jssdk",type:e,category:t,payload:n};a.log(113,i)
},impression:a.impression};o.exports=s},null),u("FB",["sdk.Auth","JSSDKCssConfig","dotAccess","sdk.domReady","sdk.DOM","sdk.ErrorHandling","sdk.Content","DOMWrapper","GlobalCallback","sdk.Insights","Log","sdk.Runtime","sdk.Scribe","JSSDKConfig"],function(t,n,i,r,a,s,l,c,u,p,h,f,g,m,v,b,y,w,k,_){function x(e,t,n,i){var o;switch(/^_/.test(n)?o="hide":I&&!I[t]&&(o=T),o){case"hide":return;case"stub":return function(){y.warn("The method FB.%s has been removed from the JS SDK.",t)};default:return f.guard(function(){function n(e){return d("Array","isArray",!1,e)?d(e,"map",!0,n):e&&"object"==typeof e&&e.__wrapped?e.__wrapped:"function"==typeof e&&/^function/.test(e.toString())?f.unguard(e):e}"warn"===o&&(y.warn("The method FB.%s is not officially supported by Facebook and access to it will soon be removed.",t),P.hasOwnProperty(t)||(b.log(b.TYPE.WARNING,b.CATEGORY.DEPRECATED,"FB."+t),k.log("jssdk_error",{appId:w.getClientID(),error:"Private method used",extra:{args:t}}),P[t]=!0));var r,a=d(Array.prototype.slice.call(arguments),"map",!0,n),s=e.apply(i,a),l=!0;if(s&&"object"==typeof s){var c=Function();c.prototype=s,r=new c,r.__wrapped=s;for(var u in s){var p=s[u];"function"==typeof p&&"constructor"!==u&&(l=!1,r[u]=x(p,t+":"+u,u,s))}}return l&&l?s:r},t)}}function S(e,t){var n=e?u(C,e,!0):C;d(d("Object","keys",!1,t),"forEach",!0,function(i){var o=t[i];if("function"==typeof o){var r=(e?e+".":"")+i,a=x(o,r,i,t);a&&(n[i]=a)}else"object"==typeof o&&(r=(e?e+".":"")+i,I&&I[r]&&(n[i]=o))})}var C,I,T=u(_,"api.mode"),P={};C=e.FB={};var E={};y.level=1,v.setPrefix("FB.__globalCallbacks");var A=o.createElement("div");m.setRoot(A),p(function(){y.info("domReady"),g.appendHidden(A),c.rules&&h.addCssRules(c.rules,c.components)}),w.subscribe("AccessToken.change",function(e){e||"connected"!==w.getLoginStatus()||l.getLoginStatus(null,!0)}),u(_,"api.whitelist.length")&&(I={},d(_.api.whitelist,"forEach",!0,function(e){I[e]=1})),w.setSecure(function(){var t=/iframe_canvas|app_runner/.test(e.name),n=/dialog/.test(e.name);return"https:"!=location.protocol||e!=top&&(t||n)?/_fb_https?/.test(e.name)?-1!=d(e.name,"indexOf",!0,"_fb_https"):void 0:!0}()),d("Object","assign",!1,E,{provide:S}),a.exports=E},null),u("ArgumentError",["ManagedError"],function(e,t,n,i,o,r,a){function s(){a.prototype.constructor.apply(this,arguments)}s.prototype=new a,s.prototype.constructor=s,o.exports=s},null),u("CORSRequest",["wrapFunction","QueryString"],function(e,t,n,o,r,a,s,l){function c(e,t){if(!i.XMLHttpRequest)return null;var n=new XMLHttpRequest,o=function(){};if("withCredentials"in n)n.open(e,t,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded");else{if(!i.XDomainRequest)return null;n=new XDomainRequest;try{n.open(e,t),n.onprogress=n.ontimeout=o}catch(r){return null}}var a={send:function(e){n.send(e)}},l=s(function(){l=o,"onload"in a&&a.onload(n)},"entry","XMLHttpRequest:load"),c=s(function(){c=o,"onerror"in a&&a.onerror(n)},"entry","XMLHttpRequest:error");return n.onload=function(){l()},n.onerror=function(){c()},n.onreadystatechange=function(){4==n.readyState&&(200==n.status?l():c())},a}function u(e,t,n,i){n.suppress_http_code=1;var o=l.encode(n);"post"!=t&&(e=l.appendToUrl(e,o),o="");var r=c(t,e);return r?(r.onload=function(e){i(d("JSON","parse",!1,e.responseText))},r.onerror=function(e){i(e.responseText?d("JSON","parse",!1,e.responseText):{error:{type:"http",message:"unknown error",status:e.status}})},r.send(o),!0):!1}var p={execute:u};r.exports=p},null),u("FlashRequest",["DOMWrapper","Flash","GlobalCallback","QueryString","Queue"],function(e,t,n,i,o,r,a,s,l,c,u){function p(){if(!g)throw new Error("swfUrl has not been set");var e=l.create(function(){f.start(function(e){var t=m.execute(e.method,e.url,e.body);if(!t)throw new Error("Could create request");v[t]=e.callback})}),t=l.create(function(e,t,n){var i;try{i=d("JSON","parse",!1,decodeURIComponent(n))}catch(o){i={error:{type:"SyntaxError",message:o.message,status:t,raw:n}}}v[e](i),delete v[e]});m=s.embed(g,a.getRoot(),null,{log:!1,initCallback:e,requestCallback:t})}function h(e,t,n,i){n.suppress_http_code=1,n.method||(n.method=t);var o=c.encode(n);if("get"===t&&e.length+o.length<2e3?(e=c.appendToUrl(e,o),o=""):t="post",!f){if(!s.isAvailable())return!1;f=new u,p()}return f.enqueue({method:t,url:e,body:o,callback:i}),!0}var f,g,m,v={},b={setSwfUrl:function(e){g=e},execute:h};o.exports=b},null),u("flattenObject",[],function(e,t,n,i,o){function r(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];if(null===i||void 0===i)continue;t[n]="string"==typeof i?i:d("JSON","stringify",!1,i)}return t}o.exports=r},null),u("JSONPRequest",["DOMWrapper","GlobalCallback","QueryString"],function(e,t,n,i,a,s,l,c,u){function d(e,t,n,i){var a=o.createElement("script"),s=function(e){s=function(){},c.remove(n.callback),i(e),a.parentNode.removeChild(a)};if(n.callback=c.create(s),n.method||(n.method=t),e=u.appendToUrl(e,n),e.length>2e3)return c.remove(n.callback),!1;a.onerror=function(){s({error:{type:"http",message:"unknown error"}})};var d=function(){r(function(){s({error:{type:"http",message:"unknown error"}})},0)};return a.addEventListener?a.addEventListener("load",d,!1):a.onreadystatechange=function(){/loaded|complete/.test(this.readyState)&&d()},a.src=e,l.getRoot().appendChild(a),!0}var p={execute:d};a.exports=p},null),u("ApiClient",["ArgumentError","Assert","CORSRequest","FlashRequest","flattenObject","JSONPRequest","Log","ObservableMixin","sprintf","sdk.URI","UrlMap","ApiClientConfig","invariant"],function(e,t,n,i,o,a,s,l,c,u,p,h,f,g,m,v,b,y,w){function k(e,t,n,i){A&&(n=d("Object","assign",!1,{},A,n)),n.access_token=n.access_token||P,n.pretty=n.pretty||0,n=p(n);var o,r={jsonp:h,cors:c,flash:u};n.transport?(o=[n.transport],delete n.transport):o=["jsonp","cors","flash"];for(var a=0;a<o.length;a++){var s=r[o[a]],l=d("Object","assign",!1,{},n);if(s.execute(e,t,l,i))return}i({error:{type:"no-transport",message:"Could not find a usable transport for request"}})}function _(e,t,n,i,o){F.inform("request.complete",t,n,i,o),e&&e(o)}function x(e){var t=e.shift();l.isString(t,"Invalid path"),/^https?/.test(t)||"/"===t.charAt(0)||(t="/"+t);var n,i={};try{n=new v(t)}catch(o){throw new s(o.message,o)}d(e,"forEach",!0,function(e){return i[typeof e]=e});var r=(i.string||"get").toLowerCase();l.isTrue(D.hasOwnProperty(r),m("Invalid method passed to ApiClient: %s",r));var a=i["function"];a||f.warn("No callback passed to the ApiClient"),i.object&&n.addQueryData(i.object);var c=n.getQueryData();return c.method=r,{uri:n,callback:a,params:c}}function S(){for(var e=[],t=0,n=arguments.length;n>t;t++)e.push(arguments[t]);var i=x(e),o=i.uri,r=i.callback,a=i.params,s=a.method,l=o.getProtocol()&&o.getDomain()?o.setQueryData({}).toString():b.resolve("graph")+o.getPath();k(l,"get"==s?"get":"post",a,d(_,"bind",!0,null,r,o.getPath(),s,a))}function C(){for(var e=[],t=0,n=arguments.length;n>t;t++)e.push(arguments[t]);var i=x(e),o=i.uri,a=i.callback,s=i.params,l=s.method,c={method:l,relative_url:o.removeQueryData("method").toString()};"post"==l.toLowerCase()&&(c.body=o.getQueryData(),c.relative_url=o.setQueryData({}).toString()),R.push(c),M.push(a),R.length==$?I():N||(N=r(I,0))}function I(){w(R.length>0);var e=R,t=M;R=[],M=[],N=null,S("/","POST",{batch:d("JSON","stringify",!1,e),include_headers:!1,batch_app_id:E||B},function(e){d("Array","isArray",!1,e)?d(e,"forEach",!0,function(e,n){t[n](d("JSON","parse",!1,e.body))}):d(t,"forEach",!0,function(e){return e({error:{message:"Fatal: batch call failed."}})})})}function T(e,t){l.isObject(e),l.isString(e.method,"method missing"),t||f.warn("No callback passed to the ApiClient");var n=e.method.toLowerCase().replace(".","_");e.format="json-strings",e.api_key=E;var i=n in O?"api_read":"api",o=b.resolve(i)+"/restserver.php",r=d(_,"bind",!0,null,t,"/restserver.php","get",e);k(o,"get",e,r)}var P,E,A,D={get:!0,post:!0,"delete":!0,put:!0},O={fql_query:!0,fql_multiquery:!0,friends_get:!0,notifications_get:!0,stream_get:!0,users_getinfo:!0},R=[],M=[],N=null,$=50,B=105440539523,F=d("Object","assign",!1,new g,{setAccessToken:function(e){P=e},setClientID:function(e){E=e},setDefaultParams:function(e){A=e},rest:T,graph:S,scheduleBatchCall:C});u.setSwfUrl(y.FlashRequest.swfUrl),o.exports=F},null),u("sdk.PlatformVersioning",["sdk.Runtime","ManagedError"],function(e,t,n,i,o,r,a,s){var l=/^v\d+\.\d\d?$/,c={REGEX:l,assertVersionIsSet:function(){if(!a.getVersion())throw new s("init not called with valid version")},assertValidVersion:function(e){if(!l.test(e))throw new s("invalid version specified")}};o.exports=c},null),u("sdk.api",["ApiClient","sdk.PlatformVersioning","sdk.Runtime","sdk.URI"],function(e,t,n,i,o,r,a,s,l,c){function u(e){if("string"==typeof e)if(l.getIsVersioned()){s.assertVersionIsSet(),/https?/.test(e)||"/"===e.charAt(0)||(e="/"+e),e=c(e).setDomain(null).setProtocol(null).toString(),s.REGEX.test(e.substring(1,d(e,"indexOf",!0,"/",1)))||(e="/"+l.getVersion()+e);var t=[e].concat(Array.prototype.slice.call(arguments,1));a.graph.apply(a,t)}else a.graph.apply(a,arguments);else a.rest.apply(a,arguments)}var p;l.subscribe("ClientID.change",function(e){a.setClientID(e)}),l.subscribe("AccessToken.change",function(e){p=e,a.setAccessToken(e)}),a.setDefaultParams({sdk:"joey"}),a.subscribe("request.complete",function(e,t,n,i){var o=!1;i&&"object"==typeof i&&(i.error?("invalid_token"==i.error||"OAuthException"==i.error.type&&190==i.error.code)&&(o=!0):i.error_code&&"190"==i.error_code&&(o=!0)),o&&p===l.getAccessToken()&&l.setAccessToken(null)}),a.subscribe("request.complete",function(e,t,n,i){("/me/permissions"==e&&"delete"===t||"/restserver.php"==e&&"Auth.revokeAuthorization"==n.method)&&i===!0&&l.setAccessToken(null)}),o.exports=u},null),u("legacy:fb.api",["FB","sdk.api"],function(e,t,n,i,o,r,a,s){a.provide("",{api:s})},3),u("sdk.Canvas.Environment",["sdk.RPC"],function(e,t,n,i,o,r,a){function s(e){a.remote.getPageInfo(function(t){e(t.result)})}function l(e,t){a.remote.scrollTo({x:e||0,y:t||0})}a.stub("getPageInfo"),a.stub("scrollTo");var c={getPageInfo:s,scrollTo:l};o.exports=c},null),u("sdk.Intl",["Log"],function(e,t,n,i,o,r,a){function s(e){return"string"!=typeof e?!1:!!e.match(new RegExp(u+"[)\"'\\s]*$"))}function l(e,t){if(void 0!==t)if("object"!=typeof t)a.error("The second arg to FB.Intl.tx() must be an Object for FB.Intl.tx("+e+", ...)");else{var n;for(var i in t)t.hasOwnProperty(i)&&(n=s(t[i])?new RegExp("\\{"+i+"\\}"+u+"*","g"):new RegExp("\\{"+i+"\\}","g"),e=e.replace(n,t[i]))}return e}function c(){throw new Error("Placeholder function")}var u="[.!?]";c._=l,o.exports={tx:c}},null),u("sdk.Dialog",["sdk.Canvas.Environment","sdk.Content","sdk.DOM","DOMEventListener","sdk.Intl","ObservableMixin","sdk.Runtime","Type","UserAgent_DEPRECATED","sdk.feature"],function(t,n,i,a,s,l,c,u,p,h,f,g,m,v,b,y){function w(){if(y("dialog_resize_refactor")){var e=p.getViewportInfo();if(e.height&&e.width)return{width:Math.min(e.width,k),height:Math.min(e.height,_)}}return null}var k=590,_=500,x=240,S=575,C=function(){var e;if(y("dialog_resize_refactor")){var t=w();e=t&&(t.height>=k||t.width>=_)}else e=!!b.ipad();return C=function(){return e},e},I=v.extend({constructor:function(e,t){this.parent(),this.id=e,this.display=t,this._e2e={},T._dialogs||(T._dialogs={},T._addOrientationHandler()),T._dialogs[e]=this,this.trackEvent("init")},trackEvent:function(e,t){return this._e2e[e]?this:(this._e2e[e]=t||d("Date","now",!1),"close"==e&&this.inform("e2e:end",this._e2e),this)},trackEvents:function(e){"string"==typeof e&&(e=d("JSON","parse",!1,e));for(var t in e)e.hasOwnProperty(t)&&this.trackEvent(t,e[t]);return this}},g),T={newInstance:function(e,t){return new I(e,t)},_dialogs:null,_lastYOffset:0,_loaderEl:null,_overlayEl:null,_stack:[],_active:null,get:function(e){return T._dialogs[e]},_findRoot:function(e){for(;e;){if(p.containsCss(e,"fb_dialog"))return e;e=e.parentNode}},_createWWWLoader:function(e){return e=e?e:460,T.create({content:'<div class="dialog_title">  <a id="fb_dialog_loader_close">    <div class="fb_dialog_close_icon"></div>  </a>  <span>Facebook</span>  <div style="clear:both;"></div></div><div class="dialog_content"></div><div class="dialog_footer"></div>',width:e})},_createMobileLoader:function(){var e=b.nativeApp()?"":'<table>  <tbody>    <tr>      <td class="header_left">        <label class="touchable_button">          <input type="submit" value="'+f.tx._("Cancel")+'"            id="fb_dialog_loader_close"/>        </label>      </td>      <td class="header_center">        <div>'+f.tx._("Loading...")+'</div>      </td>      <td class="header_right">      </td>    </tr>  </tbody></table>';return T.create({classes:"loading"+(C()?" centered":""),content:'<div class="dialog_header">'+e+"</div>"})},_restoreBodyPosition:function(){if(!C()){var e=o.getElementsByTagName("body")[0];p.removeCss(e,"fb_hidden")}},_showTabletOverlay:function(){C()&&(T._overlayEl||(T._overlayEl=o.createElement("div"),T._overlayEl.setAttribute("id","fb_dialog_ipad_overlay"),u.append(T._overlayEl,null)),T._overlayEl.className="")},_hideTabletOverlay:function(){C()&&(T._overlayEl.className="hidden")},showLoader:function(e,t){T._showTabletOverlay(),T._loaderEl||(T._loaderEl=T._findRoot(b.mobile()?T._createMobileLoader():T._createWWWLoader(t))),e||(e=function(){});var n=o.getElementById("fb_dialog_loader_close");p.removeCss(n,"fb_hidden"),n.onclick=function(){T._hideLoader(),T._restoreBodyPosition(),T._hideTabletOverlay(),e()};var i=o.getElementById("fb_dialog_ipad_overlay");i&&(i.ontouchstart=n.onclick),T._makeActive(T._loaderEl)},_hideLoader:function(){T._loaderEl&&T._loaderEl==T._active&&(T._loaderEl.style.top="-10000px")},_makeActive:function(e){T._setDialogSizes(),T._lowerActive(),T._active=e,m.isEnvironment(m.ENVIRONMENTS.CANVAS)&&c.getPageInfo(function(e){T._centerActive(e)}),T._centerActive()},_lowerActive:function(){T._active&&(T._active.style.top="-10000px",T._active=null)},_removeStacked:function(e){T._stack=d(T._stack,"filter",!0,function(t){return t!=e})},_centerActive:function(e){var t=T._active;if(t){var n=p.getViewportInfo(),i=parseInt(t.offsetWidth,10),r=parseInt(t.offsetHeight,10),a=n.scrollLeft+(n.width-i)/2,s=(n.height-r)/2.5;s>a&&(s=a);var l=n.height-r-s,c=(n.height-r)/2;if(e&&(c=e.scrollTop-e.offsetTop+(e.clientHeight-r)/2),s>c?c=s:c>l&&(c=l),c+=n.scrollTop,b.mobile()){var u=100;if(C())u+=(n.height-r)/2;else{var d=o.getElementsByTagName("body")[0];p.addCss(d,"fb_hidden"),y("dialog_resize_refactor")&&(d.style.width="auto"),c=1e4}var h=p.getByClass("fb_dialog_padding",t);h.length&&(h[0].style.height=u+"px")}t.style.left=(a>0?a:0)+"px",t.style.top=(c>0?c:0)+"px"}},_setDialogSizes:function(){if(b.mobile()&&!C())for(var e in T._dialogs)if(T._dialogs.hasOwnProperty(e)){var t=o.getElementById(e);t&&(t.style.width=T.getDefaultSize().width+"px",t.style.height=T.getDefaultSize().height+"px")}},getDefaultSize:function(){if(b.mobile()){var t=w();if(t)return t;if(b.ipad())return{width:_,height:k};if(b.android())return{width:screen.availWidth,height:screen.availHeight};var n=e.innerWidth,i=e.innerHeight,o=n/i>1.2;return{width:n,height:Math.max(i,o?screen.width:screen.height)}}return{width:S,height:x}},_handleOrientationChange:function(){var e=y("dialog_resize_refactor",!1)?p.getViewportInfo().width:screen.availWidth;if(b.android()&&e==T._availScreenWidth)return void r(T._handleOrientationChange,50);if(T._availScreenWidth=e,C())T._centerActive();else{var t=T.getDefaultSize().width;for(var n in T._dialogs)if(T._dialogs.hasOwnProperty(n)){var i=o.getElementById(n);i&&(i.style.width=t+"px")}}},_addOrientationHandler:function(){if(b.mobile()){var t="onorientationchange"in e?"orientationchange":"resize";T._availScreenWidth=y("dialog_resize_refactor",!1)?p.getViewportInfo().width:screen.availWidth,h.add(e,t,T._handleOrientationChange)}},create:function(e){e=e||{};var t=o.createElement("div"),n=o.createElement("div"),i="fb_dialog";if(e.closeIcon&&e.onClose){var r=o.createElement("a");r.className="fb_dialog_close_icon",r.onclick=e.onClose,t.appendChild(r)}i+=" "+(e.classes||""),b.ie()?(i+=" fb_dialog_legacy",d(["vert_left","vert_right","horiz_top","horiz_bottom","top_left","top_right","bottom_left","bottom_right"],"forEach",!0,function(e){var n=o.createElement("span");n.className="fb_dialog_"+e,t.appendChild(n)})):i+=b.mobile()?" fb_dialog_mobile":" fb_dialog_advanced",e.content&&u.append(e.content,n),t.className=i;var a=parseInt(e.width,10);if(isNaN(a)||(t.style.width=a+"px"),n.className="fb_dialog_content",t.appendChild(n),b.mobile()){var s=o.createElement("div");s.className="fb_dialog_padding",t.appendChild(s)}return u.append(t),e.visible&&T.show(t),n},show:function(e){var t=T._findRoot(e);t&&(T._removeStacked(t),T._hideLoader(),T._makeActive(t),T._stack.push(t),"fbCallID"in e&&T.get(e.fbCallID).inform("iframe_show").trackEvent("show"))},hide:function(e){var t=T._findRoot(e);T._hideLoader(),t==T._active&&(T._lowerActive(),T._restoreBodyPosition(),T._hideTabletOverlay(),"fbCallID"in e&&T.get(e.fbCallID).inform("iframe_hide").trackEvent("hide"))},remove:function(e){if(e=T._findRoot(e)){var t=T._active==e;T._removeStacked(e),t?(T._hideLoader(),T._stack.length>0?T.show(T._stack.pop()):(T._lowerActive(),T._restoreBodyPosition(),T._hideTabletOverlay())):null===T._active&&T._stack.length>0&&T.show(T._stack.pop()),r(function(){e.parentNode.removeChild(e)},3e3)}},isActive:function(e){var t=T._findRoot(e);return t&&t===T._active}};s.exports=T},null),u("sdk.Frictionless",["sdk.Auth","sdk.api","sdk.Event","sdk.Dialog"],function(e,t,n,i,o,r,a,s,l,c){var u={_allowedRecipients:{},_useFrictionless:!1,_updateRecipients:function(){u._allowedRecipients={},s("/me/apprequestformerrecipients",function(e){e&&!e.error&&d(e.data,"forEach",!0,function(e){u._allowedRecipients[e.recipient_id]=!0})})},init:function(){u._useFrictionless=!0,a.getLoginStatus(function(e){"connected"==e.status&&u._updateRecipients()}),l.subscribe("auth.login",function(e){e.authResponse&&u._updateRecipients()})},_processRequestResponse:function(e,t){return function(n){var i=n&&n.updated_frictionless;u._useFrictionless&&i&&u._updateRecipients(),n&&(!t&&n.frictionless&&(c._hideLoader(),c._restoreBodyPosition(),c._hideIPadOverlay()),delete n.frictionless,delete n.updated_frictionless),e&&e(n)}},isAllowed:function(e){if(!e)return!1;if("number"==typeof e)return e in u._allowedRecipients;"string"==typeof e&&(e=e.split(",")),e=d(e,"map",!0,function(e){return d(String(e),"trim",!0)});var t=!0,n=!1;return d(e,"forEach",!0,function(e){t=t&&e in u._allowedRecipients,n=!0}),t&&n}};l.subscribe("init:post",function(e){e.frictionlessRequests&&u.init()}),o.exports=u},null),u("sdk.Native",["Log","UserAgent_DEPRECATED"],function(t,n,i,o,r,a,s,l){var c="fbNativeReady",u={onready:function(t){if(!l.nativeApp())return void s.error("FB.Native.onready only works when the page is rendered in a WebView of the native Facebook app. Test if this is the case calling FB.UA.nativeApp()");if(e.__fbNative&&!this.nativeReady&&d("Object","assign",!1,this,e.__fbNative),this.nativeReady)t();else{var n=function(){e.removeEventListener(c,n),this.onready(t)};e.addEventListener(c,n,!1)}}};r.exports=u},null),u("resolveURI",[],function(t,n,i,r,a){function s(t){if(!t)return e.location.href;t=t.replace(/&/g,"&amp;").replace(/"/g,"&quot;");var n=o.createElement("div");return n.innerHTML='<a href="'+t+'"></a>',n.firstChild.href}a.exports=s},null),u("sdk.UIServer",["sdk.Auth","sdk.Content","createObjectFrom","sdk.Dialog","sdk.DOM","sdk.Event","flattenObject","sdk.Frictionless","sdk.getContextType","guid","insertIframe","Log","sdk.Native","QueryString","resolveURI","sdk.RPC","sdk.Runtime","JSSDKConfig","UrlMap","UserAgent_DEPRECATED","sdk.XD"],function(t,n,i,s,c,u,p,h,f,g,m,v,b,y,w,k,_,x,S,C,I,T,P,E,A,D,O){var R={transform:function(t){return"touch"===t.params.display&&t.params.access_token&&e.postMessage?(t.params.channel=N._xdChannelHandler(t.id,"parent"),D.nativeApp()||(t.params.in_iframe=1),t):N.genericTransform(t)},getXdRelation:function(t){var n=t.display;return"touch"===n&&e.postMessage&&t.in_iframe?"parent":N.getXdRelation(t)}},M={"stream.share":{size:{width:670,height:340},url:"sharer.php",transform:function(t){return t.params.u||(t.params.u=e.location.toString()),t.params.display="popup",t}},apprequests:{transform:function(e){return e=R.transform(e),e.params.frictionless=y&&y._useFrictionless,e.params.frictionless&&(y.isAllowed(e.params.to)&&(e.params.display="iframe",e.params.in_iframe=!0,e.hideLoader=!0),e.cb=y._processRequestResponse(e.cb,e.hideLoader)),e.closeIcon=!1,e},getXdRelation:R.getXdRelation},feed:R,"permissions.oauth":{url:"dialog/oauth",size:{width:D.mobile()?null:475,height:D.mobile()?null:183},transform:function(e){if(!P.getClientID())return void x.error("FB.login() called before FB.init().");if(p.getAuthResponse()&&!e.params.scope&&!e.params.auth_type)return x.error("FB.login() called when user is already connected."),void(e.cb&&e.cb({status:P.getLoginStatus(),authResponse:p.getAuthResponse()}));var t=e.cb,n=e.id;delete e.cb;var i=d("Object","keys",!1,d("Object","assign",!1,e.params.response_type?f(e.params.response_type.split(",")):{},{token:!0,signed_request:!0})).join(",");return"async"===e.params.display?(d("Object","assign",!1,e.params,{client_id:P.getClientID(),origin:w(),response_type:i,domain:location.hostname}),e.cb=p.xdResponseWrapper(t,p.getAuthResponse(),"permissions.oauth")):d("Object","assign",!1,e.params,{client_id:P.getClientID(),redirect_uri:I(N.xdHandler(t,n,"opener",p.getAuthResponse(),"permissions.oauth")),origin:w(),response_type:i,domain:location.hostname}),e}},"auth.logout":{url:"logout.php",transform:function(e){if(P.getClientID()){if(p.getAuthResponse())return e.params.next=N.xdHandler(e.cb,e.id,"parent",p.getAuthResponse(),"logout"),e;x.error("FB.logout() called without an access token.")}else x.error("FB.logout() called before calling FB.init().")}},"login.status":{url:"dialog/oauth",transform:function(e){var t=e.cb,n=e.id;return delete e.cb,d("Object","assign",!1,e.params,{client_id:P.getClientID(),redirect_uri:N.xdHandler(t,n,"parent",p.getAuthResponse(),"login_status"),origin:w(),response_type:"token,signed_request,code",domain:location.hostname}),e}}},N={Methods:M,_loadedNodes:{},_defaultCb:{},_resultToken:'"xxRESULTTOKENxx"',genericTransform:function(e){return("dialog"==e.params.display||"iframe"==e.params.display)&&d("Object","assign",!1,e.params,{display:"iframe",channel:N._xdChannelHandler(e.id,"parent.parent")},!0),e},checkOauthDisplay:function(e){var t=e.scope||e.perms||P.getScope();if(!t)return e.display;for(var n=t.split(/\s|,/g),i=0;i<n.length;i++)if(!E.initSitevars.iframePermissions[d(n[i],"trim",!0)])return"popup";return e.display},prepareCall:function(t,n){var i=t.method.toLowerCase(),o=N.Methods.hasOwnProperty(i)?d("Object","assign",!1,{},N.Methods[i]):{},r=k(),a=P.getSecure()||"auth.status"!==i&&"login.status"!=i;d("Object","assign",!1,t,{app_id:P.getClientID(),locale:P.getLocale(),sdk:"joey",access_token:a&&P.getAccessToken()||void 0}),t.display=N.getDisplayMode(o,t),o.url||(o.url="dialog/"+i),"dialog/oauth"!=o.url&&"dialog/permissions.request"!=o.url||!("iframe"==t.display||"touch"==t.display&&t.in_iframe)||(t.display=N.checkOauthDisplay(t)),P.getIsVersioned()&&"dialog/"===o.url.substring(0,7)&&(o.url=t.version+"/"+o.url);var s={cb:n,id:r,size:o.size||N.getDefaultSize(),url:A.resolve("touch"==t.display?"m":"www",a)+"/"+o.url,params:t,name:i,dialog:g.newInstance(r,t.display)},l=o.transform?o.transform:N.genericTransform;if(!l||(s=l(s))){"touch"===t.display&&t.in_iframe&&(s.params.parent_height=e.innerHeight);var c=o.getXdRelation||N.getXdRelation,u=c(s.params);return s.id in N._defaultCb||"next"in s.params||"redirect_uri"in s.params||(s.params.next=N._xdResult(s.cb,s.id,u,!0)),"parent"===u&&d("Object","assign",!1,s.params,{channel_url:N._xdChannelHandler(r,"parent.parent")},!0),s=N.prepareParams(s)}},prepareParams:function(e){e.params.method;"async"!==e.params.display&&delete e.params.method,e.params=b(e.params);var t=C.encode(e.params);return!D.nativeApp()&&N.urlTooLongForIE(e.url+"?"+t)?e.post=!0:t&&(e.url+="?"+t),e},urlTooLongForIE:function(e){return e.length>2e3},getDisplayMode:function(e,t){if("hidden"===t.display||"none"===t.display)return t.display;var n=P.isEnvironment(P.ENVIRONMENTS.CANVAS)||P.isEnvironment(P.ENVIRONMENTS.PAGETAB);return n&&!t.display?"async":D.mobile()||"touch"===t.display?"touch":P.getAccessToken()||"iframe"!=t.display&&"dialog"!=t.display||e.loggedOutIframe?e.connectDisplay&&!n?e.connectDisplay:t.display||(P.getAccessToken()?"dialog":"popup"):(x.error('"dialog" mode can only be used when the user is connected.'),"popup")},getXdRelation:function(t){var n=t.display;return"popup"===n||"touch"===n?"opener":"dialog"===n||"iframe"===n||"hidden"===n||"none"===n?"parent":"async"===n?"parent.frames["+e.name+"]":void 0},popup:function(t){var n="undefined"!=typeof e.screenX?e.screenX:e.screenLeft,i="undefined"!=typeof e.screenY?e.screenY:e.screenTop,r="undefined"!=typeof e.outerWidth?e.outerWidth:o.documentElement.clientWidth,a="undefined"!=typeof e.outerHeight?e.outerHeight:o.documentElement.clientHeight-22,s=D.mobile()?null:t.size.width,l=D.mobile()?null:t.size.height,c=0>n?e.screen.width+n:n,u=parseInt(c+(r-s)/2,10),d=parseInt(i+(a-l)/2.5,10),p=[];null!==s&&p.push("width="+s),null!==l&&p.push("height="+l),p.push("left="+u),p.push("top="+d),p.push("scrollbars=1"),("permissions.request"==t.name||"permissions.oauth"==t.name)&&p.push("location=1,toolbar=0"),p=p.join(",");var f;t.post?(f=e.open("about:blank",t.id,p),f&&(N.setLoadedNode(t,f,"popup"),h.submitToTarget({url:t.url,target:t.id,params:t.params}))):(f=e.open(t.url,t.id,p),f&&N.setLoadedNode(t,f,"popup")),f&&t.id in N._defaultCb&&N._popupMonitor()},setLoadedNode:function(e,t,n){e.params&&"popup"!=e.params.display&&(t.fbCallID=e.id),t={node:t,type:n,fbCallID:e.id},N._loadedNodes[e.id]=t},getLoadedNode:function(e){var t="object"==typeof e?e.id:e,n=N._loadedNodes[t];return n?n.node:null},hidden:function(e){e.className="FB_UI_Hidden",e.root=h.appendHidden(""),N._insertIframe(e)},iframe:function(e){e.className="FB_UI_Dialog";var t=function(){N._triggerDefault(e.id)};e.root=g.create({onClose:t,closeIcon:void 0===e.closeIcon?!0:e.closeIcon,classes:D.ipad()?"centered":""}),e.hideLoader||g.showLoader(t,e.size.width),m.addCss(e.root,"fb_dialog_iframe"),N._insertIframe(e)},touch:function(e){e.params&&e.params.in_iframe?e.ui_created?g.showLoader(function(){N._triggerDefault(e.id)},0):N.iframe(e):D.nativeApp()&&!e.ui_created?(e.frame=e.id,S.onready(function(){N.setLoadedNode(e,S.open(e.url+"#cb="+e.frameName),"native")}),N._popupMonitor()):e.ui_created||N.popup(e)},async:function(e){e.params.redirect_uri=location.protocol+"//"+location.host+location.pathname,delete e.params.access_token,T.remote.showDialog(e.params,function(t){var n=t.result;if(n&&n.e2e){var i=g.get(e.id);i.trackEvents(n.e2e),i.trackEvent("close"),delete n.e2e}e.cb(n)})},getDefaultSize:function(){return g.getDefaultSize()},_insertIframe:function(e){N._loadedNodes[e.id]=!1;var t=function(t){e.id in N._loadedNodes&&N.setLoadedNode(e,t,"iframe")};_(e.post?{url:"about:blank",root:e.root,className:e.className,width:e.size.width,height:e.size.height,id:e.id,onInsert:t,onload:function(t){h.submitToTarget({url:e.url,target:t.name,params:e.params})}}:{url:e.url,root:e.root,className:e.className,width:e.size.width,height:e.size.height,id:e.id,name:e.frameName,onInsert:t})},_handleResizeMessage:function(e,t){var n=N.getLoadedNode(e);n&&(t.height&&(n.style.height=t.height+"px"),t.width&&(n.style.width=t.width+"px"),O.inform("resize.ack",t||{},"parent.frames["+n.name+"]"),g.isActive(n)||g.show(n))},_triggerDefault:function(e){N._xdRecv({frame:e},N._defaultCb[e]||function(){})},_popupMonitor:function(){var e;for(var t in N._loadedNodes)if(N._loadedNodes.hasOwnProperty(t)&&t in N._defaultCb){var n=N._loadedNodes[t];if("popup"!=n.type&&"native"!=n.type)continue;var i=n.node;try{i.closed?N._triggerDefault(t):e=!0}catch(o){}}e&&!N._popupInterval?N._popupInterval=a(N._popupMonitor,100):!e&&N._popupInterval&&(l(N._popupInterval),N._popupInterval=null)},_xdChannelHandler:function(e,t){return O.handler(function(t){var n=N.getLoadedNode(e);if(n)if("resize"==t.type)N._handleResizeMessage(e,t);else if("hide"==t.type)g.hide(n);else if("rendered"==t.type){var i=g._findRoot(n);g.show(i)}else"fireevent"==t.type&&v.fire(t.event)},t,!0,null)},_xdNextHandler:function(e,t,n,i){return i&&(N._defaultCb[t]=e),O.handler(function(t){N._xdRecv(t,e)},n)+"&frame="+t},_xdRecv:function(t,n){var i=N.getLoadedNode(t.frame);if(i)if(i.close)try{i.close(),/iPhone.*Version\/(5|6)/.test(navigator.userAgent)&&"5"!==RegExp.$1&&e.focus(),N._popupCount--}catch(o){}else m.containsCss(i,"FB_UI_Hidden")?r(function(){i.parentNode.parentNode.removeChild(i.parentNode)},3e3):m.containsCss(i,"FB_UI_Dialog")&&g.remove(i);if(delete N._loadedNodes[t.frame],delete N._defaultCb[t.frame],t.e2e){var a=g.get(t.frame);a.trackEvents(t.e2e),a.trackEvent("close"),delete t.e2e}n(t)},_xdResult:function(e,t,n,i){return N._xdNextHandler(function(t){e&&e(t.result&&t.result!=N._resultToken&&d("JSON","parse",!1,t.result))},t,n,i)+"&result="+encodeURIComponent(N._resultToken)},xdHandler:function(e,t,n,i,o){return N._xdNextHandler(p.xdResponseWrapper(e,i,o),t,n,!0)}};T.stub("showDialog"),c.exports=N},null),u("sdk.ui",["Assert","sdk.Impressions","Log","sdk.PlatformVersioning","sdk.Runtime","sdk.UIServer","sdk.feature"],function(e,t,n,i,o,r,a,s,l,c,u,p,h){function f(e,t){if(a.isObject(e),a.maybeFunction(t),u.getIsVersioned()&&(c.assertVersionIsSet(),e.version?c.assertValidVersion(e.version):e.version=u.getVersion()),e=d("Object","assign",!1,{},e),!e.method)return l.error('"method" is a required parameter for FB.ui().'),null;"pay.prompt"==e.method&&(e.method="pay");var n=e.method;e.redirect_uri&&(l.warn("When using FB.ui, you should not specify a redirect_uri."),delete e.redirect_uri),"permissions.request"!=n&&"permissions.oauth"!=n||"iframe"!=e.display&&"dialog"!=e.display||(e.display=p.checkOauthDisplay(e));var i=h("e2e_tracking",!0);i&&(e.e2e={});var o=p.prepareCall(e,t||function(){});if(!o)return null;var r=o.params.display;"dialog"===r?r="iframe":"none"===r&&(r="hidden");var f=p[r];return f?(i&&o.dialog.subscribe("e2e:end",function(e){e.method=n,e.display=r,l.debug("e2e: %s",d("JSON","stringify",!1,e)),s.log(114,{payload:e})}),f(o),o.dialog):(l.error('"display" must be one of "popup", "dialog", "iframe", "touch", "async", "hidden", or "none"'),null)}o.exports=f},null),u("legacy:fb.auth",["sdk.Auth","sdk.Cookie","copyProperties","sdk.Event","FB","Log","sdk.Runtime","sdk.SignedRequest","sdk.ui"],function(e,t,n,i,o,r,a,s,l,c,u,p,h,f,g){u.provide("",{getLoginStatus:function(){return a.getLoginStatus.apply(a,arguments)},getAuthResponse:function(){return a.getAuthResponse()},getAccessToken:function(){return h.getAccessToken()||null},getUserID:function(){return h.getUserID()||h.getCookieUserID()},login:function(e,t){t&&t.perms&&!t.scope&&(t.scope=t.perms,delete t.perms,p.warn("OAuth2 specification states that 'perms' should now be called 'scope'.  Please update."));var n=h.isEnvironment(h.ENVIRONMENTS.CANVAS)||h.isEnvironment(h.ENVIRONMENTS.PAGETAB);g(l({method:"permissions.oauth",display:n?"async":"popup",domain:location.hostname},t||{}),e)},logout:function(e){g({method:"auth.logout",display:"hidden"},e)}}),a.subscribe("logout",d(c.fire,"bind",!0,c,"auth.logout")),a.subscribe("login",d(c.fire,"bind",!0,c,"auth.login")),a.subscribe("authresponse.change",d(c.fire,"bind",!0,c,"auth.authResponseChange")),a.subscribe("status.change",d(c.fire,"bind",!0,c,"auth.statusChange")),c.subscribe("init:post",function(e){if(e.status&&a.getLoginStatus(),h.getClientID())if(e.authResponse)a.setAuthResponse(e.authResponse,"connected");else if(h.getUseCookie()){var t,n=s.loadSignedRequest();if(n){try{t=f.parse(n)}catch(i){s.clearSignedRequestCookie()}t&&t.user_id&&h.setCookieUserID(t.user_id)
}s.loadMeta()}})},3),u("sdk.Canvas.IframeHandling",["DOMWrapper","sdk.RPC"],function(t,n,i,o,r,s,c,u){function d(){var e=c.getWindow().document,t=e.body,n=e.documentElement,i=Math.max(t.offsetTop,0),o=Math.max(n.offsetTop,0),r=t.scrollHeight+i,a=t.offsetHeight+i,s=n.scrollHeight+o,l=n.offsetHeight+o;return Math.max(r,a,s,l)}function p(t){"object"!=typeof t&&(t={});var n=0,i=0;if(t.height||(t.height=d(),n=16,i=4),t.frame||(t.frame=e.name||"iframe_canvas"),f){var o=f.height,r=t.height-o;if(i>=r&&r>=-n)return!1}return f=t,u.remote.setSize(t),!0}function h(e,t){void 0===t&&"number"==typeof e&&(t=e,e=!0),e||void 0===e?(null===g&&(g=a(function(){p()},t||100)),p()):null!==g&&(l(g),g=null)}var f,g=null;u.stub("setSize");var m={setSize:p,setAutoGrow:h};r.exports=m},null),u("sdk.Canvas.Navigation",["sdk.RPC"],function(e,t,n,i,o,r,a){function s(e){a.local.navigate=function(t){e({path:t})},a.remote.setNavigationEnabled(!0)}a.stub("setNavigationEnabled");var l={setUrlHandler:s};o.exports=l},null),u("sdk.Canvas.Plugin",["sdk.api","sdk.RPC","Log","UserAgent_DEPRECATED","sdk.Runtime","createArrayFrom"],function(t,n,i,o,a,s,l,c,u,p,h,f){function g(e){e._hideunity_savedstyle={},e._hideunity_savedstyle.left=e.style.left,e._hideunity_savedstyle.position=e.style.position,e._hideunity_savedstyle.width=e.style.width,e._hideunity_savedstyle.height=e.style.height,e.style.left="-10000px",e.style.position="absolute",e.style.width="1px",e.style.height="1px"}function m(e){e._hideunity_savedstyle&&(e.style.left=e._hideunity_savedstyle.left,e.style.position=e._hideunity_savedstyle.position,e.style.width=e._hideunity_savedstyle.width,e.style.height=e._hideunity_savedstyle.height)}function v(e){e._old_visibility=e.style.visibility,e.style.visibility="hidden"}function b(e){e.style.visibility=e._old_visibility||"",delete e._old_visibility}function y(e){var t=e.type?e.type.toLowerCase():null,n="application/x-shockwave-flash"===t||e.classid&&e.classid.toUpperCase()==S;if(!n)return!1;var i=/opaque|transparent/i;if(i.test(e.getAttribute("wmode")))return!1;for(var o=0;o<e.childNodes.length;o++){var r=e.childNodes[o];if(/param/i.test(r.nodeName)&&/wmode/i.test(r.name)&&i.test(r.value))return!1}return!0}function w(e){var t=e.type?e.type.toLowerCase():null;return"application/vnd.unity"===t||e.classid&&e.classid.toUpperCase()==C}function k(t){var n=f(e.document.getElementsByTagName("object"));n=n.concat(f(e.document.getElementsByTagName("embed")));var i=!1,o=!1;if(d(n,"forEach",!0,function(e){var n=y(e),a=T&&w(e);if(n||a){i=i||n,o=o||a;var s=function(){"opened"===t.state?n?v(e):g(e):n?b(e):m(e)};if(I){u.info("Calling developer specified callback");var l={state:t.state,elem:e};I(l),r(s,200)}else s()}}),Math.random()<=.001){var a={unity:o,flash:i};l(h.getClientID()+"/occludespopups","post",a)}}function _(){v(),g()}function x(){b(),m()}var S="CLSID:D27CDB6E-AE6D-11CF-96B8-444553540000",C="CLSID:444785F1-DE89-4295-863A-D46C3A781394",I=null,T=!(p.osx()>=10.9&&(p.chrome()>=31||p.webkit()>=537.71||p.firefox()>=25));c.local.hidePluginObjects=function(){u.info("hidePluginObjects called"),k({state:"opened"})},c.local.showPluginObjects=function(){u.info("showPluginObjects called"),k({state:"closed"})},c.local.showFlashObjects=c.local.showPluginObjects,c.local.hideFlashObjects=c.local.hidePluginObjects;var P={_setHidePluginCallback:function(e){I=e},hidePluginElement:_,showPluginElement:x};a.exports=P},null),u("sdk.Canvas.Tti",["sdk.RPC","sdk.Runtime"],function(e,t,n,i,o,r,a,s){function l(e,t){var n={appId:s.getClientID(),time:d("Date","now",!1),name:t},i=[n];e&&i.push(function(t){e(t.result)}),a.remote.logTtiMessage.apply(null,i)}function c(){l(null,"StartIframeAppTtiTimer")}function u(e){l(e,"StopIframeAppTtiTimer")}function p(e){l(e,"RecordIframeAppTti")}a.stub("logTtiMessage");var h={setDoneLoading:p,startTimer:c,stopTimer:u};o.exports=h},null),u("legacy:fb.canvas",["Assert","sdk.Canvas.Environment","sdk.Event","FB","sdk.Canvas.IframeHandling","sdk.Canvas.Navigation","sdk.Canvas.Plugin","sdk.RPC","sdk.Runtime","sdk.Canvas.Tti"],function(e,t,n,i,o,r,a,s,l,c,u,p,h,f,g,m){c.provide("Canvas",{setSize:function(e){return a.maybeObject(e,"Invalid argument"),u.setSize.apply(null,arguments)},setAutoGrow:function(){return u.setAutoGrow.apply(null,arguments)},getPageInfo:function(e){return a.isFunction(e,"Invalid argument"),s.getPageInfo.apply(null,arguments)},scrollTo:function(e,t){return a.maybeNumber(e,"Invalid argument"),a.maybeNumber(t,"Invalid argument"),s.scrollTo.apply(null,arguments)},setDoneLoading:function(e){return a.maybeFunction(e,"Invalid argument"),m.setDoneLoading.apply(null,arguments)},startTimer:function(){return m.startTimer.apply(null,arguments)},stopTimer:function(e){return a.maybeFunction(e,"Invalid argument"),m.stopTimer.apply(null,arguments)},getHash:function(e){return a.isFunction(e,"Invalid argument"),p.getHash.apply(null,arguments)},setHash:function(e){return a.isString(e,"Invalid argument"),p.setHash.apply(null,arguments)},setUrlHandler:function(e){return a.isFunction(e,"Invalid argument"),p.setUrlHandler.apply(null,arguments)}}),f.local.fireEvent=d(l.fire,"bind",!0,l),l.subscribe("init:post",function(e){g.isEnvironment(g.ENVIRONMENTS.CANVAS)&&(a.isTrue(!e.hideFlashCallback||!e.hidePluginCallback,"cannot specify deprecated hideFlashCallback and new hidePluginCallback"),h._setHidePluginCallback(e.hidePluginCallback||e.hideFlashCallback))})},3),u("legacy:fb.canvas-legacy",["Assert","FB","Log","sdk.Canvas.Tti"],function(e,t,n,i,o,r,a,s,l,c){s.provide("CanvasInsights",{setDoneLoading:function(e){return l.warn("Deprecated: use FB.Canvas.setDoneLoading"),a.maybeFunction(e,"Invalid argument"),c.setDoneLoading.apply(null,arguments)}})},3),u("sdk.Canvas.Prefetcher",["sdk.api","createArrayFrom","JSSDKCanvasPrefetcherConfig","sdk.Runtime"],function(e,t,n,i,a,s,l,c,u,p){function h(){var e={object:"data",link:"href",script:"src"};w==v.AUTOMATIC&&d(d("Object","keys",!1,e),"forEach",!0,function(t){var n=e[t];d(c(o.getElementsByTagName(t)),"forEach",!0,function(e){e[n]&&k.push(e[n])})}),0!==k.length&&(l(p.getClientID()+"/staticresources","post",{urls:d("JSON","stringify",!1,k),is_https:"https:"===location.protocol}),k=[])}function f(){p.isEnvironment(p.ENVIRONMENTS.CANVAS)&&p.getClientID()&&b&&(Math.random()>1/b||"*"==y||~d(y,"indexOf",!0,p.getClientID())||r(h,3e4))}function g(e){w=e}function m(e){k.push(e)}var v={AUTOMATIC:0,MANUAL:1},b=u.sampleRate,y=u.blacklist,w=v.AUTOMATIC,k=[],_={COLLECT_AUTOMATIC:v.AUTOMATIC,COLLECT_MANUAL:v.MANUAL,addStaticResource:m,setCollectionMode:g,_maybeSample:f};a.exports=_},null),u("legacy:fb.canvas.prefetcher",["FB","sdk.Canvas.Prefetcher","sdk.Event","sdk.Runtime"],function(e,t,n,i,o,r,a,s,l,c){a.provide("Canvas.Prefetcher",s),l.subscribe("init:post",function(){c.isEnvironment(c.ENVIRONMENTS.CANVAS)&&s._maybeSample()})},3),u("legacy:fb.compat.ui",["copyProperties","FB","Log","sdk.ui","sdk.UIServer"],function(e,t,n,i,o,r,a,s,l,c,u){s.provide("",{share:function(e){l.error("share() has been deprecated. Please use FB.ui() instead."),c({display:"popup",method:"stream.share",u:e})},publish:function(e,t){l.error("publish() has been deprecated. Please use FB.ui() instead."),e=e||{},c(a({display:"popup",method:"stream.publish",preview:1},e||{}),t)},addFriend:function(e,t){l.error("addFriend() has been deprecated. Please use FB.ui() instead."),c({display:"popup",id:e,method:"friend.add"},t)}}),u.Methods["auth.login"]=u.Methods["permissions.request"]},3),u("mergeArrays",[],function(e,t,n,i,o){function r(e,t){for(var n=0;n<t.length;n++)d(e,"indexOf",!0,t[n])<0&&e.push(t[n]);return e}o.exports=r},null),u("format",[],function(e,t,n,i,o){function r(e,t){return t=Array.prototype.slice.call(arguments,1),e.replace(/\{(\d+)\}/g,function(e,n){var i=t[Number(n)];return null===i||void 0===i?"":i.toString()})}o.exports=r},null),u("safeEval",[],function(t,n,i,o,r){function a(t,n){return null!==t&&"undefined"!=typeof t?"string"!=typeof t?t:/^\w+$/.test(t)&&"function"==typeof e[t]?e[t].apply(null,n||[]):Function('return eval("'+t.replace(/"/g,'\\"')+'");').apply(null,n||[]):void 0}r.exports=a},null),u("sdk.Waitable",["sdk.Model"],function(e,t,n,i,o,r,a){var s=a.extend({constructor:function(){this.parent({Value:void 0})},error:function(e){this.inform("error",e)},wait:function(e,t){t&&this.subscribe("error",t),this.monitor("Value.change",d(function(){var t=this.getValue();return void 0!==t?(this.value=t,e(t),!0):void 0},"bind",!0,this))}});o.exports=s},null),u("sdk.Query",["format","safeEval","Type","sdk.Waitable"],function(e,t,n,i,o,r,a,s,l,c){function u(e){return d(e.split(","),"map",!0,function(e){return d(e,"trim",!0)})}function p(e){var t,n,i=/^\s*(\w+)\s*=\s*(.*)\s*$/i.exec(e),o="unknown";return i&&(n=i[2],/^(["'])(?:\\?.)*?\1$/.test(n)?(n=s(n),o="index"):/^\d+\.?\d*$/.test(n)&&(o="index")),t="index"==o?{type:"index",key:i[1],value:n}:{type:"unknown",value:e}}function h(e){return"string"==typeof e?d("JSON","stringify",!1,e):e}var f=1,g=c.extend({constructor:function(){this.parent(),this.name="v_"+f++},hasDependency:function(e){return arguments.length&&(this._hasDependency=e),!!this._hasDependency},parse:function(e){var t=a.apply(null,e),n=/^select (.*?) from (\w+)\s+where (.*)$/i.exec(t);this.fields=u(n[1]),this.table=n[2],this.where=p(n[3]);for(var i=1;i<e.length;i++)l.instanceOf(g,e[i])&&e[i].hasDependency(!0);return this},toFql:function(){var e="select "+this.fields.join(",")+" from "+this.table+" where ";switch(this.where.type){case"unknown":e+=this.where.value;break;case"index":e+=this.where.key+"="+h(this.where.value);break;case"in":e+=1==this.where.value.length?this.where.key+"="+h(this.where.value[0]):this.where.key+" in ("+d(this.where.value,"map",!0,h).join(",")+")"}return e},toString:function(){return"#"+this.name}});o.exports=g},null),u("sdk.Data",["sdk.api","sdk.ErrorHandling","mergeArrays","sdk.Query","safeEval","sdk.Waitable"],function(e,t,n,i,o,a,s,l,c,u,p,h){var f={query:function(){var e=(new u).parse(Array.prototype.slice.call(arguments));return f.queue.push(e),f._waitToProcess(),e},waitOn:function(e,t){var n=new h,i=e.length;if("string"==typeof t){var o=t;t=l.unguard(function(){return p(o)})}return d(e,"forEach",!0,function(o){o.monitor("Value.change",function(){var r=!1;if(void 0!==f._getValue(o)&&(o.value=o.getValue(),i--,r=!0),0===i){var a=t(d(e,"map",!0,f._getValue));n.setValue(void 0!==a?a:!0)}return r})}),n},process:function(e){f._process(e)},_getValue:function(e){return e instanceof h?e.getValue():e},_selectByIndex:function(e,t,n,i){var o=new u;return o.fields=e,o.table=t,o.where={type:"index",key:n,value:i},f.queue.push(o),f._waitToProcess(),o},_waitToProcess:function(){f.timer<0&&(f.timer=r(function(){f._process()},10))},_process:function(e){f.timer=-1;var t={},n=f.queue;if(n.length){f.queue=[];for(var i=0;i<n.length;i++){var o=n[i];"index"!=o.where.type||o.hasDependency()?t[o.name]=o:f._mergeIndexQuery(o,t)}var r={q:{}};for(var a in t)t.hasOwnProperty(a)&&(r.q[a]=t[a].toFql());e&&(r.access_token=e),s("/fql","GET",r,function(e){e.error?d(d("Object","keys",!1,t),"forEach",!0,function(n){t[n].error(new Error(e.error.message))}):d(e.data,"forEach",!0,function(e){t[e.name].setValue(e.fql_result_set)})})}},_mergeIndexQuery:function(e,t){var n=e.where.key,i=e.where.value,o="index_"+e.table+"_"+n,r=t[o];r||(r=t[o]=new u,r.fields=[n],r.table=e.table,r.where={type:"in",key:n,value:[]}),c(r.fields,e.fields),c(r.where.value,[i]),r.wait(function(t){e.setValue(d(t,"filter",!0,function(e){return e[n]==i}))})},timer:-1,queue:[]};o.exports=f},null),u("legacy:fb.data",["FB","sdk.Data"],function(e,t,n,i,o,r,a,s){a.provide("Data",s)},3),u("legacy:fb.event",["FB","sdk.Event","sdk.Runtime","sdk.Scribe","sdk.feature"],function(e,t,n,i,o,a,s,l,c,u,p){var h=[],f=null,g=p("event_subscriptions_log",!1);s.provide("Event",{subscribe:function(e,t){return g&&(h.push(e),f||(f=r(function(){u.log("jssdk_error",{appId:c.getClientID(),error:"EVENT_SUBSCRIPTIONS_LOG",extra:{line:0,name:"EVENT_SUBSCRIPTIONS_LOG",script:"N/A",stack:"N/A",message:h.sort().join(",")}}),h.length=0,f=null},g))),l.subscribe(e,t)},unsubscribe:d(l.unsubscribe,"bind",!0,l)})},3),u("legacy:fb.event-legacy",["FB","sdk.Event"],function(e,t,n,i,o,r,a,s){a.provide("Event",{clear:d(s.clear,"bind",!0,s),fire:d(s.fire,"bind",!0,s),monitor:d(s.monitor,"bind",!0,s)}),a.provide("EventProvider",s)},3),u("legacy:fb.frictionless",["FB","sdk.Frictionless"],function(e,t,n,i,o,r,a,s){a.provide("Frictionless",s)},3),u("sdk.init",["sdk.Cookie","sdk.ErrorHandling","sdk.Event","Log","ManagedError","sdk.PlatformVersioning","QueryString","sdk.Runtime","sdk.URI","createArrayFrom"],function(t,n,i,a,s,l,c,u,p,h,f,g,m,v,b,y){function w(e){var t="number"==typeof e&&e>0||"string"==typeof e&&/^[0-9a-f]{21,}$|^[0-9]{1,21}$/.test(e);return t?e.toString():(h.warn("Invalid App Id: Must be a number or numeric string representing the application id."),null)}function k(e){if(v.getInitialized()&&h.warn("FB.init has already been called - this could indicate a problem"),v.getIsVersioned()){if("[object Object]"!==Object.prototype.toString.call(e))throw new f("Invalid argument");e.authResponse&&h.warn("Setting authResponse is not supported"),e.version||(e.version=b(location.href).getQueryData().sdk_version),g.assertValidVersion(e.version),v.setVersion(e.version)}else/number|string/.test(typeof e)&&(h.warn("FB.init called with invalid parameters"),e={apiKey:e}),e=d("Object","assign",!1,{status:!0},e||{});var t=w(e.appId||e.apiKey);null!==t&&v.setClientID(t),"scope"in e&&v.setScope(e.scope),e.cookie&&(v.setUseCookie(!0),"string"==typeof e.cookie&&c.setDomain(e.cookie)),e.kidDirectedSite&&v.setKidDirectedSite(!0),v.setInitialized(!0),p.fire("init:post",e)}r(function(){var t=/(connect\.facebook\.net|\.facebook\.com\/assets.php).*?#(.*)/;d(y(o.getElementsByTagName("script")),"forEach",!0,function(e){if(e.src){var n=t.exec(e.src);if(n){var i=m.decode(n[2]);for(var o in i)if(i.hasOwnProperty(o)){var r=i[o];"0"==r&&(i[o]=0)}k(i)}}}),e.fbAsyncInit&&!e.fbAsyncInit.hasRun&&(e.fbAsyncInit.hasRun=!0,u.unguard(e.fbAsyncInit)())},0),s.exports=k},null),u("legacy:fb.init",["FB","sdk.init"],function(e,t,n,i,o,r,a,s){a.provide("",{init:s})},3),u("legacy:fb.json",["FB","ManagedError"],function(e,t,n,i,o,r,a,s){a.provide("JSON",{stringify:function(e){try{return d("JSON","stringify",!1,e)}catch(t){throw new s(t.message,t)}},parse:function(e){try{return d("JSON","parse",!1,e)}catch(t){throw new s(t.message,t)}}})},3),u("legacy:fb.pay",["copyProperties","sdk.Runtime","sdk.UIServer","sdk.XD","sdk.feature","FB"],function(t,n,i,o,r,a,s,l,c,u,p){n("FB");var h={error_code:1383001,error_message:"An unknown error caused the dialog to be closed"},f=function(e){return function(t){e(t&&"string"==typeof t.response?d("JSON","parse",!1,t.response):"object"==typeof t?t:h)}};s(c.Methods,{pay:{size:{width:555,height:120},connectDisplay:"popup",transform:function(t){if(p("launch_payment_dialog_via_pac"))return t.cb=f(t.cb),t;if(t.cb=f(t.cb),!l.isEnvironment(l.ENVIRONMENTS.CANVAS))return t.params.order_info=d("JSON","stringify",!1,t.params.order_info),t;var n=u.handler(t.cb,"parent.frames["+(e.name||"iframe_canvas")+"]");t.params.channel=n,t.params.uiserver=!0,u.inform("Pay.Prompt",t.params)}}})},3),u("legacy:fb.ua",["FB","UserAgent_DEPRECATED"],function(e,t,n,i,o,r,a,s){a.provide("UA",{nativeApp:s.nativeApp})},3),u("legacy:fb.ui",["FB","sdk.ui"],function(e,t,n,i,o,r,a,s){a.provide("",{ui:s})},3),u("runOnce",[],function(e,t,n,i,o){function r(e){var t,n;return function(){return t||(t=!0,n=e()),n}}o.exports=r},null),u("XFBML",["Assert","createArrayFrom","sdk.DOM","sdk.feature","sdk.Impressions","Log","ObservableMixin","runOnce","UserAgent_DEPRECATED"],function(e,t,n,i,a,s,l,c,u,p,h,f,g,m,v){function b(e,t){return e[t]+""}function y(e){return e.scopeName?e.scopeName+":"+e.nodeName:""}function w(e){return C[b(e,"nodeName").toLowerCase()]||C[y(e).toLowerCase()]}function k(e){var t=d(d(b(e,"className"),"trim",!0).split(/\s+/),"filter",!0,function(e){return I.hasOwnProperty(e)});return 0===t.length?void 0:e.getAttribute("fb-xfbml-state")||!e.childNodes||0===e.childNodes.length||1===e.childNodes.length&&3===e.childNodes[0].nodeType||1===e.children.length&&"fb-xfbml-parse-ignore"===b(e.children[0],"className")?I[t[0]]:void 0}function _(e){var t={};return d(c(e.attributes),"forEach",!0,function(e){t[b(e,"name")]=b(e,"value")}),t}function x(e,t,n){var i=o.createElement("div");return u.addCss(e,t+"-"+n),d(c(e.childNodes),"forEach",!0,function(e){i.appendChild(e)}),d(c(e.attributes),"forEach",!0,function(e){i.setAttribute(e.name,e.value)}),e.parentNode.replaceChild(i,e),i}function S(e,t,n){l.isTrue(e&&e.nodeType&&1===e.nodeType&&!!e.getElementsByTagName,"Invalid DOM node passed to FB.XFBML.parse()"),l.isFunction(t,"Invalid callback passed to FB.XFBML.parse()");var i=++T;f.info("XFBML Parsing Start %s",i);var o=1,a=0,s=function(){o--,0===o&&(f.info("XFBML Parsing Finish %s, %s tags found",i,a),t(),P.inform("render",i,a)),l.isTrue(o>=0,"onrender() has been called too many times")};d(c(e.getElementsByTagName("*")),"forEach",!0,function(e){if((n||!e.getAttribute("fb-xfbml-state"))&&1===e.nodeType){var t=w(e)||k(e);if(t){v.ie()<9&&e.scopeName&&(e=x(e,t.xmlns,t.localName)),o++,a++;var i=new t.ctor(e,t.xmlns,t.localName,_(e));i.subscribe("render",m(function(){e.setAttribute("fb-xfbml-state","rendered"),s()}));var r=function(){"parsed"==e.getAttribute("fb-xfbml-state")?P.subscribe("render.queue",r):(e.setAttribute("fb-xfbml-state","parsed"),i.process())};r()}}}),P.inform("parse",i,a);var u=3e4;r(function(){o>0&&f.warn("%s tags failed to render in %s ms",o,u)},u),s()}var C={},I={},T=0,P=new g;if(P.subscribe("render",function(){var e=P.getSubscribers("render.queue");P.clearSubscribers("render.queue"),d(e,"forEach",!0,function(e){e()})}),d("Object","assign",!1,P,{registerTag:function(e){var t=e.xmlns+":"+e.localName;l.isUndefined(C[t],t+" already registered"),C[t]=e,I[e.xmlns+"-"+e.localName]=e},parse:function(e,t){S(e||o.body,t||function(){},!0)},parseNew:function(){S(o.body,function(){},!1)}}),p("log_tag_count")){var E=function(e,t){P.unsubscribe("parse",E),r(d(h.log,"bind",!0,null,102,{tag_count:t}),5e3)};P.subscribe("parse",E)}a.exports=P},null),u("PluginPipe",["sdk.Content","sdk.feature","guid","insertIframe","Miny","ObservableMixin","JSSDKPluginPipeConfig","sdk.Runtime","UrlMap","UserAgent_DEPRECATED","XFBML"],function(e,t,n,i,r,a,s,l,c,u,p,h,f,g,m,v,b){function y(){return!(!l("plugin_pipe")||void 0===g.getSecure()||!v.chrome()&&!v.firefox()||!f.enabledApps[g.getClientID()])}function w(){function e(){n--,0===n&&k(t)}var t=S;if(S=[],t.length<=x)return void d(t,"forEach",!0,function(e){u(e.config)});var n=t.length+1;d(t,"forEach",!0,function(t){var n={};for(var i in t.config)n[i]=t.config[i];n.url=m.resolve("www",g.getSecure())+"/plugins/plugin_pipe_shell.php",n.onload=e,u(n)}),e()}function k(e){var t=o.createElement("span");s.appendHidden(t);var n={};d(e,"forEach",!0,function(e){n[e.config.name]={plugin:e.tag,params:e.params}});var i=d("JSON","stringify",!1,n),r=p.encode(i);d(e,"forEach",!0,function(e){var t=o.getElementsByName(e.config.name)[0];t.onload=e.config.onload});var a=m.resolve("www",g.getSecure())+"/plugins/pipe.php",l=c();u({url:"about:blank",root:t,name:l,className:"fb_hidden fb_invisible",onload:function(){s.submitToTarget({url:a,target:l,params:{plugins:r.length<i.length?r:i}})}})}var _=new h,x=f.threshold,S=[];b.subscribe("parse",w),d("Object","assign",!1,_,{add:function(e){var t=y();return t&&S.push({config:e._config,tag:e._tag,params:e._params}),t}}),r.exports=_},null),u("IframePlugin",["sdk.Auth","sdk.DOM","sdk.Event","Log","ObservableMixin","sdk.PlatformVersioning","PluginPipe","QueryString","sdk.Runtime","Type","sdk.URI","UrlMap","UserAgent_DEPRECATED","sdk.XD","sdk.createIframe","guid","resolveURI"],function(t,n,i,a,l,c,u,p,h,f,g,m,v,b,y,w,k,_,x,S,C,I,T){function P(e,t,n){(t||0===t)&&(e.style.width=t+"px"),(n||0===n)&&(e.style.height=n+"px")}function E(e){return function(t){var n={width:t.width,height:t.height,pluginID:e};h.fire("xfbml.resize",n)}}function A(e,t){var n=e[t]||e[t.replace(/_/g,"-")]||e[t.replace(/_/g,"")]||e["data-"+t]||e["data-"+t.replace(/_/g,"-")]||e["data-"+t.replace(/_/g,"")]||void 0;return n}function D(e,t,n,i){d(d("Object","keys",!1,e),"forEach",!0,function(o){"text"!=e[o]||n[o]||(n[o]=t.textContent||t.innerText||"",t.setAttribute(o,n[o])),i[o]=N[e[o]](A(n,o))})}function O(e){return e||"0"===e||0===e?parseInt(e,10):void 0}function R(e){e&&P(e,0,0)}var M={skin:"string",font:"string",width:"px",height:"px",ref:"string",color_scheme:"string"},N={string:function(e){return e},bool:function(e){return e?/^(?:true|1|yes|on)$/i.test(e):void 0},url:function(e){return T(e)},url_maybe:function(e){return e?T(e):e},hostname:function(t){return t||e.location.hostname},px:function(e){return/^(\d+)(?:px)?$/.test(e)?parseInt(RegExp.$1,10):void 0},text:function(e){return e}},$=w.extend({constructor:function(t,n,i,r){this.parent(),i=i.replace(/-/g,"_");var a=A(r,"plugin_id");this.subscribe("xd.resize",E(a)),this.subscribe("xd.resize.flow",E(a)),this.subscribe("xd.resize.flow",d(function(e){d("Object","assign",!1,this._config.root.style,{verticalAlign:"bottom",overflow:""}),P(this._config.root,O(e.width),O(e.height)),this.updateLift(),s(this._timeoutID)},"bind",!0,this)),this.subscribe("xd.resize",d(function(e){d("Object","assign",!1,this._config.root.style,{verticalAlign:"bottom",overflow:""}),P(this._config.root,O(e.width),O(e.height)),P(this._iframe,O(e.width),O(e.height)),this._isIframeResized=!0,this.updateLift(),s(this._timeoutID)},"bind",!0,this)),this.subscribe("xd.resize.iframe",d(function(e){P(this._iframe,O(e.width),O(e.height)),this._isIframeResized=!0,this.updateLift(),s(this._timeoutID)},"bind",!0,this)),this.subscribe("xd.sdk_event",function(e){var n=d("JSON","parse",!1,e.data);n.pluginID=a,h.fire(e.event,n,t)});var l=y.getSecure()||"https:"==e.location.protocol,c=_.resolve("www",l)+"/plugins/"+i+".php?",f={};D(this.getParams(),t,r,f),D(M,t,r,f),d("Object","assign",!1,f,{app_id:y.getClientID(),locale:y.getLocale(),sdk:"joey",kid_directed_site:y.getKidDirectedSite(),channel:S.handler(d(function(e){return this.inform("xd."+e.type,e)},"bind",!0,this),"parent.parent",!0)}),p.addCss(t,"fb_iframe_widget");var g=I();this.subscribe("xd.verify",function(e){S.sendToFacebook(g,{method:"xd/verify",params:d("JSON","stringify",!1,e.token)})}),this.subscribe("xd.refreshLoginStatus",d(u.getLoginStatus,"bind",!0,u,d(this.inform,"bind",!0,this,"login.status"),!0));var m=o.createElement("span");d("Object","assign",!1,m.style,{verticalAlign:"top",width:"0px",height:"0px",overflow:"hidden"}),this._element=t,this._ns=n,this._tag=i,this._params=f,this._config={root:m,url:c+b.encode(f),name:g,width:x.mobile()?void 0:f.width||1e3,height:f.height||1e3,style:{border:"none",visibility:"hidden"},title:this._ns+":"+this._tag+" Facebook Social Plugin",onload:d(function(){return this.inform("render")},"bind",!0,this),onerror:d(function(){return R(this._iframe)},"bind",!0,this)}},process:function(){if(y.getIsVersioned()){m.assertVersionIsSet();var e=k(this._config.url);this._config.url=e.setPath("/"+y.getVersion()+e.getPath()).toString()}var t=d("Object","assign",!1,{},this._params);delete t.channel;var n=b.encode(t);if(this._element.getAttribute("fb-iframe-plugin-query")==n)return f.info("Skipping render: %s:%s %s",this._ns,this._tag,n),void this.inform("render");for(this._element.setAttribute("fb-iframe-plugin-query",n),this.subscribe("render",d(function(){this._iframe.style.visibility="visible",this._isIframeResized||R(this._iframe)},"bind",!0,this));this._element.firstChild;)this._element.removeChild(this._element.firstChild);this._element.appendChild(this._config.root);var i=x.mobile()?120:45;this._timeoutID=r(d(function(){R(this._iframe),f.warn("%s:%s failed to resize in %ss",this._ns,this._tag,i)},"bind",!0,this),1e3*i),v.add(this)||(this._iframe=C(this._config)),x.mobile()&&(p.addCss(this._element,"fb_iframe_widget_fluid"),d("Object","assign",!1,this._element.style,{display:"block",width:"100%",height:"auto"}),d("Object","assign",!1,this._config.root.style,{width:"100%",height:"auto"}),d("Object","assign",!1,this._iframe.style,{width:"100%",height:"auto",position:"static"}))},updateLift:function(){var e=this._iframe.style.width===this._config.root.style.width&&this._iframe.style.height===this._config.root.style.height;p[e?"removeCss":"addCss"](this._iframe,"fb_iframe_widget_lift")}},g);$.getVal=A,$.withParams=function(e){return $.extend({getParams:function(){return e}})},l.exports=$},null),u("PluginTags",[],function(e,t,n,i,o){var r={activity:{filter:"string",action:"string",max_age:"string",linktarget:"string",header:"bool",recommendations:"bool",site:"hostname"},composer:{action_type:"string",action_properties:"string"},create_event_button:{},degrees:{href:"url"},facepile:{href:"string",action:"string",size:"string",max_rows:"string",show_count:"bool"},follow:{href:"url",layout:"string",show_faces:"bool"},like:{href:"url",layout:"string",show_faces:"bool",share:"bool",action:"string",send:"bool"},like_box:{href:"string",show_faces:"bool",header:"bool",stream:"bool",force_wall:"bool",show_border:"bool",id:"string",connections:"string",profile_id:"string",name:"string"},open_graph:{href:"url",layout:"string",show_faces:"bool",action_type:"string",action_properties:"string"},open_graph_preview:{action_type:"string",action_properties:"string"},page_events:{href:"url"},post:{href:"url",show_border:"bool"},privacy_selector:{},profile_pic:{uid:"string",linked:"bool",href:"string",size:"string",facebook_logo:"bool"},recommendations:{filter:"string",action:"string",max_age:"string",linktarget:"string",header:"bool",site:"hostname"},share_button:{href:"url",layout:"string",type:"string"},shared_activity:{header:"bool"},send:{href:"url"},send_to_mobile:{max_rows:"string",show_faces:"bool",size:"string"},story:{href:"url",show_border:"bool"},topic:{topic_name:"string",topic_id:"string"},want:{href:"url",layout:"string",show_faces:"bool"}},a={subscribe:"follow",fan:"like_box",likebox:"like_box",friendpile:"facepile"};d(d("Object","keys",!1,a),"forEach",!0,function(e){r[e]=r[a[e]]}),o.exports=r},null),u("sdk.Arbiter",[],function(e,t,n,i,o){var r={BEHAVIOR_EVENT:"e",BEHAVIOR_PERSISTENT:"p",BEHAVIOR_STATE:"s"};o.exports=r},null),u("sdk.XFBML.Element",["sdk.DOM","Type","ObservableMixin"],function(e,t,n,i,r,a,s,l,c){var u=l.extend({constructor:function(e){this.parent(),this.dom=e},fire:function(){this.inform.apply(this,arguments)},getAttribute:function(e,t,n){var i=s.getAttr(this.dom,e);return i?n?n(i):i:t},_getBoolAttribute:function(e,t){var n=s.getBoolAttr(this.dom,e);return null===n?t:n},_getPxAttribute:function(e,t){return this.getAttribute(e,t,function(e){var n=parseInt(e,10);return isNaN(n)?t:n})},_getLengthAttribute:function(e,t){return this.getAttribute(e,t,function(e){if("100%"===e)return e;var n=parseInt(e,10);return isNaN(n)?t:n})},_getAttributeFromList:function(e,t,n){return this.getAttribute(e,t,function(e){return e=e.toLowerCase(),d(n,"indexOf",!0,e)>-1?e:t})},isValid:function(){for(var e=this.dom;e;e=e.parentNode)if(e==o.body)return!0},clear:function(){s.html(this.dom,"")}},c);r.exports=u},null),u("sdk.XFBML.IframeWidget",["sdk.Arbiter","sdk.Auth","sdk.Content","sdk.DOM","sdk.Event","sdk.XFBML.Element","guid","insertIframe","QueryString","sdk.Runtime","sdk.ui","UrlMap","sdk.XD"],function(e,t,n,i,r,a,s,l,c,u,p,h,f,g,m,v,b,y,w){var k=h.extend({_iframeName:null,_showLoader:!0,_refreshOnAuthChange:!1,_allowReProcess:!1,_fetchPreCachedLoader:!1,_visibleAfter:"load",_widgetPipeEnabled:!1,_borderReset:!1,_repositioned:!1,getUrlBits:function(){throw new Error("Inheriting class needs to implement getUrlBits().")},setupAndValidate:function(){return!0},oneTimeSetup:function(){},getSize:function(){},getIframeName:function(){return this._iframeName},getIframeTitle:function(){return"Facebook Social Plugin"},getChannelUrl:function(){if(!this._channelUrl){var e=this;this._channelUrl=w.handler(function(t){e.fire("xd."+t.type,t)},"parent.parent",!0)}return this._channelUrl},getIframeNode:function(){return this.dom.getElementsByTagName("iframe")[0]},arbiterInform:function(e,t,n){w.sendToFacebook(this.getIframeName(),{method:e,params:d("JSON","stringify",!1,t||{}),behavior:n||s.BEHAVIOR_PERSISTENT})},_arbiterInform:function(e,t,n){var i='parent.frames["'+this.getIframeNode().name+'"]';w.inform(e,t,i,n)},getDefaultWebDomain:function(){return y.resolve("www")},process:function(e){if(this._done){if(!this._allowReProcess&&!e)return;this.clear()}else this._oneTimeSetup();if(this._done=!0,this._iframeName=this.getIframeName()||this._iframeName||f(),!this.setupAndValidate())return void this.fire("render");this._showLoader&&this._addLoader(),u.addCss(this.dom,"fb_iframe_widget"),"immediate"!=this._visibleAfter?u.addCss(this.dom,"fb_hide_iframes"):this.subscribe("iframe.onload",d(this.fire,"bind",!0,this,"render"));var t=this.getSize()||{},n=this.getFullyQualifiedURL();"100%"==t.width&&u.addCss(this.dom,"fb_iframe_widget_fluid"),this.clear(),g({url:n,root:this.dom.appendChild(o.createElement("span")),name:this._iframeName,title:this.getIframeTitle(),className:v.getRtl()?"fb_rtl":"fb_ltr",height:t.height,width:t.width,onload:d(this.fire,"bind",!0,this,"iframe.onload")}),this._resizeFlow(t),this.loaded=!1,this.subscribe("iframe.onload",d(function(){this.loaded=!0,this._isResizeHandled||u.addCss(this.dom,"fb_hide_iframes")},"bind",!0,this))},generateWidgetPipeIframeName:function(){return _++,"fb_iframe_"+_},getFullyQualifiedURL:function(){var e=this._getURL();if(e+="?"+m.encode(this._getQS()),e.length>2e3){e="about:blank";var t=d(function(){this._postRequest(),this.unsubscribe("iframe.onload",t)},"bind",!0,this);this.subscribe("iframe.onload",t)}return e},_getWidgetPipeShell:function(){return y.resolve("www")+"/common/widget_pipe_shell.php"},_oneTimeSetup:function(){this.subscribe("xd.resize",d(this._handleResizeMsg,"bind",!0,this)),this.subscribe("xd.resize",d(this._bubbleResizeEvent,"bind",!0,this)),this.subscribe("xd.resize.iframe",d(this._resizeIframe,"bind",!0,this)),this.subscribe("xd.resize.flow",d(this._resizeFlow,"bind",!0,this)),this.subscribe("xd.resize.flow",d(this._bubbleResizeEvent,"bind",!0,this)),this.subscribe("xd.refreshLoginStatus",function(){l.getLoginStatus(function(){},!0)}),this.subscribe("xd.logout",function(){b({method:"auth.logout",display:"hidden"},function(){})}),this._refreshOnAuthChange&&this._setupAuthRefresh(),"load"==this._visibleAfter&&this.subscribe("iframe.onload",d(this._makeVisible,"bind",!0,this)),this.subscribe("xd.verify",d(function(e){this.arbiterInform("xd/verify",e.token)},"bind",!0,this)),this.oneTimeSetup()},_makeVisible:function(){this._removeLoader(),u.removeCss(this.dom,"fb_hide_iframes"),this.fire("render")},_setupAuthRefresh:function(){l.getLoginStatus(d(function(e){var t=e.status;p.subscribe("auth.statusChange",d(function(e){this.isValid()&&(("unknown"==t||"unknown"==e.status)&&this.process(!0),t=e.status)},"bind",!0,this))},"bind",!0,this))},_handleResizeMsg:function(e){this.isValid()&&(this._resizeIframe(e),this._resizeFlow(e),this._borderReset||(this.getIframeNode().style.border="none",this._borderReset=!0),this._isResizeHandled=!0,this._makeVisible())},_bubbleResizeEvent:function(e){var t={height:e.height,width:e.width,pluginID:this.getAttribute("plugin-id")};p.fire("xfbml.resize",t)},_resizeIframe:function(e){var t=this.getIframeNode();"true"===e.reposition&&this._repositionIframe(e),e.height&&(t.style.height=e.height+"px"),e.width&&(t.style.width=e.width+"px"),this._updateIframeZIndex()},_resizeFlow:function(e){var t=this.dom.getElementsByTagName("span")[0];e.height&&(t.style.height=e.height+"px"),e.width&&(t.style.width=e.width+"px"),this._updateIframeZIndex()},_updateIframeZIndex:function(){var e=this.dom.getElementsByTagName("span")[0],t=this.getIframeNode(),n=t.style.height===e.style.height&&t.style.width===e.style.width,i=n?"removeCss":"addCss";
u[i](t,"fb_iframe_widget_lift")},_repositionIframe:function(e){var t=this.getIframeNode(),n=parseInt(u.getStyle(t,"width"),10),i=u.getPosition(t).x,o=u.getViewportInfo().width,r=parseInt(e.width,10);i+r>o&&i>r?(t.style.left=n-r+"px",this.arbiterInform("xd/reposition",{type:"horizontal"}),this._repositioned=!0):this._repositioned&&(t.style.left="0px",this.arbiterInform("xd/reposition",{type:"restore"}),this._repositioned=!1)},_addLoader:function(){this._loaderDiv||(u.addCss(this.dom,"fb_iframe_widget_loader"),this._loaderDiv=o.createElement("div"),this._loaderDiv.className="FB_Loader",this.dom.appendChild(this._loaderDiv))},_removeLoader:function(){this._loaderDiv&&(u.removeCss(this.dom,"fb_iframe_widget_loader"),this._loaderDiv.parentNode&&this._loaderDiv.parentNode.removeChild(this._loaderDiv),this._loaderDiv=null)},_getQS:function(){return d("Object","assign",!1,{api_key:v.getClientID(),locale:v.getLocale(),sdk:"joey",kid_directed_site:v.getKidDirectedSite(),ref:this.getAttribute("ref")},this.getUrlBits().params)},_getURL:function(){var e=this.getDefaultWebDomain(),t="";return e+"/plugins/"+t+this.getUrlBits().name+".php"},_postRequest:function(){c.submitToTarget({url:this._getURL(),target:this.getIframeNode().name,params:this._getQS()})}}),_=0;r.exports=k},null),u("sdk.XFBML.Comments",["sdk.Event","sdk.XFBML.IframeWidget","QueryString","sdk.Runtime","JSSDKConfig","UrlMap","UserAgent_DEPRECATED"],function(t,n,i,r,a,s,l,c,u,p,h,f,g){var m=c.extend({_visibleAfter:"immediate",_refreshOnAuthChange:!0,setupAndValidate:function(){var t={channel_url:this.getChannelUrl(),colorscheme:this.getAttribute("colorscheme"),skin:this.getAttribute("skin"),numposts:this.getAttribute("num-posts",10),width:this._getLengthAttribute("width"),href:this.getAttribute("href"),permalink:this.getAttribute("permalink"),publish_feed:this.getAttribute("publish_feed"),order_by:this.getAttribute("order_by"),mobile:this._getBoolAttribute("mobile")};if(t.width||t.permalink||(t.width=550),h.initSitevars.enableMobileComments&&g.mobile()&&t.mobile!==!1&&(t.mobile=!0,delete t.width),t.skin||(t.skin=t.colorscheme),t.href){var n=this.getAttribute("fb_comment_id");n||(n=u.decode(o.URL.substring(d(o.URL,"indexOf",!0,"?")+1)).fb_comment_id,n&&d(n,"indexOf",!0,"#")>0&&(n=n.substring(0,d(n,"indexOf",!0,"#")))),n&&(t.fb_comment_id=n,this.subscribe("render",d(function(){e.location.hash||(e.location.hash=this.getIframeNode().id)},"bind",!0,this)))}else{if(t.migrated=this.getAttribute("migrated"),t.xid=this.getAttribute("xid"),t.title=this.getAttribute("title",o.title),t.url=this.getAttribute("url",o.URL),t.quiet=this.getAttribute("quiet"),t.reverse=this.getAttribute("reverse"),t.simple=this.getAttribute("simple"),t.css=this.getAttribute("css"),t.notify=this.getAttribute("notify"),!t.xid){var i=d(o.URL,"indexOf",!0,"#");t.xid=encodeURIComponent(i>0?o.URL.substring(0,i):o.URL)}t.migrated&&(t.href=f.resolve("www")+"/plugins/comments_v1.php?app_id="+p.getClientID()+"&xid="+encodeURIComponent(t.xid)+"&url="+encodeURIComponent(t.url))}return this._attr=t,!0},oneTimeSetup:function(){this.subscribe("xd.addComment",d(this._handleCommentMsg,"bind",!0,this)),this.subscribe("xd.commentCreated",d(this._handleCommentCreatedMsg,"bind",!0,this)),this.subscribe("xd.commentRemoved",d(this._handleCommentRemovedMsg,"bind",!0,this))},getSize:function(){return this._attr.permalink?void 0:{width:this._attr.mobile?"100%":this._attr.width,height:100}},getUrlBits:function(){return{name:"comments",params:this._attr}},getDefaultWebDomain:function(){return f.resolve(this._attr.mobile?"m":"www",!0)},_handleCommentMsg:function(e){this.isValid()&&l.fire("comments.add",{post:e.post,user:e.user,widget:this})},_handleCommentCreatedMsg:function(e){if(this.isValid()){var t={href:e.href,commentID:e.commentID,parentCommentID:e.parentCommentID,message:e.message};l.fire("comment.create",t)}},_handleCommentRemovedMsg:function(e){if(this.isValid()){var t={href:e.href,commentID:e.commentID};l.fire("comment.remove",t)}}});a.exports=m},null),u("sdk.XFBML.CommentsCount",["ApiClient","sdk.DOM","sdk.XFBML.Element","sprintf"],function(t,n,i,o,r,a,s,l,c,u){var p=c.extend({process:function(){l.addCss(this.dom,"fb_comments_count_zero");var t=this.getAttribute("href",e.location.href);s.scheduleBatchCall("/v2.1/"+encodeURIComponent(t),{fields:"share"},d(function(e){var t=e.share&&e.share.comment_count||0;l.html(this.dom,u('<span class="fb_comments_count">%s</span>',t)),t>0&&l.removeCss(this.dom,"fb_comments_count_zero"),this.fire("render")},"bind",!0,this))}});r.exports=p},null),u("sdk.Helper",["sdk.ErrorHandling","sdk.Event","UrlMap","safeEval","sprintf"],function(t,n,i,o,r,a,s,l,c,u,d){var p={isUser:function(e){return 22e8>e||e>=1e14&&0x5b0a58f100ef>=e||e>=89e12&&89999999999999>=e},upperCaseFirstChar:function(e){return e.length>0?e.substr(0,1).toUpperCase()+e.substr(1):e},getProfileLink:function(e,t,n){return!n&&e&&(n=d("%s/profile.php?id=%s",c.resolve("www"),e.uid||e.id)),n&&(t=d('<a class="fb_link" href="%s">%s</a>',n,t)),t},invokeHandler:function(e,t,n){e&&("string"==typeof e?s.unguard(u)(e,n):e.apply&&s.unguard(e).apply(t,n||[]))},fireEvent:function(e,t){var n=t._attr.href;t.fire(e,n),l.fire(e,n,t)},executeFunctionByName:function(t){for(var n=Array.prototype.slice.call(arguments,1),i=t.split("."),o=i.pop(),r=e,a=0;a<i.length;a++)r=r[i[a]];return r[o].apply(this,n)}};r.exports=p},null),u("sdk.XFBML.LoginButton",["sdk.Helper","IframePlugin"],function(e,t,n,i,o,r,a,s){var l=s.extend({constructor:function(e,t,n,i){this.parent(e,t,n,i);var o=s.getVal(i,"on_login");o&&this.subscribe("login.status",function(e){a.invokeHandler(o,null,[e])})},getParams:function(){return{scope:"string",perms:"string",size:"string",login_text:"text",show_faces:"bool",max_rows:"string",show_login_face:"bool",registration_url:"url_maybe",auto_logout_link:"bool",one_click:"bool",show_banner:"bool",auth_type:"string",default_audience:"string"}}});o.exports=l},null),u("escapeHTML",[],function(e,t,n,i,o){function r(e){return e.replace(a,function(e){return s[e]})}var a=/[&<>"'\/]/g,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","/":"&#x2F;"};o.exports=r},null),u("sdk.XFBML.Name",["ApiClient","escapeHTML","sdk.Event","sdk.XFBML.Element","sdk.Helper","Log","sdk.Runtime"],function(e,t,n,i,o,r,a,s,l,c,u,p,h){var f={}.hasOwnProperty,g=c.extend({process:function(){if(d("Object","assign",!1,this,{_uid:this.getAttribute("uid"),_firstnameonly:this._getBoolAttribute("first-name-only"),_lastnameonly:this._getBoolAttribute("last-name-only"),_possessive:this._getBoolAttribute("possessive"),_reflexive:this._getBoolAttribute("reflexive"),_objective:this._getBoolAttribute("objective"),_linked:this._getBoolAttribute("linked",!0),_subjectId:this.getAttribute("subject-id")}),!this._uid)return p.error('"uid" is a required attribute for <fb:name>'),void this.fire("render");var e=[];e.push(this._firstnameonly?"first_name":this._lastnameonly?"last_name":"name"),this._subjectId&&(e.push("gender"),this._subjectId==h.getUserID()&&(this._reflexive=!0)),l.monitor("auth.statusChange",d(function(){return this.isValid()?(this._uid&&"loggedinuser"!=this._uid||(this._uid=h.getUserID()),void(this._uid&&a.scheduleBatchCall("/v1.0/"+this._uid,{fields:e.join(",")},d(function(e){return f.call(e,"error")?void p.warn("The name is not found for ID: "+this._uid):(this._subjectId==this._uid?this._renderPronoun(e):this._renderOther(e),void this.fire("render"))},"bind",!0,this)))):(this.fire("render"),!0)},"bind",!0,this))},_renderPronoun:function(e){var t="",n=this._objective;if(this._subjectId&&(n=!0,this._subjectId===this._uid&&(this._reflexive=!0)),this._uid==h.getUserID()&&this._getBoolAttribute("use-you",!0))t=this._possessive?this._reflexive?"your own":"your":this._reflexive?"yourself":"you";else switch(e.gender){case"male":t=this._possessive?this._reflexive?"his own":"his":this._reflexive?"himself":n?"him":"he";break;case"female":t=this._possessive?this._reflexive?"her own":"her":this._reflexive?"herself":n?"her":"she";break;default:t=this._getBoolAttribute("use-they",!0)?this._possessive?this._reflexive?"their own":"their":this._reflexive?"themselves":n?"them":"they":this._possessive?this._reflexive?"his/her own":"his/her":this._reflexive?"himself/herself":n?"him/her":"he/she"}this._getBoolAttribute("capitalize",!1)&&(t=u.upperCaseFirstChar(t)),this.dom.innerHTML=t},_renderOther:function(e){var t="",n="";this._uid==h.getUserID()&&this._getBoolAttribute("use-you",!0)?t=this._reflexive?this._possessive?"your own":"yourself":this._possessive?"your":"you":e&&(null===e.first_name&&(e.first_name=""),null===e.last_name&&(e.last_name=""),this._firstnameonly&&void 0!==e.first_name?t=s(e.first_name):this._lastnameonly&&void 0!==e.last_name&&(t=s(e.last_name)),t||(t=s(e.name)),""!==t&&this._possessive&&(t+="'s")),t||(t=s(this.getAttribute("if-cant-see","Facebook User"))),t&&(this._getBoolAttribute("capitalize",!1)&&(t=u.upperCaseFirstChar(t)),n=e&&this._linked?u.getProfileLink(e,t,this.getAttribute("href",null)):t),this.dom.innerHTML=n}});o.exports=g},null),u("sdk.XFBML.RecommendationsBar",["sdk.Arbiter","DOMEventListener","sdk.Event","sdk.XFBML.IframeWidget","resolveURI","sdk.Runtime"],function(t,n,i,a,s,l,c,u,p,h,f,g){var m=h.extend({getUrlBits:function(){return{name:"recommendations_bar",params:this._attr}},setupAndValidate:function(){function t(e,t){function n(){t(),o=null,i=d("Date","now",!1)}var i=0,o=null;return function(){if(!o){var t=d("Date","now",!1);e>t-i?o=r(n,e-(t-i)):n()}return!0}}function n(e){if(e.match(/^\d+(?:\.\d+)?%$/)){var t=Math.min(Math.max(parseInt(e,10),0),100);e=t/100}else"manual"!=e&&"onvisible"!=e&&(e="onvisible");return e}function i(e){return Math.max(parseInt(e,10)||30,10)}function a(e){return"left"==e||"right"==e?e:g.getRtl()?"left":"right"}this._attr={channel:this.getChannelUrl(),api_key:g.getClientID(),font:this.getAttribute("font"),colorscheme:this.getAttribute("colorscheme"),href:f(this.getAttribute("href")),side:a(this.getAttribute("side")),site:this.getAttribute("site"),action:this.getAttribute("action"),ref:this.getAttribute("ref"),max_age:this.getAttribute("max_age"),trigger:n(this.getAttribute("trigger","")),read_time:i(this.getAttribute("read_time")),num_recommendations:parseInt(this.getAttribute("num_recommendations"),10)||2},this._showLoader=!1,this.subscribe("iframe.onload",d(function(){var e=this.dom.children[0];e.className="fbpluginrecommendationsbar"+this._attr.side},"bind",!0,this));var s=d(function(){return u.remove(e,"scroll",s),u.remove(o.documentElement,"click",s),u.remove(o.documentElement,"mousemove",s),r(d(this.arbiterInform,"bind",!0,this,"platform/plugins/recommendations_bar/action",null,c.BEHAVIOR_STATE),1e3*this._attr.read_time),!0},"bind",!0,this);if(u.add(e,"scroll",s),u.add(o.documentElement,"click",s),u.add(o.documentElement,"mousemove",s),"manual"==this._attr.trigger){var l=d(function(e){return e==this._attr.href&&(p.unsubscribe("xfbml.recommendationsbar.read",l),this.arbiterInform("platform/plugins/recommendations_bar/trigger",null,c.BEHAVIOR_STATE)),!0},"bind",!0,this);p.subscribe("xfbml.recommendationsbar.read",l)}else{var h=t(500,d(function(){return this.calculateVisibility()&&(u.remove(e,"scroll",h),u.remove(e,"resize",h),this.arbiterInform("platform/plugins/recommendations_bar/trigger",null,c.BEHAVIOR_STATE)),!0},"bind",!0,this));u.add(e,"scroll",h),u.add(e,"resize",h),h()}this.visible=!1;var m=t(500,d(function(){return!this.visible&&this.calculateVisibility()?(this.visible=!0,this.arbiterInform("platform/plugins/recommendations_bar/visible")):this.visible&&!this.calculateVisibility()&&(this.visible=!1,this.arbiterInform("platform/plugins/recommendations_bar/invisible")),!0},"bind",!0,this));u.add(e,"scroll",m),u.add(e,"resize",m),m(),this.focused=!0;var v=d(function(){return this.focused=!this.focused,!0},"bind",!0,this);return u.add(e,"blur",v),u.add(e,"focus",v),this.resize_running=!1,this.animate=!1,this.subscribe("xd.signal_animation",d(function(){this.animate=!0},"bind",!0,this)),!0},getSize:function(){return{height:25,width:"recommend"==this._attr.action?140:96}},calculateVisibility:function(){var t=o.documentElement.clientHeight;if(!this.focused&&e.console&&e.console.firebug)return this.visible;switch(this._attr.trigger){case"manual":return!1;case"onvisible":var n=this.dom.getBoundingClientRect().top;return t>=n;default:var i=e.pageYOffset||o.body.scrollTop,r=o.documentElement.scrollHeight;return(i+t)/r>=this._attr.trigger}}});s.exports=m},null),u("sdk.XFBML.Registration",["sdk.Auth","sdk.Helper","sdk.XFBML.IframeWidget","sdk.Runtime","UrlMap"],function(t,n,i,o,r,a,s,l,c,u,p){var h=c.extend({_visibleAfter:"immediate",_baseHeight:167,_fieldHeight:28,_skinnyWidth:520,_skinnyBaseHeight:173,_skinnyFieldHeight:52,setupAndValidate:function(){return this._attr={action:this.getAttribute("action"),border_color:this.getAttribute("border-color"),channel_url:this.getChannelUrl(),client_id:u.getClientID(),fb_only:this._getBoolAttribute("fb-only",!1),fb_register:this._getBoolAttribute("fb-register",!1),fields:this.getAttribute("fields"),height:this._getPxAttribute("height"),redirect_uri:this.getAttribute("redirect-uri",e.location.href),no_footer:this._getBoolAttribute("no-footer"),no_header:this._getBoolAttribute("no-header"),onvalidate:this.getAttribute("onvalidate"),width:this._getPxAttribute("width",600),target:this.getAttribute("target")},this._attr.onvalidate&&this.subscribe("xd.validate",d(function(e){var t=d("JSON","parse",!1,e.value),n=d(function(t){this.arbiterInform("Registration.Validation",{errors:t,id:e.id})},"bind",!0,this),i=l.executeFunctionByName(this._attr.onvalidate,t,n);i&&n(i)},"bind",!0,this)),this.subscribe("xd.authLogin",d(this._onAuthLogin,"bind",!0,this)),this.subscribe("xd.authLogout",d(this._onAuthLogout,"bind",!0,this)),!0},getSize:function(){return{width:this._attr.width,height:this._getHeight()}},_getHeight:function(){if(this._attr.height)return this._attr.height;var e;if(this._attr.fields)try{e=d("JSON","parse",!1,this._attr.fields)}catch(t){e=this._attr.fields.split(/,/)}else e=["name"];return this._attr.width<this._skinnyWidth?this._skinnyBaseHeight+e.length*this._skinnyFieldHeight:this._baseHeight+e.length*this._fieldHeight},getUrlBits:function(){return{name:"registration",params:this._attr}},getDefaultWebDomain:function(){return p.resolve("www",!0)},_onAuthLogin:function(){s.getAuthResponse()||s.getLoginStatus(),l.fireEvent("auth.login",this)},_onAuthLogout:function(){s.getAuthResponse()||s.getLoginStatus(),l.fireEvent("auth.logout",this)}});r.exports=h},null),u("legacy:fb.xfbml",["Assert","sdk.domReady","sdk.Event","FB","IframePlugin","PluginTags","wrapFunction","XFBML","sdk.XFBML.Comments","sdk.XFBML.CommentsCount","sdk.XFBML.LoginButton","sdk.XFBML.Name","sdk.XFBML.RecommendationsBar","sdk.XFBML.Registration"],function(e,t,n,i,a,s,l,c,u,p,h,f,g,m){var v={comments:t("sdk.XFBML.Comments"),comments_count:t("sdk.XFBML.CommentsCount"),login_button:t("sdk.XFBML.LoginButton"),name:t("sdk.XFBML.Name"),recommendations_bar:t("sdk.XFBML.RecommendationsBar"),registration:t("sdk.XFBML.Registration")};d(d("Object","keys",!1,f),"forEach",!0,function(e){m.registerTag({xmlns:"fb",localName:e.replace(/_/g,"-"),ctor:h.withParams(f[e])})}),d(d("Object","keys",!1,v),"forEach",!0,function(e){m.registerTag({xmlns:"fb",localName:e.replace(/_/g,"-"),ctor:v[e]})}),p.provide("XFBML",{parse:function(e){return l.maybeXfbml(e,"Invalid argument"),e&&9===e.nodeType&&(e=e.body),m.parse.apply(null,arguments)}}),m.subscribe("parse",d(u.fire,"bind",!0,u,"xfbml.parse")),m.subscribe("render",d(u.fire,"bind",!0,u,"xfbml.render")),u.subscribe("init:post",function(e){e.xfbml&&r(g(d(c,"bind",!0,null,m.parse),"entry","init:post:xfbml.parse"),0)}),l.define("Xfbml",function(e){return(1===e.nodeType||9===e.nodeType)&&"string"==typeof e.nodeName});try{o.namespaces&&!o.namespaces.item.fb&&o.namespaces.add("fb")}catch(b){}},3),u("legacy:fb.xfbml-legacy",["FB","sdk.Event"],function(t,n,i,o,r,a,s,l){s.provide("XFBML.RecommendationsBar",{markRead:function(t){l.fire("xfbml.recommendationsbar.read",t||e.location.href)}})},3)}.call({},window.inDapIF?parent.window:window)}catch(o){(new Image).src="http://www.facebook.com/common/scribe_endpoint.php?c=jssdk_error&m="+encodeURIComponent('{"error":"LOAD", "extra": {"name":"'+o.name+'","line":"'+(o.lineNumber||o.line)+'","script":"'+(o.fileName||o.sourceURL||o.script)+'","stack":"'+(o.stackTrace||o.stack)+'","revision":"1468811","message":"'+o.message+'"}}')}n("facebook",function(){}),n("account/oAuth/FB",["durandal/app","facebook"],function(e){function t(t){e.facebook.authResponse=t.authResponse,e.facebook.status="connected"===t.status?2:"not_authorized"===t.status?1:0,e.trigger("oAuth:login",{gateway:"facebook",response:e.facebook})}return e.facebook=e.facebook||{authResponse:void 0,getProfile:function(){return $.Deferred(function(t){FB.api("/me",function(n){console.log(n),t.resolve(n),e.facebook.profile=n})})},getFriends:function(){return $.Deferred(function(e){FB.api("/me/friends",function(t){console.log(t),e.resolve(t)})})},status:0},FB&&(FB.init({appId:"447561982032834",status:!1,cookie:!0,xfbml:!1}),FB.Event.subscribe("auth.authResponseChange",t)),{getStatus:function(n){return $.Deferred(function(i){FB.getLoginStatus(function(n){t(n),i.resolve(e.facebook)},n)})},login:function(){return $.Deferred(function(n){FB.login(function(i){t(i),n.resolve(e.facebook)})})}}}),n("account/facebook",["durandal/app","api/constants","./oAuth/FB"],function(e){function t(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}return window.page={loading:e.loading,username:ko.observable().extend({required:"Username is required",stringLength:{minLength:3,message:"Incorrect e-mail or username"}}),email:ko.observable().extend({customValidation:function(e){return e?t(e)?"":"Incorrect e-mail address":""}}),errorMessage:ko.observable(),activate:function(){this.username(e.facebook.profile.username.replace(".",""))},gologin:function(){e.trigger("account:view:change","account/login")},facebookProfile:e.facebook.profile,signup:function(){e.Sound.play(e.Sound.sounds.click.button),e.loading(!0);var t={fbToken:e.facebook.authResponse,username:this.username(),email:this.email()?this.email():!1},n=this;e.trigger("server:account:fb",t,function(i){e.loading(!1),i.success?(i.username=t.username,localStorage.removeItem("tutorial"),e.dialog.close("panel"),e.trigger("toContext:account:login",i),e.trigger("account:login",i),e.fromSignUp=!0,e.navigate("tutorial")):n.errorMessage(i.message)})}}}),n("account/index",["plugins/router"],function(e){var t=e.createChildRouter().makeRelative({moduleId:"account",fromParent:!0}).map([{route:"facebook",moduleId:"oAuth/facebook",title:"Login via Facebook",nav:!0}]).buildNavigationModel();return{router:t}}),n("account/l-faq",["durandal/app"],function(e){return{activate:function(){},loading:e.loading,close:function(){e.dialog.close("panel")}}}),n("account/l-privacy",["durandal/app"],function(e){return{activate:function(){},loading:e.loading,close:function(){e.trigger("account:view:change","account/sign-up")}}}),n("account/l-terms",["durandal/app"],function(e){return{activate:function(){},loading:e.loading,close:function(){e.trigger("account:view:change","account/sign-up")}}}),n("account/login",["durandal/app","api/datacontext","api/constants","./oAuth/FB"],function(e,t,n,o){function r(){$("button.facebook").transition({y:-50}),$(".facebook.profile").delay(500).transition({y:60})}function a(){this.loading=e.loading,this.facebookLogin=!0,this.hasUsername=t.username&&t.username.length>2&&t.username.length<20,this.username=ko.observable(this.hasUsername?t.username:"").extend({required:"You need to enter you username or e-mail",stringLength:{minLength:3,message:"Incorrect e-mail or username"}}),this.password=ko.observable().extend({required:"You need to enter your password"}),this.errorMessage=ko.observable(),this.facebookProfile=ko.observable(void 0)}return a.prototype.signUp=function(){e.loading()||e.trigger("account:view:change","account/sign-up")},a.prototype.recover=function(){e.trigger("account:view:change","account/recovery")},a.prototype.facebook=function(){if(this.facebookLogin){var n=this;e.loading(!0),o.login().then(function(i){2!=i.status?(e.loading(!1),n.errorMessage("Something went wrong!")):i.getProfile().then(function(o){n.facebookProfile(o),n.username(o.username+"@facebook.com"),n.password(i.authResponse.signedRequest),r(),e.trigger("server:account:fb",{fbToken:e.facebook.authResponse},function(n){e.loading(!1),n.success&&!n.username?e.trigger("account:view:change","account/facebook"):n.success&&(e.ctx.besoz=n.besoz||0,e.ctx.needTutorial=n.tutorial||!1,e.dialog.close("panel"),e.trigger("toContext:account:login",n),e.trigger("account:login",n),e.navigate(e.ctx.needTutorial?"tutorial":t.nextRoute?t.nextRoute:"lobby"))})})})}},a.prototype.login=function(){e.Sound.play(e.Sound.sounds.click.button),e.loading(!0);var o={username:this.username(),password:i.SHA3(n.salt+this.password()).toString()},r=this;e.trigger("server:account:login",o,function(n){e.loading(!1),n.success?(e.ctx.besoz=n.besoz||0,e.ctx.needTutorial=n.tutorial||!1,e.dialog.close("panel"),e.trigger("toContext:account:login",n),e.trigger("account:login",n),e.navigate(e.ctx.needTutorial?"tutorial":t.nextRoute?t.nextRoute:"lobby")):r.errorMessage(n.message)})},a}),n("account/logout",["api/datacontext"],function(e){return{getView:function(){return $("<div/>").get(0)},activate:function(){e.logout()}}}),n("account/oAuth/facebook",["durandal/app","./FB"],function(e,t){function n(){this.login=function(){t.login().then(function(e){console.log(e)})}}return t.getStatus(!0).then(function(e){console.log(e)}),n.prototype.activate=function(){palette.get("menu").visible(!1),palette.get("currency").visible(!1)},n.prototype.detached=function(){palette.get("menu").visible(!0),palette.get("currency").visible(!0)},n}),n("account/recovery",["durandal/app","api/constants"],function(e){function t(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}var n=ko.observable(),i=ko.observable();return n.verify=function(e){return""==e?"E-mail is required":t(e)?"":"Incorrect e-mail address"},{loading:e.loading,errorMessage:i,email:n,recover:function(){e.loading(!0)},login:function(){e.trigger("account:view:change","account/login")}}}),n("account/sign-up",["durandal/app","api/constants"],function(e,t){function n(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}return{loading:e.loading,username:ko.observable().extend({required:"Username is required",stringLength:{minLength:3,message:"Incorrect e-mail or username"}}),password:ko.observable().extend({required:"Password is required"}),email:ko.observable().extend({required:"E-mail is required",customValidation:function(e){return n(e)?"":"Incorrect e-mail address"}}),errorMessage:ko.observable(),signUp:function(){e.Sound.play(e.Sound.sounds.click.button),e.loading(!0);var n={username:this.username(),email:this.email(),password:i.SHA3(t.salt+this.password()).toString()},o=this;e.trigger("server:account:sign-up",n,function(t){e.loading(!1),t.success?e.trigger("server:account:login",n,function(t){t.username=n.username,localStorage.removeItem("tutorial"),e.dialog.close("panel"),e.trigger("toContext:account:login",t),e.trigger("account:login",t),e.fromSignUp=!0,e.navigate("tutorial")}):o.errorMessage(t.message)})},login:function(){e.trigger("account:view:change","account/login")},terms:function(){e.loading(!0),e.dialog.show("panel",{module:"account/l-terms",fixed:!0,css:"wide"},{compositionComplete:function(){e.loading(!1)}})},privacy:function(){e.loading(!0),e.dialog.show("panel",{module:"account/l-privacy",fixed:!0,css:"wide"},{compositionComplete:function(){e.loading(!1)}})}}}),n("api/controllers/authController",["api/datacontext"],function(e){function t(){}t.prototype.activate=function(){return e.auth},t.prototype.authValidate=function(){return e.auth}}),n("api/helper/Canvas",[],function(){function e(e){for(var t=atob(e.split(",")[1]),n=new ArrayBuffer(t.length),i=new Uint8Array(n),o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return new Blob([n],{type:"image/png"})}var t={};return t.toDataURL=function(e){return e.toDataURL("image/png")},t.toBlob=function(n){return e(t.toDataURL(n))},t}),n("api/helper/CanvasCapture",[],function(){var e={},t={width:640,heigh:640,innerCircleDiam:529,left:55,top:55};return e.capture=function(e,n,i){var o=$.Deferred(),r=$("<div/>").css({display:"block",width:563,height:563,position:"absolute",zIndex:-1}).append($(e).clone().css("height","100%").addClass("clean"))[0],a=parseInt($("h1",r).css("fontSize"));return document.body.appendChild(r),$(".tile",r).css("fontSize","563px").find(".poem").css("fontSize",i*(529/376)).end().find("h1").css("fontSize",a*(529/376)),html2canvas(r,{onrendered:function(e){function i(n){if(n){var i=document.createElement("canvas").getContext("2d");i.canvas.height=i.canvas.width=529,i.drawImage(e,-16.875,-16.875),a.canvas.width=t.width,a.canvas.height=t.heigh,a.clearRect(0,0,t.width,t.heigh),a.webkitImageSmoothingEnabled=a.mozImageSmoothingEnabled=a.imageSmoothingEnabled=a.msImageSmoothingEnabled=!0,u?(a.drawImage(l,t.left,t.top,t.innerCircleDiam,t.innerCircleDiam),a.drawImage(i.canvas,t.left,t.top,t.innerCircleDiam,t.innerCircleDiam),a.drawImage(c,0,0,t.width,t.heigh),a.beginPath(),a.arc(t.left+t.innerCircleDiam/2,t.top+t.innerCircleDiam/2,t.innerCircleDiam/2+2,2*Math.PI,0,!0),a.lineWidth=4,a.strokeStyle="white",a.stroke()):(a.drawImage(c,0,0,t.width,t.heigh),a.drawImage(i.canvas,t.left,t.top-70,t.innerCircleDiam,t.innerCircleDiam)),o.resolve(e)}}$(r).remove();var a=e.getContext("2d"),s=0,l=new Image,c=new Image,u=!!n;l.onload=c.onload=function(){i(s++)},l.src=n||"images/game/poem-mask-empty.jpg",c.src=u?"images/game/poem-mask.png":"images/game/poem-mask-empty.jpg"}}),o.promise()},e}),n("api/helper/draggable.beta",[],function(){$.fn.draggable=function(e){function t(){return i.data("immovable")&&i.data("immovable")()}function n(e){if($.support.touch){var t=e.originalEvent.changedTouches[0];if(e.clientX=e.pageX=t.pageX,e.clientY=e.pageY=t.pageY,"touchstart"==e.type){var n=$("canvas")[0],i=document.createEvent("TouchEvent");i.initTouchEvent("touchstart",!0,!0,window,1,e.clientX,e.clientY,e.clientX,e.clientY,!1,!1,!1,!1,e.originalEvent.touches,e.originalEvent.targetTouches,e.originalEvent.changedTouches,1,0),n.dispatchEvent(i)}}}e=$.extend({},$.fn.draggable.defaults,e);var i=$(this),o=!1;this.immovable=t;var r={mousedown:function(o){if(o.preventDefault(),o.stopPropagation(),n(o),e.withinEl){var a=e.withinEl.innerHeight(),s=e.withinEl.innerWidth(),l=e.withinEl.offset();e.within={l:l.left,t:l.top,r:l.left+s,b:l.top+a}}var l=i.offset(),c={h:i.outerHeight(),w:i.outerWidth(),t:l.top-o.pageY,l:l.left-o.pageX,parent:i.parent(),scrollTop:e.parent.scrollTop(),scrollTopChanging:0};if(c.scrollTopTarget=c.scrollTop,e.centerBased&&(e.within.t+=c.h/2,e.within.b+=c.h/2,e.within.l+=c.w/2,e.within.r+=c.w/2),e.dragStart.call(this,o,e.within),!t()){var u=$.support.touch?"touchmove":"mousemove";i.hide(),i.addClass("drag").appendTo($("#fixed")).css({top:l.top,left:l.left}),i.show(),$(document).bind(u,c,r.mousemove),e.parent.bind("scroll",c,r.scroll)}var d=$.support.touch?"touchend":"mouseup";return $(document).one(d,c,r.mouseup),c},mousemove:function(t){n(t);var r=t.pageY+t.data.t,a=t.pageX+t.data.l;if(e.lastEvent=t,e.topLimit&&r<e.within.t&&(r=e.within.t),a<e.within.l&&(a=e.within.l),r+t.data.h>e.within.b&&(r=e.within.b-t.data.h),a+t.data.w>e.within.r&&(a=e.within.r-t.data.w),e.move(t,{top:r,left:a})&&(i.css({top:r,left:a}),o=!0,t.pageY<100&&!t.data.scrollTopChanging)){var s=e.parent.scrollTop()-50;-50!=s&&(0>s&&(s=0),t.data.scrollTopChanging=!0,e.parent.animate({scrollTop:s},"fast",function(){t.data.scrollTopChanging=!1}))}},mouseup:function(t){if(i.hasClass("drag")){if(n(t),$.support.touch){i.hide();var a=document.createEvent("TouchEvent"),s=document.elementFromPoint(t.clientX,t.clientY);i.show(),a.initTouchEvent("touchend",!0,!0,window,1,t.clientX,t.clientY,t.clientX,t.clientY,!1,!1,!1,!1,t.originalEvent.touches,t.originalEvent.targetTouches,t.originalEvent.changedTouches,1,0),s.dispatchEvent(a)}else{i.hide();var a=document.createEvent("MouseEvents"),s=document.elementFromPoint(t.clientX,t.clientY);i.show(),a.initMouseEvent("mouseup",!0,!0,window,1,t.clientX,t.clientY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),s.dispatchEvent(a)}$(document).unbind("mousemove touchmove",r.mousemove),e.parent.unbind("scroll",r.scroll);var l=t.data,c=l.scrollTop-e.parent.scrollTop();e.within.t+=c,e.within.b+=c;var u=r.isWithinBoundaries(t),d=u?t.data.t+t.pageY:i.position().top,p=u?t.data.l+t.pageX:i.position().left;d-=l.parent.offset().top,p-=l.parent.offset().left,i.hide(),i.removeClass("drag").appendTo(l.parent).css({top:d,left:p}),i.show(),o&&(i.addClass("dragged"),0>d&&(d=0,e.usePercentage||e.noTask||Task.run(function(){i.css({top:0})})),e.usePercentage&&(d=100*d/(e.within.b-e.within.t),p=100*p/(e.within.r-e.within.l),e.noTask?i.css({top:d+"%",left:p+"%"}):Task.run(function(){i.css({top:d+"%",left:p+"%"})}))),e.dropped(t,{top:d,left:p,hasMoved:o,within:e.within,scrollTopChange:t.data.scrollTopChange,isWithin:u}),o=!1}},scroll:function(){},isWithinBoundaries:function(t){var n=t.pageY+t.data.t+t.data.scrollTopChange,i=t.pageX+t.data.l;return n<e.within.t||n+t.data.h>e.within.b||i<e.within.l||i+t.data.w>e.within.r?!1:!0}},a=$.support.touch?"touchstart":"mousedown";return i.bind(a,r.mousedown),i.data("draggable",this),this.dispose=function(){i.unbind(),r.mouseup()},i.css("cursor",e.cursor)},$.fn.draggable.defaults={within:{l:0,r:window.innerWidth,t:0,b:window.innerHeight},withinEl:null,dragStart:function(){},dropped:function(){},move:function(){return!0},parent:$("#app"),dragable:!0,usePercentage:!0,cursor:"pointer",centerBased:!1,topLimit:!1}}),n("api/helper/draggable",[],function(){$.fn.draggable=function(e){function t(){return i.data("immovable")&&i.data("immovable")()}function n(e){if($.support.touch){var t=e.originalEvent.changedTouches[0];if(e.clientX=e.pageX=t.pageX,e.clientY=e.pageY=t.pageY,"touchstart"==e.type){var n=$("canvas")[0],i=document.createEvent("TouchEvent");n&&n.dispatchEvent&&(i.initTouchEvent("touchstart",!0,!0,window,1,e.clientX,e.clientY,e.clientX,e.clientY,!1,!1,!1,!1,e.originalEvent.touches,e.originalEvent.targetTouches,e.originalEvent.changedTouches,1,0),n.dispatchEvent(i))}}}e=$.extend({},$.fn.draggable.defaults,e);var i=$(this),o=!1;this.immovable=t;var r={mousedown:function(o){if(o.preventDefault(),o.stopPropagation(),n(o),e.withinEl){var a=e.withinEl.innerHeight(),s=e.withinEl.innerWidth(),l=e.withinEl.offset();e.within={l:l.left,t:l.top,r:l.left+s,b:l.top+a}}var l=i.offset(),c={h:i.outerHeight(),w:i.outerWidth(),t:l.top-o.pageY,l:l.left-o.pageX,parent:i.parent(),scrollTop:e.parent.scrollTop(),scrollTopChanging:0};if(c.scrollTopTarget=c.scrollTop,e.centerBased&&(e.within.t+=c.h/2,e.within.b+=c.h/2,e.within.l+=c.w/2,e.within.r+=c.w/2),e.dragStart.call(this,o,e.within,c),!t()){var u=$.support.touch?"touchmove":"mousemove";i.hide(),i.addClass("drag").appendTo($("#fixed")).css({top:l.top,left:l.left}),i.show(),$(document).bind(u,c,r.mousemove),e.parent.bind("scroll",c,r.scroll)}var d=$.support.touch?"touchend":"mouseup";return $(document).one(d,c,r.mouseup),c},mousemove:function(t){n(t);var r=t.pageY+t.data.t,a=t.pageX+t.data.l;if(e.lastEvent=t,e.topLimit&&r<e.within.t&&(r=e.within.t),a<e.within.l&&(a=e.within.l),r+t.data.h>e.within.b&&(r=e.within.b-t.data.h),a+t.data.w>e.within.r&&(a=e.within.r-t.data.w),e.move(t,{top:r,left:a})&&(i.css({top:r,left:a}),o=!0,t.pageY<100&&!t.data.scrollTopChanging)){var s=e.parent.scrollTop()-50;
-50!=s&&(0>s&&(s=0),t.data.scrollTopChanging=!0,e.parent.animate({scrollTop:s},"fast",function(){t.data.scrollTopChanging=!1}))}},mouseup:function(t){if(i.hasClass("drag")){if(n(t),$.support.touch){i.hide();var a=document.createEvent("TouchEvent"),s=document.elementFromPoint(t.clientX,t.clientY);i.show(),s&&s.dispatchEvent&&(a.initTouchEvent("touchend",!0,!0,window,1,t.clientX,t.clientY,t.clientX,t.clientY,!1,!1,!1,!1,t.originalEvent.touches,t.originalEvent.targetTouches,t.originalEvent.changedTouches,1,0),s.dispatchEvent(a))}else{i.hide();var a=document.createEvent("MouseEvents"),s=document.elementFromPoint(t.clientX,t.clientY);i.show(),s&&s.dispatchEvent&&(a.initMouseEvent("mouseup",!0,!0,window,1,t.clientX,t.clientY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),s.dispatchEvent(a))}$(document).unbind("mousemove touchmove",r.mousemove),e.parent.unbind("scroll",r.scroll);var l=t.data,c=l.scrollTop-e.parent.scrollTop();e.within.t+=c,e.within.b+=c;var u=r.isWithinBoundaries(t),d=u?t.data.t+t.pageY:i.position().top,p=u?t.data.l+t.pageX:i.position().left,h=l.dropzone?l.dropzone:l.parent;d-=h.offset().top,p-=h.offset().left,i.hide(),i.removeClass("drag").appendTo(l.parent).css({top:d,left:p}),i.show(),o&&(i.addClass("dragged"),0>d&&(d=0,e.usePercentage||e.noTask||Task.run(function(){i.css({top:0})})),e.usePercentage&&(d=100*d/(e.within.b-e.within.t),p=100*p/(e.within.r-e.within.l),e.noTask?i.css({top:d+"%",left:p+"%"}):Task.run(function(){i.css({top:d+"%",left:p+"%"})}))),e.dropped(t,{top:d,left:p,hasMoved:o,within:e.within,scrollTopChange:t.data.scrollTopChange,isWithin:u}),o=!1}},scroll:function(){},isWithinBoundaries:function(t){var n=t.pageY+t.data.t+t.data.scrollTopChange,i=t.pageX+t.data.l;return n<e.within.t||n+t.data.h>e.within.b||i<e.within.l||i+t.data.w>e.within.r?!1:!0}},a=$.support.touch?"touchstart":"mousedown";return i.bind(a,r.mousedown),i.data("draggable",this),this.dispose=function(){i.unbind(),r.mouseup()},i.css("cursor",e.cursor)},$.fn.draggable.defaults={within:{l:0,r:window.innerWidth,t:0,b:window.innerHeight},withinEl:null,dragStart:function(){},dropped:function(){},move:function(){return!0},parent:$("#app"),dragable:!0,usePercentage:!0,cursor:"pointer",centerBased:!1,topLimit:!1}}),n("api/helper/draggable.static",[],function(){$.fn.draggableStatic=function(e){function t(){return i.data("immovable")&&i.data("immovable")()}function n(e){if($.support.touch){var t=e.originalEvent.changedTouches[0];if(e.clientX=e.pageX=t.pageX,e.clientY=e.pageY=t.pageY,"touchstart"==e.type){var n=$("canvas")[0],i=document.createEvent("TouchEvent");i.initTouchEvent("touchstart",!0,!0,window,1,e.clientX,e.clientY,e.clientX,e.clientY,!1,!1,!1,!1,e.originalEvent.touches,e.originalEvent.targetTouches,e.originalEvent.changedTouches,1,0),n.dispatchEvent(i)}}}e=$.extend({},$.fn.draggableStatic.defaults,e);var i=$(this),o=!1;this.immovable=t;var r={mousedown:function(o){if(o.preventDefault(),o.stopPropagation(),i.addClass("drag"),n(o),e.withinEl){var a=e.withinEl[0].scrollHeight,s=e.withinEl.innerWidth(),l=parseInt(e.withinEl.css("padding-left")),c=parseInt(e.withinEl.css("padding-top")),u=parseInt(e.withinEl.css("padding-right")),d=parseInt(e.withinEl.css("padding-bottom"));e.within={l:l,t:c,r:s-l-u,b:a-c-d}}var p={h:i.outerHeight(),w:i.outerWidth(),t:i.position().top-o.pageY,l:i.position().left-o.pageX,scrollTop:e.parent.scrollTop(),scrollTopChange:0,scrollTopTarget:0};if(p.scrollTopTarget=p.scrollTop,e.centerBased&&(e.within.t+=p.h/2,e.within.b+=p.h/2,e.within.l+=p.w/2,e.within.r+=p.w/2),e.dragStart.call(this,o,e.within),!t()){var h=$.support.touch?"touchmove":"mousemove";e.parent.bind(h,p,r.mousemove),e.parent.bind("scroll",p,r.scroll)}var f=$.support.touch?"touchend":"mouseup";return e.parent.one(f,p,r.mouseup),p},mouseup:function(t){if(i.hasClass("drag")){if(n(t),$.support.touch){i.hide();var a=document.createEvent("TouchEvent"),s=document.elementFromPoint(t.clientX,t.clientY);i.show(),a.initTouchEvent("touchend",!0,!0,window,1,t.clientX,t.clientY,t.clientX,t.clientY,!1,!1,!1,!1,t.originalEvent.touches,t.originalEvent.targetTouches,t.originalEvent.changedTouches,1,0),s.dispatchEvent(a)}else{i.hide();var a=document.createEvent("MouseEvents"),s=document.elementFromPoint(t.clientX,t.clientY);i.show(),a.initMouseEvent("mouseup",!0,!0,window,1,t.clientX,t.clientY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),s.dispatchEvent(a)}e.parent.unbind("mousemove touchmove",r.mousemove),e.parent.unbind("scroll",r.scroll),i.removeClass("drag");var l=r.isWithinBoundaries(t),c=l?t.data.t+t.pageY+t.data.scrollTopChange:i.position().top,u=l?t.data.l+t.pageX:i.position().left;i.position().top<e.within.t&&(c=e.within.t,i.css({top:c})),o&&e.usePercentage&&(c=100*c/(e.within.b-e.within.t),u=100*u/(e.within.r-e.within.l),i.css({top:c+"%",left:u+"%"})),o&&i.addClass("dragged"),e.dropped(t,{top:c,left:u,hasMoved:o,within:e.within,scrollTopChange:t.data.scrollTopChange,isWithin:l}),o=!1}},scroll:function(){e.lastEvent&&(e.lastEvent.data.scrollTopChange=e.parent.scrollTop()-e.lastEvent.data.scrollTop,r.mousemove(e.lastEvent))},mousemove:function(t){n(t);var r=t.pageY+t.data.t+t.data.scrollTopChange,a=t.pageX+t.data.l;if(e.lastEvent=t,e.topLimit&&r<e.within.t&&(r=e.within.t),a<e.within.l&&(a=e.within.l),r+t.data.h>e.within.b&&(r=e.within.b-t.data.h),a+t.data.w>e.within.r&&(a=e.within.r-t.data.w),e.move(t,{top:r,left:a})&&(i.css({top:r,left:a}),o=!0,t.data.scrollTop+t.data.scrollTopChange!=0&&t.pageY<100)){var s=t.data.scrollTop+t.data.scrollTopChange;if(t.data.scrollTopTarget==s){var l=s-50;0>l&&(l=0),t.data.scrollTopTarget=l,console.log("scrolled",l),e.parent.animate({scrollTop:l},"fast",function(){})}}},isWithinBoundaries:function(t){var n=t.pageY+t.data.t+t.data.scrollTopChange,i=t.pageX+t.data.l;return n<e.within.t||n+t.data.h>e.within.b||i<e.within.l||i+t.data.w>e.within.r?!1:!0}},a=$.support.touch?"touchstart":"mousedown";return i.bind(a,r.mousedown),i.data("draggable",this),this.dispose=function(){i.unbind(),r.mouseup()},i.css("cursor",e.cursor)},$.fn.draggableStatic.defaults={within:{l:0,r:window.innerWidth,t:0,b:window.innerHeight},withinEl:null,dragStart:function(){},dropped:function(){},move:function(){return!0},parent:$("#app"),dragable:!0,usePercentage:!0,cursor:"pointer",centerBased:!1,topLimit:!1}}),n("api/helper/facebook",["api/helper/Canvas","api/helper/CanvasCapture","facebook"],function(e){var t={accessToken:"",expiresIn:0,signedRequest:"",userID:""},n={uploadImages:"publish_stream"};return window.facebook=window.facebook||{},app&&(app.facebook=facebook),FB&&(FB.init({appId:"447561982032834",status:!1,cookie:!0,xfbml:!1}),FB.Event.subscribe("auth.authResponseChange",function(e){t=e.authResponse})),facebook.utils=facebook.utils||{},facebook.utils.getProfileImageSrc=function(e,n){return e=e||200,n=n||200,"//graph.facebook.com/"+t.userID+"/picture?height="+n+"&width="+e},facebook.utils.getUserInfo=function(){var e=$.Deferred();return FB.api("/me",function(t){facebook.user=t,facebook.user.profileImageSrc=facebook.utils.getProfileImageSrc(),e.resolve()}),e.promise()},facebook.PublishImage=function(){function i(){var e=this;this.loginState=$.Deferred(),this.loginState.promise().then(function(){e.loginRequested=!0}),this.canvas=null,this.poemImageSrc=ko.observable(""),this.uploadPercent=ko.observable(0)}return i.prototype.login=function(){var e=this;return e.logRequested?e.loginState.promise():(FB.login(function(n){"connected"==n.status?(t=n.authResponse,facebook.utils.getUserInfo().then(function(){e.loginState.resolve()})):(e.loginState.reject(),e.loginState=$.Deferred())},{scope:n.uploadImages}),e.loginState.promise())},i.prototype.publishImageUI=function(t){var n=this;return n.canvas=t,n.poemImageSrc(e.toDataURL(t)),app.loading(!0),$.Deferred(function(){n.loginState.then(function(){app.dialog.show("panel",{module:"api/ui/facebook.poem",fixed:!0},{compositionComplete:function(){$("input[autofocus]").focus(),app.loading(!1)}})},function(){app.loading(!1)})})},i.prototype.publishImage=function(n){var i=this;i.uploadPercent(0);var o=new FormData;return o.append("access_token",t.accessToken),o.append("source",e.toBlob(this.canvas)),o.append("message",n||""),$.ajax({url:"https://graph.facebook.com/me/photos?access_token="+t.accessToken,data:o,type:"POST",cache:!1,processData:!1,contentType:!1,success:function(e){console.log("success "+e)},error:function(e,t,n){console.log("error "+n+" Status "+e.status)},xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var t=e.loaded/e.total;i.uploadPercent(t)}},!1),e}}).then(function(){app.dialog.show("alert",{content:"Your poem is published to your facebook now!"}),app.Sound.play(app.Sound.sounds.action.success)}).promise()},new i}(),facebook}),n("api/paypal",[],function(){var e={getToken:function(e){return $.Deferred(function(t){app.trigger("server:payment:paypal-token",e,function(){t.resolve.apply(this,arguments)})})}};return e}),n("api/ui/facebook.poem",["api/helper/facebook"],function(e){return{activate:function(){this.uploading(!1),this.message("")},loading:app.loading,uploading:ko.observable(!1),user:e.user,poem:e.PublishImage.poemImageSrc,message:ko.observable(""),uploadPercent:e.PublishImage.uploadPercent,publish:function(){app.loading(!0),this.uploading(!0),e.PublishImage.publishImage(this.message()).then(function(){app.loading(!1),app.dialog.close("panel"),ga("send","event","poem","shared","facebook")})},close:function(){this.uploading()||app.dialog.close("panel")}}}),n("api/ui/paymentwall",["api/helper/facebook"],function(){return{activate:function(){},close:function(){app.dialog.close("panel")}}}),n("api/ui/paypalcancel",[],function(){return{getView:function(){return $("<div/>").get(0)},activate:function(){ga("send","event","paypal","canceled"),app.navigate("#newGame"),Task.run(function(){app.dialog.showBesozCancel()},1e3)},loading:app.loading}}),n("api/ui/paypalcb",[],function(){return{activate:function(){var e=arguments[0];e.payerID=e.payerID||e.PayerID,delete e.PayerID,app.trigger("server:payment:paypal-confirm",{paypal:{payerID:e.payerID,token:e.token}},function(e){e.success?(ga("send","event","paypal","bought"),ctx.user.refresh(),app.navigate(localStorage.getItem("returnedHash")||""),Task.run(function(){app.dialog.showBesozBought()},1e3)):(ga("send","event","paypal","error"),app.navigate("#newGame"),Task.run(function(){app.dialog.showBesozCancel()},1e3))})},loading:app.loading}}),n("dialogs/pages/GameOver",["durandal/app"],function(e){function t(t){this.heading=t.heading,this.content=t.content.replace("{{scored}}",'<span class="score">'+ctx.player.score()+"</span>"),this.btnText=t.btnText,this.xp=t.xp||0,this.noXP=void 0===t.noXP?!1:t.noXP,this.target=t.target,this.noRedirect=t.noRedirect,this.btnSizeAuto=!!t.btnSizeAuto,this.showButtons=!t.hideButtons,this.stats=t.stats;var n=this;this.gotoLobby=function(){n.close(function(){n.target&&e.navigate(n.target)})},this.showPoem=function(){n.close(function(){e.dialog.showPoem()})}}var n={WON:{heading:"Congratulations!",content:"You won the game, scoring {{scored}} points.",btnText:"Great!",stats:"won"},LOST:{heading:"Good luck next time!",content:"You lost the game, scoring {{scored}} points.",btnText:"Dismiss!",stats:"lost"},SOLO:{heading:"Well done!",content:"You completed the game board, scoring {{scored}} points.",btnText:"Start New Game",target:"singlePlayer",stats:"won"},RESIGNED:{heading:"The game has ended!",content:"Your opponent has resigned from the game. Too bad, but this means you win!",btnText:"OK!",target:"lobby",btnSizeAuto:!0,hideButtons:!0,stats:"resigned"}};return t.WON=function(){return new t(n.WON)},t.LOST=function(){return new t(n.LOST)},t.SOLO=function(){return new t(n.SOLO)},t.RESIGNED=function(){return new t(n.RESIGNED)},t}),n("dialogs/pages/addWords",["durandal/app","api/datacontext"],function(e,t){function n(){this.loading=ko.observable(!1),this.message=ko.observable(),this.words=ko.observableArray([]),this.activeWord=ko.observable(),this.lemma=ko.observable(),this.searched=ko.observable(""),this.tMode=t.tutorialMode;var n=this;this.suggest=function(){e.trigger("server:user:suggest",{lemma:n.searched()},function(){e.dialog.show("alert",{content:$("<div/>").css("fontSize","20px").html("Thanks for your suggestion. <br> We will consider your word in future!")[0].outerHTML,delay:5e3})}),n.close()},this.search=function(){return this.loading(!0),n.lemma(n.lemma().trim()),e.trigger("server:game:search-word",{lemma:n.lemma()},function(t){return n.searched(n.lemma()),n.loading(!1),0==t.words.length?(e.Sound.play(e.Sound.sounds.action.functionFailed),t.message=t.message||"Sorry! <b>{word}</b> does not exist in our database at the moment.",n.message(t.message.replace("{word}",n.lemma())),n.words([]),void n.activeWord(void 0)):(n.activeWord(t.words[0]),void n.words(t.words))}),!1},this.done=function(){function i(t){n.loading(!1),t.word.css="new",t.words=[t.word],t.oldWords=[],t.success&&(e.Sound.play(e.Sound.sounds.word.wiggling),n.ticket(!1),e.trigger("game:swap-words",t),e.scrollDown(),n.close())}if(n.loading(!0),t.tutorialMode()){var o={success:!0,word:{id:10,x:.5,y:.2,lemma:n.activeWord(),points:3,isRelated:!1,angle:3,altLemma:n.activeWord()}};i(o)}else e.trigger("server:game:add-word",{username:t.username,gameID:t.gameID,lemma:n.activeWord()},function(n){i(n),n.success?void 0!=n.besoz&&(t.user.besoz(n.besoz),0==n.besoz&&e.trigger("game:bubble","zeroBesoz")):e.dialog.showNoBesoz(4)})},this.select=function(e){n.activeWord(e)}}return n}),n("dialogs/pages/currency",["durandal/app","api/datacontext","api/paypal"],function(e,t,n){function i(){this.loading=t.shop.loading(),this.list=t.shop.besozes,t.shop.besozes.load(),this.buy=function(i){e.dialog.closeAll(),e.dialog.show("loading"),t.loading(!0),t.loadingStatus("Waiting for the server..."),t.loadingBox(!0),n.getToken(i).then(function(n){n.success?(e.palette.dispose(),t.loadingStatus("Waiting for Paypal..."),localStorage.setItem("returnedHash",location.hash),window.location=n.link):(t.loading(!1),t.loadingBox(!1),e.dialog.close("loading"))})}}return new i}),n("dialogs/pages/email",["durandal/app","api/datacontext"],function(e,t){function n(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}function i(){this.loading=ko.observable(!1),this.email=ko.observable().extend({required:"E-mail is required",customValidation:function(e){return n(e)?"":"Incorrect e-mail address"}});var i=this;this.send=function(){e.trigger("server:user:email",{command:"change",email:i.email()},function(n){n.success?(e.dialog.show("alert",{content:"Your email is changed to "+i.email()+" successfuly!"}),t.user.refresh()):e.dialog.show("alert",{content:"There was a problem with your action!"})}),e.dialog.close("notice")}}return i}),n("dialogs/pages/invite",["durandal/app","api/datacontext","api/helper/facebook"],function(e){function t(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}function n(){this.loading=ko.observable(!1),this.email=ko.observable().extend({required:"E-mail is required",customValidation:function(e){return t(e)?"":"Incorrect e-mail address"}});var n=this;this.send=function(){e.trigger("server:user:invite",{email:n.email()},function(){e.dialog.show("alert",{content:"An invitation has been sent to "+n.email()+"!"})}),e.dialog.close("notice")},this.facebook=function(){FB.ui({method:"send",message:"Let's make a poem together!",link:"http://wordsofoz.com/"})}}return n}),n("dialogs/pages/versions",["durandal/app","api/datacontext"],function(e,t){function n(){this.step=ko.observable(1),this.dropped=ko.observable(!1),this.loading=e.loading,this.message=ko.observable(),this.tMode=t.tutorialMode;var n=this;this.detached=function(){var e=this.lastWord;e&&(e.isPlayed=!1,t.words.valueHasMutated())},this.enter=function(){console.log("enter")},this.leave=function(){console.log("leave")},this.drop=function(){var i=this.lastWord=t.activeWord();i&&(i.isPlayed=1,t.words.valueHasMutated(),n.word=i,n.lemma=i.lemma,n.dropped(!0),e.trigger("server:game:versions",{command:"get",username:t.username,lemma:i.lemma},function(i){return 0==i.versions.length?(i.message=i.message||'<p>Only words that are <b>verbs</b> can be changed at the moment.</p><br/><p class=sm>Verbs are doing words like "talk", "run" and "smile", or being words like "wish", "feel" and "know".</p>',n.message(i.message),n.dropped(!1),n.word.isPlayed=0,t.words.valueHasMutated(),void e.Sound.play(e.Sound.sounds.action.functionFailed)):(n.activeVersion=ko.observable(i.versions[0]),n.versions=ko.observableArray(i.versions),void n.step(2))}))},this.done=function(){n.loading(!0),t.tutorialMode()?(n.loading(!1),n.word.isPlayed=!1,n.word.lemma=n.activeVersion(),t.words.valueHasMutated(),n.ticket(!1),n.close()):e.trigger("server:game:versions",{command:"set",username:t.username,gameID:t.gameID,wordID:n.word.id,version:n.activeVersion()},function(i){n.loading(!1),i.success?(void 0!=i.besoz&&(t.user.besoz(i.besoz),0==i.besoz&&e.trigger("game:bubble","zeroBesoz")),n.word.isPlayed=!1,n.word.isRelated=i.isRelated,n.word.lemma=i.version,n.word.soundPlayed=!1,t.words.valueHasMutated(),n.ticket(!1),n.close()):e.dialog.showNoBesoz(2)})},this.select=function(e){n.activeVersion(e)}}return n}),n("dialogs/templates/_Effects",["durandal/app"],function(){return{downCustom:function(e,t){e.css({y:-100,opacity:0}).transition({y:20,opacity:.8},t,"ease").transition({y:0,opacity:1},t/2,"ease")},zoom:function(e){e.css({scale:.5,opacity:0}),e.transition({scale:1,opacity:1})},middle:function(e){e.css({top:($(window).innerHeight()-e.outerHeight())/2})},bottom:function(){},down:function(e,t,n){n||e.css({opacity:0}),e.transition({y:0},1*t/4).transition({y:100,opacity:n?0:1},3*t/4)},up:function(e,t,n){n||e.css({opacity:0}),e.transition({y:-100,opacity:n?0:1},3*t/4)}}}),n("dialogs/templates/_Dialog",["durandal/app","./_Effects"],function(e,t){function n(e,t){this.type=e,this.content=null,this.modal=null,this._closing=!1,this.attributes=$.extend({fixed:!0,singleton:!0},t)}function i(e){for(var n=this.attributes["effect"+e].split(" "),i=0;i<n.length;i++)t[n[i]](this.el,this.attributes["effect"+e+"Duration"]||s.effectDuration,this._closing);var o=this.attributes["effect"+e+"Done"];o&&o.call(this,this.el)}function o(){this.attributes.effectStart&&i.call(this,"Start")}function r(){return this.attributes.effectClose&&i.call(this,"Close"),this.el.promise()}var a=$.Deferred(function(e){e.resolve()}).promise(),s={effectDuration:500};return n.Inherit=function(e,t,i){return e.prototype=new n(t||e.name.toLowerCase(),i),e.prototype.constructor=e,e.prototype.super=n.prototype,e},n.Create=function(e,t){var i=function(){};return n.Inherit(i,e,t)},n.prototype.activate=function(e){this.content=e.content,this.modal=e.modal||!1,this.attributes.activate&&this.attributes.activate.apply(this,arguments)},n.prototype.attached=function(e){if(this.el=$("."+this.type,e),this._closing)throw"Unexpected Error: dialog attached before former one is closed!";o.apply(this),this.attributes.attached&&this.attributes.attached.apply(this,arguments)},n.prototype.close=function(e){return this._closing=!0,e&&e.forced?a:r.apply(this)},n.prototype.canDeactivate=function(){var e=this;return $.Deferred(function(t){e.el&&!e._closing&&e.close().then(function(){t.resolve()})}).promise()},n}),n("dialogs/templates/alert",["./_Dialog","durandal/app"],function(e){var t=e.Create("alert",{effectStart:"middle zoom",effectStartDuration:500,effectStartDone:function(e){var t=this;e.delay(this.delay).fadeOut(function(){t.forceClose()})},activate:function(e){this.delay=e.delay||2e3}});return t}),n("dialogs/templates/confirm",["./_Dialog","durandal/app"],function(e,t){function n(){this.content="",this.cancelText="CANCEL",this.doneText="DONE",this.duration=400,this.modal=!1,this.images=!0;var e=i=this;this.done=function(){t.Sound.play(t.Sound.sounds.click.button),e.close("done"),t.Sound.play(t.Sound.sounds.dialog.confirmClosing)},this.cancel=function(){t.Sound.play(t.Sound.sounds.click.button),e.close("cancel"),t.Sound.play(t.Sound.sounds.dialog.confirmClosing)},this.close=function(t){this._closing||(i=void 0,this._closing=!0,e.el.transition({y:0},300).transition({y:100,opacity:0}).promise().then(function(){e.el.hide().css({opacity:""})}),e.el.parent().removeClass("modal"),e.onClose(t))},this.onClose=function(){i=void 0}}var i;return $(document).keydown(function(e){i&&(13==e.keyCode?i.done():27==e.keyCode&&i.cancel())}),n.prototype.activate=function(e){e&&(this.modal=e.modal||this.modal,this.duration=e.duration||this.duration,this.content=e.content||this.content,this.doneText=e.doneText||this.doneText,this.cancelText=e.cancelText||this.cancelText)},n.prototype.bindingComplete=function(e){this.el=$(".confirm",e).css({opacity:0,y:100}),this.modal&&this.el.parent().addClass("modal"),this.__dialog__.settings.bindingComplete(e)},n.prototype.load=function(){var e=this;t.Sound.play(t.Sound.sounds.dialog.confirm),e.el.addClass("transit0-25").css({y:0,opacity:1}),e.el.one($.support.transitionEnd,function(){e.el.css({y:10},200),e.el.one($.support.transitionEnd,function(){e.el.removeClass("transit0-25")})})},n.prototype.canDeactivate=function(){var e=this;return $.Deferred(function(t){e.el&&(e.close(),e.el.promise().then(function(){t.resolve(!0)}))}).promise()},n.prototype.attributes={fixed:!0,singleton:!0},n}),n("dialogs/templates/control",["durandal/app"],function(){function e(){this.nWords=ko.observable()}return e.prototype.activate=function(e){this.content=e.content||"",this.left=e.left||0,this.top=e.top||0,this.nWords(e.nWords),this.up=function(){var t=this.nWords();9>t&&(0==t&&(t=2),this.nWords(t+1),e.changed(this.nWords()))},this.down=function(){var t=this.nWords();t>3?(this.nWords(t-1),e.changed(this.nWords())):3==t&&(this.nWords(0),e.changed(0))},this.del=function(){e.changed(null),this.onClose()},this.cw=function(){e.changed("cw")}},e.prototype.attached=function(e){this.el=$(".control",e).css({left:this.left,top:this.top})},e.prototype.canDeactivate=function(){return $.Deferred(function(e){e.resolve(!0)})},e}),n("dialogs/templates/loading",["durandal/app","api/datacontext"],function(e,t){function n(){this.loadingStatus=t.loadingStatus,this.loading=t.loading,this.box=t.loadingBox,this.duration=400}return n.prototype.activate=function(){},n.prototype.binding=function(e){this.el=$(".loading",e)},n.prototype.bindingComplete=function(e){this.el=$(".loading",e),$(".block",this.el).css({scale:.5,opacity:0})},n.prototype.attributes={fixed:!0,singleton:!0},n.prototype.compositionComplete=function(t){this.el=$(".loading",t),e.inlineLoading(!0),this.el.css({top:($(window).innerHeight()-this.el.outerHeight())/2-150}),$(".block",this.el).css({opacity:1,scale:1})},n.prototype.canDeactivate=function(){return $.Deferred(function(t){e.inlineLoading(!1),t.resolve(!0)}).promise()},n}),n("dialogs/templates/menu",["durandal/app","plugins/router"],function(e,t){function n(){this.images=!0;var n=this;this.close=function(e){if(console.log(e),n.el.is(":visible")){e=e||500;var t=n.el.transition({x:-10},e/2,"ease").transition({x:100,opacity:0},e).promise().then(function(){n.el.css({x:0}).hide()});return n.el.parent().removeClass("modal"),t}return n.el.promise()},this.onClose=function(){},this.items=i,this.nav=function(n){e.Sound.play(e.Sound.sounds.click.button),n.click?n.click():t.navigate(n.hash)}}var i=[{text:"New Game",hash:"newGame",icon:"mi-new"},{text:"Shop",hash:"shop",icon:"mi-shop"},{text:"My Games",hash:"lobby",icon:"mi-lobby"},{text:"My Poems",hash:"poems",icon:"mi-poems"},{text:"settings",hash:"settings",icon:"mi-settings"},{text:"tutorial",hash:"tutorial/new",icon:"mi-tutorial"},{text:"help",click:function(){e.loading(!0),e.dialog.show("panel",{module:"account/l-faq",fixed:!0,css:"wide"},{compositionComplete:function(){e.loading(!1)}})},icon:"mi-help"},{text:"Logout",hash:"account/logout",icon:"mi-logout"}];return"niklas"==e.ctx.username&&i.push({text:"sound",hash:"sound"}),n.prototype.attributes={fixed:!0,singleton:!0},n.prototype.activate=function(){},n.prototype.bindingComplete=function(e){this.el=$(".menu",e).hide(),this.__dialog__.settings.bindingComplete(e)},n.prototype.load=function(){e.Sound.play(e.Sound.sounds.dialog.menu);this.el.show().css({x:100,opacity:0,top:"100px"}).transition({x:-10,opacity:1},400,"ease").transition({y:0},300)},n.prototype.canDeactivate=function(){return this.close(200)},n}),n("dialogs/templates/notice",["durandal/app"],function(e){function t(){this.modal=!1,this.model={},this.view="",this.images=!0,this.css="",this.dfd1=$.Deferred(),this.dfd2=$.Deferred();var t=r=this;this.close=function(){e.Sound.play(e.Sound.sounds.dialog.closing),o=o||500;var n=t.el.transition({y:10},o/2,"ease").transition({y:-100,opacity:0},o).promise().then(function(){t.el.css({y:0,display:"none"})});if(t.onClose){var i=arguments;n.then(function(){t.onClose.apply(t,i)})}return r=null,n},e.off("notice:close"),e.on("notice:close",function(){t.close()})}function n(e){if(e.data("centered")){var t=window.innerHeight,n=(t-e.outerHeight())/2;0>n&&(n=0),e.transition({y:n,scale:.99})}}var i,o=400,r=null;return $(document).keydown(function(e){r&&27==e.keyCode&&r.close()}),t.prototype.activate=function(t){this.modal=t.modal||this.modal,this.view=t.view,this.model=t.model||{},this.css=t.css,this.closeOnClick=void 0==t.closeOnClick?!0:t.closeOnClick,this.centered=t.centered||!1,this.model.close=this.close;var i=this;$.when(this.dfd1,this.dfd2).then(function(){e.Sound.play(e.Sound.sounds.dialog.notice),i.centered?(i.el.css({top:0}).data("centered",!0).show(),n(i.el)):i.el.show().css({y:0,opacity:0,scale:.8}).transition({scale:1.1,opacity:1},400,"ease").transition({scale:1},300,"ease")})},t.prototype.bindingComplete=function(e){i=this.el=$(".notice",e).hide(),this.__dialog__.settings.bindingComplete(e)},t.prototype.load=function(){this.dfd1.resolve()},t.prototype.compositionComplete=function(){this.dfd2.resolve()},t.prototype.canDeactivate=function(){var e=this;return i=null,$.Deferred(function(t){e.el?e.el.promise().then(function(){t.resolve(!0)}):t.reject()}).promise()},e.on("dialog:adjust-size",function(){i&&n(i)}),e.on("app:resized:hook",function(){i&&n(i)}),t}),n("dialogs/templates/panel",["durandal/app"],function(e){function t(){if(n){var e=window.innerHeight,t=(e-n.outerHeight())/2;0>t||(n.css({y:t}),setTimeout(function(){$("input[autofocus]").focus()},0))}}var n,i;return{activate:function(n){n&&("string"!=typeof n?(this.modelName(n.module),this.modal=!0,this.css=n.css):(this.modal=!1,this.modelName(n),this.css=""),i=e.on("app:resized:hook").then(t))},bindingComplete:function(e){$(".panel",e).hide();return{cacheViews:!1}},compositionComplete:function(t){n=this.el=$(".panel",t);var i=window.innerHeight,o=(i-n.outerHeight())/2;n.css({y:o}).show(),n.css({y:o-100,opacity:0}).transition({y:o+10,opacity:1}).transition({y:o}),e.Sound.play(e.Sound.sounds.dialog.login)},canDeactivate:function(){return i.off(),this.el?this.el.fadeOut("fast").promise():!0},modelName:ko.observable(),loading:e.loading,attributes:{fixed:!1,singleton:!0}}}),n("dialogs/templates/slipper-fixed",["durandal/app"],function(e){function t(){this.heading="",this.content="",this.images=!0;var e=this;this.close=function(t){if(t=t||500,!e.el)return $.Deferred(function(e){e.resolve()});var n=e.el.transition({y:10},t/2,"ease").transition({y:-100,opacity:0},t).promise().then(function(){e.el.css({y:0,display:"none"})});return e.el.parent().removeClass("modal"),n},this.collapse=function(t,n){n.preventDefault(),n.stopPropagation(),e.el.toggleClass("minimized")},this.onClose=function(){}}return t.prototype.attributes={fixed:!1,singleton:!0},t.prototype.activate=function(e){this.heading=e.heading,this.content=e.content,e.modal===!0&&this.el.parent().addClass("modal")},t.prototype.bindingComplete=function(e){this.el=$(".slipper",e).hide(),this.__dialog__.settings.bindingComplete(e)},t.prototype.load=function(){e.Sound.play(e.Sound.sounds.dialog.slipper);var t=this;this.el.show().css({y:-100,display:"block",opacity:0}).transition({y:10,opacity:1},500,"ease").transition({y:0},300),setTimeout(function(){t.el.addClass("minimized")},5e3)},t.prototype.canDeactivate=function(){return this.close(200)},t}),n("dialogs/templates/slipper-profile",["durandal/app","api/context/user"],function(e,t){function n(){this.owner=!1,this.level=ko.observable(),this.xp=ko.observable(),this.xpMax=ko.observable(),this.username=ko.observable(),this.title=ko.observable(""),this.isFriend=ko.observable(!1),this.images=!0;var n=this;this.close=function(e){e=e||500;var t=n.el.transition({y:10},e/2,"ease").transition({y:-100,opacity:0},e).promise().then(function(){n.el.css({y:0,display:"none"})});return n.el.parent().removeClass("modal"),t},this.onClose=function(){},this.addFriend=function(n,i){if(i.stopPropagation(),!this.isFriend()&&!this.owner){this.isFriend(!0),e.Sound.play(e.Sound.sounds.click.button);var o=this;t.friends.add(o.username()).then(function(t){e.dialog.show("alert",{content:t.success?o.username()+" is now your friend.":"Oh, Something went wrong!"})})}},this.removeFriend=function(n,i){if(i.stopPropagation(),!this.isFriend()&&!this.owner){e.Sound.play(e.Sound.sounds.click.button);var o=this;t.friends.del(o.username()).then(function(t){e.dialog.show("alert",{content:t.success?o.username()+" has been unfriended.":"Oh, Something went wrong!"})})}},this.blockUser=function(n,i){if(i.stopPropagation(),!this.isFriend()&&!this.owner){e.Sound.play(e.Sound.sounds.click.button);var o=this;e.dialog.confirm("Are you sure you want to block <b>"+o.username()+"</b>? <br> "+o.username()+" will not be able to start a game with you anymore!",{doneText:"YES",cancelText:"NO",modal:!0}).then(function(){t.block.add(o.username()).then(function(t){t.success&&o.isFriend(!0),e.dialog.show("alert",{content:t.success?o.username()+" has been blocked.":"Oh, Something went wrong!"}),t.success?e.navigate("lobby"):o.isFriend(!1)})})}}}return n.prototype.attributes={fixed:!0,singleton:!0},n.prototype.activate=function(n){var i=this;n&&n.username&&n.username!=e.ctx.username?(this.owner=!1,e.trigger("server:user:info",{username:e.ctx.username,targetUsername:n.username},function(e){i.level(e.level),i.xp(e.xp),i.xpMax(e.xpMax),i.username(e.username),i.title(e.title),i.isFriend(t.friends.has(e.username))})):(t.refresh(),this.owner=!0,this.level=t.level,this.xp=t.xp,this.xpMax=t.xpMax,this.username=t.username,this.title=t.title)},n.prototype.bindingComplete=function(e){this.el=$(".profile",e).hide(),this.__dialog__.settings.bindingComplete(e)},n.prototype.load=function(){e.Sound.play(e.Sound.sounds.dialog.slipper),this.el.show().css({y:-100,display:"block",opacity:0}).transition({y:10,opacity:1},500,"ease").transition({y:0},300)},n.prototype.canDeactivate=function(){return this.close(200)},n}),n("dialogs/templates/slipper",["durandal/app"],function(e){function t(){this.heading="",this.content="",this.images=!0;var e=this;this.close=function(t){t=t||500;var n=e.el.transition({y:10},t/2,"ease").transition({y:-100,opacity:0},t).promise().then(function(){e.el.css({y:0,display:"none"})});return e.el.parent().removeClass("modal"),n},this.collapse=function(t,n){n.preventDefault(),n.stopPropagation(),e.el.toggleClass("minimized")},this.onClose=function(){}}return t.prototype.attributes={fixed:!0,singleton:!0},t.prototype.activate=function(e){this.heading=e.heading,this.content=e.content,e.modal===!0&&this.el.parent().addClass("modal")},t.prototype.bindingComplete=function(e){var t=this;t.el=$(".slipper",e).hide(),this.__dialog__.settings.bindingComplete(e)},t.prototype.load=function(){e.Sound.play(e.Sound.sounds.dialog.slipper),this.el.show().css({y:-100,opacity:0}).transition({y:10,opacity:1},500,"ease").transition({y:0},300)},t.prototype.canDeactivate=function(){return this.close(200)
},t}),n("dialogs/templates/tutorial",["durandal/app","api/helper/draggable"],function(e){function t(){this.heading="",this.content="",this.css="";var t=this;this.onChange=e.on("dialog:data:changed").then(function(e){t.activate(e),t.el&&t.el.transition({top:t.top,left:t.left})}),this.close=function(){return t.onChange.off(),e.Sound.play(e.Sound.sounds.dialog.helpClosing),$.Deferred(function(e){e.resolve()})},this.onClose=function(){}}return t.prototype.activate=function(e){this.heading=e.heading,this.content=e.content,this.left=e.left||0,this.top=e.top||0,this.css=e.css||"",this.attributes.fixed=e.fixed||!1},t.prototype.attached=function(t){this.el=$(".tutorial",t),e.Sound.play(e.Sound.sounds.dialog.help),this.el.css({x:100,opacity:0,top:this.top,left:this.left}).transition({x:-10,opacity:1},500,"ease").transition({x:0},300).promise().then(function(){this.css({x:0})})},t.prototype.canDeactivate=function(){return this.close()},t.prototype.attributes={fixed:!1,singleton:!0},t}),n("dialogs/templates/window",["durandal/app","api/helper/draggable.static"],function(e){function t(){this.heading="",this.content="";var t=this;this.close=function(){return $.Deferred(function(n){return t.el?(t.draggable&&t.el.data("draggable").dispose(),e.Sound.play(e.Sound.sounds.dialog.helpClosing),void t.el.animate({height:0,opacity:0},250).promise().then(function(){$(this).hide(),n.resolve()})):void n.resolve()})},this.onClose=function(){}}return t.prototype.activate=function(e){this.heading=e.heading,this.content=e.content,this.left=e.left||0,this.top=e.top||0,this.draggable=void 0===e.draggable?!0:e.draggable;var t=$(window).innerWidth();t-this.left<300&&(this.left=t-350)},t.prototype.bindingComplete=function(e){this.el=$(".window",e),this.el.css({x:100,opacity:0,top:this.top,left:this.left})},t.prototype.compositionComplete=function(t){this.el=$(".window",t),this.left=($(window).innerWidth()-this.el.outerWidth())/2,this.top+=document.getElementById("app").scrollTop,e.Sound.play(e.Sound.sounds.dialog.help),this.el.css({x:100,opacity:0,top:this.top,left:this.left}).transition({x:-10,opacity:1},500,"ease").transition({x:0},300).promise().then(function(){this.css({x:0})}),this.draggable&&this.el.draggableStatic({usePercentage:!1,topLimit:!0,withinEl:$("#app")})},t.prototype.canDeactivate=function(){return this.close(200)},t}),n("error/not-found",[],function(){return{}}),n("game-editor/Tile",["api/datacontext","api/constants","api/model/Path"],function(e,t,n){var i=function(n,i,o,r){this.id=n,this.x=i||.5,this.y=o||.5,this.imageName=t.bigImageURL("woz",n),this.imageId=n,this.instruction="tile image",this.angle=ko.observable(r||0),this.info=n;var a=this;this.rest=ko.computed(function(){var t=e.paths(),n=e.tiles();return ko.utils.arrayFilter(n,function(e){if(e.id==a.id)return!1;for(var n=0,i=0;i<t.length;i++){var o=t[i];(o.startTile.id==a.id&&o.endTile.id==e.id||o.startTile.id==e.id&&o.endTile.id==a.id)&&n++}return 4>n})})},o=0;return i.prototype.addPath=function(t,i,r,a,s){if(this.id!=t.id&&(this.x!=t.x||this.y!=t.y)){var l;a=void 0!==a?a?1:0:null!=(l=ko.utils.arrayFirst(e.paths(),function(e){return console.log(e,this.id,t.id),e.startTile.id==this.id&&e.endTile.id==t.id||e.startTile.id==t.id&&e.endTile.id==this.id},this))&&l.cw?0:1,startTile=t.x<this.x?t:this,endTile=t.x>this.x?t:this,r=void 0===r?3:r;var c=new n(e,o++,r,startTile.id,endTile.id,a,s);e.paths.push(c)}},n.prototype.onLeave=function(){app.dialog.close("control")},n.prototype.onEnter=function(t){var n=this;app.dialog.show("control",{left:t.x,top:t.y,nWords:n.nWords,changed:function(t){if("cw"==t)n.cw^=1,n.phrase.words.valueHasMutated();else{if(null==t){var i=e.paths.indexOf(n);return app.dialog.close("control"),n.onEnter=n.onLeave=null,n.dispose(),void e.paths.splice(i,1)}if(0==t&&n.nWords>0||t>0&&0==n.nWords){var i=e.paths.indexOf(n);return app.dialog.close("control"),n.onEnter=n.onLeave=null,n.dispose(),e.paths.splice(i,1),void n.startTile.addPath(n.endTile,null,t,n.cw,n.phrase.words())}n.nWords=t,n.phrase.words.valueHasMutated()}}})},i}),n("game-editor/_server",["api/server/connection"],function(e){e.addEmission("manager:boards")}),n("game/canvas/vm/Box",["durandal/app","api/datacontext","paper"],function(e,t){function n(e,t,n,i){var o=this;o.index=e,o.active=!1,o.cPoint=n||r,o.angle=i||0,o.prevAngle=0,o.scale=1,o.prevScale=1,o.isCircle=!1,o.isButton=!1,o._guiRect=null,o._guiElem=null,o.pathModel=o.wordModel=o.hasData=null,this.updateModel(t)}var i=paper,o=new i.Color(0,0),r=new i.Point(-100,-100);return n.prototype.button=function(e){this.hasData=!0,this.isButton=!0,this.isCircle=!1,this.pathModel=e},n.prototype.hideIfEmpty=function(){!this.hasData&&this._guiRect&&this._guiRect.hide()},n.prototype.showIfEmpty=function(){!this.hasData&&this._guiRect&&this._guiRect.show()},n.prototype.updateModel=function(e){if(void 0!==e&&null!=e&&(this.pathModel=e,this.wordModel=e.getWordAt(this.index),this.hasData=null!=this.wordModel,this.isCircle=0==e.nWords,this.hasData)){if(!this.pathModel.cPoint)return;var t=this.wordModel.lastBox;t&&t!=this&&t.pathModel.removeWordAt(t.index,{keepUnplayed:!0}),this.wordModel.lastBox=this,this.show()}},n.prototype.show=function(){this.hasData?(this.active=!1,null!=this._guiRect&&(this._guiRect.remove(),this._guiRect=null),this.isButton?null==this._guiElem?this.createBtn():this.updateBtn():(this.prevAngle=0,null==this._guiElem?this.createElem():this.updateElem())):(null!=this._guiElem&&(this._guiElem.remove(),this._guiElem=null),null==this._guiRect?this.createRect():this.updateRect())},n.prototype.scaledWidth=function(){return this.width()*this.scale},n.prototype.width=function(){return this.hasData&&this._guiElem?this._guiElem.outerWidth():this.isCircle?2*n.options.circle.radius:60},n.prototype.height=function(){return this.hasData&&this._guiElem?this._guiElem.outerHeight():this.isCircle?n.options.circle.radius:23},n.prototype.enter=function(e){return this.hasData||null==e||""!=t.mode()||0!=t.gameOver()?null:(this.wordModel=e,this.active=!0,clearInterval(this._hoverHandler),this._hoverHandler=setTimeout(function(e){e._guiRect&&e._guiRect.addClass("hover")},1,this),this)},n.prototype.leave=function(){!this.hasData&&this.active&&(this.active=!1,clearInterval(this._hoverHandler),this._hoverHandler=setTimeout(function(e){e._guiRect&&(e._guiRect.removeClass("hover"),e.isCircle||e._guiRect.children(".box").text(""))},1,this))},n.prototype.drop=function(){this.active&&!this.hasData&&null!=this.wordModel&&(this.pathModel.addWord(this.wordModel,this.index)||e.dialog.show("alert",{content:"It's not your turn!"}))},n.prototype.put=function(e){if(!this.hasData&&null!=e.obsWords()){var t=this.pathModel.nWords,n=e.obsWords();if(n.length==t)for(var i=0;i<n.length;i++)this.pathModel.addWord(n[i],i+1)}},n.prototype.updateBtn=function(){var e={x:this.cPoint.x-n.pathOptions.container.left-this._guiElem.outerWidth()/2,y:this.cPoint.y-n.pathOptions.container.top-this._guiElem.outerHeight()/2},t=this._guiElem.find(".button");this.scale*=.5;var i=this._guiElem;i.css(e),t.transition({scale:this.scale,rotate:this.angle},500,"ease").promise().then(function(){i.addClass("ready")})},n.prototype.createBtn=function(){{var t=$("<div/>",{"class":"confirm-box"}),i=this;this.pathModel.cw?" cw":""}t.append($("<div/>",{"class":"button",title:"Done!"})),t.css({x:this.pathModel.cPoint.x-n.pathOptions.container.left,y:this.pathModel.cPoint.y-n.pathOptions.container.top}),t.prependTo("#tiles"),t.find(".button").one("click",this,function(){n.options.animate=!0,i.pathModel.phrase._complete(!0),i.pathModel.phrase.words.valueHasMutated(),n.options.animate=!1}).transition({rotateY:"360deg"},500,"ease"),this.width=function(){return t.outerWidth()/2},null!=this._guiElem&&this._guiElem.remove(),this._guiElem=t,this.updateBtn(),setTimeout(function(){e.trigger("game:bubble","dynamicSubmit")},100)},n.prototype.updateElem=function(){this.pathModel.phrase.complete.immediate()&&(this._guiElem.find(".magnet").addClass("complete"),this._guiElem.off("click")),this._guiElem.find(".magnet").text(this.wordModel.lemma);var e={x:this.cPoint.x-n.pathOptions.container.left-this._guiElem.outerWidth()/2,y:this.cPoint.y-n.pathOptions.container.top-this._guiElem.outerHeight()/2,rotate:this.angle+"deg"};e.scale=.8*this.scale,this._guiElem.stop(),this._guiElem.transition(e,300,"ease")},n.prototype.createElem=function(){this.wordModel._noPlaceSound||e.Sound.play(e.Sound.sounds.word.place);var i,o=$("<div/>",{"class":"magnet-placeholder elem"});if(this.pathModel.phrase.complete.immediate()||!this.wordModel.$el)i=$("<div/>",{"class":"magnet",text:this.wordModel.lemma}),this.wordModel.isRelated&&i.addClass("related");else{i=this.wordModel.$el.clone().show(),i.css({left:0,top:0});var r=this.wordModel,a=this.pathModel,s=(this.index,this);o.data("immovable",function(){return a.phrase.complete.immediate()}),o.draggable({noTask:!0,usePercentage:!1,centerBased:!1,withinEl:$("#app"),dragStart:function(n,i){if(e.Sound.play(e.Sound.sounds.word.lift),!a.phrase.complete.immediate()){t.activeWord(r),r.tX=o.css("x"),r.tY=o.css("y"),o.css({rotate:0,scale:1,x:0,y:0,left:r.tX,top:r.tY});var s=$("#tiles").offset().left,l=$("#tiles").offset().top;i.l-=s,i.r-=s,i.t-=l,i.b-=l}},dropped:function(n,i){if(!a.phrase.complete.immediate())if(t.activeWord(null),-.5<s.angle&&s.angle<.5&&(s.angle=0),o.addClass("noTransition").css({rotate:s.angle,scale:.8,left:0,top:0,x:r.tX,y:r.tY}),setTimeout(function(){o.removeClass("noTransition")},0),i.hasMoved){var l=$("#workspace").offset();if(i.top-=i.within.t,i.left-=i.within.l,l.top<i.top+20){var c=$("#workspace").innerWidth(),u=$("#workspace").innerHeight();r.originalY=1*((i.top-l.top)/u).toFixed(4),r.originalX=1*((i.left-l.left)/c).toFixed(4),r.originalX<0&&(r.originalX=0),r.originalY<0&&(r.originalY=0),e.trigger("server:game:move-word",{username:t.username,gameID:t.gameID,word:{id:r.id,x:r.originalX,y:r.originalY}}),e.Sound.play(e.Sound.sounds.word.placeBack),a.removeWordAt(s.index)}else e.Sound.play(e.Sound.sounds.word.place)}else e.Sound.play(e.Sound.sounds.word.placeBack),a.removeWordAt(s.index)}})}i.addClass("placed"),o.css({x:this.pathModel.cPoint.x-n.pathOptions.container.left,y:this.pathModel.cPoint.y-n.pathOptions.container.top,scale:.8}),o.appendTo("#tiles"),i.appendTo(o),null!=this._guiElem&&this._guiElem.remove(),this._guiElem=o,this.updateElem()},n.prototype.updateRect=function(){this._guiRect.css({x:this.cPoint.x-n.pathOptions.container.left-this._guiRect.outerWidth()/2,y:this.cPoint.y-n.pathOptions.container.top-this._guiRect.outerHeight()/2,rotate:this.angle,scale:this.scale})},n.prototype.createRect=function(){var e=$("<div/>",{"class":"magnet-placeholder"}),t=this.isCircle?"circle":"box";e.append($("<div/>",{"class":t})),e.css({x:this.pathModel.cPoint.x-n.pathOptions.container.left,y:this.pathModel.cPoint.y-n.pathOptions.container.top,zIndex:0}),e.appendTo("#tiles"),this._guiRect=e,this.updateRect()},n.prototype._clear=function(){this._guiRect&&this._guiRect.remove(),this._guiElem&&this._guiElem.remove(),this._guiElem=null,this._guiRect=null},n.prototype.remove=function(){this._clear()},n.options={animate:!1,rect:{style:{strokeColor:"#CBB28F",strokeWidth:1,fillColor:o,shadowColor:o},activeStyle:{strokeWidth:2,shadowColor:"#CBB28F",shadowBlur:5,shadowOffset:new i.Point(0,0)},size:new i.Point(30,15)},circle:{radius:8,margin:16,width:23,style:{fillColor:"#CBB28F",shadowBlur:0,strokeWidth:0},activeStyle:{strokeWidth:2,strokeColor:"#CBB28F",shadowBlur:20,shadowColor:"#CBB28F",shadowOffset:new i.Point(0,0)}},textStyle:{fillColor:"grey",justification:"center",fontSize:14,font:"CopseRegular"}},n}),n("game/canvas/vm/Path",["durandal/app","api/datacontext","game/canvas/vm/Box","paper"],function(e,t,n){function i(e){this._displayItems=[],this._trash=[],this.pathModel=e}var o=t.activeWord,r=t.activeWords,a=new paper.Color(0,0),s=null;return o.subscribe(function(e){null==e&&null!=s&&s.drop()}),i.activePath=null,i.prototype.isActive=!1,i.prototype.leavingHandler=0,i.prototype.enter=function(){var e=null!=r(),t=this.pathModel;if(e){var n=r();if(n.length!=t.nWords)return;for(var o=0;o<t.guiBoxes.length;o++)t.guiBoxes[o].enter(n[o])}else t&&t.onEnter&&(this.isActive||(i.activePath&&i.activePath!=this&&(i.activePath.isActive=!1),this.isActive=!0,i.activePath=this,t.onEnter(this.midPath)),this.leavingHandler&&(clearTimeout(this.leavingHandler),this.leavingHandler=0))},i.prototype.leave=function(){var e=this.pathModel;if(null!=r()){var t=r();if(t.length!=e.nWords)return;for(var n=0;n<e.guiBoxes.length;n++)e.guiBoxes[n].leave()}else e&&e.onLeave&&(this.leavingHandler&&clearTimeout(this.leavingHandler),this.leavingHandler=setTimeout(function(t){t.isActive&&(t.isActive=!1,e.onLeave(),i.activePath==t&&(i.activePath=null))},1,this))},i.prototype._canPut=!0,i.prototype.put=function(){if(this._canPut&&null!=r()&&!t.gameOver()){this._canPut=!1,setTimeout(function(e){e._canPut=!0},500,this);var n=r(),i=this.pathModel;if(n.length!=i.nWords)return void(n.length>i.nWords?(e.Sound.play(e.Sound.sounds.action.functionFailed),e.dialog.show("alert",{content:"too many words"})):(e.Sound.play(e.Sound.sounds.action.functionFailed),e.dialog.show("alert",{content:"need more words"})));r(null);for(var o=0;o<i.guiBoxes.length;o++)i.addWord(n[o],o)}},i.prototype.events={boxHoverEvents:{mouseenter:function(e){s=this.data.enter(o()),this.data.pathModel.canvas.enter(e)},mouseleave:function(){this.data.leave(),this.data.pathModel.canvas&&this.data.pathModel.canvas.leave()},mousedown:function(){this.data.pathModel.canvas.put()}}},i.prototype.dispose=function(){this.remove(),this._removeAll(this.pathModel.guiBoxes),delete this.pathModel.guiBoxes},i.prototype.setup=function(){console.log("%cPath Setup","background: orange; color: white",this.pathModel.id);var e=this.pathModel,t=e.nWords;if(0==e.nWords&&(t=6),e.guiBoxes&&e.guiBoxes.length==t)for(var i=0;t>i;i++){var o=e.guiBoxes[i];o.updateModel(e)}else if(e.guiBoxes)if(e.guiBoxes.length>t)e.guiBoxes[t].remove(),e.removeWordAt(t),e.guiBoxes.splice(t,1);else{var o=new n(t-1,e);e.guiBoxes.push(o),this._displayItems.push(o)}else{e.guiBoxes=[];for(var i=0;t>i;i++){var o=new n(i,e);e.guiBoxes.push(o),this._displayItems.push(o)}}},i.prototype.show=function(){console.log("%cPath","background: orange; color: white",this.pathModel.id+" is being drawn");var e=this.pathModel,t=e.nWords;if(null!=e.guiBoxes){this._cleanCycle();var n=i.getDesiredLength(e.guiBoxes);path=i.getBestArc(e.startTile.center,e.endTile.center,n,e.cw,t),this.midPath=path.getPointAt(path.length/2);for(var o=path.length-n,r=path.length-2*(i.options.tileMargin+i.options.tileRadius),a=n-2*(i.options.tileMargin+i.options.tileRadius),s=i.options.tileRadius+i.options.tileMargin,l=s,c=0;t>c;c++){var u,d=e.guiBoxes[c];d.scale=o>=0?1:r/a,u=d.scaledWidth()/2+i.options.rectMargin+(o>0?o/(2*t):0),l+=u;var p=path.getPointAt(l),h=path.getTangentAt(l),f=0,g=path.getNormalAt(l).normalize((e.cw?1:-1)*f),m=this.createHoverArea(path,l,d.scaledWidth()+2*i.options.rectMargin+(o>0?o/t:0));m.data=d,l+=u,d.cPoint=p.add(g),d.angle=h.angle,d.show(),i.options.debug&&(m.strokeColor="lightgreen")}if(i.options.debug){this._trash.push(path);for(var c=0;c<i._trash.length;c++)this._trash.push(i._trash[c]);i._trash=[]}else path.remove();paper.view.draw()}},i.prototype.createHoverArea=function(e,t,n){var o=t-n/2,r=e.getPointAt(o),s=e.getNormalAt(o).normalize(i.options.hoverMargin),l=t+n/2,c=e.getPointAt(l),u=e.getNormalAt(l).normalize(i.options.hoverMargin),d=new paper.Path(r.add(s),r.subtract(s),c.subtract(u),c.add(u));return d.closePath(),d.fillColor=a,d.on(this.events.boxHoverEvents),this._trash.push(d),d},i.prototype._cleanCycle=function(){this._removeAll(this._trash),this._trash=[],i.options.debug&&i._clear()},i.prototype._removeAll=function(e){if(null!=e)for(var t=0;t<e.length;t++)e[t].remove()},i.prototype.remove=function(){this._removeAll(this._trash),this._removeAll(this._displayItems),this._displayItems=[],this._trash=[]},i._trash=[],i.getBestArc=function(e,t,n,o,r,a){var s=t.subtract(e).length,l=i.options.minArc*(r/2),c=i.options.maxArc*(r/3),u=new paper.Path.Line(e,t),d=u.getPointAt(u.length/2),p=u.getNormalAt(u.length/2);u.remove(),s>550&&(c*=550/s,l=i.options.minArc*(r/4)),c>150&&(c=150),c=30*r,l=c-40,u=new paper.Path.Line(d.subtract(p.normalize(-l*(o?1:-1))),d.subtract(p.normalize(-c*(o?1:-1))));var h,f=0,g=u.length,m=1e4,v=u.length/2;a=a||10;for(var b=0;a>b;b++,v/=2){var y=u.getPointAt((f+g)/2),w=new paper.Path.Arc(e,y,t);Math.abs(w.length-n)<m?(h&&h.remove(),m=Math.abs(w.length-n),h=w):w.remove(),w.length>n?g-=v:f+=v}if(i.options.debug){var k=new paper.Path.Circle(d,5);k.fillColor="orange",u.strokeColor="orange",u.strokeWidth=2,h.strokeColor="grey",i._trash.push(k),i._trash.push(u)}else u.remove();return h},i.getDesiredLength=function(e,t){for(var n=2*(i.options.tileMargin+i.options.tileRadius),o=0;o<(t||e.length);o++)n+=e[o].width()+2*i.options.rectMargin;return n},i._clear=function(){for(var e=0;e<i._trash.length;e++){var t=i._trash[e];t.remove()}i._trash=[]},i.options={tileRadius:80,tileMargin:10,hoverMargin:48,rectMargin:0,minArc:33,maxArc:99,debug:0,container:null},i.Box=n,i.Box.pathOptions=i.options,i}),n("game/canvas/vm/confirm-box",["./Path","./Box"],function(e){var t=paper,n=function(e){this._trash=[],this.hide=function(){for(var e=0;e<this._trash.length;e++)this._trash[e].remove()},t=e};return n.prototype.events={mouseenter:function(){this.style={shadowColor:"#b8b0a3",shadowBlur:3,shadowOffset:new t.Point(0,0)}},mouseleave:function(){this.style={shadowBlur:0}},mousedown:function(){}},n.prototype.show=function(e){this.hide(),this.showDoneCenter(e)},n.prototype.showBox=function(n,i){for(var o,r=0;r<i.length&&i[r].hasData;r++)o=i[r];var a=o.cPoint.add(n.getNormalAt(n.length/2).normalize(-60)).add([50,0]),s=this.createDoneContainer(),l=this.createDoneButton(new t.Point(0,0));s.position=a,l.position=a.add([0,15]);var c=new t.PointText({point:a.add([0,-15]),content:"Are you done?"});c.style=e.Box.options.textStyle,c.fontSize=12,c.fillColor="black",this._trash.push(c)},n.prototype.createDoneContainer=function(){var e=new t.Point(60,40),n=new t.Path.Rectangle(e.negate(),e);return this._trash.push(n),n.style={fillColor:"white",strokeColor:"#e8e0d3",shadowColor:"#b8b0a3",shadowBlur:5,shadowOffset:new t.Point(1,1)},n.bringToFront(),n},n.prototype.showDoneCenter=function(e){var t=50,n=e.length/2,i=e.getNormalAt(n).normalize(t),o=e.getPointAt(n).add(i),r=this.createDoneButton(o);r.rotate(e.getTangentAt(n).angle,o),this._trash.push(r)},n.prototype.createDoneButton=function(n){var i=new t.Group,o=new t.Point(30,15),r=new t.Path.Rectangle(n.subtract(o),n.add(o));r.strokeColor="#e8e0d3",r.fillColor="orange",r.strokeWidth=2;var a=new t.PointText({point:n,content:"Done"});return a.style=e.Box.options.textStyle,a.fillColor="white",a.position.y+=4,a.characterStyle.fontStyle="bold",i.addChild(r),r=r.clone(),i.addChild(r),i.addChild(a),r.fillColor=new t.Color(0,0),r.bringToFront(),r.on(this.events),this._trash.push(i),i},n}),n("game/canvas/vm/DynamicPath",["api/datacontext","./Box","./Path","./confirm-box","paper"],function(e,t,n){function i(e){var t=this;this.pathModel=e,this.activeWord=null,this.activeWords=null,this.events={mouseenter:function(){if(null!=o()){for(var e=t.pathModel.guiBoxes,n=o(),i=0;i<e.length;i++)e[i].enter(n);a=t,t.activeWord=n}else if(null!=r()){var s=r();if(s.length>=3&&s.length<=6){for(var e=t.pathModel.guiBoxes,i=0;i<e.length;i++)e[i].enter({});a=t,t.activeWords=s}}else{var l=t.pathModel;l&&l.onEnter&&l.onEnter(t.midPath)}},mouseleave:function(){if(a==t){for(var e=t.pathModel.guiBoxes,n=0;n<e.length;n++)e[n].leave();a=null,t.activeWord=null,t.activeWords=null}else{var i=t.pathModel;i&&i.onLeave&&i.onLeave()}}},this.events.mousedown=function(e){null!=t.activeWord?(t.pathModel.addWord(t.activeWord),t.events.mouseleave(e)):null!=t.activeWords&&(t.pathModel.addWords(t.activeWords),t.events.mouseleave(e))},this.drop=function(){t.events.mousedown()},this.draw=this.show}var o=e.activeWord,r=e.activeWords,a=(new paper.Color(0,0),null);o.subscribe(function(e){null==e&&null!=a&&a.drop()});return i.prototype=new n,i.prototype.constructor=i,i.prototype.show=function(){console.log("%cDynamic Path","background: orange; color: white",this.pathModel.id+" is being drawn");var e=this.pathModel,i=6,o=e.phrase.words().length>=3&&!e.phrase.complete.immediate()&&e.phrase.words().length<6;o?(this.confirmBox||(this.confirmBox=new t(6,null),this.confirmBox.button(e),this.confirmBox.show()),e.guiBoxes.push(this.confirmBox),i++):this.confirmBox&&(this.confirmBox.remove(),delete this.confirmBox),e.phrase.complete.immediate()===!0?(i=e.phrase.words().length,this._hideCircles()):this._showCircles(),this._cleanCycle();var r=n.getDesiredLength(e.guiBoxes,i),a=n.getBestArc(e.startTile.center,e.endTile.center,r,e.cw,i);this.cPoint=n.cPoint,this.midPath=a.getPointAt(a.length/2);var s=a.length-r,l=a.length-2*(n.options.tileMargin+n.options.tileRadius),c=r-2*(n.options.tileMargin+n.options.tileRadius),u=n.options.tileRadius+n.options.tileMargin,d=u,p=new paper.Path;p.add(e.startTile.center);for(var h=0;i>h;h++){var f,g=ko.utils.arrayFirst(e.guiBoxes,function(e){return e.index==h});g.scale=s>=0?1:l/c,f=g.scaledWidth()/2+n.options.rectMargin+(s>0?s/(2*i):0),d+=f;var m=a.getPointAt(d),v=a.getNormalAt(d).normalize(n.options.hoverMargin/1.5);p.add(m.subtract(v)),p.insert(0,m.add(v)),d+=f,g.cPoint=m,g.angle=v.angle+90,g.scale=s>=0?1:a.length/r,g.show()}p.on(this.events),p.fillColor=new paper.Color(0,0),p.add(e.endTile.center),p.closePath(),this._trash.push(p),o&&e.guiBoxes.pop(),n.options.debug?(p.strokeColor="lightgreen",this._trash.push(a)):a.remove(),paper.view.draw()},i.prototype._hideCircles=function(){for(var e=0;e<this.pathModel.guiBoxes.length;e++)this.pathModel.guiBoxes[e].isCircle&&this.pathModel.guiBoxes[e].hideIfEmpty()},i.prototype._showCircles=function(){for(var e=0;e<this.pathModel.guiBoxes.length;e++)this.pathModel.guiBoxes[e].isCircle&&this.pathModel.guiBoxes[e].showIfEmpty()},i}),n("game/canvas/paths",["durandal/app","api/datacontext","game/canvas/vm/Path","game/canvas/vm/DynamicPath","paper"],function(e,t,n,i){function o(i){paper.dfd.promise().then(function(){console.log("UpdateModel");var o=$("#tiles"),a=o.parent();n.options.container={width:o.width(),height:o.height(),left:a.position().left,top:o.offset().top+parseInt(o.css("paddingTop"))+e.el.scrollTop},r(i);for(var s=t.paths(),l=0;l<s.length;l++){var c=s[l],u=c.startTile.center,d=c.endTile.center;c.cPoint=c.cPoint||new paper.Point,c.cPoint.x=(u.x+d.x)/2,c.cPoint.y=(u.y+d.y)/2}})}function r(e){function i(e,t){var i=new paper.Point;return i.x=n.options.container.width*e+n.options.container.left,i.y=n.options.container.height*t+n.options.container.top,i}e=e||t.tiles();for(var o=0;o<e.length;o++){var r=e[o];r.center=i(r.x,r.y)}}function a(e){paper.dfd.promise().then(function(){e.hasOwnProperty("canvas")||(e.canvas=0===e.nWords?new i(e):new n(e),s.call(e),e.canvasSub=e.phrase.words.subscribe(s,e),e.dispose=function(){console.log("%cPath Disposed","background: orange; color: white",e.id),e.canvasSub&&(e.canvasSub.dispose(),delete e.canvasSub),e.canvas&&(e.canvas.dispose(),delete e.canvas)})})}function s(){o();var e=this;paper.dfd.promise().then(function(){e.canvas.setup(),e.canvas.show()})}function l(e){console.log("paths setup"),paper.setup(e),paper.pathsCSize={w:$(e).width(),h:$(e).height()},p=e,paper.dfd.resolve()}function c(){var e=p.getContext("2d");e.canvas.width=$(p).width(),e.canvas.height=$(p).height(),o();for(var n=t.paths(),i=0;i<n.length;i++)n[i].canvas.show();paper.view.draw()}function u(){var e={w:$(p).width(),h:$(p).height()};paper.pathsCSize.w!=e.w||paper.pathsCSize.h!=e.h?(paper.pathsCSize=e,paper.setup(p),c(),console.log("resized occurred")):console.log("resized ignored")}function d(){console.log("paths disposed"),paper.dfd=$.Deferred()}var p;return e.on("app:resized").then(u),t.tiles.subscribe(function(e){t.paths().length&&o(e)}),t.paths.subscribe(function(e){for(var t=0;t<e.length;t++)a(e[t])}),paper.dfd=$.Deferred(),t.tiles().length&&t.tiles.notifySubscribers(t.tiles()),t.paths().length&&t.paths.notifySubscribers(t.paths()),e.on("game:tiles:update").then(r),e.on("app:force-resize").then(c),{setup:l,redraw:c,dispose:d}}),n("game/canvas",["api/datacontext","paper","game/canvas/paths"],function(e,t,n){function i(e){var t=e.getContext("2d");t.canvas.width=$(e).width(),t.canvas.height=$(e).height(),n.setup&&n.setup(e)}return{compositionComplete:function(e){i(e)},binding:function(){return{cacheViews:!1}},detached:function(){n.dispose()}}}),n("game-editor/edit",["durandal/app","durandal/system","plugins/router","api/datacontext","./Tile","./_server","game/canvas"],function(e,t,n,i,o){var r=0,a={words:[{id:17,angle:-3.7593988655135036,x:.66,y:.10304030562518166,isRelated:!1,lemma:"mmmmmm",points:4},{id:12,angle:-3.4063681517727673,x:.21,y:.10582611734513193,isRelated:!1,lemma:"mmmmm",points:1},{id:18,angle:-1.4734306372702122,x:.75,y:.09065341219073161,isRelated:!1,lemma:"ppppppppppppp",points:2},{id:8,angle:-1.205036765895784,x:.75,y:-.005974720227532089,isRelated:!1,lemma:"pppppppppp",points:1},{id:13,angle:2.648484369274229,x:.30000000000000004,y:.09659385376377032,isRelated:!1,lemma:"bb",points:4},{id:1,angle:2.1487802150659263,x:.12,y:-.0012193915154784917,isRelated:!1,lemma:"bb",points:4},{id:19,angle:.41890177642926574,x:.84,y:.10237198378425091,isRelated:!1,lemma:"bb",points:1},{id:10,angle:-4.26587772089988,x:.03,y:.10073526226216928,isRelated:!1,lemma:"ccc",points:4},{id:15,angle:.4335586610250175,x:.48,y:.09012758530676365,isRelated:!1,lemma:"ccc",points:3},{id:3,angle:.11435552965849638,x:.30000000000000004,y:.00413871304364875,isRelated:!1,lemma:"dddd",points:3},{id:6,angle:4.282350090797991,x:.5700000000000001,y:-.0017783761210739613,isRelated:!1,lemma:"dddd",points:1},{id:11,angle:4.6806065598502755,x:.12,y:.10505832111695781,isRelated:!1,lemma:"eeeee",points:3},{id:16,angle:4.599650478921831,x:.5700000000000001,y:.09557405668077991,isRelated:!0,lemma:"eeeee",points:1},{id:7,angle:-.7446857844479382,x:.66,y:-.000411419621668756,isRelated:!1,lemma:"gggggg",points:2},{id:2,angle:2.2331691347062588,x:.21,y:-.009482073495164514,isRelated:!1,lemma:"gggggg",points:3},{id:9,angle:.24570417124778032,x:.84,y:-.0014767247764393688,isRelated:!1,lemma:"hhhhhhh",points:1},{id:14,angle:2.116484788712114,x:.39,y:.10969814801588655,isRelated:!1,lemma:"hhhhhhh",points:0},{id:4,angle:-1.8087744829244912,x:.39,y:.006773537730332464,isRelated:!1,lemma:"kkkkkkkkk",points:3},{id:5,angle:4.207501553464681,x:.48,y:-.003607121885288507,isRelated:!1,lemma:"kkkkkkkkk",points:3},{id:0,angle:4.444658893626183,x:.03,y:-.0062058544321917,isRelated:!1,lemma:"care",points:2}]};ko.utils.arrayForEach(a.words,function(e){e.isSelected=ko.observable(!1),e.css=""});var s=function(e){var t=this;t.id=e,t.level=ko.observable(0),t.draft=ko.observable(!0),r=0};return s.prototype.debugMode=ko.observable(!1),s.prototype.debug=function(){var e=this;t.acquire("game/canvas/vm/Path").then(function(t){e.debugMode(t.options.debug^=!0);for(var n=i.paths(),o=0;o<n.length;o++)n[o].phrase.words.valueHasMutated()})},s.prototype.portraitMode=ko.observable(!1),s.prototype.portrait=function(){var e=this;e.portraitMode(!e.portraitMode())},s.prototype.addTile=function(){var e=new o(r++);i.tiles.push(e)},s.prototype.back=function(){n.navigate("game-editor")},s.prototype.save=function(){if(!e.loading()){var t=ko.utils.arrayMap(i.tiles(),function(e){return{id:e.id,x:1*e.x.toFixed(2),y:1*e.y.toFixed(2),angle:e.angle()}}),n=ko.utils.arrayMap(i.paths(),function(e){return{id:e.id,startTile:e.startTile.id,endTile:e.endTile.id,cw:e.cw,nWords:e.nWords}}),o={command:"set",id:this.id,tiles:t,paths:n,level:1*this.level(),draft:1*this.draft()},r=this;e.loading(!0),e.trigger("server:manager:boards",o,function(t){t.success?(r.id=t.id,e.dialog.show("alert",{content:"Game Board Saved"})):e.dialog.show("alert",{content:"Failed to save the board"}),e.loading(!1)})}},t.extend(s.prototype,{activate:function(t){if(this.id="new"==t?-1:1*t,i.players([{username:"player",score:100,active:ko.observable(!0)},{username:"opponent",score:0,active:ko.observable(!1)}]),i.player=i.players()[0],i.words(a.words),-1!=this.id){var n=this;i.loading(!0),e.trigger("server:manager:boards",{command:"get",id:this.id},function(e){if(i.loading(!1),e.success){var t=e.board;ko.utils.arrayForEach(t.tiles,function(e){e.id>r&&(r=e.id+1),i.tiles.push(new o(e.id,1*e.x,1*e.y,e.angle))}),ko.utils.arrayForEach(t.paths,function(e){var t=ko.utils.arrayFirst(i.tiles(),function(t){return t.id==e.startTile}),n=ko.utils.arrayFirst(i.tiles(),function(t){return t.id==e.endTile});n.addPath(t,null,e.nWords,e.cw)}),n.level(t.level),n.draft(t.draft)}})}},binding:function(){return{cacheViews:!1}},compositionComplete:function(){},loading:e.loading,deactivate:function(){for(var e=i.paths(),t=0;t<e.length;t++)e[t].dispose();i.paths.removeAll(),i.tiles.removeAll(),i.words.removeAll(),$("#menu").remove()}}),s}),n("game-editor/menu",["plugins/router","durandal/app","api/datacontext","./_server"],function(e,t){var n=ko.observableArray();return{height:ko.observable(100),activate:function(){n([]),t.trigger("server:manager:boards",{command:"getAll"},function(e){for(var t=n(),i=e.boards,o=0;o<i.length;o++){var r=i[o],a=r.level;t.hasOwnProperty(a)||(t[a]={key:a,value:ko.observableArray()}),t[a].value.push(r)}n.valueHasMutated()})},groups:n,edit:function(t){e.navigate("game-editor/edit/"+t.id)},remove:function(e){t.dialog.show("confirm",{content:"Are you sure you want to remove this game board?",modal:!0,doneText:"YES",cancelText:"NO"}).then(function(i){if("done"==i){t.trigger("server:manager:boards",{id:e.id,command:"delete"});var o=n()[e.level].value,r=o.indexOf(e);o.splice(r,1)}})},beingRemove:function(e){"DIV"==e.tagName&&$(e).fadeOut(300)},createNew:function(){e.navigate("game-editor/edit/new")},binding:function(){return{cacheViews:!1}},compositionComplete:function(){$(window).bind("resize",this,this.resize),this.resize({data:this})},resize:function(e){e.data.height($(window).innerHeight()-120)},deactivate:function(){$(window).unbind("resize",this.resize)}}}),n("game-editor/tiles",["durandal/app","api/datacontext","api/helper/draggable.static"],function(e,t){function n(){for(var e=0;e<o.length;e++){var t=o[e].$el,n=o[e].tile;t.css({left:100*n.x+"%",top:100*n.y+"%"}),t.find(".mask").css({scale:1,fontSize:"1em"}),n.ruleOffset={x:0,y:0},i(n)}o=[]}function i(e){var t=e.angle();e.$inst.css({rotate:t}),e.$inst.find(".rule").css(t>90||-90>t?{rotate:180}:{rotate:0})}var o=[];return{tiles:t.tiles,collection:t.collection,tileAngleUp:function(e){e.angle(e.angle()+1),i(e)},tileAngleDown:function(e){e.angle(e.angle()-1),i(e)},del:function(n){e.dialog.show("confirm",{content:"Delete tile?",modal:!0,doneText:"YES",cancelText:"NO"}).then(function(e){if("done"==e){for(var i=t.paths(),o=0;o<i.length;o++){var r=i[o];(r.startTile.id==n.id||r.endTile.id==n.id)&&(t.paths.splice(t.paths.indexOf(r),1),r.dispose(),o--)}t.tiles.splice(t.tiles.indexOf(n),1)}})},afterRender:function(r,a){var s=$(r).filter(".tile:first");a.$el=s,a.$inst=s.find(".cloud"),a.$el.draggableStatic({withinEl:s.parent(),centerBased:!0,topLimit:!0,usePercentage:!1,dragStart:function(){a.lastAngle=a.angle(),a.lastX=a.x},move:function(e,t){return a.x=t.left/s.parent().innerWidth(),a.y=t.top/s.parent().innerHeight(),a.angle(a.lastAngle>90||a.lastAngle<-90?a.lastAngle-Math.floor(90*(a.x-a.lastX)):a.lastAngle+Math.floor(90*(a.x-a.lastX))),i(a),!0},dropped:function(n,i){if(i.hasMoved){!i.isWithin,a.$el.css({top:100*a.y+"%",left:100*a.x+"%"}),e.trigger("game:tiles:update");for(var o=t.paths(),r=0;r<o.length;r++){var s=o[r];if(s.startTile.x>s.endTile.x){var l=s.startTile;s.startTile=s.endTile,s.endTile=l,s.cw^=1}s.phrase.words.valueHasMutated()}}}}),a.$inst.find(".rule").draggableStatic({withinEl:$(document),centerBased:!0,usePercentage:!1,topLimit:!1,move:function(e,t){var n=Math.ceil(90+Math.atan2(t.top,t.left)*(180/Math.PI));
return a.angle(n),i(a),!1}}),0==o.length&&setTimeout(n,100),o.push({$el:s,tile:a})}}}),n("game/canvas/circleWords",["durandal/system","durandal/app","api/datacontext","paper"],function(e,t,n){function i(){$("canvas").unbind("mouseup"),paper.tool.remove()}function o(){var e,i=new paper.Tool,o=[];i.minDistance=16,i.maxDistance=32,i.onMouseDown=function(t){t.event.preventDefault(),e=new paper.Path,e.add(t.point),o=[],addStarAt(t.point)},i.onMouseDrag=function(t){t.event.preventDefault(),e.add(t.point),addStarAt(t.point)},i.onMouseUp=function(){if(0!=e.length){e.closePath();var i=a(e,l());n.gameOver()||(i.length<3?(console.log("Too few words!"),t.Sound.play(t.Sound.sounds.action.functionFailed)):i.length>9?(console.log("Too many words!"),t.Sound.play(t.Sound.sounds.action.functionFailed),t.dialog.show("alert",{content:"Too many words!"})):(i=r(i),s.resolve(i))),e.remove(),t.trigger("app:force-resize")}},addStarAt=function(e){star=new paper.Raster("star"),star.position=e,star.rotate(Math.floor(360*Math.random())),star.scale(.4+.6*Math.random()),star.removeOnUp(),t.Sound.play(t.Sound.sounds.selectTool)}}function r(e){function t(e){upper=e[0],slightY=0;for(var t=1;t<e.length;t++){var n=e[t],i=upper.y-n.y;i-slightY>.06?(upper.x-n.x>.06,upper=n,slightY=0):i>0&&(slightY+=i)}return e.splice(e.indexOf(upper),1),upper}function n(e,t){return e.x-t.x}var i=[];for(e.sort(n);e.length;)i.push(t(e));return i}function a(e,t){var n=$("#app").scrollTop();return ko.utils.arrayFilter(t,function(t){var i=t.$el.offset().left+t.$el.innerWidth()/2,o=t.$el.offset().top+n+t.$el.innerHeight()/2;return e.contains(i,o)})}var s,l=n.unplayedWords;return circleWords={load:function(){return s=e.defer(),t.trigger("app:force-resize"),i(),o(),s.promise()},unload:i}}),n("game/tutorial",["durandal/app","dialogs/_constants","api/context/storage"],function(e,t,n){function i(){this.storage=new n(function(){return"tutorial["+e.ctx.username+"].bubble"},.1,{menu:null,dynamic:null,poem:null}),this.swapWords=function(){var e=$(".palette.left .btn:first"),t=TUT.SWAP_WORDS;return t.css="left",t.top=e.offset().top,t.left=e.offset().left+60,t.fixed=!0,t},this.circleWords=function(){var e=$(".palette.left .btn:nth-child(2)"),t=TUT.SELECT_PHRASE;return t.css="left",t.top=e.offset().top,t.left=e.offset().left+60,t.fixed=!0,t},this.archivedGames=function(){var e=$(".palette.right .menu"),t=TUT.ARCHIVE_GAMES;return t.css="right",t.top=e.offset().top-10,t.left=e.offset().left-190,t.fixed=!0,t},this.placePhrase=function(){var e=window.innerWidth-300,t=$(".magnet-placeholder").filter(function(){return $(this).offset().top>200&&$(this).offset().left<e&&$(this).offset().left>70?!0:!1}),n=TUT.PLACE_PHRASE;return n.css="bottom left",n.top=t.offset().top-170+o.scrollTop,n.left=t.offset().left,n},this.fillPath=function(){var e=window.innerWidth-300,t=$(".magnet-placeholder").filter(function(){return $(this).offset().top>200&&$(this).offset().left<e&&$(this).offset().left>70?!0:!1}),n=TUT.FILL_PATH;return n.css="bottom left",n.top=t.offset().top-110+o.scrollTop,n.left=t.offset().left,n},this.dynamicSubmit=function(){var t=(window.innerWidth-300,$(".confirm-box .button")),n={heading:"Done?",content:"Click me when <br> you are done! <br> Use 3-6 words."};return t.offset().top+o.scrollTop<150?(n.css="left",n.top=t.offset().top+15+o.scrollTop,n.left=t.offset().left+65):(n.css="bottom right",n.top=t.offset().top-100+o.scrollTop,n.left=t.offset().left-75),t.click(function(){e.dialog.close("tutorial")}),n},this.zeroBesoz=function(){var t=(window.innerWidth-300,$(".command.currency"));if(t){var n={heading:"No besoz!",content:"Press the wand <br> when you want to <br> get besoz to use <br> in the game."};return n.css="right",n.top=t.offset().top+15,n.left=t.offset().left-140,n.fixed=!0,t.click(function(){e.dialog.close("tutorial")}),n}},this.poemMenu=function(){var e=$(".palette.right .menu"),t={heading:"Poems",content:"Go to My Poems <br> in the menu to <br> find all your <br> saved poems."};return t.css="right",t.top=e.offset().top-10,t.left=e.offset().left-140,t.fixed=!0,t},this.bonusFor=function(e,t){var n=(window.innerWidth-300,$(".cloud .info",e.$el)),i={heading:"Bonus points",content:t||"Use an adequate word to <br/> fulfill this bonus point."},r=60*i.content.split("<br").length;return i.css="bottom left",i.top=n.offset().top-r+o.scrollTop,i.left=n.offset().left+20,i},this.bonus=function(){var e=window.innerWidth-300,t=$(".cloud .info").filter(function(){return $(this).offset().top>220&&$(this).offset().left<e&&$(this).offset().left>70?!0:!1}),n=TUT.BONUS;return n.css="bottom left",n.top=t.offset().top-220+o.scrollTop,n.left=t.offset().left+20,n};this.relatedWords=function(){var t=$(".magnet.related:first");if(0==t.length)return null;var n=function(){e.dialog.close("tutorial"),t.unbind("mouseup",n)};t.bind("mouseup",n);var i={heading:"Related Word",content:"Use a related word in <br/> your path."};return i.css="bottom right",i.top=t.offset().top-110+o.scrollTop,i.left=t.offset().left-120,i.fixed=!1,i}}TUT=t.TUT;var o=document.getElementById("app");i.prototype.getNext=function(){return this.qIndex=this.qIndex||0,[this.placePhrase,this.fillPath,this.bonus,this.swapWords,this.circleWords,this.relatedWords][this.qIndex++]},i.prototype.showOne=function(t){return e.dialog.show("tutorial",t)},i.prototype.closeAll=function(){return e.dialog.close("tutorial")},i.prototype.showNext=function(){var t=this.getNext();if(!t)return localStorage.setItem("tutorial","end"),$.Deferred();var n=this,i=t();return null==i?(localStorage.setItem("tutorial","related"),null):e.dialog.show("tutorial",i).then(function(e){return e&&e.force?$.Deferred():n.showNext()})},i.prototype.refresh=function(){this.qIndex--;var t=this.getNext();e.trigger("dialog:data:changed",t())},i.prototype.show=function(){var t=this;this.qIndex=0;var n=localStorage.getItem("tutorial");switch(n||this.showNext(),n){case"related":this.qIndex=5,this.showNext()}var t=this,i=e.on("app:resized:delayed").then(function(){var e=localStorage.getItem("tutorial");e?i.off():t.refresh()})},i.prototype.testRelated=function(){var e=localStorage.getItem("tutorial");"related"==e&&(this.qIndex=5,this.showNext())};var r=new i;return e.on("game:score:done").then(function(){!e.ctx._gameOver()||e.ctx.players()[0].resigned()||1!=e.ctx.players().length&&e.ctx.players()[1].resigned()||r.storage.menu.load()||(r.storage.menu.save(!0),setTimeout(function(){r.showOne(r.archivedGames())},2e3))}),e.on("game:bubble").then(function(t,n,i){ctx=e.ctx,"dynamicPath"===t?r.storage.dynamic.load()||(r.storage.dynamic.save(!0),r.showOne(r[t].call(r,n,i))):"poemMenu"===t?r.storage.poem.load()||(r.storage.poem.save(!0),r.showOne(r[t].call(r,n,i))):r.showOne(r[t].call(r,n,i))}),r}),n("game/game",["durandal/app","durandal/system","api/datacontext","dialogs/_constants","./tutorial"],function(e,t,n,i){function o(t,n,i,o,r){var a,s;if($(".player").each(function(e,n){return ko.dataFor(n)==t?void(a=$(n)):void 0}),a){e.Sound.play(e.Sound.sounds.scoring.word),s=ko.utils.arrayMap(n.guiBoxes,function(e){return e});for(var l=a.offset().left+20,c=a.offset().top,u=0;u<s.length;u++){var d=$(s[u]._guiElem),p=s[u].wordModel.lemma,h=ko.utils.arrayFirst(i.words,function(e){return e.lemma==p}).points;if(h){$(".magnet",d).addClass("highlight"),setTimeout(function(e){$(".magnet",e).removeClass("highlight")},1200,d);var f=$("<div/>",{"class":"score",text:"+"+h});d.prepend(f),(!o||r)&&setTimeout(function(e){e.bind($.support.transitionEnd,function(e){"opacity"==e.originalEvent.propertyName&&$(this).remove()}).css({y:"-3em",opacity:0,scale:2})},0,f)}for(var g=parseInt($("#gameboard").css("paddingTop")),m=500,v=2*h,b=0;v>b;b++)!function(e){var t=(5*Math.random()+3)/10,n=d.offset(),i=d.position(),o=m/v*e,r=$("<div/>",{"class":"star"}).css({scale:t,x:n.left*(1/t)+(20*Math.random()-10),y:i.top*(1/t)+g}).appendTo($("#app"));Task.run(function(){var e=1.3*Math.random()+.4;r.bind($.support.transitionEnd,function(){$(this).remove()}).css({x:l*(e/t),y:c*(e/t),scale:t/e,opacity:0})},o)}(b)}}}function r(t){var i,o,r;$(".rule").each(function(e,a){return ko.dataFor(a)==t?(i=$(a),o=i.parent(),void(r=2*(t.bonus||(n.player.scored||n.player.score())*t.mult||20))):void 0}),e.Sound.play(t.bonus?e.Sound.sounds.scoring.bonus:e.Sound.sounds.scoring.bonusMult),h++%2==0?i.transition({scale:1.2},{easing:"ease-in-out"}).transition({scale:.9},{easing:"ease-in-out"}).transition({scale:1},{easing:"ease-in-out"}):i.transition({rotate:"+=15"},{easing:"ease-in-out"}).transition({rotate:"-=30"},{easing:"ease-in-out"}).transition({rotate:"+=15"},{easing:"ease-in-out"});for(var a=0;r>a;a++){var s=(5*Math.random()+3)/10,l=(i.position(),i.offset(),150);!function(){var e=$("<div/>",{"class":"star"}).css({scale:s,left:60,top:-20}).appendTo(o);Task.run(function(){var t=1.3*Math.random()+.4,n=360*Math.random(),i=l*Math.cos(n*Math.PI/180),o=l*Math.sin(n*Math.PI/180);e.bind($.support.transitionEnd,function(){$(this).remove()}).css({x:i*(t/s),y:o*(t/s),scale:s/t,opacity:0})},700*Math.random())}(a)}}function a(){e.trigger("game:started:ready")}function s(){return n.gameOver()||n.resumedGame?void a():(document.getElementById("app").classList.add("noScroll"),void setTimeout(function(){e.scrollDown(window.innerHeight,!0),setTimeout(e.scrollUp,800,!0),setTimeout(function(){document.getElementById("app").classList.remove("noScroll"),a()},1500)},800))}var l=n.tickets.swapWords,c=n.tickets.addWords,u=n.tickets.versions,d=n.allowCircle;n.loading.subscribe(function(t){t===!0?e.loading(!1):t===!1&&(e.palette.show(),e.palette.get("quit").visible(!n.tutorialMode()))});var p=null;n.activeWords.subscribe(function(e){if(e)for(var t=0;t<e.length;t++)e[t].isSelected(!0);else{e=p;for(var t=0;t<e.length;t++)e[t].isSelected(!1);e=null}p=e}),$(document).keydown(function(e){location.hash.match(/game/gi)&&(80==e.keyCode||83==e.keyCode||85==e.keyCode||86==e.keyCode||87==e.keyCode)});var h=0;e.on("game:updated").then(function(t){if(n.player.scored){n.lastPath.guiBoxes=ko.utils.arrayFilter(n.lastPath.guiBoxes,function(e){return!!e.wordModel});var i=2e3,a=500;t.path.score.startTile.satisfied&&(ko.utils.arrayForEach(t.path.score.startTile.words,function(e){for(var o=t.path.score.words[e].lemma,e=0;e<n.lastPath.guiBoxes.length;e++){var r=n.lastPath.guiBoxes[e].wordModel.lemma;if(r==o){var a=$(".magnet",n.lastPath.guiBoxes[e]._guiElem);a.addClass("highlight"),setTimeout(function(e){e.removeClass("highlight")},i,a)}}var s=n.lastPath.startTile.bonus||t.path.score.total/n.lastPath.startTile.mult,l=$("<div/>",{"class":"score",text:"+"+s}),c=$(n.lastPath.guiBoxes[Math.floor(n.lastPath.guiBoxes.length/2)]._guiElem);c.prepend(l),setTimeout(function(e){e.bind($.support.transitionEnd,function(e){"opacity"==e.originalEvent.propertyName&&$(this).remove()}).css({y:"-3em",opacity:0,scale:2})},0,l)}),r(n.lastPath.startTile)),setTimeout(function(){t.path.score.endTile.satisfied&&(ko.utils.arrayForEach(t.path.score.endTile.words,function(e){for(var o=t.path.score.words[e].lemma,e=0;e<n.lastPath.guiBoxes.length;e++){var r=n.lastPath.guiBoxes[e].wordModel.lemma;if(r==o){var a=$(".magnet",n.lastPath.guiBoxes[e]._guiElem);a.addClass("highlight"),setTimeout(function(e){e.removeClass("highlight")},i,a)}}var s=n.lastPath.endTile.bonus||t.path.score.total/n.lastPath.endTile.mult,l=$("<div/>",{"class":"score",text:"+"+s}),c=$(n.lastPath.guiBoxes[Math.floor(n.lastPath.guiBoxes.length/2)]._guiElem);c.prepend(l),setTimeout(function(e){e.bind($.support.transitionEnd,function(t){"opacity"==t.originalEvent.propertyName&&e.remove()}).css({y:"-3em",opacity:0,scale:2})},0,l)}),r(n.lastPath.endTile))},t.path.score.startTile.satisfied*(i+a)),setTimeout(function(){var i=!1,r=0,a=ko.utils.arrayMap(t.path.score.words,function(e){var n=0;return e.related&&(i=!0,n=15,t.path.score.words[r].points-=15),r++,{lemma:e.lemma,points:n,related:e.related}}),s=t.path.score.words;i?(t.path.score.words=a,o(n.player,n.lastPath,t.path.score,1,1),e.Sound.play(e.Sound.sounds.scoring.related),t.path.score.words=s,setTimeout(function(){o(n.player,n.lastPath,t.path.score)},2e3)):o(n.player,n.lastPath,t.path.score),setTimeout(function(){e.trigger("game:stars:done")},2e3+2e3*i)},t.path.score.startTile.satisfied*(i+a)+t.path.score.endTile.satisfied*(i+a))}}),e.on("game:started").then(function(){setTimeout(function(){n.tutorialMode()&&0!=n.gameID||e.fromSignUp||s()},800)}),e.on("game:started:ready").then(function(){setTimeout(function(){},500)});var f=ko.computed(function(){return!n.gameOver()}),g=ko.computed(function(){return n.player.active()}),m={loadingStatus:n.loadingStatus,loading:n.loading,player:n.player,anyTileActive:ko.computed(function(){var e=n.tiles();return e.some(function(e){return e.active()})}),toggleTile:function(){var t=n.tiles(),i=ko.utils.arrayFirst(t,function(e){return e.active()});i&&e.trigger("game:tile:toggle",i)},allowSwap:ko.computed(function(){return f()&&g()&&l()&&(""===n.mode()||"swapWords"===n.mode())&&!n.activeWords()}),allowResign:ko.computed(function(){return f()}),allowCircle:ko.computed(function(){return f()&&g()&&d()&&(""===n.mode()||"circleWords"==n.mode())}),allowVersions:ko.computed(function(){return f()&&g()&&u()&&(""===n.mode()||"versions"==n.mode())&&!n.activeWords()}),allowAddWords:ko.computed(function(){return f()&&g()&&c()&&(""===n.mode()||"addWords"==n.mode())&&!n.activeWords()}),mode:n.mode,swapWords:function(){function t(){e.dialog.close("confirm"),e.dialog.close("slipper"),n.mode("");for(var t=n.selectedWords(),i=0;i<t.length;i++)t[i].isSelected(!1);paper.tool.remove()}if("swapWords"==n.mode())t(),m._wordsSub&&(m._wordsSub.dispose(),m._wordsSub=null);else if(m.allowSwap()){ga("send","event","action","click","swap-word"),e.dialog.show("slipper",i.SWAP_WORDS),n.mode("swapWords"),e.scrollDown();var o=!1,r=m;r._wordsSub=n.selectedWords.subscribe(function(i){"swapWords"!=n.mode()&&m._wordsSub.dispose(),i.length>0&&!o?(o=!0,e.dialog.show("confirm",{content:"",doneText:"Swap Words",cancelText:"Cancel"}).then(function(i){if("cancel"==i)r._wordsSub.dispose(),t();else if("done"==i){r._wordsSub.dispose(),e.dialog.close("slipper"),n.loadingStatus("Swapping words"),e.loading(!0);var o={username:n.player.username,gameID:n.gameID,words:ko.utils.arrayMap(n.selectedWords(),function(e){return e.id})};n.tutorialMode()?(e.trigger("game:swap-words",{success:!0,oldWords:o.words,words:ko.utils.arrayMap(n.selectedWords(),function(e){var t=$.extend(!0,{},e);return t.lemma=t.altLemma,t})}),l(!1),n.mode(""),e.loading(!1)):e.trigger("server:game:swap-words",o,function(i){i.success?l(!1):t(),n.mode(""),e.loading(!1)})}})):i.length<=0&&o&&(o=!1,e.dialog.close("confirm"))})}},resign:function(){if(!n.gameOver()){var t=1==n.playerCount?"Are you sure you want to delete this game?":"Are you sure you want to resign?";e.dialog.show("confirm",{content:t,modal:!0,doneText:1==n.playerCount?"Delete":"Resign",cancelText:1==n.playerCount?"Cancel":"Cancel"}).then(function(t){"cancel"!=t&&(1==n.playerCount&&e.Sound.play(e.Sound.sounds.game.del),e.trigger("server:game:resign",{username:n.player.username,gameID:n.gameID}))})}},circleWords:function(){if(m.allowCircle()){if(n.activeWords())return n.activeWords(null),void e.dialog.close("slipper");var o={load:function(){e.dialog.show("slipper",i.CIRCLE_WORDS),e.scrollDown(),t.acquire("game/canvas/circleWords").then(function(t){t.load().then(function(t){e.scrollUp();n.activeWords(t),n.mode(""),o.unload(),e.dialog.show("slipper",i.CHOOSE_PATH)})}),n.activeWords(null)},unload:function(){e.dialog.close("slipper"),paper.tool.remove()}};"circleWords"==n.mode()?(n.mode(""),o.unload()):(ga("send","event","action","click","circle-word"),n.mode("circleWords"),o.load())}},versions:function(){"versions"==n.mode()?(n.mode(""),e.dialog.close("notice")):m.allowVersions()&&(n.mode("versions"),ga("send","event","action","click","word-version"),e.scrollUp(),t.acquire("dialogs/pages/versions").then(function(t){var i=new t;i.ticket=u,e.dialog.show("notice",{model:i,view:"dialogs/pages/versions",closeOnClick:!1}).then(function(){n.mode("")})}))},addWords:function(){"addWords"==n.mode()?(n.mode(""),e.dialog.close("notice")):m.allowAddWords()&&(n.mode("addWords"),ga("send","event","action","click","add-word"),t.acquire("dialogs/pages/addWords").then(function(t){var i=new t;i.ticket=c,e.dialog.show("notice",{model:i,view:"dialogs/pages/addWords",closeOnClick:!1,css:"top",fixed:!0}).then(function(){n.mode("")})}))}};return t.extend(m,{noTransite:!0,activate:function(t){return n.auth.then(function(){e.loading(!0),e.trigger("game:dispose"),e.palette.dispose(),e.dialog.closeAll(),e.fromSignUp&&setTimeout(function(){e.dialog.show("notice",{view:"dialogs/pages/welcome",modal:!0,fixed:!0,centered:!0}).then(function(){localStorage.removeItem("login-mode"),delete e.fromSignUp,s()})},200),e.palette.hide({duration:0}),e.palette.add("poem","command","right",void 0,"Make Poem").click(function(){e.dialog.showPoem()}).visible(ko.computed(function(){return n.gameOver()&&!n.tutorialMode()})),e.palette.add("quit","command","right",void 0,"Exit").click(m.resign).css({disabled:ko.computed(function(){return!m.allowResign()})}).visible(ko.computed(function(){return!n.tutorialMode()&&!n.gameOver()})),e.palette.add("swapWords","action","left",void 0,"Swap Words").click(m.swapWords).css({cancel:ko.computed(function(){return"swapWords"===m.mode()}),disabled:ko.computed(function(){return!m.allowSwap()})}),e.palette.add("circleWords","action","left",void 0,"Select Tool").click(m.circleWords).css({cancel:ko.computed(function(){return"circleWords"==m.mode()||n.activeWords()}),disabled:ko.computed(function(){return!m.allowCircle()})}),e.palette.add("addWords","action","left",void 0,"Add Word").click(m.addWords).css({cancel:ko.computed(function(){return"addWords"===m.mode()}),disabled:ko.computed(function(){return!m.allowAddWords()})}),e.palette.add("versions","action","left",void 0,"Version").click(m.versions).css({cancel:ko.computed(function(){return"versions"===m.mode()}),disabled:ko.computed(function(){return!m.allowVersions()})}),n.unload();var i=n.load(t),o="Exit";n.tutorialMode()||i.then&&(o=1==n.playerCount?"Delete":"Resign",i.then(function(){e.palette.get("quit").editTitle(o)}))})},binding:function(){return e.scrollUp({noAnimate:!0}),{cacheViews:!1}},compositionComplete:function(){},detached:function(){n.unload(),e.dialog.closeAll();for(var t=n.paths(),i=0;i<t.length;i++)t[i].dispose();n.paths.removeAll(),n.tiles.removeAll(),n.words.removeAll(),e.palette.dispose()}})}),n("game/players",["durandal/app","api/datacontext"],function(e,t){return{showProfile:function(t){e.dialog.showProfile(t.username)},players:ko.computed(function(){var e=t.players();return e.length<=1?e:e[1].username==t.username?e:[e[1],e[0]]}),loading:t.loading,binding:function(){return{cacheViews:!1}}}}),n("game/poem/background",["api/datacontext"],function(e){function t(){app.Sound.play(app.Sound.sounds.poem.range)}e.poem=e.poem||{},e.poem.title=ko.observable(""),e.poem.tile=ko.observable(),e.poem.settings={visible:ko.observable(!1),shade:{name:"shade",min:0,max:3,value:ko.observable(3)},size:{name:"size",min:17,max:32,value:ko.observable(22)},current:ko.observable(),lightColor:ko.observable(!0)},e.poem.settings.current(e.poem.settings.size);var n=ko.observableArray(),i={};e.poem.settings.size.value.subscribe(t),e.poem.settings.shade.value.subscribe(t);var o=function(){this.heading="Background and settings",this.valid=ko.observable(!0),this.reset=function(){e.poem.title(""),e.poem.tile(null),e.poem.settings.visible(!1),e.poem.settings.shade.value(3),e.poem.settings.size.value(22),e.poem.settings.lightColor(!0)}};return o.prototype.action=function(e){app.Sound.play(app.Sound.sounds.click.button),this.settings.visible(!!e),this.settings.current(e?this.settings[e]:this.settings.size)},o.prototype.switchColor=function(){e.poem.settings.lightColor(e.poem.settings.lightColor()^!0),app.Sound.play(app.Sound.sounds.click.button)},o.prototype.range=function(e,t){for(var n=[];e!=t;)n.push(e++);return n.push(e),n},o.prototype.activate=function(){this.tiles=n,this.tile=e.poem.tile,this.title=e.poem.title,this.phrases=e.poem.chosenPhrases,this.settings=e.poem.settings,n.removeAll(),ko.utils.arrayPushAll(n,e.tiles()),n.push(i)},o.prototype.compositionComplete=function(){e.poem.title.valueHasMutated()},o}),n("game/poem/phrase",["api/datacontext"],function(e){e.poem=e.poem||{},e.poem.phrases=ko.observableArray(),e.poem.chosenPhrases=ko.observableArray();var t=function(){var t=this;this.phrases=e.poem.phrases,this.splitters=[{text:"Include",fixed:!0},{text:"Exclude",fixed:!1}],this.validate=ko.observable(),this.valid=ko.computed(function(){return t.validate(),e.poem.phrases().some(function(e){return!e.excluded})}),this.moved=this.moved.bind(this),this.reset=function(){e.poem.chosenPhrases.removeAll(),e.poem.phrases.removeAll(),e.poem.gameID=null}};return t.prototype.activate=function(){if(e.poem.gameID!=e.gameID){e.poem.gameID=e.gameID;var t=e.paths().map(function(e,t){var n=e.phrase.words.sort(function(e,t){return e.index-t.index}).map(function(e){return e.word.lemma}).join(" ");return{phrase:n,id:e.phrase.id,index:t,excluded:!1}});e.poem.phrases(t)}this.splitters[1].index=e.poem.phrases().filter(function(e){return!e.excluded}).length+1},t.prototype.moved=function(e,t,n,i){if(void 0==t.excluded)e.excluded=i>n,this.validate.valueHasMutated();else{var o=t.index;t.index=e.index,e.index=o}},t.prototype.canDeactivate=function(){return!0},t.prototype.deactivate=function(){e.poem.phrases().sort(function(e,t){return e.index-t.index}),e.poem.chosenPhrases(e.poem.phrases().filter(function(e){return!e.excluded}))},t.prototype.bindingComplete=function(){},t.prototype.compositionComplete=function(){},t}),n("game/poem/share",["api/datacontext","api/helper/facebook","api/helper/CanvasCapture"],function(e,t,n){var i=function(){this.heading="Share with friends!",this.valid=ko.observable(!0),this.btnNextCaption="Save",this.btnNextFn=this.save,this.reset=function(){}};return i.prototype.activate=function(){this.tile=e.poem.tile,this.title=e.poem.title,this.phrases=e.poem.chosenPhrases,this.settings=e.poem.settings},i.prototype.compositionComplete=function(){e.poem.title.valueHasMutated()},i.prototype.facebook=function(){ga("send","event","poem","share","facebook"),t.PublishImage.login(),n.capture($(".slider"),e.poem.tile().imageName,e.poem.settings.size.value()).then(function(e){t.PublishImage.publishImageUI(e)})},i}),n("game/poem/index",["durandal/activator","./phrase","./background","./share","api/datacontext"],function(e,t,n,i,o){var r=[new t,new n,new i],a=0,s=e.create(),l=ko.computed(function(){var e=s();return e&&e.heading?e.heading:"Make a poem!"}),c=ko.computed(function(){var e=s();return e&&e.btnNextCaption?e.btnNextCaption:"Next >"});return{activate:function(){return o.auth.then(function(){r.forEach(function(e){e.reset()}),r[0].activate(),s(r[a=0])})},heading:l,btnNextCaption:c,page:s,hasBack:ko.computed(function(){return s(),0!=a}).extend({throttle:150}),canNext:ko.computed(function(){var e=s();return e&&e.valid?e.valid():!1}).extend({throttle:150}),next:function(){app.Sound.play(app.Sound.sounds.click.button),a>=r.length-1?(this.save(),app.trigger("notice:close")):s(r[++a])},save:function(){ga("send","event","poem","save");var e={};e.phraseIDs=o.poem.chosenPhrases().map(function(e){return e.id}),e.gameID=o.poem.gameID,e.username=o.username,e.title=o.poem.title(),e.tileID=void 0==o.poem.tile().id?!1:o.poem.tile().id,e.size=o.poem.settings.size.value(),e.shadow=o.poem.settings.shade.value(),e.light=o.poem.settings.lightColor(),e.command="set",app.trigger("server:user:poem",e,function(e){e.success&&app.trigger("game:bubble","poemMenu"),app.dialog.show("alert",{content:e.success?"Your poem has been saved!":"Oh, Something went wrong!"})})},back:function(){app.Sound.play(app.Sound.sounds.click.button),s(r[--a])}}}),n("game/tiles",["durandal/app","api/datacontext","api/helper/draggable"],function(e,t){function n(e,t){if(f){var n=e.$inst,i=e.topOffset;i-t>0&&(n.appendTo(e.$parent).removeClass("fixed").css({left:0,top:0}),delete e.isFixed)}}function i(e,t){if(f){var n=e.$inst,i=n.find(".rule");if(elTop=i.offset().top,0>=elTop){var o=0,r=i.offset().left;e.topOffset=t+elTop,e.$parent=n.parent(),e.isFixed=!0,n.offset({left:r,top:o}).addClass("fixed").appendTo("body"),n.offset({left:r,top:o})}}}function o(){if(f)for(var e=document.getElementById("app").scrollTop,t=0;t<p.length;t++)if(!p[t].active()){{p[t].$inst}p[t].isFixed?n(p[t],e):i(p[t],e)}}function r(){a();for(var e=t.tiles(),n=0;n<e.length;n++)e[n].active()||(l(e[n]),s(e[n],!1))}function a(){h.w=$("#tiles").innerWidth(),h.h=$("#tiles").innerHeight(),h.ww=$("#tiles-max").innerWidth(),h.hh=$("#tiles-max").innerHeight(),h.hh>window.innerHeight?(h.hh=window.innerHeight-20,h.top=-$("#tiles-aspect").position().top,h.top+=30):h.top=0}function s(e,t){return 0!=h.h?(t||e.$mask.addClass("noTransition"),e.origin=e.origin||{scale:1,h:e.$mask.outerHeight()},e.active()?(e.origin.scale=e.origin.h/h.hh,e.$mask.css({fontSize:1/e.origin.scale+"em"})):(e.origin.scale=e.origin.h/h.hh,e.$mask.css({scale:e.origin.scale,fontSize:1/e.origin.scale+"em"})),t?void 0:Task.run(function(){e.$mask.removeClass("noTransition")})):void 0}function l(e,t){0!=h.h&&e.$el.css(t?h.top?{x:0,y:h.top}:{x:0,y:0}:{x:e.x*h.w-h.w/2,y:e.y*h.h-h.h/2})}function c(e){var t=e.angle;e.$inst.css({rotate:t}),(t>90||-90>t)&&e.$inst.find(".rule").css({rotate:180})}function u(){$("#app").unbind("scroll",o);for(var e=0;e<p.length;e++){var t=p[e].$inst;p[e].$mask.unbind($.support.transitionEnd),p[e].isFixed&&ko.removeNode(t[0])}p.splice(0,p.length)}function d(t){var i=t.active();i?(e.Sound.play(e.Sound.sounds.shrinkTile),setTimeout(o,500),l(t,!1),t.$mask.css({scale:t.origin.scale})):(e.Sound.play(e.Sound.sounds.enlargeTile),s(t,!1).thenRun(function(){t.$mask.css({scale:1})}),t.isFixed&&n(t,0),l(t,!0),e.scrollUp()),t.active(!i)}var p=[],h={w:0,h:0,ww:0,hh:0,top:0},f=!1;e.on("game:rule:toggle").then(function(){if(f)for(var e=0;e<p.length;e++)n(p[e],0);f=!f}),e.on("app:resized").then(r),e.on("game:dispose").then(u);var g=ko.observable(!0);return e.on("game:started").then(function(){g(t.gameOver()&&t.resumedGame?!1:!0)}),e.on("game:tiles:visible",function(e){g(e)}),e.on("game:tile:toggle",d),{loading:t.loading,tiles:t.tiles,gameOver:t.gameOver,forceVisible:g,collection:t.collection,tutorialMode:t.tutorialMode,tutorialObject:t.tutorialObject,carryingWords:ko.computed(function(){return t.activeWords()||t.activeWord()}),disabled:ko.computed(function(){var e=t.mode();return"swapWords"==e||"circleWords"==e||"versions"==e}),activate:function(){$("#app, body").bind("scroll",o)},binding:function(){return{cacheViews:!1}},compositionComplete:function(){r()},toggleTile:d,help:function(t,n){if(t.active())return n.stopPropagation=!1,!0;var i=t.$inst.offset(),o=i.left,r=i.top+200-$("#app").scrollTop();t.isFixed&&(r-=120),r=150,e.dialog.show("window",{heading:t.instruction,content:t.description,left:o,top:r})},afterRender:function(e,t){var n=$(e).filter(".tile:first");t.$el=n,t.$inst=n.find(".cloud"),t.$mask=n.find(".mask"),t.ruleOffset={x:0,y:0},t.$mask.bind($.support.transitionEnd,function(){t.active()||(t.$mask.addClass("noTransition"),t.$mask.css({transform:"",fontSize:""}),setTimeout(function(){t.$mask.removeClass("noTransition")},0))}),setTimeout(function(){c(t),l(t),p.push(t)},1)},detached:u}}),n("game/words",["api/datacontext","api/helper/draggable"],function(e){function t(e){var t=o[Math.floor(Math.random()*o.length)];t.runAfter(n.bind(this,e),50+250*Math.random())}function n(e){e.$el.css({rotate:e.angle,scale:1,opacity:1}),e.soundPlayed?e.soundPlaceBack:(e.soundPlayed=!0,app.Sound.play(app.Sound.sounds.word.show))}for(var i=e.unplayedWords,o=[],r=0;4>r;r++)o[r]=new Task.Queue(r);return{words:i,binding:function(){return{cacheViews:!1}},detached:function(e){$(".magnet",e).each(function(e,t){var n=$(t).data("draggable");n&&n.dispose&&n.dispose()})},afterRender:function(n,i){var o=$(n);void 0===i.originalX&&(i.originalX=i.x),void 0===i.originalY&&(i.originalY=i.y),i.x=i.originalX,i.y=i.originalY,i.$el=o.css({left:(100*i.x).toFixed(2)+"%",top:(100*i.y).toFixed(2)+"%"}).data("immovable",e.words.immovable).draggable({withinEl:o.parent(),dragStart:function(){"swapWords"==e.mode()?(app.Sound.play(app.Sound.sounds.word.select),i.isSelected(1^i.isSelected())):(app.Sound.play(app.Sound.sounds.word.lift),e.activeWord(i),o.css({rotate:0})),i.originalX=i.x,i.originalY=i.y,o.hasClass("new")&&(o.removeClass("new"),i.css=i.css.replace("new",""))},dropped:function(t,n){e.activeWord(null),i.x=1*(n.hasMoved?n.left/100:i.x).toFixed(4),i.y=1*(n.hasMoved?n.top/100:i.y).toFixed(4),!i.isPlayed&&n.hasMoved?(app.Sound.play(app.Sound.sounds.word.placeBack),i.originalX=i.x,i.originalY=i.y,e.tutorialMode()||app.trigger("server:game:move-word",{username:e.username,gameID:e.gameID,word:{id:i.id,x:i.x,y:i.y}})):i.isPlayed&&o.hide()}}),t(i)}}}),n("home/help",["plugins/router","durandal/app","api/datacontext"],function(e,t,n){return{activate:function(){return n.auth.then(function(){t.palette.dispose(),t.dialog.closeAll(),t.trigger("game:dispose")})},binding:function(){return{cacheViews:!1}},username:n.username,block:n.user.block,removeBlocked:function(){},deleteUsername:function(){},attached:function(){t.Sound.play(t.Sound.sounds.pageTransition)}}}),n("home/index",["durandal/app","durandal/activator","api/ui/palette","api/datacontext","dialogs/templates/panel"],function(e,t,n,i){function o(t){e.loading(!0),e.dialog.show("panel",t,{compositionComplete:function(){$("input[autofocus]").focus(),e.loading(!1)}})}return{activate:function(t){n.get("menu").visible(!1),n.get("currency").visible(!1),this.viewChanger=e.on("account:view:change").then(o),i.nextRoute=t},binding:function(){return{cacheViews:!1}},compositionComplete:function(){e.trigger("account:view:change","account/login")},attached:function(){e.Sound.play(e.Sound.sounds.pageTransition)},detached:function(){this.viewChanger.off(),e.dialog.close("panel"),n.get("menu").visible(!0),n.get("currency").visible(!0)}}}),n("home/lobby/games",["durandal/app","api/datacontext"],function(e,t){function n(e){var n=l("{{modDate, date}} ",e);return e.newGame?n+l("{{creator}} has started a game with you.",e):e.resigned?a(e).username==t.username?n+l("{{loser}} resigned from your game.",e):n+l("{{loser}} resigned from a game against {{winner}}.",e):e.over?a(e).username==t.username?n+l("You won a game against {{opponent}}. Score: {{winnerScore}} over {{loserScore}} points.",e):n+l("You lost a game against {{opponent}}. Score: {{winnerScore}} over {{loserScore}} points.",e):void 0}function i(e){return[e.playerCount>1?l(b.playedWith,e):l(b.playedSolo,e),e.over?l(b.gameEnded,e):l(b.gameStarted,e),e.over?e.playerCount>1?l(b.playerWon,e):l(b.playerScored,e):e.lastPhrase.username?l(b.phrasePlaced,e):l(b.noPhrase,e)]}function o(e){return e.players[0].username===t.username?e.players[0]:e.players[1]}function r(e){return e.players[0].username===t.username?e.players[1]:e.players[0]}function a(e){return 1==e.players.length?e.players[0]:e.resigned?e.players[0].resigned?e.players[1]:e.players[0]:e.players[0].score>e.players[1].score?e.players[0]:e.players[1]}function s(e){return 1==e.players.length?e.players[0]:e.resigned?e.players[0].resigned?e.players[0]:e.players[1]:e.players[0].score<e.players[1].score?e.players[0]:e.players[1]}function l(e,t){return e.replace(/\{\{([a-z]*),?\s*([a-z]*)\}\}/gi,function(e,n,i){return y[n](t,i)})}function c(){this.getView=function(){return $("<div/>").get(0)},this.loading=t.lobby.loading,this.activeGame=ko.observable(),this.type=ko.observable(),this.notifications=f,this.gotoShopStorage=function(){e.Sound.play(e.Sound.sounds.click.button),e.navigate("shop/storage")};var n=this;this.forGames=g,this.binding=function(){return t.lobby.games.valueHasMutated(),t.lobby.notifications.valueHasMutated(),e.trigger("lobby:update"),{cacheViews:!1}},this.detached=function(){console.log("detached")
},this.loadNotification=function(){m(u),n.type("notification")},this.loadOnGoing=function(){v(d),n.list(n.ongoing),n.type("ongoing")},this.loadArchive=function(){v(d),n.list(n.archive),n.type("archive")},this.list=ko.observableArray(),this.ongoing=[{title:"My Turn",empty:"You have no ongoing games where it's your turn.",games:ko.computed(function(){return ko.utils.arrayFilter(h(),function(e){return o(e).active})})},{title:"Their Turn",empty:"You have no ongoing games where it's your opponents turn.",games:ko.computed(function(){return ko.utils.arrayFilter(h(),function(e){return!o(e).active})})}],this.archive=[{title:"two player",empty:"You have not finished any game.",games:ko.computed(function(){return ko.utils.arrayFilter(p(),function(e){return 2==e.players.length})})},{title:"Single player",empty:"You have not finished any game.",games:ko.computed(function(){return ko.utils.arrayFilter(p(),function(e){return 1==e.players.length})})}],this.nextPageNotifications=function(){return m(m()+u),Task.run.call(this,function(){return m()<t.lobby.notifications().length},150*u)},this.nextPageGames=function(){return v(v()+d),Task.run.call(this,function(){return v()<t.lobby.games().length},150*d)},this.storage=t.user.storage,this.archiveStorageVisibility=ko.computed(function(){return t.user.storage()<=p().length&&0!=t.user.storage()}),this.selectGame=function(t){t.resigned||t.newGame&&t.over||(e.Sound.play(e.Sound.sounds.click.button),ga("send","event","lobby","select"),n.activeGame(t),e.navigate("game/"+t.gameID))},this.resign=function(n){e.dialog.show("confirm",{content:"Are you sure you want to delete this game?",modal:!0,doneText:"Delete",cancelText:"No"}).then(function(i){ga("send","event","lobby","resigned"),"done"==i&&(e.Sound.play(e.Sound.sounds.game.del),e.trigger("server:game:resign",{username:t.username,gameID:n.gameID},function(){}))})},this.message=ko.observable()}var u=15,d=10,p=ko.observableArray(),h=ko.observableArray(),f=ko.observableArray();f.queue=new Task.Queue,f.show=function(e){1===e.nodeType&&($(e).hide(),f.queue.runAfter(function(){$(e).slideDown()},150))},f.render=function(){g.queue.runAfter(function(){1==this.timer&&(console.log("loading lobby"),e.Sound.play(e.Sound.sounds.lobbyLoading))},1)};var g={};g.queue=new Task.Queue,g.render=function(){g.queue.runAfter(function(){1==this.timer&&(console.log("loading lobby"),e.Sound.play(e.Sound.sounds.lobbyLoading))},1)},g.show=function(){};var m=ko.observable(u);m.subscribe(function(){t.lobby.notifications.valueHasMutated()});var v=ko.observable(d);v.subscribe(function(){t.lobby.games.valueHasMutated()}),t.lobby.notifications.subscribe(function(e){f().splice(0,f().length);for(var t=0;e[t];t++){var i=e[t];if(i.notificationSummary=n(i),i.notificationSummary&&(i.over||i.newGame)){if(!(m()>f().length))break;f().push(i)}}f.valueHasMutated()}),t.user.storage.subscribe(function(){t.lobby.games.valueHasMutated()}),t.lobby.games.subscribe(function(e){h.removeAll(),p.removeAll();var n=t.user.storage();ko.utils.arrayForEach(e,function(e){e.summary||(e.summary=i(e)),e.resigned||(e.over?(0==n||n>p().length&&v()>p().length)&&p().push(e):v()>h().length&&h().push(e))}),h.valueHasMutated(),p.valueHasMutated()});var b={playedWith:"Played with {{opponent}} - Using {{collection}} collection",playedSolo:"Played solo - Using {{collection}} collection",gameEnded:"Game ended {{modDate, date}}",gameStarted:"Game started {{modDate, date}}",phrasePlaced:"{{lastPlayer}} placed: {{lastPhrase}} for {{lastScore}} points",noPhrase:"has not been played yet",playerScored:"{{winner}} scored {{winnerScore}} points.",playerWon:"{{winner}} won the game with {{winnerScore}} over {{loserScore}} points."},y={collection:function(e){return $("<span/>",{"class":"collection",text:e.collection.longName}).get(0).outerHTML},opponent:function(e){return $("<span/>",{"class":"bold",text:r(e).username}).get(0).outerHTML},modDate:function(e,t){if("date"==t){var n=$("<span/>",{"class":"date"});return ko.bindingHandlers.date.init(n,function(){return e.modDate}),n.get(0).outerHTML}},lastPlayer:function(e){return e.lastPhrase.username==t.username?"You":$("<span/>",{"class":"bold",text:e.lastPhrase.username}).get(0).outerHTML},lastPhrase:function(e){return $("<span/>",{"class":"phrase",text:e.lastPhrase.phrase}).get(0).outerHTML},lastScore:function(e){return $("<span/>",{"class":"point",text:e.lastPhrase.score}).get(0).outerHTML},winner:function(e){var n=a(e);return n.username==t.username?"You":$("<span/>",{"class":"bold",text:n.username}).get(0).outerHTML},loser:function(e){var n=s(e);return n.username==t.username?"You":$("<span/>",{"class":"bold",text:n.username}).get(0).outerHTML},winnerScore:function(e){var t=a(e);return $("<span/>",{"class":"point",text:t.score}).get(0).outerHTML},loserScore:function(e){var t=s(e);return $("<span/>",{"class":"point",text:t.score}).get(0).outerHTML},player:function(){return $("<span/>",{"class":"bold",text:"You"}).get(0).outerHTML},creator:function(e){return e.creator==t.username?"You":$("<span/>",{"class":"bold",text:e.creator}).get(0).outerHTML}};return new c}),n("home/lobby/index",["durandal/app","api/datacontext","./games"],function(e,t,n){function i(){this.loading=ko.observable(!1),this.loadingData=t.lobby.loading,this.unseens=t.lobby.unseens,this.activeTab=0,this.compose=ko.observable({model:n,view:"",cacheViews:!1})}$.Deferred();return i.prototype._navigate=function(e){0==e?n.loadOnGoing():1==e?n.loadNotification():2==e&&n.loadArchive(),this.compose().view=1==e?"home/lobby/notifications":"home/lobby/games",this.compose.valueHasMutated(),sessionStorage.setItem("lobby",e);var t=this;return t.loading(!1),$.Deferred(function(e){Task.run(function(){e.resolve()},100)})},i.prototype.navEnd=function(){},i.prototype.navSwitch=function(e,n){void 0!==e&&(ga("send","event","button","click",0==n?"OnGoing":1==n?"Notification":"Archive"),0==e?t.lobby.seenAllOngoing():1==e&&t.lobby.seenAll())},i.prototype.navigate=function(e,t){return this.loading(!0),t.then(this._navigate.bind(this))},i.prototype.activate=function(){return t.auth.then(function(){e.trigger("game:dispose"),e.dialog.closeAll(),e.palette.dispose(),sessionStorage.getItem("lobby")?this.activeTab=sessionStorage.getItem("lobby"):sessionStorage.setItem("lobby",0)})},i.prototype.start=function(){e.Sound.play(e.Sound.sounds.click.button),e.navigate("newGame")},i.prototype.binding=function(){return{cacheViews:!1}},i.prototype.attached=function(){e.Sound.play(e.Sound.sounds.pageTransition)},i}),n("home/newGame",["durandal/app","api/datacontext"],function(e,t){var n=[{id:0,title:"play with friend",description:"Choose from my friends list",playerCount:2,className:"icon-group"},{id:1,title:"random opponent",description:"Find an opponent automatically",playerCount:2,className:"icon-random"},{id:2,title:"single play",description:"Compete with yourself",playerCount:1,className:"icon-user"}],i={list:{mode:"list",title:"Friends List"},search:{mode:"search",title:"Search Result"}},o=function(){this.gameOptions=n,this.gameOptionId=ko.observable(0),this.collections=t.user.collections,this.collection=ko.observable("woz"),this.friends=ko.observableArray([]),this.query=ko.observable(""),this.friendListMode=ko.observable(i.list),this.searchLoading=ko.observable(!1),this.activeFriend=ko.observable(),this.startEnable=ko.computed(function(){var e=this.gameOptionId(),t=this.activeFriend();return t||0!=e},this);var e=this;e.query.subscribe(function(n){n||t.user.friends.load().then(function(t){e.friends(t)})}),e.query.notifySubscribers(),ko.computed(function(){var n=e.query();""!=n?(e.searchLoading(!0),t.user.friends.search(e.query()).then(function(t){e.activeFriend(null),e.friendListMode(i.search),e.friends(t),e.searchLoading(!1)})):(e.activeFriend(null),e.friendListMode(i.list))}).extend({throttle:300})};return o.prototype.clicked=function(t){return e.Sound.play(e.Sound.sounds.click.button),this.gameOptionId(t),!0},o.prototype.friendSelected=function(t){e.Sound.play(e.Sound.sounds.click.button),this.activeFriend()==t?this.activeFriend(null):t.isFriend&&this.activeFriend(t)},o.prototype.queryChanged=function(e){this.query(e.target.value)},o.prototype.activate=function(){var n=this;return t.auth.then(function(){n.activeFriend(null),e.dialog.closeAll(),e.trigger("game:dispose"),e.palette.dispose()})},o.prototype.collectionClicked=function(t){return e.Sound.play(e.Sound.sounds.click.button),"more"==t.shortName&&e.navigate("shop"),!0},o.prototype.binding=function(){return{cacheViews:!1}},o.prototype.attached=function(){e.Sound.play(e.Sound.sounds.pageTransition)},o.prototype.invite=function(){e.dialog.showInvite()},o.prototype.addFriend=function(n){e.Sound.play(e.Sound.sounds.click.button);var i=this;t.user.friends.add(n.username).then(function(){i.query("")})},o.prototype.removeFriend=function(n){e.Sound.play(e.Sound.sounds.click.button);var i=this;e.trigger("server:friends",{username:t.username,command:"delete",friendUsername:n.username},function(){i.query()||i.query.valueHasMutated()})},o.prototype.start=function(){if(e.Sound.play(e.Sound.sounds.click.button),this.startEnable()){var i=this.gameOptionId();t.playerCount=n[i].playerCount,0==i?t.friendUsername=this.activeFriend().username:(t.friendUsername="",delete t.friendUsername),t.collection.name(this.collection()),e.navigate("game")}else e.dialog.show("alert",{content:"Please select a friend to continue."})},o.prototype.toShop=function(){e.Sound.play(e.Sound.sounds.click.button),e.navigate("shop")},o}),n("home/nextTutorial",["durandal/app","api/datacontext"],function(e){return{getView:function(){return $("<div/>").get(0)},activate:function(){e.navigate("tutorial/next",{replace:!0,trigger:!0})}}}),n("home/poem/friends",["durandal/app","api/datacontext","api/helper/facebook","api/helper/CanvasCapture"],function(e,t,n,i){function o(){var e=this;this.loading=t.user.poems.loading,this.list=t.user.poems.friends,this.visibleList=ko.computed(function(){var t=a();return ko.utils.arrayFilter(e.list(),function(){return--t>=0})})}var r=6,a=ko.observable(r);o.prototype.activate=function(){t.user.poems.load()},o.prototype.loadNextPage=function(){var e=this;return a(a()+r),Task.run.call(this,function(){return a()<e.list().length},150*r)},o.prototype.like=function(e){ga("send","event","poem",e.liked()?"unlike":"like"),(e.liked()?t.user.poems.unlike(e.id):t.user.poems.like(e.id)).then(function(){})};var s=new Task.Queue;return o.prototype.afterRender=function(t,n){n.$el=$(t[1]),n.$slider=$(".slider",n.$el),s.runAfter(function(){1==this.timer&&e.Sound.play(e.Sound.sounds.lobbyLoading)},1)},o.prototype.facebook=function(e){ga("send","event","poem","share"),i.capture(e.$slider,e.imageName,e.size).then(function(e){n.PublishImage.publishImageUI(e)})},o}),n("home/poem/index",["durandal/app","durandal/system","api/datacontext"],function(e,t,n){return{loading:ko.observable(!1),module:ko.observable(),activeTab:0,close:function(){},navigate:function(e){var t=this;return t.loading(!0),{moduleId:0===+e?"home/poem/my":"home/poem/friends",acquired:function(e){t.loading(!1),t.module(e)}}},activate:function(){return n.auth.then(function(){e.trigger("game:dispose"),e.dialog.closeAll(),e.palette.dispose()})},start:function(){e.Sound.play(e.Sound.sounds.click.button),e.navigate("lobby")},binding:function(){return{cacheViews:!1}},attached:function(){e.Sound.play(e.Sound.sounds.pageTransition)}}}),n("home/poem/my",["durandal/app","api/datacontext","api/helper/facebook","api/helper/CanvasCapture"],function(e,t,n,i){function o(){var e=this;this.loading=t.user.poems.loading,this.list=t.user.poems.mine,this.visibleList=ko.computed(function(){var t=a();return ko.utils.arrayFilter(e.list(),function(){return--t>=0})})}var r=6,a=ko.observable(r);o.prototype.activate=function(){t.user.poems.load(!0)},o.prototype.loadNextPage=function(){var e=this;return a(a()+r),Task.run.call(this,function(){return a()<e.list().length},150*r)},o.prototype.remove=function(n){e.dialog.confirm("Are you sure you want to delete this poem?",{doneText:"YES",cancelText:"NO",modal:!0}).then(function(){ga("send","event","poem","delete"),t.user.poems.del(n.id).then(function(e){e.success&&n.$el.hide(400,function(){$(this).remove()})})})};var s=new Task.Queue;return o.prototype.afterRender=function(t,n){n.$el=$(t[1]),n.$slider=$(".slider",n.$el),s.runAfter(function(){1==this.timer&&e.Sound.play(e.Sound.sounds.lobbyLoading)},1)},o.prototype.facebook=function(e){ga("send","event","poem","share"),n.PublishImage.login(),i.capture(e.$slider,e.imageName,e.size).then(function(e){n.PublishImage.publishImageUI(e)})},o}),n("home/poems",["plugins/router","durandal/app","api/datacontext"],function(e,t,n){return{activate:function(){t.palette.dispose()},binding:function(){return{cacheViews:!1}},username:n.username,deleteUsername:function(){},attached:function(){t.Sound.play(t.Sound.sounds.pageTransition)}}}),n("home/settings",["plugins/router","durandal/app","api/datacontext"],function(e,t,n){return{activate:function(){var e=this;return n.auth.then(function(){t.palette.dispose(),t.dialog.closeAll(),t.trigger("game:dispose"),e.emailNew=ko.observable(n.user.emailNew()),e.emailEnd=ko.observable(n.user.emailEnd()),e.emailPhrase=ko.observable(n.user.emailPhrase()),n.user.ready.then(function(){function i(){t.trigger("server:user:email",{command:"notifications",emailNew:e.emailNew(),emailEnd:e.emailEnd(),emailPhrase:e.emailPhrase()},function(){n.user.refresh()})}e.emailNew(n.user.emailNew()),e.emailEnd(n.user.emailEnd()),e.emailPhrase(n.user.emailPhrase()),e.emailNew.subscribe(i),e.emailEnd.subscribe(i),e.emailPhrase.subscribe(i)})})},binding:function(){return{cacheViews:!1}},username:n.username,email:n.user.email,block:n.user.block,emailNew:ko.observable(!1),emailEnd:ko.observable(!1),emailPhrase:ko.observable(!1),change:function(){t.dialog.showEmail()},removeBlocked:function(e){n.user.block.del(e.username)},attached:function(){t.Sound.play(t.Sound.sounds.pageTransition)}}}),n("home/shop/currency",["durandal/app","api/datacontext","api/paypal"],function(e,t,n){function i(){this.loading=t.shop.loading(),this.list=t.shop.besozes,t.shop.besozes.load(),this.buy=function(i){e.dialog.closeAll(),e.dialog.show("loading"),t.loading(!0),t.loadingStatus("Waiting for the server..."),t.loadingBox(!0),ga("send","event","paypal","buy",(i||{besoz:0}).besoz),n.getToken(i).then(function(n){n.success?(e.palette.dispose(),t.loadingStatus("Redirecting to Paypal's website..."),localStorage.setItem("returnedHash",location.hash),window.location=n.link):(t.loading(!1),t.loadingBox(!1),e.dialog.close("loading"))})}}return i}),n("home/shop/expansion",["durandal/app","api/datacontext"],function(e,t){function n(){var n=this;this.userCollections=t.user.collections,this.collections=t.shop.collections,this.loading=ko.observable(!1),ko.computed(function(){var e=n.userCollections(),t=n.collections();ko.utils.arrayForEach(t,function(t){var n=ko.utils.arrayFirst(e,function(e){return e.shortName==t.shortName});t.purchased?t.purchased(!!n):t.purchased=ko.observable(!!n),t.flags=t.flags||(t.boosters.length?t.boosters[0].flags:null);for(var i=0;i<t.boosters.length;i++){var o=!1;if(n){var r=ko.utils.arrayFirst(n.boosters,function(e){return e.shortName==t.boosters[i].shortName});o=!!r}t.boosters[i].purchased?t.boosters[i].purchased(o):t.boosters[i].purchased=ko.observable(o),t.boosters[i].collection=t}})}),t.shop.collections.load(),this.buy=function(i){if(!this.purchased()&&!n.loading()){n.loading(!0);var o=i;o.dependent="starter"==o.type?null:o.collection.purchased()?null:o.collection,o.totalPrice=+o.price+(o.dependent?+o.dependent.price:0),ga("send","event","shop","buy",(o||{longName:""}).longName),e.dialog.show("notice",{model:o,view:"dialogs/pages/shop-collections",css:"long",closeOnClick:!1,fixed:!0,centered:!0,modal:!0}).then(function(i){i&&i.confirm?(ga("send","event","shop","bought",(o||{longName:""}).longName),o.dependent&&t.user.buyCollection(o.collection.type,o.collection.shortName),t.user.buyCollection(o.type,o.shortName).then(function(){e.dialog.showAlertNote({title:"Thank you!",content:"The new collection is now available to be played."})}).always(function(){n.loading(!1)}).fail(function(){e.dialog.showNoBesoz(o.totalPrice)})):n.loading(!1)})}}}return n}),n("home/shop/index",["durandal/app","api/datacontext"],function(e,t){return{loading:ko.observable(!1),module:ko.observable(),mode:ko.observable(),activeTab:0,close:function(){},navigate:function(e,t){var n=this;return n.loading(!0),e*=1,t.then(function(){n.module(null),n.module(0===e?"home/shop/expansion":2===e?"home/shop/currency":"home/shop/storage"),n.mode(e),n.loading(!1)})},activate:function(n){return t.auth.then(function(){e.trigger("game:dispose"),e.dialog.closeAll(),e.palette.dispose(),sessionStorage.getItem("shop")?(n=n||"",this.activeTab=n.match(/storage/gi)?1:0):sessionStorage.setItem("shop",0)})},start:function(){e.Sound.play(e.Sound.sounds.click.button),e.navigate("newGame")},binding:function(){return{cacheViews:!1}},attached:function(){e.Sound.play(e.Sound.sounds.pageTransition)}}}),n("home/shop/storage",["durandal/app","api/datacontext"],function(e,t){function n(){this.loading=t.shop.loading(),this.list=t.shop.storageSpaceList,t.shop.storageSpaceList.load(),this.storage=t.user.storage,this.buy=function(n){t.user.buyStorageSpace(n).then(function(){e.dialog.showAlertNote({title:"Thank you!",content:"You have successfully received more storage space for your archived games."})})}}return n}),n("home/singlePlayer",["durandal/app","api/datacontext"],function(e,t){return{getView:function(){return $("<div/>").get(0)},activate:function(){t.playerCount=1,e.navigate("game")}}}),n("home/sound",["api/Sound"],function(e){function t(){var t=[];for(var n in e.sounds){var i=e.sounds[n];if(i.push)t.push({key:n,items:i});else for(var o in i)t.push({key:n+"."+o,items:i[o]})}this.collection=t}return t.prototype.save=function(){return e.save(function(e){e||app.dialog.show("alert",{content:"save "+(e?"failed":"completed")})})},t.prototype.play=function(t){return e.play(t,!0)},t.prototype.meta=function(t){return e.metaSounds[t]},t.prototype.activate=function(){app.palette.dispose()},t.prototype.binding=function(){return{cacheViews:!1}},t}),n("home/test",["durandal/app","api/datacontext"],function(){window.objs=[{b:"test1"},{b:"test2"},{b:"test3"}],window.obs=ko.observableArray(),window.obs.show=function(e){1===e.nodeType&&$(e).hide().slideDown()};for(var e=0;objs[e];e++)obs.push(objs[e]);return{a:obs,binding:function(){return{cacheViews:!1}},compositionComplete:function(e){for(var t=0;16>t;t++){var n=$("<div/>",{"class":"shiny"});n.addClass(t%5==0?"typeA":t%5==1?"typeB":t%5==2?"typeC":t%5==3?"typeD":"typeE");var i=40*Math.random();n.css({width:i,left:50-i/2,opacity:0,scale:.99}),$(".shine",e).append(n),setTimeout(function(e){e.l.css({opacity:1,width:e.w,left:50-e.w/2})},300*t,{l:n,w:i+30}),setTimeout(function(e){e.css({opacity:0})},200*t+2e3,n)}}}}),n("shell",["plugins/router","durandal/app"],function(e,t){var n=ko.observable(!1),i=ko.observable(!1),o=ko.observableArray(),r=ko.observable(!1);return t.on("socket:status").then(function(e){n("connect"==e)}),t.on("socket:server").then(function(e){r(e)}),window.addEventListener("online",function(){i(!0)}),window.addEventListener("offline",function(){i(!1)}),window.addEventListener("error",function(e){o.push(e)}),{router:e,loading:ko.computed(function(){return(e.isNavigating()||t.loading())&&!t.inlineLoading()}),status:{cnn:n,online:i,devMode:r},errors:o,summary:ko.computed(function(){var e="";return ko.utils.arrayForEach(o(),function(t){e+=t.message,e+="\n",e+=t.lineno+" "+t.filename.match(/\/(.*?\.js)/gi)[0],e+="\n"}),e}),showSummary:function(){t.dialog.show("alert",{content:$("<div/>").css({fontSize:"12px"}).html(this.summary())[0].outerHTML,delay:5e3})},activate:function(){return ga("create","UA-39481639-3","auto"),e.on("router:navigation:complete",function(e,t){var n=t.fragment.indexOf("/");n>0?ga("set","page",t.fragment.substr(0,n)):ga("set","page",t.fragment),ga("send","pageview")}),e.map([{route:["","login","login/:route"],moduleId:"home/index",title:""},{route:"test",moduleId:"home/test",title:"Test"},{route:"lobby",moduleId:"home/lobby/index",title:"My Games",nav:!0},{route:"poems",moduleId:"home/poem/index",title:"My Poems",nav:!0},{route:"shop",moduleId:"home/shop/index",title:"Shop",nav:!0},{route:"shop/:id",moduleId:"home/shop/index",title:"Shop"},{route:"settings",moduleId:"home/settings",title:"Settings",nav:!0},{route:"help",moduleId:"home/help",title:"Help - FAQ",nav:!0},{route:"sound",moduleId:"home/sound",title:"Sound Debugger",nav:!0},{route:"newGame",moduleId:"home/newGame",title:"New Game",nav:!0},{route:"singlePlayer",moduleId:"home/singlePlayer",title:"Loading the game"},{route:"nextTutorial",moduleId:"home/nextTutorial",title:"Loading the game"},{route:"account/logout",moduleId:"account/logout",title:"Loging out.."},{route:"not-found",moduleId:"error/not-found",title:"Not Found"},{route:"game",moduleId:"game/game",title:"Play"},{route:"game/:id",moduleId:"game/game",title:"Play"},{route:"tutorial",moduleId:"game/game",title:"Tutorial",nav:!0},{route:"tutorial/:id",moduleId:"game/game",title:"Tutorial"},{route:"game-editor",moduleId:"game-editor/menu",title:"Game Editor"},{title:"Game Editor - Edit",route:"game-editor/edit/:id",moduleId:"game-editor/edit"},{route:"account*details",moduleId:"account/index",title:"Account Settings",hash:"#account"},{route:"facebook",moduleId:"account/oAuth/facebook",title:"Words of Oz"},{route:"paypalcancel",moduleId:"api/ui/paypalcancel",title:"Paypal cancel"},{route:"paypalcb",moduleId:"api/ui/paypalcb",title:"Paypal confirmation"}]).buildNavigationModel().mapUnknownRoutes("error/not-found","not-found").activate()},compositionComplete:function(){$("#fixed").prependTo("body")}}}),n("widgets/list/viewmodel",["durandal/composition","api/helper/draggable"],function(e,t){function n(e){if(!e.data("draggable")){var t=e.height(),n=e.width(),i=[];e.css({height:t,width:n}),$($("li",e).get().reverse()).each(function(){var e=$(this),t=e.children(".phrase, .container"),n=t.position().top,o=t.position().left,r=t.outerWidth(),a=e.outerHeight();i.unshift({yPos:n,xPos:o,h:a}),t.css({position:"absolute",width:r,top:n,left:o}),e.css({height:a}).data({top:n,height:a})}),e.addClass("drag").data("draggable",i)}}function i(e){$(".container, .phrase",e).each(function(){var e=$(this).parent();$(this).css({top:e.data("top")})})}function o(e,t){return t=t||{},t.offsetY=e.offset().top,t.height=e.height(),t.prevHeight=e.prev().height(),t.nextHeight=e.next().height(),t.HiBound=t.offsetY+(t.height+t.nextHeight)/3,t.LoBound=t.offsetY-(t.height+t.prevHeight)/3,t}function t(t){var r=this,a=e.getParts(t),s=$(a.item),l=s.parent("li"),c=l.parent(),u={},d=$(".phrase",l).draggable({withinEl:c,parent:$(document),topLimit:!0,usePercentage:!1,noTask:!0,dragStart:function(e,t,i){t.t-=20,t.b+=20,t.r-=2,i.dropzone=c,n(c),l.addClass("hole"),u=o(l,u),app.Sound.play(app.Sound.sounds.poem.phraseDrag)},dropped:function(){l.removeClass("hole"),Task.run(function(){d.css({top:l.data("top")})}),app.Sound.play(app.Sound.sounds.poem.phraseDrop)},move:function(e,t){function n(e,t){var n=e.data(),i=t.data(),o=n.top>i.top?e:t,a=n.top<i.top?e:t,s=o.data("top");if(o.data("top",a.data("top")),a.data("top",s+o.data("height")-a.data("height")),r.settings.moved){var l=ko.dataFor(e[0]),c=ko.dataFor(t[0]);r.settings.moved(l,c,e.index(),t.index()),app.Sound.play(app.Sound.sounds.poem.phraseSwap)}}if(t.top>u.HiBound&&!l.is(":last-of-type"))console.log("n"),n(l,l.next()),l.insertAfter(l.next()),o(l,u),i(c);else if(t.top<u.LoBound&&!l.is(":first-of-type")){var a=l.prev();a.hasClass("fixed")||(console.log("p"),n(l,a),l.insertBefore(a),o(l,u),i(c))}return!0}})}var r=function(){};return r.prototype.activate=function(e){this.settings=e,this.settings.splitters=this.settings.splitters||[],this.afterRenderItem=this.afterRenderItem.bind(this)},r.prototype.afterRenderItem=function(e){this.settings.draggable&&t.call(this,e)},r.prototype.bindingComplete=function(e){for(var t,n=0;t=this.settings.splitters[n++];)if(t.index&&n-1!=t.index){var i=$("li",e),o=$(i[n-1]),r=$(i[t.index]);o.insertAfter(r)}},r}),n("widgets/poem/viewmodel",["durandal/composition"],function(){var e=26,t=function(){this.sectors=[];for(var t=0;e>t;t++)this.sectors.push({index:t,active:!1})};return t.prototype.activate=function(t){this.settings=t,this.settings.max=this.settings.max||100;var n=ko.unwrap(this.settings.value),i=ko.unwrap(this.settings.max);this.sectors.forEach(function(t){t.active=n/i>t.index/e}),this.afterRenderItem=this.afterRenderItem.bind(this)},t.prototype.afterRenderItem=function(){},t}),n("widgets/slider/viewmodel",["durandal/composition"],function(){var e=function(){};return e.prototype.activate=function(e){this.settings=e,this.afterRenderItem=this.afterRenderItem.bind(this);var t=this,n=this.settings.items.indexOf(ko.unwrap(this.settings.selectedItem));this.index=ko.observable(n>-1?n:0),this.canLeft=ko.computed(function(){return t.index()>0}),this.canRight=ko.computed(function(){return t.index()<ko.unwrap(t.settings.items).length-1}),this.flex=app.support.flex,this.indexSub=this.index.subscribe(function(){var e=t.index();if(t.$ul){var n=$($("li",t.$ul)[e]).position().left+t.$ul.scrollLeft();t.$ul.animate({scrollLeft:n},300),console.log(e,n)}var i=ko.unwrap(t.settings.items)[e];ko.isObservable(t.settings.selectedItem)?t.settings.selectedItem(i):t.settings.selectedItem=i}),this.index.notifySubscribers()},e.prototype.afterRenderItem=function(){},e.prototype.binding=function(){return{cacheViews:!1}},e.prototype.detached=function(){this.indexSub.dispose()},e.prototype.bindingComplete=function(){},e.prototype.attached=function(e){var t=this.index();$("li",e).each(function(e){t>e&&$(this).hide()})},e.prototype.compositionComplete=function(e){this.$ul=$(".slider",e);var t=this.index(),n=$($("li",this.$ul)[t]).width()*t;$("li",e).each(function(e){t>e&&$(this).show()}),this.$ul.scrollLeft(n)},e.prototype.goLeft=function(){this.index(this.index()-1),app.Sound.play(app.Sound.sounds.poem.imageSwip)},e.prototype.goRight=function(){this.index(this.index()+1),app.Sound.play(app.Sound.sounds.poem.imageSwip)},e}),n("widgets/tile/viewmodel",["durandal/composition"],function(){var e=function(){};return e.prototype.activate=function(e){this.settings=e,this.afterRenderItem=this.afterRenderItem.bind(this)},e.prototype.afterRenderItem=function(){},e}),n("widgets/xp/viewmodel",["durandal/composition"],function(){var e=26,t=function(){this.sectors=[];for(var t=0;e>t;t++)this.sectors.push({index:t,active:ko.observable(!1)})};return t.prototype.activate=function(t){this.settings=t,this.settings.max=this.settings.max||100,this.cmp=ko.computed(function(){var t=ko.unwrap(this.settings.value),n=ko.unwrap(this.settings.max);this.sectors.forEach(function(i){i.active(t/n>i.index/e)})},this),this.afterRenderItem=this.afterRenderItem.bind(this)},t.prototype.detached=function(){this.cmp.dispose()},t.prototype.afterRenderItem=function(){},t}),n("plugins/dialog",["durandal/system","durandal/app","durandal/composition","durandal/activator","durandal/viewEngine","jquery","knockout"],function(e,t,n,i,o,r,a){function s(t){return e.defer(function(n){e.isString(t)?e.acquire(t).then(function(t){n.resolve(e.resolveObject(t))}).fail(function(n){e.error("Failed to load dialog module ("+t+"). Details: "+n.message)}):n.resolve(t)}).promise()}var l,c={},u=0,d=function(e,t,n){this.message=e,this.title=t||d.defaultTitle,this.options=n||d.defaultOptions};return d.prototype.selectOption=function(e){l.close(this,e)},d.prototype.getView=function(){return o.processMarkup(d.defaultViewMarkup)},d.setViewUrl=function(e){delete d.prototype.getView,d.prototype.viewUrl=e},d.defaultTitle=t.title||"Application",d.defaultOptions=["Ok"],d.defaultViewMarkup=['<div data-view="plugins/messageBox" class="messageBox">','<div class="modal-header">','<h3 data-bind="text: title"></h3>',"</div>",'<div class="modal-body">','<p class="message" data-bind="text: message"></p>',"</div>",'<div class="modal-footer" data-bind="foreach: options">','<button class="btn" data-bind="click: function () { $parent.selectOption($data); }, text: $data, css: { \'btn-primary\': $index() == 0, autofocus: $index() == 0 }"></button>',"</div>","</div>"].join("\n"),l={MessageBox:d,currentZIndex:1050,getNextZIndex:function(){return++this.currentZIndex},isOpen:function(){return u>0},getContext:function(e){return c[e||"default"]},addContext:function(e,t){t.name=e,c[e]=t;var n="show"+e.substr(0,1).toUpperCase()+e.substr(1);this[n]=function(t,n){return this.show(t,n,e)}},createCompositionSettings:function(e,t){var n={model:e,activate:!1,transition:!1};return t.attached&&(n.attached=t.attached),t.compositionComplete&&(n.compositionComplete=t.compositionComplete),n},getDialog:function(e){return e?e.__dialog__:void 0},close:function(e){var t=this.getDialog(e);if(t){var n=Array.prototype.slice.call(arguments,1);t.close.apply(t,n)}},show:function(t,o,r){var a=this,l=c[r||"default"];return e.defer(function(e){s(t).then(function(t){var r=i.create();r.activateItem(t,o).then(function(i){if(i){var o=t.__dialog__={owner:t,context:l,activator:r,close:function(){var n=arguments;r.deactivateItem(t,!0).then(function(i){i&&(u--,l.removeHost(o),delete t.__dialog__,0===n.length?e.resolve():1===n.length?e.resolve(n[0]):e.resolve.apply(e,n))})}};o.settings=a.createCompositionSettings(t,l),l.addHost(o),u++,n.compose(o.host,o.settings)}else e.resolve(!1)})})}).promise()},showMessage:function(t,n,i){return e.isString(this.MessageBox)?l.show(this.MessageBox,[t,n||d.defaultTitle,i||d.defaultOptions]):l.show(new this.MessageBox(t,n,i))},install:function(e){t.showDialog=function(e,t,n){return l.show(e,t,n)},t.showMessage=function(e,t,n){return l.showMessage(e,t,n)},e.messageBox&&(l.MessageBox=e.messageBox),e.messageBoxView&&(l.MessageBox.prototype.getView=function(){return e.messageBoxView})}},l.addContext("default",{blockoutOpacity:.2,removeDelay:200,addHost:function(e){var t=r("body"),n=r('<div class="modalBlockout"></div>').css({"z-index":l.getNextZIndex(),opacity:this.blockoutOpacity}).appendTo(t),i=r('<div class="modalHost"></div>').css({"z-index":l.getNextZIndex()}).appendTo(t);if(e.host=i.get(0),e.blockout=n.get(0),!l.isOpen()){e.oldBodyMarginRight=t.css("margin-right"),e.oldInlineMarginRight=t.get(0).style.marginRight;var o=r("html"),a=t.outerWidth(!0),s=o.scrollTop();r("html").css("overflow-y","hidden");var c=r("body").outerWidth(!0);t.css("margin-right",c-a+parseInt(e.oldBodyMarginRight,10)+"px"),o.scrollTop(s)}},removeHost:function(e){if(r(e.host).css("opacity",0),r(e.blockout).css("opacity",0),setTimeout(function(){a.removeNode(e.host),a.removeNode(e.blockout)},this.removeDelay),!l.isOpen()){var t=r("html"),n=t.scrollTop();t.css("overflow-y","").scrollTop(n),e.oldInlineMarginRight?r("body").css("margin-right",e.oldBodyMarginRight):r("body").css("margin-right","")}},attached:function(e){r(e).css("visibility","hidden")},compositionComplete:function(e,t,n){var i=l.getDialog(n.model),o=r(e),a=o.find("img").filter(function(){var e=r(this);return!(this.style.width&&this.style.height||e.attr("width")&&e.attr("height"))});o.data("predefinedWidth",o.get(0).style.width);var s=function(){setTimeout(function(){o.data("predefinedWidth")||o.css({width:""});var e=o.outerWidth(!1),t=o.outerHeight(!1),n=r(window).height(),a=Math.min(t,n);o.css({"margin-top":(-a/2).toString()+"px","margin-left":(-e/2).toString()+"px"}),o.data("predefinedWidth")||o.outerWidth(e),t>n?o.css("overflow-y","auto"):o.css("overflow-y",""),r(i.host).css("opacity",1),o.css("visibility","visible"),o.find(".autofocus").first().focus()},1)};s(),a.load(s),o.hasClass("autoclose")&&r(i.blockout).click(function(){i.close()})}}),l}),n("plugins/http",["jquery","knockout"],function(e,t){return{callbackParam:"callback",get:function(t,n){return e.ajax(t,{data:n})},jsonp:function(t,n,i){return-1==t.indexOf("=?")&&(i=i||this.callbackParam,t+=-1==t.indexOf("?")?"?":"&",t+=i+"=?"),e.ajax({url:t,dataType:"jsonp",data:n})
},post:function(n,i){return e.ajax({url:n,data:t.toJSON(i),type:"POST",contentType:"application/json",dataType:"json"})}}}),n("plugins/observable",["durandal/system","durandal/binder","knockout"],function(e,t,n){function i(e){var t=e[0];return"_"===t||"$"===t}function o(t){return!(!t||void 0===t.nodeType||!e.isNumber(t.nodeType))}function r(e){if(!e||o(e)||e.ko===n||e.jquery)return!1;var t=p.call(e);return-1==h.indexOf(t)&&!(e===!0||e===!1)}function a(e,t){var n=e.__observable__,i=!0;if(!n||!n.__full__){n=n||(e.__observable__={}),n.__full__=!0,f.forEach(function(n){e[n]=function(){i=!1;var e=b[n].apply(t,arguments);return i=!0,e}}),g.forEach(function(n){e[n]=function(){i&&t.valueWillMutate();var o=v[n].apply(e,arguments);return i&&t.valueHasMutated(),o}}),m.forEach(function(n){e[n]=function(){for(var o=0,r=arguments.length;r>o;o++)s(arguments[o]);i&&t.valueWillMutate();var a=v[n].apply(e,arguments);return i&&t.valueHasMutated(),a}}),e.splice=function(){for(var n=2,o=arguments.length;o>n;n++)s(arguments[n]);i&&t.valueWillMutate();var r=v.splice.apply(e,arguments);return i&&t.valueHasMutated(),r};for(var o=0,r=e.length;r>o;o++)s(e[o])}}function s(t){var o,s;if(r(t)&&(o=t.__observable__,!o||!o.__full__)){if(o=o||(t.__observable__={}),o.__full__=!0,e.isArray(t)){var l=n.observableArray(t);a(t,l)}else for(var u in t)i(u)||o[u]||(s=t[u],e.isFunction(s)||c(t,u,s));y&&e.log("Converted",t)}}function l(e,t,n){var i;e(t),i=e.peek(),n?i?i.destroyAll||a(i,e):(i=[],e(i),a(i,e)):s(i)}function c(t,i,o){var r,c,u=t.__observable__||(t.__observable__={});if(void 0===o&&(o=t[i]),e.isArray(o))r=n.observableArray(o),a(o,r),c=!0;else if("function"==typeof o){if(!n.isObservable(o))return null;r=o}else e.isPromise(o)?(r=n.observable(),o.then(function(t){if(e.isArray(t)){var i=n.observableArray(t);a(t,i),t=i}r(t)})):(r=n.observable(o),s(o));return Object.defineProperty(t,i,{configurable:!0,enumerable:!0,get:r,set:n.isWriteableObservable(r)?function(t){t&&e.isPromise(t)?t.then(function(t){l(r,t,e.isArray(t))}):l(r,t,c)}:void 0}),u[i]=r,r}function u(t,i,o){var r,a={owner:t,deferEvaluation:!0};return"function"==typeof o?a.read=o:("value"in o&&e.error('For defineProperty, you must not specify a "value" for the property. You must provide a "get" function.'),"function"!=typeof o.get&&e.error('For defineProperty, the third parameter must be either an evaluator function, or an options object containing a function called "get".'),a.read=o.get,a.write=o.set),r=n.computed(a),t[i]=r,c(t,i,r)}var d,p=Object.prototype.toString,h=["[object Function]","[object String]","[object Boolean]","[object Number]","[object Date]","[object RegExp]"],f=["remove","removeAll","destroy","destroyAll","replace"],g=["pop","reverse","sort","shift","splice"],m=["push","unshift"],v=Array.prototype,b=n.observableArray.fn,y=!1;return d=function(e,t){var i,o,r;return e?(i=e.__observable__,i&&(o=i[t])?o:(r=e[t],n.isObservable(r)?r:c(e,t,r))):null},d.defineProperty=u,d.convertProperty=c,d.convertObject=s,d.install=function(e){var n=t.binding;t.binding=function(e,t,i){i.applyBindings&&!i.skipConversion&&s(e),n(e,t)},y=e.logConversion},d}),n("plugins/serializer",["durandal/system"],function(e){return{typeAttribute:"type",space:void 0,replacer:function(e,t){if(e){var n=e[0];if("_"===n||"$"===n)return void 0}return t},serialize:function(t,n){return n=void 0===n?{}:n,(e.isString(n)||e.isNumber(n))&&(n={space:n}),JSON.stringify(t,n.replacer||this.replacer,n.space||this.space)},getTypeId:function(e){return e?e[this.typeAttribute]:void 0},typeMap:{},registerType:function(){var t=arguments[0];if(1==arguments.length){var n=t[this.typeAttribute]||e.getModuleId(t);this.typeMap[n]=t}else this.typeMap[t]=arguments[1]},reviver:function(e,t,n,i){var o=n(t);if(o){var r=i(o);if(r)return r.fromJSON?r.fromJSON(t):new r(t)}return t},deserialize:function(e,t){var n=this;t=t||{};var i=t.getTypeId||function(e){return n.getTypeId(e)},o=t.getConstructor||function(e){return n.typeMap[e]},r=t.reviver||function(e,t){return n.reviver(e,t,i,o)};return JSON.parse(e,r)}}}),n("plugins/widget",["durandal/system","durandal/composition","jquery","knockout"],function(e,t,n,i){function o(e,n){var o=i.utils.domData.get(e,l);o||(o={parts:t.cloneNodes(i.virtualElements.childNodes(e))},i.virtualElements.emptyNode(e),i.utils.domData.set(e,l,o)),n.parts=o.parts}var r={},a={},s=["model","view","kind"],l="durandal-widget-data",c={getSettings:function(t){var n=i.utils.unwrapObservable(t())||{};if(e.isString(n))return{kind:n};for(var o in n)n[o]=-1!=i.utils.arrayIndexOf(s,o)?i.utils.unwrapObservable(n[o]):n[o];return n},registerKind:function(e){i.bindingHandlers[e]={init:function(){return{controlsDescendantBindings:!0}},update:function(t,n,i,r,a){var s=c.getSettings(n);s.kind=e,o(t,s),c.create(t,s,a,!0)}},i.virtualElements.allowedBindings[e]=!0,t.composeBindings.push(e+":")},mapKind:function(e,t,n){t&&(a[e]=t),n&&(r[e]=n)},mapKindToModuleId:function(e){return r[e]||c.convertKindToModulePath(e)},convertKindToModulePath:function(e){return"widgets/"+e+"/viewmodel"},mapKindToViewId:function(e){return a[e]||c.convertKindToViewPath(e)},convertKindToViewPath:function(e){return"widgets/"+e+"/view"},createCompositionSettings:function(e,t){return t.model||(t.model=this.mapKindToModuleId(t.kind)),t.view||(t.view=this.mapKindToViewId(t.kind)),t.preserveContext=!0,t.activate=!0,t.activationData=t,t.mode="templated",t},create:function(e,n,i,o){o||(n=c.getSettings(function(){return n},e));var r=c.createCompositionSettings(e,n);t.compose(e,r,i)},install:function(e){if(e.bindingName=e.bindingName||"widget",e.kinds)for(var n=e.kinds,r=0;r<n.length;r++)c.registerKind(n[r]);i.bindingHandlers[e.bindingName]={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t,n,i,r){var a=c.getSettings(t);o(e,a),c.create(e,a,r,!0)}},t.composeBindings.push(e.bindingName+":"),i.virtualElements.allowedBindings[e.bindingName]=!0}};return c}),n("transitions/entrance",["durandal/system","durandal/composition","jquery"],function(e,t,n){var i=100,o={marginRight:0,marginLeft:0,opacity:1},r={marginLeft:"",marginRight:"",opacity:"",display:""},a=function(t){return e.defer(function(e){function a(){e.resolve()}function s(){t.keepScrollPosition||n(document).scrollTop(0)}function l(){s(),t.triggerAttach();var e={marginLeft:u?"0":"20px",marginRight:u?"0":"-20px",opacity:0,display:"block"},i=n(t.child);i.css(e),i.animate(o,{duration:c,easing:"swing",always:function(){i.css(r),a()}})}if(t.child){var c=t.duration||500,u=!!t.fadeOnly;t.activeView?n(t.activeView).fadeOut({duration:i,always:l}):l()}else n(t.activeView).fadeOut(i,a)}).promise()};return a}),n("text",["module"],function(e){var n,i,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],r=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,s="undefined"!=typeof location&&location.href,l=s&&location.protocol&&location.protocol.replace(/\:/,""),c=s&&location.hostname,u=s&&(location.port||void 0),d=[],p=e.config&&e.config()||{};return n={version:"2.0.3",strip:function(e){if(e){e=e.replace(r,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(i){}if(e){o=[n];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),i=e.substring(0,n),o=e.substring(n+1,e.length);return n=o.indexOf("!"),-1!==n&&(t=o.substring(n+1,o.length),t="strip"===t,o=o.substring(0,n)),{moduleName:i,ext:o,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,i,o){var r,a,s,l=n.xdRegExp.exec(e);return l?(r=l[2],a=l[3],a=a.split(":"),s=a[1],a=a[0],!(r&&r!==t||a&&a.toLowerCase()!==i.toLowerCase()||(s||a)&&s!==o)):!0},finishLoad:function(e,t,i,o){i=t?n.strip(i):i,p.isBuild&&(d[e]=i),o(i)},load:function(e,t,i,o){if(o.isBuild&&!o.inlineText)return void i();p.isBuild=o.isBuild;var r=n.parseName(e),a=r.moduleName+"."+r.ext,d=t.toUrl(a),h=p.useXhr||n.useXhr;!s||h(d,l,c,u)?n.get(d,function(t){n.finishLoad(e,r.strip,t,i)},function(e){i.error&&i.error(e)}):t([a],function(e){n.finishLoad(r.moduleName+"."+r.ext,r.strip,e,i)})},write:function(e,t,i){if(d.hasOwnProperty(t)){var o=n.jsEscape(d[t]);i.asModule(e+"!"+t,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,t,i,o,r){var a=n.parseName(t),s=a.moduleName+"."+a.ext,l=i.toUrl(a.moduleName+"."+a.ext)+".js";n.load(s,i,function(){var t=function(e){return o(l,e)};t.asModule=function(e,t){return o.asModule(e,l,t)},n.write(e,s,t,r)},r)}},"node"===p.env||!p.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(i=t.nodeRequire("fs"),n.get=function(e,t){var n=i.readFileSync(e,"utf8");0===n.indexOf("")&&(n=n.substring(1)),t(n)}):"xhr"===p.env||!p.env&&n.createXhr()?n.get=function(e,t,i){var o=n.createXhr();o.open("GET",e,!0),p.onXhr&&p.onXhr(o,e),o.onreadystatechange=function(){var n,r;4===o.readyState&&(n=o.status,n>399&&600>n?(r=new Error(e+" HTTP status: "+n),r.xhr=o,i(r)):t(o.responseText))},o.send(null)}:("rhino"===p.env||!p.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java)&&(n.get=function(e,t){var n,i,o="utf-8",r=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),o)),l="";try{for(n=new java.lang.StringBuffer,i=s.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),n.append(i);null!==(i=s.readLine());)n.append(a),n.append(i);l=String(n.toString())}finally{s.close()}t(l)}),n}),n("text!account/facebook.html",[],function(){return'<i class="command close" data-bind="click:gologin"></i>\r\n\r\n<div style="position:relative; overflow:hidden;">\r\n   <div class="facebook profile" style="position:static">\r\n      <div class="avatar btn"></div>\r\n      <div class="avatar" data-bind="style: {backgroundImage: \'url(\\\'https://graph.facebook.com/\'+ facebookProfile.id +\'/picture?width=100&height=100\\\')\'}"></div>\r\n      <div class="name" data-bind="text: facebookProfile.name">Ali Arafati</div>\r\n   </div>\r\n</div>\r\n<p></p>\r\n<form data-bind="verifiableSubmit: signup">\r\n   <input type="text" placeholder="Username" data-bind="verifiableValue: username, disable: loading" autofocus autocorrect="off" autocapitalize="off" />\r\n   <span class="error" data-bind="text: username.validationMessage"></span>\r\n   <input type="text" placeholder="Email (optional)" data-bind="verifiableValue: email, disable: loading" />\r\n   <span class="error" data-bind="text: email.validationMessage"></span>\r\n\r\n   <p class="error" data-bind="text: errorMessage"></p>\r\n\r\n   <button class="blue" type="submit" data-bind="disable: loading">\r\n      <span>SIGN UP</span>\r\n   </button>\r\n</form>'}),n("text!account/index.html",[],function(){return"<div>    \r\n    <div data-bind=\"router: { transition: 'entrance', cacheViews: false }\"></div>\r\n</div>"}),n("text!account/l-faq.html",[],function(){return'<i class="command close" data-bind="click: close"></i>\r\n\r\n<div data-bind="compose: {view: \'static/faq\'}" class="scroll"\r\n     style="max-height: 400px;\r\n            overflow: scroll;\r\n            text-align: left;\r\n            color: black;\r\n            overflow-x: hidden;border-radius:8px;\r\n            margin: 1em -8px; padding: 1em;\r\n            border:1px solid #c8b39b"></div>\r\n<button class="blue" data-bind="click: close">OK, Cool!</button>'}),n("text!account/l-privacy.html",[],function(){return'<i class="command close" data-bind="click: close"></i>\r\n\r\n<div data-bind="compose: {view: \'../static/privacy\'}" class="scroll"\r\n     style="max-height: 400px;\r\n            overflow: scroll;\r\n            text-align: left;\r\n            color: black;\r\n            overflow-x: hidden;border-radius:8px;\r\n            margin: 1em -8px; padding: 1em;\r\n            border:1px solid #c8b39b"></div>\r\n<a href="#" target="_blank" style="position:absolute;right:1em" data-bind="attr: {href: \'app/static/privacy.html\'}">Open in new tab..</a>\r\n<button class="blue" data-bind="click: close">OK, Cool!</button>'}),n("text!account/l-terms.html",[],function(){return'<i class="command close" data-bind="click: close"></i>\r\n\r\n<div data-bind="compose: {view: \'../static/terms\'}" class="scroll"\r\n     style="max-height: 400px;\r\n            overflow: scroll;\r\n            text-align: left;\r\n            color: black;\r\n            overflow-x: hidden;border-radius:8px;\r\n            margin: 1em -8px; padding: 1em;\r\n            border:1px solid #c8b39b"></div>\r\n<a href="#" target="_blank" style="position:absolute;right:1em" data-bind="attr: {href: \'app/static/terms.html\'}">Open in new tab..</a>\r\n<button class="blue" data-bind="click: close">OK, Cool!</button>'}),n("text!account/login.html",[],function(){return'<!--<h1>Join The Game!</h1>-->\r\n<div style="position:relative; overflow:hidden;">\r\n   <button class="facebook" data-bind="enable: facebookLogin && !loading(), click:facebook">login with facebook</button>\r\n   <div class="facebook profile" data-bind="if: facebookProfile">\r\n      <div class="avatar btn"></div>\r\n      <div class="avatar" data-bind="style: {backgroundImage: \'url(\\\'https://graph.facebook.com/\'+ facebookProfile().id +\'/picture?width=100&height=100\\\')\'}"></div>\r\n      <div class="name" data-bind="text: facebookProfile().name">Ali Arafati</div>\r\n   </div>\r\n</div>\r\n<p>or</p>\r\n\r\n<form data-bind="verifiableSubmit: login">\r\n   <input type="text" placeholder="Username or e-mail" data-bind="verifiableValue: username, disable: loading, attr: { autofocus: !hasUsername }" autocorrect="off" autocapitalize="off" />\r\n   <span class="error" data-bind="text: username.validationMessage"></span>\r\n   <input type="password" placeholder="Password" data-bind="verifiableValue: password, disable: loading, attr: { autofocus: hasUsername }" />\r\n   <span class="error" data-bind="text: password.validationMessage"></span>\r\n\r\n   <p class="error" data-bind="text: errorMessage"></p>\r\n\r\n   <button class="blue" type="submit" data-bind="disable: loading">\r\n      <span>LOG IN</span>\r\n      <!--<i data-bind="visible: loading()" class="icon-spinner icon-spin"></i>-->\r\n   </button>\r\n</form>\r\n\r\n<a class="block link big space" data-bind="click: signUp">SIGN UP</a>\r\n<!--<a class="block link small" data-bind="click: recover">recover password</a>-->'}),n("text!account/oAuth/facebook.html",[],function(){return'<div>\r\n   <fb:login-button show-faces="true" width="200" max-rows="1"></fb:login-button>\r\n   <button class="blue" data-bind="click: login">facebook</button>\r\n</div>'}),n("text!account/recovery.html",[],function(){return'<h1>Recover password</h1>\r\n\r\n<i class="command close" data-bind="click:login"></i>\r\n\r\n<form data-bind="verifiableSubmit: recover">   \r\n   <p>Enter your email address bellow and you will receive an e-mail shortly giving you instruction to change your password.</p>\r\n   <br />\r\n   <input type="email" placeholder="email" data-bind="verifiableValue: email" autofocus />\r\n   <span class="error" data-bind="text: email.errorMessage"></span>\r\n\r\n   <p class="error" data-bind="text: errorMessage"></p>\r\n\r\n   <button class="blue" type="submit" data-bind="disable: loading()">\r\n      <span>Send Request</span>\r\n      <!--<i data-bind="visible: loading()" class="icon-spinner icon-spin"></i>-->\r\n   </button>\r\n</form>'}),n("text!account/sign-up.html",[],function(){return'<h1>Join The Game!</h1>\r\n\r\n<i class="command close" data-bind="click:login"></i>\r\n\r\n<form data-bind="verifiableSubmit: signUp">\r\n    <input type="text" placeholder="Username" data-bind="verifiableValue: username" autofocus autocorrect="off" autocapitalize="off" />\r\n    <span class="error" data-bind="text: username.validationMessage"></span>\r\n    <input type="email" placeholder="E-mail" data-bind="verifiableValue: email" autocorrect="off" autocapitalize="off" />\r\n    <span class="error" data-bind="text: email.validationMessage"></span>\r\n    <input type="password" placeholder="Password" data-bind="verifiableValue: password">\r\n    <span class="error" data-bind="text: password.validationMessage"></span>\r\n\r\n    <p class="error" data-bind="text: errorMessage"></p>\r\n\r\n    <button type="submit" class="blue" data-bind="disable: loading()">\r\n        <span>SIGN UP</span>\r\n        <!--<i data-bind="visible: loading()" class="icon-spinner icon-spin"></i>-->\r\n    </button>\r\n</form>\r\n\r\n<p class="agreement">\r\n    By clicking <i>sign up</i> you agree to our <br />\r\n    <a class="clickable" data-bind="click: terms"><b>Terms of Use</b></a> and\r\n    <a class="clickable" data-bind="click: privacy"><b>Privacy Policy</b></a>.\r\n</p>'}),n("text!account/static/login.html",[],function(){return'<!--<h1>Join The Game!</h1>-->\r\n<div style="position:relative; overflow:hidden;">\r\n   <button class="facebook" data-bind="click: facebook, enable: facebookLogin && !loading()">login with facebook</button>\r\n   <div class="facebook profile" data-bind="if: facebookProfile">\r\n      <div class="avatar btn"></div>\r\n      <div class="avatar" data-bind="style: {backgroundImage: \'url(\\\'https://graph.facebook.com/\'+ facebookProfile().id +\'/picture?width=100&height=100\\\')\'}"></div>\r\n      <div class="name" data-bind="text: facebookProfile().name">Ali Arafati</div>\r\n   </div>\r\n</div>\r\n<p>or</p>\r\n\r\n<form data-bind="verifiableSubmit: login">\r\n   <input type="text" placeholder="Username or e-mail" data-bind="verifiableValue: username, disable: loading" autofocus autocorrect="off" autocapitalize="off" />\r\n   <span class="error" data-bind="text: username.validationMessage"></span>\r\n   <input type="password" placeholder="Password" data-bind="verifiableValue: password, disable: loading" />\r\n   <span class="error" data-bind="text: password.validationMessage"></span>\r\n\r\n   <p class="error" data-bind="text: errorMessage"></p>\r\n\r\n   <button class="blue" type="submit" data-bind="disable: loading">\r\n      <span>LOG IN</span>\r\n      <!--<i data-bind="visible: loading()" class="icon-spinner icon-spin"></i>-->\r\n   </button>\r\n</form>\r\n\r\n<a class="block link big space" data-bind="click: signUp">SIGN UP</a>\r\n<!--<a class="block link small" data-bind="click: recover">recover password</a>-->'}),n("text!account/static/sign-up.html",[],function(){return'<h1>Join The Game!</h1>\r\n\r\n<i class="command close" data-bind="click:login"></i>\r\n\r\n<form data-bind="verifiableSubmit: signUp">\r\n   <input type="text" placeholder="Username" data-bind="verifiableValue: username" autofocus autocorrect="off" autocapitalize="off" />\r\n   <span class="error" data-bind="text: username.validationMessage"></span>\r\n   <input type="email" placeholder="E-mail" data-bind="verifiableValue: email" autocorrect="off" autocapitalize="off" />\r\n   <span class="error" data-bind="text: email.validationMessage"></span>\r\n   <input type="password" placeholder="Password" data-bind="verifiableValue: password">\r\n   <span class="error" data-bind="text: password.validationMessage"></span>\r\n\r\n   <p class="error" data-bind="text: errorMessage"></p>\r\n\r\n   <button type="submit" class="blue" data-bind="disable: loading()">\r\n      <span>SIGN UP</span>\r\n      <!--<i data-bind="visible: loading()" class="icon-spinner icon-spin"></i>-->\r\n   </button>\r\n</form>\r\n\r\n<p class="agreement">\r\n   By clicking <i>sign up</i> you agree to our <br /><b>Terms of Use</b> and <b>Privacy Policy</b>.\r\n</p>'}),n("text!api/ui/facebook.poem.html",[],function(){return'<i class="command close" data-bind="click: close"></i>\r\n<div class="facebook profile" style="position:static; top: 0">\r\n   <div class="avatar btn"></div>\r\n   <div class="avatar" data-bind="style: {backgroundImage: \'url(\\\'\'+ user.profileImageSrc +\'\\\')\'}"></div>\r\n   <div class="name" data-bind="text: user.name"></div>\r\n</div>\r\n<hr />\r\n<input type="text" placeholder="Message (optional)" data-bind="value: message" autofocus />\r\n<img data-bind="attr:{src: poem}" style="width: 300px;height: 300px; border-radius: 10px;margin-top: 5px;" />\r\n<hr />\r\n<div>\r\n   <button class="blue sm" data-bind="disable: uploading, click: publish, visible: !uploading()">Publish</button>\r\n   <div data-bind="visible: uploading() && uploadPercent() != 1">\r\n      Uploading\r\n      <progress max="1" data-bind="value: uploadPercent, text: (100 * uploadPercent()).toFixed()"></progress>\r\n   </div>\r\n   <div data-bind="visible: uploading() && uploadPercent() == 1">\r\n      Waiting for facebook...\r\n   </div>\r\n</div>\r\n\r\n\r\n'}),n("text!api/ui/palette.html",[],function(){return'<!--ko with: menu-->\r\n<div class="palette right fixed" data-bind="foreach: fixedItems, fadeVisible: visible">\r\n   <i data-bind="click: click, css: css, visible: visible, metaText: content, attr: {\'data-title\': title}"></i>\r\n</div>\r\n\r\n<div class="palette left">\r\n   <div class="actions" data-bind="foreach: leftItems, fadeVisible: visible">\r\n      <div class="btn" data-bind="click: click, attr: {\'data-title\': title}">\r\n         <i data-bind="css: css, visible: visible"></i>\r\n      </div>\r\n   </div>\r\n</div>\r\n<div class="palette right" data-bind="foreach: rightItems, fadeVisible: visible">\r\n    <i data-bind="click: click, css: css, visible: visible, attr: {\'data-title\': title}"></i>\r\n</div>\r\n<!--/ko-->'}),n("text!api/ui/paymentwall.html",[],function(){return'<div style="height: 450px">\r\n   <i class="command close" data-bind="click: close"></i>\r\n   <div style="position:absolute;width:100%;text-align:center;z-index:-1">\r\n      <div class="icon-spinner icon-2x icon-spin"></div>\r\n   </div>\r\n\r\n   <!--<iframe src="https://api.paymentwall.com/api/subscription/?key=ac27dccd2c6eb706c8a33055736ba9d7&uid=testuser@ozma.se&widget=p1_1"\r\n           width="750" height="435" frameborder="0"></iframe>-->\r\n</div>'}),n("text!api/ui/paypalcancel.html",[],function(){return"<div>\r\n    Waiting for paypal confirmation...\r\n</div>\r\n\r\n\r\n\r\n"}),n("text!api/ui/paypalcb.html",[],function(){return"<div>\r\n    Waiting for paypal confirmation...\r\n</div>\r\n\r\n\r\n\r\n"}),n("text!dialogs/pages/GameOver.html",[],function(){return'<i class="command close" data-bind="click: $parent.close"></i>\r\n\r\n<div class="wand-stars"></div>\r\n\r\n<h1 data-bind="text: heading"></h1>\r\n<div data-bind="html: content"></div>\r\n<br />\r\n<div data-bind="ifnot: xp <= -1 && !noXP">\r\n   <div class="strong">You received:</div>\r\n   <div class="xp-container">\r\n      <span class="xp" data-bind="text: xp"></span>\r\n      <span class="symbol">XP</span>\r\n   </div>\r\n</div>\r\n<br />\r\n<div style="width:160px; margin:0 auto; margin-bottom: 1em;">\r\n   <button class="blue enableGPU" data-bind="text: btnText, click: gotoLobby, clickBubble: false, style:{ width: btnSizeAuto ? \'auto\': \'160px\'}"></button>\r\n   <button class="orange enableGPU" style="width:160px" data-bind="visible: showButtons, click: showPoem">make a poem</button>\r\n</div>\r\n'}),n("text!dialogs/pages/LevelUp.html",[],function(){return'<i class="command close"></i>\r\n\r\n<div class="wand-left">\r\n    <h1>Congratulations!</h1>\r\n    <div>\r\n        You have reached level <span data-bind="text: level"></span>.\r\n    </div>\r\n    <br /><br />\r\n    <h1 style="font-size:2em;" class="curly">\r\n        You gained <span data-bind="text: besoz"></span> besoz.\r\n    </h1>\r\n    <div class="badge" data-bind="style: {backgroundImage: \'url(\\\'\' + imageName + \'\\\')\'}"></div>\r\n    <button class="blue" data-bind="click: close, clickBubble: false">OK, GREAT</button>\r\n</div>\r\n'}),n("text!dialogs/pages/LevelUpTitle.html",[],function(){return'<i class="command close"></i>\r\n\r\n<div class="badge" data-bind="style: {backgroundImage: \'url(\\\'\' + imageName + \'\\\')\'}">\r\n    <h1>Congratulations!</h1>\r\n    <div>You have reached the next difficulty level.</div>\r\n    <br style="font-size: 1.4em" />\r\n    <h1 style="font-size:2em;" class="curly" data-bind="text: title"></h1>\r\n    <button class="blue" data-bind="click: close, clickBubble: false">OK, GREAT</button>\r\n</div>\r\n'}),n("text!dialogs/pages/TutorialEnd.html",[],function(){return'<i class="command close" data-bind="click: $parent.close"></i>\r\n\r\n<h1>Good job!</h1>\r\n<div> Thats was all you need to know. </div>\r\n<br />\r\n<button class="blue enableGPU" data-bind="click: $parent.close">Start Playing</button>'}),n("text!dialogs/pages/TutorialNext.html",[],function(){return'<i class="command close" data-bind="click: $parent.close"></i>\r\n\r\n<h1>Good job!</h1>\r\n<div> Proceed to next tutorial..</div>\r\n<br />\r\n<button class="blue enableGPU" data-bind="click: $parent.close">Next</button>'}),n("text!dialogs/pages/addWords.html",[],function(){return'<i class="command close" data-bind="click: $parent.close"></i>\r\n<div>\r\n   <h1>Search for a word to add</h1>\r\n   <br />\r\n   <form class="search-box" data-bind="submit: search">\r\n      <input type="search" placeholder="type in part of a word.." maxlength="25" data-bind="value: lemma" autofocus />\r\n      <button class="btn" type="submit">\r\n         <i class="command find" data-bin1d="click: search"></i>\r\n      </button>\r\n      <i class="icon-spinner icon-spin" data-bind="css: {active: loading() && words().length == 0}"></i>\r\n   </form>\r\n   <div data-bind="if: words().length">\r\n      <div class="versions scroll sm" data-bind="foreach: words">\r\n         <div class="version" data-bind="text: $data, css: {active: $parent.activeWord() == $data}, click: $parent.select"></div>\r\n      </div>\r\n      <button class="blue enableGPU" data-bind="click: done, clickBubble: false, disable: loading() || words().length == 0, css:{\'has-currency\': !tMode()}">\r\n         <span class="currency">4</span>\r\n         Add Word\r\n      </button>\r\n   </div>\r\n   <div data-bind="if: words().length === 0 && searched">\r\n      <br />\r\n      <p>\r\n         Sorry! <b data-bind="text: searched"></b> does not exist in our database at the moment.\r\n         Would you like us to consider this word in future?\r\n      </p>\r\n      <button class="blue flat" style="font-size:.91em" data-bind="click: suggest">Yes, suggest this word!</button>\r\n   </div>\r\n</div>'}),n("text!dialogs/pages/alert-note.html",[],function(){return'<i class="command close" data-bind="click: $parent.close"></i>\r\n<div>\r\n   <h2 data-bind="text: title"></h2>\r\n   <i data-bind="text: content"></i>\r\n   <br /><br />\r\n   <button class="blue enableGPU" data-bind="click: $parent.close, clickBubble: false, text: btnText">OK!</button>   \r\n</div>'}),n("text!dialogs/pages/alert.html",[],function(){return'<i class="command close" data-bind="click: $parent.close"></i>\r\n<div data-bind="html: message"></div>\r\n<br />\r\n<button class="blue" data-bind="click: $parent.close">Okay</button>'}),n("text!dialogs/pages/besoz.html",[],function(){return'<i class="command close" data-bind="click: $parent.close"></i>\r\n<div>\r\n   <h2>Thank you for buying besoz!</h2>\r\n\r\n   <p>We hope you will have a good time spending them.</p>\r\n   \r\n   <br />\r\n   <button class="blue enableGPU" data-bind="click: $parent.close">OK!</button>   \r\n</div>'}),n("text!dialogs/pages/currency.html",[],function(){return'<i class="command close" data-bind="click: $parent.close"></i>\r\n<div>\r\n   <span class="loader-bar center" data-bind="fadeVisible: loading"><i></i><i></i><i></i></span>\r\n   <div class="table-flex" data-bind="foreach: list">\r\n      <div class="row mild-padding">\r\n         <!--ko if: flag--><div class="ribbon" data-bind="text: flag.flag, style: {backgroundColor: flag.colour}"></div><!-- /ko-->\r\n         <div class="item-icon currency" data-bind="css: \'item-icon-index-\' + iconID "></div>\r\n         <span class="besoz"><span data-bind="text: besoz"></span> besoz</span>\r\n         <span class="price"><span data-bind="text: price"></span> USD</span>\r\n         <button class="orange sm pull-right" data-bind="click: $parent.buy">BUY</button>\r\n         <span class="discount" data-bind="if: discount, text:discount"></span>\r\n      </div>\r\n   </div>   \r\n   <div class="payment-icon"></div>\r\n</div>\r\n'}),n("text!dialogs/pages/email.html",[],function(){return'<i class="command close" data-bind="click: $parent.close"></i>\r\n<div>\r\n   <h1>Change your Email</h1>\r\n   <form data-bind="submit: send">\r\n      <input type="email" placeholder="email address" maxlength="50" data-bind="verifiableValue: email" autocorrect="off" autocapitalize="off" autofocus />\r\n      <button class="blue" type="submit">Done</button>\r\n   </form>   \r\n</div>'}),n("text!dialogs/pages/invite.html",[],function(){return'<i class="command close" data-bind="click: $parent.close"></i>\r\n<div>\r\n   <!--<h1>Invite a friend!</h1>\r\n   <form data-bind="submit: send">\r\n      <input type="email" placeholder="email address" maxlength="50" data-bind="verifiableValue: email" autocorrect="off" autocapitalize="off" autofocus />\r\n      <button class="blue" type="submit">Send</button>\r\n   </form>   \r\n   <hr />-->\r\n   <button class="blue" data-bind="click: facebook">Invite via Facebook</button>\r\n</div>'}),n("text!dialogs/pages/noBesoz.html",[],function(){return'<i class="command close" data-bind="click: $parent.close"></i>\r\n<div>\r\n   <h2>Sorry, you don\'t have enough besoz!</h2>\r\n   <i>This purchase requires <span data-bind="text:besoz"></span> besoz.</i>\r\n   <br />\r\n   <div class="wand" style="position:absolute; right:30px;"></div>\r\n   <br /><br />\r\n   <button class="blue enableGPU" data-bind="click: getBesoz, clickBubble: false">\r\n      Get Besoz\r\n   </button>   \r\n</div>'}),n("text!dialogs/pages/paypalcancel.html",[],function(){return'<i class="command close" data-bind="click: $parent.close"></i>\r\n<div>\r\n   <h2>The transaction has been canceled!</h2>\r\n\r\n   <p>We have not received confirmation from Paypal; therefore, no money was deducted from your account.</p>\r\n   \r\n   <br />\r\n   <button class="blue enableGPU" data-bind="click: $parent.close">OK!</button>   \r\n</div>'}),n("text!dialogs/pages/shop-collections.html",[],function(){return'<i class="command close" data-bind="click: $parent.close"></i>\r\n<div class="table-flex">\r\n    <div class="row">\r\n        <div class="head" data-bind="text: longName"></div>\r\n        <div class="body">\r\n            <p data-bind="text: example" style="text-align: center; font-style:italic; font-size: 18px;"></p>\r\n            <div class="collection centered full-row">\r\n                <!-- ko if: dependent-->\r\n                <p>\r\n                    In order to unlock this booster, you need to buy the starter first.\r\n                </p>\r\n                <div class="couple has-currency" data-bind="css: dependent.shortName">\r\n                    <div class="currency" data-bind="text: dependent.price"></div>\r\n                </div>\r\n                <!-- /ko -->\r\n                <div class="couple has-currency" data-bind="css: shortName ">\r\n                    <div class="currency" data-bind="text: price"></div>\r\n                </div>\r\n                <p class="font-smaller" style="text-align:left">\r\n                    <!-- ko if: dependent-->\r\n                    <span data-bind="text: dependent.longDescription"></span>\r\n                    <!-- /ko -->\r\n                    <span data-bind="text: longDescription"></span>\r\n                </p>\r\n                <p>\r\n                    New Tiles: <span class="" data-bind="text: nImages + (dependent? dependent.nImages: 0)"></span>,\r\n                    New Words: <span class="" data-bind="text: nWords + (dependent? dependent.nWords: 0)"></span>\r\n                </p>\r\n                <br />\r\n                <p class="bold">\r\n                    Buy\r\n                    <span data-bind="if: dependent">both starter and booster</span>\r\n                    <span data-bind="if: dependent == null">\r\n                        <span data-bind="text: \'this \' + type"></span>\r\n                    </span>\r\n                    for <span data-bind="text: totalPrice"></span> besoz.\r\n                </p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <button class="orange centered normal" data-bind="click: $parent.close.bind(null, {confirm: true})">\r\n        <span class="currency" data-bind="text: totalPrice"></span>\r\n        Buy\r\n    </button>\r\n</div>\r\n\r\n'
}),n("text!dialogs/pages/versions.html",[],function(){return'<div style="min-height:200px">\r\n   <i class="command close" data-bind="click: $parent.close"></i>\r\n   <div data-bind="if: step() == 1">\r\n      <h1>Select a word to change its ending</h1>\r\n      <div class="dropzone" data-bind="visible: !dropped(), pointer: {enter: enter, leave: leave, drop: drop}">\r\n         <span data-bind="ifnot: message">You can only change verbs right now. <br /> Drag and drop the word here!</span>\r\n         <!-- ko if: message -->\r\n         <div data-bind="html: message"></div>\r\n         <!-- /ko-->\r\n      </div>\r\n      <div data-bind="if: dropped">\r\n         <div class="loader-bar"><i></i><i></i><i></i></div>\r\n      </div>\r\n   </div>\r\n   <div data-bind="if: step() == 2">\r\n      <h2>Choose an alternative for <span class="magnet view" data-bind="text: lemma"></span></h2>\r\n      <div class="versions" data-bind="foreach: versions">\r\n         <div class="version" data-bind="text: $data, css: {active: $parent.activeVersion() == $data}, click: $parent.select"></div>\r\n      </div>\r\n      <button class="blue enableGPU" data-bind="click: done, clickBubble: false, disable: loading() || versions().length == 0, css:{\'has-currency\': !tMode()}">\r\n         <span class="currency" data-bind="visible: !tMode()">2</span>\r\n         Change Word\r\n      </button>\r\n   </div>\r\n</div>'}),n("text!dialogs/pages/welcome.html",[],function(){return'<i class="command close" data-bind="click: $parent.close"></i>\r\n\r\n<h1>Welcome to Words of Oz!</h1>\r\n<p>\r\n   We are excited to have you as a new player. <br /> Let\'s start with a short tutorial.\r\n</p>\r\n<h2 class="bold">Good luck!</h2>\r\n<button class="blue">Let\'s do this!</button>\r\n   '}),n("text!dialogs/templates/alert.html",[],function(){return'<div class="dialog top-center">\r\n    <div class="alert" data-bind="html: content"></div>\r\n</div>\r\n'}),n("text!dialogs/templates/confirm.html",[],function(){return'<div class="dialog bottom-center">\r\n    <div class="ui-overlay"></div>\r\n    <div class="confirm">\r\n        <p data-bind="html:content, visible:content"></p>\r\n        <button class="flat orange" data-bind="click: cancel, text:cancelText">CANCEL</button>\r\n        <button class="flat blue" data-bind="click: done, text: doneText">DONE</button>\r\n    </div>\r\n</div>\r\n'}),n("text!dialogs/templates/control.html",[],function(){return'<div class="dialog top-center">\r\n    <div class="control">\r\n        <div class="nWords">\r\n            <div class="up" data-bind="click: up"></div>\r\n            <div class="number" data-bind="text: nWords"></div>\r\n            <div class="down" data-bind="click: down"></div>\r\n            <div style="clear: both"></div>\r\n        </div>\r\n        <div class="btnDel" data-bind="click: del">X</div>\r\n        <div class="btnCW" data-bind="click: cw">CW</div>\r\n        <div style="clear: both"></div>\r\n    </div>\r\n</div>\r\n'}),n("text!dialogs/templates/loading.html",[],function(){return'<div class="dialog top-center modal">\r\n    <div class="ui-overlay" data-bind="fadeVisible: loading"></div>\r\n    <div class="block loading" data-bind="fadeVisible: loading">\r\n        <div class="loading-image"></div>\r\n        <div data-bind="css: {\'loading-content\': box}">\r\n            <h1 data-bind="text: loadingStatus"></h1>\r\n            <i data-bind="visible: loading" class="icon-spinner icon-2x icon-spin active"></i>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),n("text!dialogs/templates/menu.html",[],function(){return'<div class="dialog top-right modal">\r\n    <div class="ui-overlay transparent" data-bind="click: close"></div>\r\n    <div class="menu" data-bind="click: close, foreach: items">\r\n        <button class="menuItem float left" data-bind="click: $root.nav">\r\n            <span data-bind="text: text"></span>\r\n            <i data-bind="css: icon"></i>\r\n        </button>\r\n        <div class="clear"></div>\r\n    </div>\r\n</div>\r\n'}),n("text!dialogs/templates/notice.html",[],function(){return'<div class="dialog top-center" data-bind="css: {modal: modal, clickable: closeOnClick}">\r\n   <div class="ui-overlay"></div>\r\n   <!-- ko if: closeOnClick -->\r\n   <div class="notice" data-bind="click: close, compose: {model: model, view: view, preserveContext: true}, css: css"></div>\r\n   <!-- /ko-->\r\n   <!-- ko ifnot: closeOnClick -->\r\n   <div class="notice" data-bind="compose: {model: model, view: view, preserveContext: true}, css: css"></div>\r\n   <!-- /ko-->\r\n</div>\r\n'}),n("text!dialogs/templates/panel.html",[],function(){return'<div class="dialog top-center" data-bind="css: modal? \'modal\': \'absolute\' ">\r\n    <div class="ui-overlay"></div>\r\n    <div class="panel" data-bind="compose: { model: modelName}, style: {zIndex: !modal ? \'auto\': \'10\'}, css: css"></div>\r\n</div>\r\n\r\n'}),n("text!dialogs/templates/slipper-fixed.html",[],function(){return'<div class="dialog top-center absolute">\r\n    <div class="ui-overlay"></div>\r\n    <div class="slipper" data-bind="click: collapse">\r\n        <h1 data-bind="text: heading"></h1>\r\n        <div class="content" data-bind="html: content"></div>\r\n    </div>\r\n</div>\r\n'}),n("text!dialogs/templates/slipper-profile.html",[],function(){return'<div class="dialog top-right modal">\r\n   <div class="ui-overlay transparent" data-bind="click: close"></div>\r\n   <div class="profile" data-bind="click: close">\r\n      <div class="title" data-bind="text: title"></div>\r\n      <div class="username" data-bind="text: username"></div>\r\n       <div data-bind="visible: owner">\r\n           <div class="xp" data-bind="xp: { value: xp, max: xpMax }"></div>\r\n           <div class="level"> Level <span data-bind="text: level"></span></div>\r\n       </div>\r\n      <div class="pic"></div>\r\n      <div class="cmd" data-bind="visible: !owner">\r\n         <i class="icon addFriend" data-title="Add Friend" data-bind="click: $root.addFriend, css:{disabled: $root.isFriend}"></i>\r\n         <i class="icon block" data-title="Block User" data-bind="click: $root.blockUser, css:{disabled: $root.isFriend}"></i>\r\n      </div>\r\n      <div class="level-icon" data-bind="style:{ backgroundImage: \'url(\\\'images/game/level/\' + title().toLowerCase() + \'.png\\\')\' }"></div>\r\n   </div>\r\n</div>\r\n'}),n("text!dialogs/templates/slipper.html",[],function(){return'<div class="dialog top-center">\r\n    <div class="ui-overlay"></div>\r\n    <div class="slipper" data-bind="click: collapse">\r\n        <h1 data-bind="text: heading"></h1>\r\n        <div class="content" data-bind="html: content"></div>\r\n        <!--<div class="btnCommand" data-bind="click: collapse"></div>-->\r\n    </div>\r\n</div>\r\n'}),n("text!dialogs/templates/tutorial.html",[],function(){return'<div class="dialog absolute low top-left">\r\n   <div class="tutorial" data-bind="css: css, click: onClose">\r\n      <button><i class="command close"></i></button>\r\n      <div class="content">\r\n         <h1 data-bind="text: heading"></h1>\r\n         <div data-bind="html: content"></div>\r\n      </div>\r\n      <h1 data-bind="text: heading"></h1>\r\n      <div data-bind="html: content" style="white-space:nowrap"></div>\r\n   </div>\r\n</div>\r\n'}),n("text!dialogs/templates/window.html",[],function(){return'<div class="dialog absolute low top-left">\r\n   <div class="window">\r\n      <div style="position:absolute; top:0; right:0; width:32px; height: 32px; z-index: 2" data-bind="click: close">\r\n         <i class="command close"></i>\r\n      </div>\r\n      <h1 data-bind="text: heading"></h1>\r\n      <div data-bind="html: content"></div>\r\n   </div>\r\n</div>\r\n'}),n("text!error/not-found.html",[],function(){return'<div style="width:100%">\r\n    <div id=splash>\r\n        <h1>Page not found</h1>\r\n    </div>\r\n</div>'}),n("text!game-editor/edit.html",[],function(){return'<div>\r\n   <div id="game-main">\r\n      <!--ko compose: { model: \'game/canvas\', mode: \'inline\' }--><canvas></canvas><!--/ko-->\r\n      <div class="logo page"></div>\r\n      <!--ko compose: \'game-editor/tiles\'--><!--/ko-->\r\n      <hr />\r\n      <!--ko compose: \'game/words\'--><!--/ko-->\r\n   </div>\r\n   <div id="game-players" data-bind="compose: \'game/players\'"></div>\r\n   <div id="menu">\r\n      <div class="palette left">\r\n         <div class="actions">\r\n            <label class="sm">\r\n               Game Level\r\n               <input type="number" data-bind="value: level" max="2" min="0"\r\n                      style="position:absolute; width: 2em; padding: .5em; border: 1px solid #d7bea2; background-color: #F9F8F4; border-radius: 5px; float:right; top:.7em;right:2em" />\r\n            </label>\r\n            <label class="sm">\r\n               Draft\r\n               <input type="checkbox" data-bind="checked: draft" /> <span></span>\r\n            </label>\r\n            <i class="command green" data-bind="click: addTile"><span>add tile</span></i>\r\n            <i class="command pink" data-bind="click: save, css: {disabled: loading}"><span>save</span></i>\r\n            <i class="action" data-bind="click: debug, css: { cancel: debugMode }"><span>debug</span></i>\r\n            <i class="action" data-bind="click: portrait, css: { cancel: portraitMode }"><span>portrait</span></i>\r\n         </div>\r\n      </div>\r\n\r\n      <div class="palette right">\r\n         <div class="actions">\r\n            <i class="command back" data-bind="click: back"><span>BACK</span></i>\r\n         </div>\r\n      </div>\r\n   </div>\r\n</div>\r\n'}),n("text!game-editor/menu.html",[],function(){return'<div>\r\n   <div style="margin: 30px 0 0 30px">\r\n      <button class="orange flat" data-bind="click: createNew">Create New Game Board</button>\r\n      <div class="loader active" data-bind="visible: !groups().length">\r\n         <i class="icon-spinner icon-2x icon-spin"></i>\r\n      </div>\r\n   </div>\r\n   <div class="grid container y scroll auto" data-bind="foreach: groups, style:{\'max-height\': height() + \'px\'}" style="max-width:550px">\r\n      <!-- ko if: $data -->\r\n      <h1>Level <span data-bind="text: key"></span></h1>\r\n      <div class="table compact" data-bind="foreach: { data: value, beforeRemove: $root.beingRemove }">\r\n         <div class="game-item">\r\n            <div class="cell" style="width: 500px" data-bind="click: $root.edit">\r\n               <div class="float left"\r\n                    style="height: 3em; width: 4em; position: relative; margin-right: 10px; box-shadow: 0 0 1px #986B31; background-color: #F1EAD7"\r\n                    data-bind="foreach: tiles">\r\n                  <a data-bind="style: { left: 100 * x + \'%\', top: 100 * y + \'%\' }"\r\n                     style="display: block; background-color: rgba(255, 106, 0, .5); width: 10px; height: 10px; border-radius: 100%; position: absolute; margin-left: -5px; margin-top: -5px"></a>\r\n               </div>\r\n               <div class="float left">\r\n                  <div>#Tiles: <span class="bold" data-bind="text: tiles.length"></span></div>\r\n                  <div>#Paths: <span class="bold" data-bind="text: paths.length"></span></div>\r\n               </div>\r\n               <div class="float left">\r\n                  <div style="margin-left:2em">\r\n                     <span data-bind="timeAgo: modDate, attr:{title: new Date(modDate)}"></span>\r\n                  </div>\r\n                  <div style="margin-left:2em">\r\n                     <span data-bind="if: draft">Draft</span>\r\n                     <span data-bind="ifnot: draft">Published</span>\r\n                  </div>\r\n               </div>\r\n               <div class="float right visibleOnHover visibleOnActive">\r\n                  <button class="right blue flat" data-bind="click: $root.remove, clickBubble: false">Remove</button>\r\n               </div>\r\n            </div>\r\n         </div>\r\n      </div>\r\n      <!-- /ko -->\r\n   </div>\r\n</div>\r\n'}),n("text!game-editor/tiles.html",[],function(){return'<div id="gameboard">\r\n   <div id="tiles-max">\r\n      <div id="tiles-aspect">\r\n         <div id="tiles" data-bind="css: collection.name" style="border: 1px solid orange">\r\n            <div class="container" style="border: 1px solid blue" data-bind="foreach: { data: tiles, afterRender: afterRender }">\r\n               <div class="tile">\r\n                  <div class="tile-circle">\r\n                     <div style="position:relative; width: 100%; height:100%">\r\n                        <div class="cloud drag">\r\n                           <div class="rule">\r\n                              <span data-bind="text: instruction"></span>\r\n                              <div class="info" data-bind="text: info"></div>\r\n                              <div class="help"></div>\r\n                           </div>\r\n                        </div>\r\n                        <div class="mask norm" data-bind="style: { backgroundPosition: ((100 / 29) * imageId).toFixed(2) + \'% 0\' }"></div>\r\n                        <div class="rest" data-bind="foreach: rest">\r\n                           <div class="thumbnail"\r\n                                data-bind="style: { backgroundImage: \'url(\\\'\' + imageName + \'\\\')\' }, click: $parent.addPath.bind($parent)">\r\n                           </div>\r\n                        </div>\r\n                        <div class="control">\r\n                           <div style="width: 30px; position: relative; top: 10px;">\r\n                              <div class="up" data-bind="click: $parent.tileAngleUp, clickBubble: false"></div>\r\n                              <div class="number" data-bind="text: angle"></div>\r\n                              <div class="down" data-bind="click: $parent.tileAngleDown, clickBubble: false"></div>\r\n                              <div style="clear: both"></div>\r\n                           </div>\r\n                           <div style="width: 20px; position: absolute; top: 20px; right: 0">\r\n                              <div class="btnDel" data-bind="click: $parent.del">X</div>\r\n                           </div>\r\n                        </div>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n            </div>\r\n         </div>\r\n      </div>\r\n   </div>\r\n</div>\r\n'}),n("text!game/game.html",[],function(){return'<div>\r\n   <img id="star" src="images/app/star.png" style="display: none;" />\r\n\r\n   <div id="game-main" data-bind="css: { loading: loading }">\r\n      <div class="ui-overlay fullscreen transparent top" data-bind="visible: anyTileActive, click: toggleTile"></div>\r\n      <div class="logo page"></div>\r\n      <div id="game-players" data-bind="compose: \'game/players\'"></div>\r\n      <!--ko compose: { model: \'game/canvas\', mode: \'inline\' }--><canvas></canvas><!--/ko-->\r\n      <!--ko compose: \'game/tiles\'--><!--/ko-->\r\n      <!--ko compose: \'game/words\'--><!--/ko-->\r\n   </div>\r\n</div>\r\n'}),n("text!game/players.html",[],function(){return'<div id="game-players">\r\n   <div id="players" data-bind="foreach: players(), visible: !loading()" style="z-index: 2">\r\n      <div class="player enableGPU" data-bind="click: $root.showProfile">\r\n         <div class="decoration">\r\n            <div class="score">\r\n               <p data-bind="text: score"></p>\r\n            </div>\r\n         </div>\r\n         <div class="name">\r\n            <p data-bind="text: username"></p>\r\n         </div>\r\n      </div>\r\n   </div>\r\n</div>\r\n'}),n("text!game/poem/background.html",[],function(){return'<input type="text" style="text-align:center" data-bind="value: title, valueUpdate: \'input\'" placeholder="Enter a title (optional)" />\r\n<div class="clear"></div>\r\n<div data-bind="slider: {items: tiles, selectedItem: tile }">\r\n   <div data-part="item" style="height: 430px">\r\n      <div data-bind="tile: {tile: $data}">\r\n         <div data-part="text">\r\n            <div class="ctrl">\r\n               <i class="shade" data-bind="click: $root.action.bind($root, \'shade\')"></i>\r\n               <i class="size" data-bind="click: $root.action.bind($root, \'size\')"></i>\r\n               <i class="color" data-bind="click: $root.switchColor"></i>\r\n               <div class="box" data-bind="visible: $root.settings.visible">\r\n                  <button data-bind="click: $root.action.bind($root, null)" tabindex="-1">\r\n                     <i class="command close"></i>\r\n                  </button>\r\n                  <div class="content" data-bind="with: $root.settings.current">\r\n                     <i data-bind="css: name"><s>a</s></i>\r\n                     <i data-bind="css: name"><s>a</s></i>\r\n                     <div class="teeth" data-bind="foreach: $root.range(min, max), css: name"><div class="tooth"></div></div>\r\n                     <div class="range">\r\n                        <input type="range" tabindex="-1" data-bind="attr:{min: min, max: max}, value: value, valueUpdate: \'input\'" />\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n            </div>\r\n            <div class="confiner">\r\n               <div class="poem-container" data-bind="css: $root.settings.lightColor() ? (\'light shade-\' + $root.settings.shade.value() ): (\'dark shade-\'+  $root.settings.shade.value())">\r\n                  <div class="row" data-bind="css: {none: $root.title() == \'\' }"></div>\r\n                  <div class="row" data-bind="css: {none: $root.title() == \'\' }">\r\n                     <h1 data-bind="text: $root.title, resizeText: {maxWidth: 220, size: {max: 1.5, min: 1.05 } }"></h1>\r\n                  </div>\r\n                  <div class="poem" data-bind="style: {fontSize: $root.settings.size.value() + \'px\'}">\r\n                     <!--ko foreach: $root.phrases -->\r\n                     <div class="phrase" data-bind="text: phrase"></div>\r\n                     <!-- /ko -->\r\n                  </div>\r\n               </div>\r\n            </div>\r\n         </div>\r\n      </div>\r\n   </div>\r\n</div>'}),n("text!game/poem/index.html",[],function(){return'<i class="command close" data-bind="click: $parent.close"></i>\r\n<div style="min-height: 400px">\r\n   <h1 data-bind="text: heading"></h1>\r\n   <div data-bind="compose: {model: page, transition: \'entrance\'}"></div>\r\n   <button class="orange flat" data-bind="click: back, visible: hasBack">< Back</button>\r\n   <button class="blue flat" data-bind="click: next, enable: canNext, text: btnNextCaption">Next ></button>\r\n</div>'}),n("text!game/poem/phrase.html",[],function(){return'<div style="min-height:450px;">\r\n   <p>Drag the phrases in the order you like. <br />Drag a phrase below the line to exclude from the poem.</p>\r\n   <div style="display:table; width:100%">\r\n      <div style="display:table-cell; vertical-align:top" data-bind="list: {items: phrases, draggable: true, splitters: splitters, moved: moved}">\r\n         <div data-part="item" class="phrase" data-bind="text: phrase"></div>\r\n      </div>\r\n   </div>\r\n</div>\r\n'}),n("text!game/poem/share.html",[],function(){return'<div class="center">\r\n    <i class="clickable social fb" data-bind="click: facebook"></i>\r\n    <i class="clickable social pn disabled"></i>\r\n    <i class="clickable social tw disabled"></i>\r\n</div>\r\n\r\n<div class="slider">\r\n    <div data-bind="tile: {tile: tile()}" style="height: 422px" class="poem-mask">\r\n        <div data-part="text">\r\n            <div class="confiner">\r\n                <div class="poem-container" data-bind="css: $root.settings.lightColor() ? (\'light shade-\' + $root.settings.shade.value() ): (\'dark shade-\'+  $root.settings.shade.value())">\r\n                    <div class="row" data-bind="css: {none: $root.title() == \'\' }"></div>\r\n                    <div class="row" data-bind="css: {none: $root.title() == \'\' }">\r\n                        <h1 data-bind="text: $root.title, resizeText: {maxWidth: 220, size: {max: 1.5, min: 1.05 } }"></h1>\r\n                    </div>\r\n                    <div class="poem" data-bind="style: {fontSize: $root.settings.size.value() + \'px\'}">\r\n                        <!--ko foreach: $root.phrases -->\r\n                        <div class="phrase" data-bind="text: phrase"></div>\r\n                        <!-- /ko -->\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'}),n("text!game/tiles.html",[],function(){return'<div id="gameboard" data-bind="css: {carry: carryingWords}">\r\n   <div id="tiles-max">\r\n      <div id="tiles-aspect">\r\n         <div id="tiles" data-bind="css: collection.name">\r\n            <div class="container" data-bind="foreach: { data: tiles, afterRender: afterRender }">\r\n               <div class="tile" data-bind="css: { active: active }, click: $root.toggleTile">\r\n                  <div class="tile-circle">\r\n                     <div class="cloud" data-bind="if: instruction != \'\'">\r\n                        <div class="rule" \r\n                             data-bind="click: $root.help, clickBubble: false, fadeVisible: !$root.gameOver() || $root.forceVisible(), duration:{ fadeOut: 1200, type: \'transition\' }">\r\n                           <span data-bind="text: instruction"></span>\r\n                           <div class="info" data-bind="text: info"></div>\r\n                           <i class="command help sm"></i>\r\n                        </div>\r\n                     </div>\r\n                     <div class="mask" data-bind="style: { \'backgroundPosition\': ((100 / 29) * imageId).toFixed(2) + \'% 0\' }">\r\n                        <div class="big visibleOnActive" data-bind="style: { backgroundImage: \'url(\\\'\' + imageName + \'\\\')\' }"></div>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n            </div>\r\n            <!-- ko if: $root.tutorialMode -->\r\n            <div class="notice-board" data-bind="with: tutorialObject">\r\n               <h1 data-bind="text: title"></h1>\r\n               <p data-bind="html: description"></p>\r\n            </div>\r\n            <div class="footer" data-bind="with: tutorialObject">\r\n               <div class="page" data-bind="text: page"></div>\r\n               <div class="skip-link">\r\n                  <a data-bind="click: skip">skip tutorial</a>\r\n               </div>\r\n            </div>\r\n            <!-- /ko -->\r\n         </div>\r\n      </div>\r\n   </div>\r\n   <div class="ui-overlay" data-bind="fadeVisible: disabled"></div>\r\n</div>\r\n<hr data-bind="visible: !loading()" />\r\n'}),n("text!game/words.html",[],function(){return'<div id="workspace">\r\n   <!-- ko foreach:{ data: words, afterRender: afterRender } --><div class="magnet" data-bind="css: { related: isRelated, selected: isSelected, \'new\': css == \'new\' }">\r\n      <span data-bind="text: lemma"></span>\r\n      <!-- ko if:points-->\r\n      <span class="points" data-bind="text: points"></span>\r\n      <!-- /ko -->\r\n   </div><!-- /ko-->\r\n</div>'}),n("text!home/help.html",[],function(){return'<div class="enableGPU">\r\n    <div class="logo page"></div>\r\n    <br />\r\n    <div class="grid page faq">\r\n        <h1>FAQ</h1>\r\n        <div class="container y scroll" style="max-height: 700px">\r\n            <ul>\r\n                <li>How do I start a new game?</li>\r\n                <li>How do I invite a friend to play with me?</li>\r\n                <li>What are the rules for Words of Oz?</li>\r\n                <li>How do I score points</li>\r\n                <li>How can I get new words to use in the game?</li>\r\n                <li>How can I get more /currency/?</li>\r\n                <li>How do I get more tiles and words to play with?</li>\r\n                <li>Can I change the language of the game?</li>\r\n                <li>How do I change my profile settings?</li>\r\n                <li>I\'ve forgotten my password, can I get a new one?</li>\r\n                <li>Is there a single player version?</li>\r\n            </ul>\r\n            <div class="details">\r\n                assafkla sjskld\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),n("text!home/index.html",[],function(){return'<div>\r\n   <div id="login-page">\r\n      <div class="top">\r\n         <div id="bKey" class="background logo"></div>\r\n      </div>\r\n      <div class="bottom">\r\n         <div id="fKey" class="background footer"></div>\r\n      </div>\r\n   </div>   \r\n</div>\r\n'}),n("text!home/lobby/games.html",[],function(){return'<div style="position:relative">\r\n   <!-- ko if: type() === \'archive\' -->\r\n   <div class="note pull-right" data-bind="visible: type() == \'archive\' && archiveStorageVisibility()">\r\n      You can see up to <span data-bind="text: storage "></span> archived games at the time. <a data-bind="click: gotoShopStorage">Get more space</a>!\r\n   </div>\r\n   <!-- /ko -->\r\n   <!-- ko ifnot: type() == \'notification\' -->\r\n   <div data-bind="foreach: list, loadMore: $root.nextPageGames">\r\n      <h1 data-bind="text: title, visible: !$root.loading() || games().length != 0" class="archive"></h1>\r\n      <!-- ko if: games().length -->\r\n      <div data-bind1="css: {\'container y scroll games\': $root.type() == \'archive\'}">\r\n         <div class="table" data-bind="template: {foreach: games, afterAdd: $root.forGames.show, afterRender: $root.forGames.render}">\r\n            <div class="game-item" data-bind="click: $root.selectGame, css: {unseen: !seenOngoing}">\r\n               <div class="cell left">\r\n                  <div class="subCell">\r\n                     <div class="pic" data-bind="css: collection.shortName"></div>\r\n                  </div><div class="subCell" style="width:100%">\r\n                     <div class="flow" data-bind="foreach: summary">\r\n                        <div data-bind="html: $data"></div>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n               <div class="cell right">\r\n                  <div class="wrapper">\r\n                     <div class="btn" data-bind="click: $root.resign.bind($root, $data), clickBubble: false, visible: $root.type() == \'ongoing\'">\r\n                        <i class="command close compact" title="Resign the game"></i>\r\n                     </div>\r\n                     <div class="box">\r\n                        <div class="time" title="" data-bind="timeAgo: modDate"></div>\r\n                        <div class="chat" title="Number of unread messages">\r\n                           <div data-bin1d="text: unreads"></div>\r\n                        </div>\r\n                     </div>\r\n                     <div class="players" data-bind="foreach: players">\r\n                        <div>\r\n                           <span class="player" data-bind="text: username"></span>\r\n                           <span class="score" data-bind="text: score"></span>\r\n                        </div>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n            </div>\r\n         </div>\r\n      </div>\r\n      <!-- /ko -->\r\n      <i class="message" data-bind="text: empty, visible: games().length == 0 && !$root.loading()"></i>\r\n   </div>\r\n   <!-- /ko -->\r\n   <div style="width: 100%; height: 20px"></div>\r\n</div>'}),n("text!home/lobby/index.html",[],function(){return'<div>\r\n   <div class="logo page"></div>\r\n   <div class="grid page noLeft">\r\n      <button class="orange sm" style="position:relative; float: right; top: -3.5em; right: -3em; z-index: 1;" \r\n              data-bind="click: start">\r\n         Start New Game\r\n      </button>\r\n      <br />\r\n      <div class="tab responsive" \r\n           data-bind="tab: {nav: navigate, navEnd: navEnd, navSwitch: navSwitch, activeTab: activeTab}">\r\n         <nav>\r\n            <ul>\r\n               <li><span>ongoing games</span></li>\r\n               <li>\r\n                  <span class="animate" data-bind="css: unseens() == 0 ? \'\': \'has-number\'">\r\n                     notifications\r\n                     <span class="number" data-bind="text: unseens, visible: unseens"></span>\r\n                  </span>\r\n               </li>\r\n               <li><span>game archive</span></li>\r\n               <li class="ending"><span>ending</span></li>\r\n            </ul>\r\n            <div class="loader-bar" data-bind="fadeVisible: $root.loading() || $root.loadingData()"><i></i><i></i><i></i></div>\r\n         </nav>\r\n         <div class="content">\r\n            <div>\r\n               <div data-bind="compose: compose"></div>\r\n            </div>\r\n         </div>\r\n      </div>\r\n   </div>\r\n\r\n</div>\r\n'}),n("text!home/lobby/notifications.html",[],function(){return'<div>\r\n   <div class="table-flex" data-bind="loadMore: nextPageNotifications">\r\n       <!-- ko if: !notifications().length -->\r\n        <div class="poem-page">\r\n           <div class="note pull-left">\r\n               You have no notification yet.\r\n           </div>\r\n       </div>\r\n       <!-- /ko -->\r\n      <!--ko template: {foreach: notifications, afterAdd: notifications.show, afterRender: notifications.render}-->\r\n      <div class="row mild-padding no-shadow rightRibbon" style="max-width:520px"\r\n           data-bind="css:{won: won, newGame: newGame, resigned: resigned, over: over, unseen: !seen }, click: $root.selectGame">\r\n         <span data-bind="html: notificationSummary"></span>         \r\n      </div>\r\n      <!-- /ko -->\r\n   </div>\r\n</div>'}),n("text!home/newGame.html",[],function(){return'<div class="enableGPU">\r\n   <div class="logo page"></div>\r\n   <br />\r\n   <div class="grid page">      \r\n      <div class="container">\r\n         <article>\r\n            <h1>choose game mode</h1>\r\n            <div class="container group" data-bind="foreach: gameOptions">\r\n               <label class="radio" data-bind="click: $root.clicked.bind($root, id)">\r\n                  <span class="title" data-bind="text: title"></span>\r\n                  <span class="description" data-bind="text: description"></span>\r\n                  <input type="radio" name="gameOption" data-bind="value: id, checked: $root.gameOptionId" /><span></span>\r\n                  <i data-bind="css: className"></i>\r\n               </label>\r\n            </div>\r\n            <h1>\r\n               choose friend\r\n               <span class="invite" data-bind="click:invite"></span>\r\n            </h1>\r\n            <div class="container group ">\r\n               <div class="input-box">\r\n                  <input type="search" placeholder="Search for a friend" data-bind="value: query, valueUpdate: \'afterkeydown\', search: queryChanged" autocorrect="off" autocapitalize="off" />\r\n                  <i class="command find" data-bind1="click: search"></i>\r\n                  <i class="icon-spinner icon-spin" data-bind="css: {hidden: !searchLoading()}"></i>\r\n               </div>\r\n            </div>\r\n            <div class="container y scroll compact friends" style="margin-left: .5em; width: auto;">\r\n               <ul class="list">\r\n                  <li class="header" data-bind="text: friendListMode().title"></li>\r\n                  <!-- ko if: $root.friendListMode().mode == \'list\' -->\r\n                  <!-- ko foreach: friends -->\r\n                  <li data-bind="css:{ active: $root.activeFriend() == $data }, click: $root.friendSelected.bind($root, $data)">\r\n                     <span data-bind="text: username"></span>\r\n                     <div class="btn" data-bind="click: $root.removeFriend.bind($root, $data)">\r\n                        <i class="command delete xxsm"></i>\r\n                     </div>\r\n                  </li>\r\n                  <!-- /ko -->\r\n                  <!-- ko if: friends().length == 0 -->\r\n                  <li class="inst">\r\n                     At the moment you have no friends!<br />\r\n                     You can search for new friends <br />\r\n                     and add them to your list.\r\n                  </li>\r\n                  <!-- /ko -->\r\n                  <!-- /ko -->\r\n                  <!-- ko if: $root.friendListMode().mode == \'search\' -->\r\n                  <!-- ko foreach: friends -->\r\n                  <li data-bind="css:{ active: $root.activeFriend() == $data }, click: $root.friendSelected.bind($root, $data)">\r\n                     <span data-bind="text: username"></span>\r\n                     <!-- ko ifnot: isFriend -->\r\n                     <div class="btn" data-bind="click: $root.addFriend.bind($root, $data)">\r\n                        <i class="command addFriend sm"></i>\r\n                     </div>\r\n                     <!-- /ko -->\r\n                     <!-- ko if: isFriend -->\r\n                     <span class="grayed pull-right">friend</span>\r\n                     <!-- /ko -->\r\n                  </li>\r\n                  <!-- /ko -->\r\n                  <!-- ko if: friends().length == 0 -->\r\n                  <li class="inst">\r\n                     Your query results in no result!<br />\r\n                  </li>\r\n                  <!-- /ko -->\r\n                  <!-- /ko -->\r\n               </ul>\r\n            </div>\r\n         </article><article>\r\n            <h1>choose collection</h1>\r\n            <div class="container y scroll">\r\n               <!-- ko if:  !collections().length-->\r\n               <div class="loader-bar"><i></i><i></i><i></i></div>\r\n               <!-- /ko -->\r\n               <!-- ko foreach: collections-->\r\n               <label class="radio">\r\n                  <span class="pic" data-bind="css: shortName"></span>\r\n                  <span class="text">\r\n                     <span class="title" data-bind="text: longName"></span>\r\n                     <span class="description" data-bind="text: desc"></span>\r\n                  </span>\r\n                  <input type="radio" name="c" data-bind="value: shortName, checked: $root.collection, click: $root.collectionClicked" /><span></span>\r\n               </label>\r\n               <!-- /ko-->\r\n            </div>            \r\n            <!--<h1>set language</h1>\r\n            <div class="container group">\r\n               <select class="woz" data-bind="dropdown: { inst: \'Change Language\', options: null, selected: null }">\r\n                  <option selected>English</option>\r\n                  <option>German</option>\r\n                  <option>Portuguese</option>\r\n                  <option>Spanish</option>\r\n                  <option>Swedish</option>\r\n               </select>\r\n            </div>-->\r\n            <div class="container group">\r\n               <button data-bind="click: $root.start" class="blue" style="/*position:absolute;right:1.1em;top:12em;*/float:right;">Start Game</button>\r\n            </div>\r\n         </article>\r\n         <button class="orange sm" style="position:absolute; float: right; top: -4em; right: -3em; z-index: 1;"\r\n                 data-bind="click: $root.toShop">\r\n            GET COLLECTION\r\n         </button>\r\n      </div>\r\n   </div>\r\n</div>\r\n'
}),n("text!home/poem/friends.html",[],function(){return'<div style="font-size: 18px">\r\n   <span class="loader-bar" style="position:absolute; right: 0" data-bind="fadeVisible: loading"><i></i><i></i><i></i></span>\r\n    <!-- ko if: !loading() && visibleList().length === 0 -->\r\n    <div class="poem-page">\r\n        <div class="note pull-right">\r\n            Your friends have not created any poems yet.\r\n        </div>\r\n    </div>\r\n    <!-- /ko -->\r\n   <div class="poem-page" data-bind="foreach: {data: visibleList, afterRender: afterRender}, loadMore: $root.loadNextPage">\r\n      <div class="cell withTitle">\r\n         <div class="title">\r\n            <span class="username" data-bind="text: username"></span>\r\n            <span class="opponent" data-bind="if: opponent"> with <span data-bind="text: opponent"></span></span>\r\n         </div>\r\n         <button class="right" data-bind="click: $root.like, css: (liked() ? \'icon-heart\': \'icon-heart-empty\') "></button>\r\n         <div class="footer">\r\n            <div class="likes">\r\n               <span class="icon-heart"></span>\r\n               <span data-bind="text: likes"></span> like this               \r\n            </div>\r\n            <div class="date" data-bind="date: creationDate"></div>\r\n         </div>\r\n         <div class="slider">\r\n            <div data-bind="tile: {tile: {imageName: imageName }}" style="height: 422px" class="poem-mask">\r\n               <div data-part="text">\r\n                  <div class="confiner" data-bind="with: $parent">\r\n                     <div class="poem-container"\r\n                          data-bind="css: light ? (\'light shade-\' + shadow ): (\'dark shade-\'+  shadow)">\r\n                        <div class="row" data-bind="css: {none: title == \'\' }"></div>\r\n                        <div class="row" data-bind="css: {none: title == \'\' }">\r\n                           <h1 data-bind="text: title, resizeText: {maxWidth: 220, size: {max: 1.5, min: 1.05 } }"></h1>\r\n                        </div>\r\n                        <div class="poem" data-bind="style: {fontSize: size + \'px\'}, foreach: poemString">\r\n                           <div class="phrase" data-bind="text: $data"></div>\r\n                        </div>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n            </div>\r\n         </div>\r\n      </div>\r\n   </div>\r\n</div>'}),n("text!home/poem/index.html",[],function(){return'<div>\r\n   <div class="logo page"></div>\r\n   <div class="grid page big">\r\n      <button class="orange sm" \r\n              style="position:relative; float: right; top: -3.5em; right: -3em; z-index: 1;" data-bind="click: $root.start">\r\n         My Games\r\n      </button>\r\n      <br />\r\n      <div class="tab" data-bind="tab: {nav: navigate, activeTab: activeTab}">\r\n         <nav>\r\n            <ul>\r\n               <li><span>My Poems</span></li>\r\n               <li><span>My Friend\'s Poems</span></li>\r\n               <li class="ending" style="width:380px"><span>ending</span></li>\r\n            </ul>\r\n            <div class="loader-bar" data-bind="fadeVisible: $root.loading"><i></i><i></i><i></i></div>\r\n         </nav>\r\n         <div class="content">\r\n            <div data-bind="compose: module"></div>\r\n         </div>\r\n      </div>\r\n   </div>\r\n</div>\r\n'}),n("text!home/poem/my.html",[],function(){return'<div style="font-size: 18px">\r\n    <span class="loader-bar" style="position:absolute; right:0" data-bind="fadeVisible: loading"><i></i><i></i><i></i></span>\r\n    <!-- ko if: !loading() && visibleList().length === 0 -->\r\n    <div class="poem-page">\r\n        <div class="note pull-right">\r\n            You have not created any poems yet.\r\n        </div>\r\n    </div>\r\n    <!-- /ko -->\r\n    <div class="poem-page" data-bind="foreach: {data: visibleList, afterRender: afterRender}, loadMore: $root.loadNextPage">\r\n        <div class="cell">\r\n            <a class="poem-button share">\r\n                <span>share</span>                \r\n                <div class="tooltip">\r\n                    <i class="social fb" data-bind="click: $root.facebook"></i>\r\n                    <i class="social pn disabled"></i>\r\n                    <i class="social tw disabled"></i>\r\n                </div>\r\n            </a>\r\n            <button class="right" data-bind="click: $root.remove"><i class="command delete xsm"></i></button>\r\n            <div class="footer">\r\n                <div class="likes">\r\n                    <span class="icon-heart"></span>\r\n                    <span data-bind="text: likes"></span> like this\r\n                </div>\r\n                <div class="date" data-bind="date: creationDate"></div>\r\n            </div>\r\n            <div class="slider">\r\n                <div data-bind="tile: {tile: {imageName: imageName }}" style="height: 422px" class="poem-mask">\r\n                    <div data-part="text">\r\n                        <div class="confiner" data-bind="with: $parent">\r\n                            <div class="poem-container"\r\n                                 data-bind="css: light ? (\'light shade-\' + shadow ): (\'dark shade-\'+  shadow)">\r\n                                <div class="row" data-bind="css: {none: title == \'\' }"></div>\r\n                                <div class="row" data-bind="css: {none: title == \'\' }">\r\n                                    <h1 data-bind="text: title, resizeText: {maxWidth: 220, size: {max: 1.5, min: 1.05 } }"></h1>\r\n                                </div>\r\n                                <div class="poem" data-bind="style: {fontSize: size + \'px\'}, foreach: poemString">\r\n                                    <div class="phrase" data-bind="text: $data"></div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'}),n("text!home/poems.html",[],function(){return'<div>\r\n  <div class="grid">\r\n    <article>\r\n      <h1>Profile:</h1>\r\n      <div class="container group">\r\n         <p>Please proceed with caution. <br /> this will delete <b data-bind="text: username"></b>.</p>\r\n         <button class="orange" data-bind="click: deleteUsername">Delete Account</button>\r\n      </div>\r\n      <h1>change password:</h1>\r\n      <div class="container group">\r\n      </div>\r\n    </article>\r\n    <article>\r\n      <h1>Misc:</h1>\r\n      <div class="container">\r\n        <label>connect to facebook<input type="checkbox" checked /><span></span></label>\r\n        <label>push notification<input type="checkbox" /><span></span></label>\r\n        <label>email notification<input type="checkbox" checked /><span></span></label>\r\n      </div>\r\n      <br />\r\n      <h1>set language</h1>\r\n      <div class="container">\r\n        <select class="woz" data-bind="dropdown: { inst: \'Change Language\', options: null, selected: null }">\r\n          <option selected>English</option>\r\n          <option>German</option>\r\n          <option>Portuguese</option>\r\n          <option>Spanish</option>\r\n          <option>Swedish</option>\r\n        </select>\r\n      </div>\r\n    </article>\r\n  </div>\r\n</div>\r\n'}),n("text!home/settings.html",[],function(){return'<div>\r\n   <div class="grid">\r\n       <article>\r\n           <!--<h1>Profile:</h1>\r\n        <div class="container group">\r\n           <p>Please proceed with caution. <br /> this will delete <b data-bind="text: username"></b>.</p>\r\n           <button class="orange" data-bind1="click: deleteUsername">Delete Account</button>\r\n        </div>\r\n        <h1>change password:</h1>\r\n        <div class="container group">\r\n\r\n        </div>-->\r\n           <h1>your email address:</h1>\r\n           <div class="container group">\r\n               <label class="radio" data-bind1="click: $root.clicked">\r\n                   <span class="title" data-bind="text: email">email@domain.com</span>\r\n                   <span class="description" data-bind="click: change">Click to change your email address.</span>\r\n               </label>\r\n           </div>\r\n\r\n           <h1>EMAIL NOTIFICATIONS:</h1>\r\n           <div class="container group">\r\n               <label>\r\n                   Game invitations\r\n                   <input type="checkbox" data-bind="checked: emailNew" /><span></span>\r\n               </label>\r\n               <label>\r\n                   When it\'s your turn\r\n                   <input type="checkbox" data-bind="checked: emailPhrase" /><span></span>\r\n               </label>\r\n               <label>\r\n                   Announcing the winner\r\n                   <input type="checkbox" data-bind="checked: emailEnd" /><span></span>\r\n               </label>\r\n           </div>\r\n\r\n       </article><article>\r\n            <h1>Blocked Players:</h1>\r\n            <div class="container y scroll compact friends" style="margin-left: .5em; width: auto; margin-top: .4em">\r\n                <ul class="list">\r\n                    <!-- ko if: $root.block().length == 0 -->\r\n                    <li class="inst">\r\n                        No blocked players yet\r\n                    </li>\r\n                    <!-- /ko -->\r\n                    <!-- ko if: $root.block().length != 0 -->\r\n                    <li class="header">players</li>\r\n                    <!-- ko foreach: $root.block -->\r\n                    <li>\r\n                        <span data-bind="text: username"></span>\r\n                        <div class="btn" data-bind="click: $root.removeBlocked" data-title="unblock">\r\n                            <i class="command delete xxsm"></i>\r\n                        </div>\r\n                    </li>\r\n                    <!-- /ko -->\r\n                    <!-- /ko -->\r\n                </ul>\r\n            </div>\r\n         <!--<br />\r\n         <h1>set language</h1>\r\n         <div class="container">\r\n            <select class="woz" data-bind1="dropdown: { inst: \'Change Language\', options: null, selected: null }">\r\n               <option selected>English</option>\r\n               <option>Persian</option>\r\n               <option>Portuguese</option>\r\n               <option>Spanish</option>\r\n               <option>Swedish</option>\r\n            </select>\r\n         </div>-->\r\n      </article>\r\n   </div>\r\n</div>\r\n'}),n("text!home/shop/currency.html",[],function(){return'<div style="font-size: 18px">\r\n   <span class="loader-bar center" data-bind="fadeVisible: loading"><i></i><i></i><i></i></span>\r\n   <div class="table-flex" data-bind="foreach: list">\r\n      <div class="row mild-padding" style="max-width:520px">\r\n         <!--ko if: flag--><div class="ribbon" data-bind="text: flag.flag, style: {backgroundColor: flag.colour}"></div><!-- /ko-->\r\n         <div class="item-icon currency" data-bind="css: \'item-icon-index-\' + iconID "></div>\r\n         <span class="besoz"><span data-bind="text: besoz"></span> besoz</span>\r\n         <span class="price"><span data-bind="text: price"></span> USD</span>\r\n         <button class="orange xsm pull-right" data-bind="click: $parent.buy">BUY</button>\r\n         <span class="discount" data-bind="if: discount, text:discount"></span>\r\n      </div>\r\n   </div>\r\n    <div class="payment-icon"></div>\r\n</div>'}),n("text!home/shop/expansion.html",[],function(){return'<div style="margin-bottom:20px;">\r\n   <div class="table-flex" data-bind="foreach: collections">\r\n      <div class="row">\r\n         <!--ko if: flags--><div class="ribbon" data-bind="text: flags[0].flag, style: {backgroundColor: flags[0].colour}"></div><!-- /ko-->\r\n         <div class="head" data-bind="text: longName"></div>\r\n         <div class="body">\r\n             <div class="collection" data-bind="css:{ disabled: purchased }, click: $root.buy">\r\n                 <div class="couple has-currency" data-bind="css: shortName">\r\n                     <div class="currency" data-bind="text: price"></div>\r\n                 </div>\r\n                 <div class="description">\r\n                     <div class="upper font-smaller" data-bind="text: type"></div>\r\n                     <div class="bold italic font-bigger" data-bind="text: longName"></div>\r\n                     <div class="font-smaller desc" data-bind="text: shortDescription"></div>\r\n                     <i>\r\n                         Tiles: <span data-bind="text: nImages"></span>,\r\n                         New Words: <span data-bind="text: nWords"></span>\r\n                     </i>\r\n                     <div data-bind="if: !purchased()">\r\n                         <button class="orange sm" data-bind="click: $root.buy, disable: $root.loading">BUY</button>\r\n                     </div>\r\n                     <div data-bind="if: purchased">\r\n                         <b>You already have this.</b>\r\n                     </div>\r\n                 </div>\r\n             </div><!--ko foreach: boosters--><div class="collection" data-bind="css:{ disabled: purchased }, click: $root.buy">\r\n    <div class="couple has-currency" data-bind="css: shortName">\r\n        <div class="currency" data-bind="text: price"></div>\r\n    </div>\r\n    <div class="description">\r\n        <div class="upper font-smaller" data-bind="text: type"></div>\r\n        <div class="bold italic font-bigger" data-bind="text: longName"></div>\r\n        <div class="font-smaller desc" data-bind="text: shortDescription"></div>\r\n        <i>\r\n            Tiles: <span data-bind="text: nImages"></span>,\r\n            New Words: <span data-bind="text: nWords"></span>\r\n        </i>\r\n        <div data-bind="if: !purchased()">\r\n            <button class="orange sm" data-bind="click: $root.buy, disable: $root.loading">BUY</button>\r\n        </div>\r\n        <div data-bind="if: purchased">\r\n            <b>You already have this.</b>\r\n        </div>\r\n    </div>\r\n</div><!-- /ko -->\r\n         </div>\r\n      </div>\r\n   </div>\r\n</div>\r\n'}),n("text!home/shop/index.html",[],function(){return'<div>\r\n   <div class="logo page"></div>\r\n   <div class="grid page big">\r\n      <button class="orange sm" style="position:relative; float: right; top: -3.5em; right: -3em; z-index: 1; /* for tablets z-index required*/" data-bind="click: $root.start">\r\n         Start New Game\r\n      </button>\r\n         <br />\r\n         <div class="tab" data-bind="tab: {nav: navigate, activeTab: activeTab}">\r\n            <nav>\r\n               <ul>\r\n                  <li><span>collections</span></li>\r\n                  <li><span>storage space</span></li>\r\n                  <li><span>besoz</span></li>\r\n                  <li class="ending"><span>ending</span></li>\r\n               </ul>\r\n               <div class="loader-bar" data-bind="fadeVisible: $root.loading"><i></i><i></i><i></i></div>\r\n            </nav>\r\n            <div class="content">\r\n               <div>\r\n                  <div data-bind="compose: module"></div>\r\n               </div>\r\n            </div>\r\n         </div>\r\n</div>\r\n\r\n</div>\r\n'}),n("text!home/shop/storage.html",[],function(){return'<div style="font-size: 18px">\r\n   <p style="max-width:520px;margin-left:1em; text-align:center">\r\n      You currently have space for <span class="bold" data-bind="text: (storage() ? storage(): \'unlimited\')"></span> games in your archive. Get more space for your archived games!\r\n   </p>\r\n   <span class="loader-bar pull-right" data-bind="fadeVisible: loading"><i></i><i></i><i></i></span>\r\n   <div class="table-flex" data-bind="foreach: list">\r\n      <div class="row mild-padding" style="max-width:520px" data-bind="css: {disabled: $root.storage() >= storage && (storage != 0 || storage == $root.storage()) || $root.storage() == 0}">\r\n         <!--ko if: flag--><div class="ribbon" data-bind="text: flag.flag, style: {backgroundColor: flag.colour}"></div><!-- /ko-->\r\n         <div class="item-icon storage" data-bind="css: \'item-icon-index-\' + iconID "></div>\r\n         <span class="besoz" data-bind="text: text"></span>\r\n         <span class="price" style="width:150px"><span data-bind="text: price"></span> besoz</span>\r\n         <!--ko ifnot: $root.storage() >= storage && (storage != 0 || storage == $root.storage()) || $root.storage() == 0-->\r\n         <button class="orange xsm pull-right" data-bind="click: $parent.buy">BUY</button>\r\n         <!-- /ko -->\r\n      </div>\r\n   </div>\r\n</div>'}),n("text!home/sound.html",[],function(){return'<div style="padding:1em">\r\n   <button class="orange" data-bind="click: $root.save">Save</button>\r\n   <table border="1" cellpadding="0" cellspacing="0" style=" font-size: 12px; line-height: 20px">\r\n      <thead>\r\n         <tr>\r\n            <th>key</th>\r\n            <th>filename</th>\r\n            <th>delay 0 to 500ms</th>\r\n            <th>volumn 0 to 1</th>\r\n            <th></th>\r\n         </tr>\r\n      </thead>\r\n      <tbody data-bind="foreach: collection">\r\n         <tr>\r\n            <td data-bind="text: key"></td>\r\n            <td>\r\n               <div data-bind="foreach: items">\r\n                  <div style="min-width: 500px;" data-bind="text: $root.meta($data).src"></div>                  \r\n               </div>\r\n            </td>\r\n            <td>\r\n               <div data-bind="foreach: items">\r\n                  <input style="height: 20px;display:block;"  type="range" min="0" max="500" step="50" data-bind="value: $root.meta($data).delay" />                  \r\n               </div>\r\n            </td>\r\n            <td>\r\n               <div data-bind="foreach: items">                  \r\n                  <input style="height: 20px;display:block"  type="range" min="0" max="1" step=".05" data-bind="value: $root.meta($data).volumn" />                  \r\n               </div>\r\n            </td>\r\n            <td>\r\n               <div data-bind="foreach: items">\r\n                  <button style="display:block" class="blue xsm" data-bind="click: $root.play.bind($root, $data)">Play</button>                  \r\n               </div>\r\n            </td>\r\n         </tr>\r\n      </tbody>\r\n   </table>\r\n</div>\r\n'}),n("text!home/test.html",[],function(){return'\r\n<div>\r\n    <div class="progressBarDecor">\r\n        <div class="inner">\r\n            <progress max="1" value="46" id="loadingBar"></progress>\r\n        </div>        \r\n    </div>\r\n</div>\r\n\r\n\r\n<!--<div>   \r\n   <div data-bind="template: {foreach: a, afterAdd: a.show}" class="table-flex">\r\n      <div data-bind="text: b" class="row mild-padding"></div>\r\n   </div>\r\n\r\n   <div style="padding: 40px; display:none">\r\n      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin scelerisque turpis sem, sit amet posuere libero blandit at. Quisque adipiscing posuere lacus at laoreet. Pellentesque orci felis, placerat non turpis quis, tempus fringilla justo. Interdum et malesuada fames ac ante ipsum primis in faucibus. Aliquam erat volutpat. Praesent nec metus vitae dolor iaculis lacinia at eu neque. Pellentesque viverra cursus purus. Nulla volutpat cursus magna, eu semper leo egestas ut. Proin vitae velit purus. Morbi aliquet neque nunc, eu gravida quam auctor et. Fusce eget turpis adipiscing, vehicula massa eget, eleifend lacus. Suspendisse aliquet nibh felis, non tincidunt orci tristique quis. In ultrices urna nec lacus porta, ac commodo arcu bibendum. Sed a bibendum eros, nec mollis mi. Praesent dignissim nulla nulla, in elementum neque porta id.\r\n\r\n      Suspendisse potenti. In porta ante id lacus commodo, a pulvinar eros mattis. Quisque feugiat turpis vitae gravida molestie. Donec bibendum tincidunt cursus. Etiam in pulvinar est, a lobortis mi. Vestibulum ullamcorper lectus at massa viverra, quis congue quam mollis. Vivamus ultrices risus ac massa fringilla consequat. Nulla non nibh ut augue fringilla congue iaculis semper odio.\r\n\r\n      Cras malesuada ultrices mi at sollicitudin. Curabitur eu molestie ante. Nulla porttitor augue nec imperdiet tincidunt. Integer feugiat porta elementum. Suspendisse vel rhoncus nibh. Aliquam rhoncus turpis id iaculis porttitor. Quisque tristique vulputate orci, dictum mattis mauris condimentum eu. Donec eget erat sed nisl egestas hendrerit. Etiam nunc elit, interdum vitae consequat vitae, sodales faucibus libero.\r\n\r\n      Etiam et orci a tortor dignissim porta id id risus. Fusce interdum, metus non convallis fermentum, ipsum lacus varius arcu, sed sodales lorem lorem eu eros. Praesent elit odio, dictum quis neque non, vehicula venenatis mi. Nunc egestas libero sit amet tempus porta. Nulla sem leo, aliquet et suscipit eget, ultricies bibendum magna. Sed convallis augue lorem. Fusce eros lorem, pharetra nec lorem sit amet, adipiscing pretium augue. Ut eu nulla mi. Mauris iaculis adipiscing eros nec laoreet. Proin adipiscing congue velit, at pellentesque ante vulputate quis. Quisque nec elit a dolor sollicitudin hendrerit nec ut lectus. Aliquam fringilla erat sed turpis porta condimentum. Curabitur non sem sit amet nulla laoreet consectetur eu ut lacus. Integer aliquet est sed dolor scelerisque volutpat. Proin in ullamcorper nisi.\r\n\r\n      Curabitur vitae congue ipsum. Vivamus risus nisl, vehicula non felis nec, pharetra facilisis magna. Fusce congue congue risus ac vulputate. Fusce pulvinar nunc iaculis nunc scelerisque, varius porta felis adipiscing. Interdum et malesuada fames ac ante ipsum primis in faucibus. Vestibulum aliquet nisl justo, hendrerit bibendum arcu auctor eget. Sed a lorem sed nisl aliquam ornare. Etiam sed blandit ligula. Suspendisse suscipit, lorem in adipiscing mollis, purus odio euismod diam, nec mollis tortor nibh vel nisl. Donec condimentum neque non dapibus volutpat.\r\n\r\n      Etiam tempus luctus risus nec sollicitudin. Duis eu pretium purus. Curabitur turpis eros, ultricies vitae ultrices id, ultrices id magna. Mauris volutpat lacinia orci in tempus. Pellentesque hendrerit sapien vitae leo adipiscing facilisis tristique sed purus. Quisque non ullamcorper dui. Duis at pharetra massa. Vestibulum ornare velit quis malesuada gravida. Curabitur facilisis tortor purus. Praesent quis nulla quis massa volutpat venenatis a a sem. Etiam bibendum et purus et porttitor. Phasellus aliquam dignissim neque, vehicula imperdiet lorem pretium vel. Vivamus aliquam pretium malesuada. Suspendisse potenti. In convallis purus a mollis tristique. Aenean ut lorem nec quam sodales egestas quis vel est.\r\n\r\n      Nulla facilisi. Suspendisse venenatis erat erat, at sodales mi lobortis a. Sed id lorem aliquet est adipiscing dictum ut nec orci. Sed eu leo eu sem eleifend lacinia. Proin lobortis ut ante id dignissim. Vestibulum lacinia, urna ut posuere commodo, nulla massa congue nisl, sed consequat libero elit ut risus. Nam tempor id diam eu viverra. Nulla sed rutrum risus, vitae pharetra massa. Aliquam mattis nec mauris id commodo. Vestibulum dui lectus, commodo nec sem et, eleifend lobortis lectus. Phasellus pulvinar tincidunt neque, id luctus elit tempor vitae. In quis ullamcorper lectus. Curabitur vulputate facilisis nunc vitae egestas.\r\n\r\n      Cras suscipit, turpis in fermentum tempus, lectus odio euismod elit, vel sollicitudin metus mauris id nunc. Vestibulum porta, sem vel fringilla tristique, nisl sapien rutrum erat, in tempus massa velit a elit. Vestibulum sollicitudin gravida nisi nec pretium. Ut tempor sem ut quam fringilla condimentum. Vestibulum quam magna, dictum nec luctus eget, varius non ipsum. Praesent vehicula feugiat magna, quis laoreet turpis tincidunt ac. Curabitur pharetra volutpat suscipit. Proin diam ipsum, hendrerit quis mi in, vestibulum malesuada tortor. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Cras gravida quis nisl ac pretium. Aliquam tristique, libero ac consequat malesuada, lacus diam adipiscing risus, et aliquet enim felis ac nunc.\r\n\r\n      Pellentesque tempor tellus posuere arcu lobortis, quis porta est suscipit. Curabitur quis turpis quis elit feugiat porta eget eu eros. Aliquam erat volutpat. Nunc accumsan, orci aliquet euismod vulputate, sapien eros blandit lacus, sit amet aliquet lacus risus at orci. Nam diam velit, cursus ut ante eget, vehicula ornare magna. Pellentesque purus quam, semper a semper eu, hendrerit non nibh. Mauris posuere nibh sit amet dui tempor, eget semper magna sodales. Nam blandit sed nunc in pellentesque. Pellentesque mollis vestibulum odio, eget euismod est tristique blandit. Phasellus eu consequat sem, venenatis aliquam mi. Pellentesque elementum volutpat nisi eu sagittis. Vivamus in nisi semper, tristique mauris at, aliquet odio. In mauris quam, consequat sit amet nunc sit amet, rhoncus laoreet tellus. Proin et adipiscing tellus. Integer pulvinar lectus velit, ac condimentum est pretium et. Sed id sagittis urna.\r\n\r\n      Aenean feugiat enim non turpis interdum rhoncus. Donec metus ligula, auctor a venenatis a, suscipit sit amet lectus. Donec pharetra enim eget ipsum ornare, eu blandit lacus volutpat. Nullam magna libero, ultricies ac fermentum et, mollis porta augue. Quisque dolor massa, accumsan vitae scelerisque in, congue in nibh. Nullam a tincidunt lectus, et mattis augue. Nam sem odio, aliquam id mattis id, mattis ut nulla.\r\n\r\n      Phasellus commodo dui eget iaculis fringilla. Aenean mollis, purus vel pellentesque vulputate, enim metus dapibus orci, quis egestas nulla ligula vitae sapien. Donec et risus odio. Cras ut varius nisl, tincidunt ornare dui. Aliquam mollis auctor purus, at lobortis arcu lobortis at. Donec mattis mauris vel odio convallis auctor sed et orci. Aliquam ultricies, nisi eget tempus faucibus, lacus justo faucibus leo, eu tristique urna nibh quis erat. Pellentesque placerat tempus diam, ac adipiscing leo convallis et. Interdum et malesuada fames ac ante ipsum primis in faucibus. Vestibulum sit amet mi eget felis euismod pretium. Integer ut vestibulum dui. Suspendisse a venenatis velit, sed blandit erat. Sed ut nisl at turpis mollis vulputate at ac nibh. Vivamus eget libero faucibus, porttitor magna porttitor, aliquam metus. Morbi quam augue, vehicula vel auctor ac, facilisis ac dui. Cras venenatis ligula at aliquet dignissim.\r\n\r\n      Vivamus euismod, tellus et mollis ornare, ante arcu luctus lacus, vitae sollicitudin ligula diam eu arcu. Donec velit purus, sodales a ipsum nec, malesuada volutpat mauris. Donec sagittis, ipsum et ornare iaculis, augue justo bibendum justo, sed viverra leo nisi ac odio. Vivamus et suscipit sapien, adipiscing varius eros. Nullam volutpat semper urna, eget euismod dui semper ac. Aenean non facilisis leo, aliquam ornare libero. Nunc eget placerat quam, a gravida ipsum. Maecenas ultrices facilisis nisi, a ullamcorper dolor sagittis at. Nullam hendrerit elit ipsum, id condimentum erat accumsan eget. In fermentum nec lacus id rhoncus. Aenean eu bibendum mi. Maecenas metus sem, suscipit sit amet tempus non, feugiat nec nulla.\r\n\r\n      Morbi volutpat pretium ligula in rhoncus. Nam pretium est ut erat aliquet tempor. Quisque quis semper nisi. Aliquam imperdiet scelerisque elit sed cursus. Sed rhoncus risus vel quam adipiscing porta. Suspendisse aliquam sem eu mollis semper. Duis aliquet lacus eu justo varius, vel dictum leo pellentesque. Quisque ut magna non ligula pharetra laoreet non in turpis. Aenean feugiat odio in faucibus tristique. Quisque malesuada hendrerit tellus, sit amet imperdiet sapien aliquam in. Cras eu felis mi. Vivamus et malesuada ligula, vitae pharetra lorem. Morbi molestie leo a nulla blandit aliquam. Aliquam fermentum, lectus eu molestie dictum, est purus convallis orci, eget tempus eros odio a felis. Interdum et malesuada fames ac ante ipsum primis in faucibus.\r\n\r\n      Praesent ut diam condimentum, molestie quam a, mollis neque. Cras elementum enim turpis, a lacinia enim luctus ac. Cras faucibus eros sapien, nec consectetur magna pharetra sit amet. Maecenas varius interdum mi quis pulvinar. Cras justo est, accumsan ac pharetra eu, mattis sed nisi. Suspendisse sed consectetur dui, eu rutrum ligula. Nullam mattis eleifend orci, non facilisis diam. Suspendisse sit amet ultricies augue, eu sollicitudin magna. Fusce facilisis commodo lectus vel pharetra. Praesent a posuere nulla. Cras quis posuere erat, vitae dapibus orci.\r\n\r\n      Praesent dictum, est sed sodales aliquet, est turpis consectetur justo, vel ultricies enim metus at nunc. In varius velit ac felis posuere feugiat. Donec id scelerisque dui, quis tempor ligula. Mauris iaculis volutpat pretium. Nullam semper vehicula nulla, in bibendum eros facilisis quis. Duis rutrum tempus massa, non feugiat dui gravida vel. Suspendisse ut mi lobortis, cursus quam bibendum, mollis metus. Vivamus sed mi eros. Suspendisse viverra ipsum id nibh varius, quis dictum neque porttitor. Etiam eu orci ut diam cursus pretium in sed felis.\r\n\r\n      Sed a erat non nisl porta semper. Vivamus id magna leo. Nunc augue diam, interdum at est sed, convallis suscipit tellus. Mauris sed fermentum nibh, ac pharetra mauris. Nulla commodo ornare massa ac elementum. Mauris congue nunc felis, in pharetra nulla sollicitudin et. Nulla facilisi. Phasellus faucibus risus at mollis hendrerit. Sed tempus vulputate nisl eu ullamcorper.\r\n\r\n      Sed congue malesuada accumsan. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Proin scelerisque erat sit amet tellus feugiat, non vestibulum magna fringilla. Fusce a turpis aliquam odio tincidunt iaculis. In hac habitasse platea dictumst. Aenean rutrum mauris quis urna vehicula imperdiet. Sed non magna auctor metus dapibus consectetur vitae eu enim. Nulla facilisi. Vestibulum pretium erat ligula, id gravida leo ultricies at. Fusce tincidunt, dolor eu aliquam eleifend, felis tortor convallis sapien, eu congue arcu est nec nunc. Phasellus sagittis mauris et nisi facilisis, eu cursus est blandit. Sed id felis vel dui convallis porttitor. Phasellus ut arcu nunc. Duis a elit ac risus convallis ultricies ac a mi. Nam sit amet est quis sapien accumsan pellentesque. Integer volutpat nec erat eu tempor.\r\n\r\n      Sed accumsan diam elit, sed egestas tortor suscipit sit amet. Aenean vehicula augue aliquet nulla ultrices bibendum. Nam dignissim metus sapien, quis lacinia nunc ultrices vel. Duis porta sem sed dui aliquam blandit. Vivamus aliquet, nisl sed venenatis rhoncus, arcu mi sodales eros, vel eleifend libero massa eget mi. Cras tempor sem quis mauris ornare, eu rutrum risus aliquam. Donec dapibus sapien id consequat luctus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec fermentum auctor nibh, et vulputate velit malesuada vitae. Duis vitae lectus malesuada, pulvinar odio aliquam, posuere mauris. Ut a libero ac mauris elementum gravida. Vestibulum nec ultrices leo, tristique consequat dolor. Maecenas ut commodo lacus.\r\n\r\n      Pellentesque egestas mauris scelerisque congue accumsan. Pellentesque ornare consectetur dapibus. Suspendisse ornare pharetra ligula id rutrum. In venenatis blandit tortor, vitae consectetur ipsum hendrerit sit amet. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Sed ut elit ornare, rutrum odio quis, facilisis quam. Pellentesque mollis porta massa, sit amet ultrices nisl accumsan id. Integer rutrum augue a est suscipit volutpat. Fusce enim magna, consectetur et laoreet eu, porta non arcu. Nam blandit ut quam quis semper. Cras suscipit justo non mi volutpat feugiat. Etiam ut orci facilisis, molestie odio vitae, placerat eros. Cras at condimentum turpis. Suspendisse vitae facilisis libero.\r\n\r\n      Sed lacinia aliquam sapien, ultricies bibendum justo viverra quis. Proin dapibus, nulla in pulvinar ullamcorper, purus ligula cursus justo, eget dapibus orci turpis eu lorem. Maecenas pharetra arcu tellus, nec fermentum metus semper fringilla. Nulla pulvinar luctus eros, non scelerisque augue. Suspendisse potenti. Pellentesque pretium bibendum imperdiet. Praesent tempus viverra orci, id dictum purus aliquam ut. Donec ut fringilla quam, eu eleifend leo.\r\n\r\n      Curabitur a urna in nisl sollicitudin egestas non eu diam. Nulla suscipit hendrerit ante, vel adipiscing orci. Suspendisse placerat turpis diam, sit amet viverra quam ullamcorper vel. Sed augue orci, fermentum nec tempor sit amet, volutpat facilisis ipsum. In quis magna sit amet leo posuere laoreet sit amet faucibus eros. Nunc et eros non mauris scelerisque cursus. Vivamus accumsan neque non varius tempor. Ut quis ante lorem. Donec eget elit nec lectus luctus lobortis.\r\n\r\n      Integer convallis sapien risus, in semper mauris cursus ut. Praesent aliquet eu mauris blandit rhoncus. Pellentesque venenatis a felis vitae lacinia. Nullam rutrum at diam at lacinia. Nullam aliquam vehicula aliquet. Phasellus aliquam ornare sodales. Cras nulla diam, blandit non odio eget, vulputate pretium nulla. Sed nulla dui, volutpat ut lectus ac, rutrum feugiat purus. Aenean vitae vehicula velit, et tempor diam. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Nunc vitae risus feugiat, aliquam odio sed, tristique justo.\r\n\r\n      Vivamus et feugiat mi, vel ornare sem. Aliquam dapibus urna vel dolor dapibus, nec pretium ante gravida. Ut pretium eu velit vitae egestas. Fusce sodales egestas elit ac posuere. Mauris posuere, odio quis venenatis pulvinar, purus sem laoreet ante, vel sodales sem lorem sed purus. Maecenas quam quam, luctus vestibulum neque a, vulputate tempus augue. Donec aliquam tortor sed aliquam tincidunt. Integer commodo commodo est. Etiam ornare erat et porttitor elementum. Donec eleifend vel mi sed scelerisque. Morbi porta non elit elementum facilisis. In a dolor nulla.\r\n\r\n      Fusce posuere, lectus eu blandit bibendum, nibh massa lobortis urna, nec consectetur ante nulla a mi. Mauris dictum magna nisi, vel scelerisque sapien placerat sollicitudin. Donec porttitor lectus metus, in vestibulum lacus accumsan vitae. In eu purus augue. Sed sed leo pharetra metus feugiat ornare eget ut dui. Cras placerat dictum consequat. Sed consequat tellus in velit viverra, sit amet feugiat nunc porttitor. Nulla facilisi. Praesent venenatis nunc vel blandit fringilla. Nullam sed aliquet lacus, nec pellentesque augue. Vivamus nulla dolor, hendrerit in gravida non, aliquet nec lectus. In et nisl enim. Fusce faucibus vitae dolor non posuere. Nulla tempus lorem turpis, quis luctus turpis vulputate tempor. Duis enim nulla, tempus fermentum vulputate eu, ullamcorper at augue. Duis a felis ornare, tempus dui at, rhoncus lectus.\r\n   </div>\r\n\r\n   <div style="margin: 100px" class="shine"></div><div style="width: 100px; height: 100px" class="star-box"></div>\r\n</div>-->\r\n'
}),n("text!shell.html",[],function(){return'<div id="shell">\r\n   <div id="fixed">\r\n      <!--ko compose: "api/ui/palette"--><!--/ko-->\r\n      <div class="loader page" data-bind="css: { active: loading }">\r\n         <i class="icon-spinner icon-2x icon-spin"></i>\r\n      </div>\r\n      <div class="status-box">\r\n         <div class="switch">\r\n            <span></span>\r\n         </div>\r\n         <div class="switch" data-bind="css: { b: status.cnn }">\r\n            <span class="bad">Offline</span>\r\n            <span class="good">Online</span>\r\n         </div>\r\n         <div class="switch" data-bind="css: { b: status.devMode }">\r\n            <span class="bad"></span>\r\n            <span class="good" style="color:darkslateblue;opacity:1">Developement Mode</span>\r\n         </div>\r\n         <div class="switch" data-bind="css: { b: errors().length }">\r\n            <span class="good"></span>\r\n            <span class="bad" data-bind="attr:{title: $root.summary}, click: $root.showSummary">\r\n               Errors on the page: <span data-bind="text: errors().length"></span>\r\n            </span>\r\n         </div>\r\n      </div>\r\n   </div>\r\n   <div id="console" style="position:fixed; top:300px; left: 100px; display:block;z-index:10000"></div>\r\n   <!--ko router: { transition: \'entrance\', cacheViews: true }--><!--/ko-->\r\n</div>\r\n'}),n("text!static/faq.html",[],function(){return'<!DOCTYPE html>\r\n<html>\r\n<head prefix="og: http://ogp.me/ns#">\r\n    <title>Words of Oz Privacy Policy</title>\r\n\r\n    <meta charset="utf-8" />\r\n\r\n    <link rel="shortcut icon" href="../../images/icon.png" />\r\n    <link rel="apple-touch-icon" href="../../images/icon.png" />\r\n    <link rel="apple-touch-startup-image" href="../../images/icon.png" />\r\n\r\n    <style>\r\n        .document {\r\n            line-height: 1.3em;\r\n        }\r\n\r\n            .document h1 {\r\n                font-size: 1.5em;\r\n            }\r\n\r\n            .document h2 {\r\n                font-size: 1.2em;\r\n                padding: .3em 0;\r\n            }\r\n\r\n            .document ul {\r\n                padding: 0;\r\n                padding-left: 25px;\r\n            }\r\n\r\n            .document ol {\r\n                padding: 0;\r\n                padding-left: 25px;\r\n            }\r\n\r\n                .document ol > li {\r\n                    margin-top: .4em;\r\n                    margin-left: 1.5em;\r\n                    position: relative;\r\n                }\r\n\r\n                    .document ol > li:before {\r\n                        position: absolute;\r\n                        left: -2.5em;\r\n                    }\r\n        .document .centered {\r\n            text-align: center;\r\n        }\r\n\r\n        .document img {\r\n            margin: 10px;\r\n        }\r\n    </style>\r\n</head>\r\n<body>\r\n    <article class="document">\r\n        <h2>What is Besoz?</h2>\r\n        <p>Besoz are the internal currency in the game. You can see the amount of besoz you have in the top right corner above the red wand. Besoz can be used to buy new collections to play with and more storage space for archived games. It can also be used to make buy new words inside a game and to change verb endings.</p>\r\n        <p>To buy besoz either simply click the red wand in the top right corner, or go to the shop and select the besoz tab. Choose the number of besoz you wish to purchase. You will then be transferred to Paypal to finish your transaction.</p>\r\n\r\n        <h2>What is XP?</h2>\r\n        <p>XP or "Experience Points" are points you receive for doing things in the game. When you reach a certain amount of XP you will level up. Every time you level up you will receive an amount of besoz, our internal currency.</p>\r\n        <p>You will find the details about the XP you\'ve earned and how far you are from the next level on your Profile, which is displayed when you click your username in the top right corner inside a game.</p>\r\n        <p class="centered"><img src="images/faq/image00.png" /></p>\r\n\r\n        <h2>How do I earn XP?</h2>\r\n        <p>You will earn XP by doing the following things. We might add more in the future.</p>\r\n        <ul>\r\n            <li>Playing a single-player game to the end (3 XP)</li>\r\n            <li>Winning a two-player game (15 XP)</li>\r\n            <li>Losing a two-player game (5 XP)</li>\r\n            <li>Playing with a new friend gives 10 extra XP on top of the ones you earn for winning of losing (does not apply to a random opponent)</li>\r\n        </ul>\r\n        <p></p>\r\n\r\n        <h2>How do the Advancement levels work?</h2>\r\n        <p>There are three Advancement levels in the game:</p>\r\n        <ol>\r\n            <li>Apprentice of Poetry</li>\r\n            <li>Practitioner of Poetry</li>\r\n            <li>Master of Poetry</li>\r\n        </ol>\r\n        <p>You start out as an Apprentice of Poetry. You will become a Practitioner of Poetry when you reach level 2 and a Master of Poetry when you reach level 4. When you reach a new Advancement level you will get new game boards to play with and new bonus rules are unlocked.</p>\r\n\r\n        <h2>How do I add a friend?</h2>\r\n        <p>There are two ways to add a friend.</p>\r\n        <ol>\r\n            <li>\r\n                Go to New Game in the menu. Here you can search for a friend by using name, username or email address. The search will look for your friends among the registered Words of Oz players. If you find your friend in the search result, simply click the add friend symbol to add your friend.\r\n                <p class="centered"><img src="images/faq/image02.png" /></p>\r\n            </li>\r\n            <li>\r\n                The second way to add a friend is to click the username of the your opponent player inside a game. You will then see their profile. Use the Add friend-button on their profile to add them as a friend.\r\n                <p class="centered"><img src="images/faq/image01.png" /></p>\r\n            </li>\r\n        </ol>\r\n\r\n        <h2>How do I block a person?</h2>\r\n        <p>To block a person that has started a game with you, click the username of the your opponent player inside the game. You will then see their profile. Use the Block-button on their profile to block them. This means you will never receive new game requests from them again.</p>\r\n\r\n        <h2>What is a collection?</h2>\r\n        <p>A collection is a set of 20 images and 250 words. When you play with a certain collection, all the images and most of the words will be randomly picked from it. The rest of the words come from a set of basic words that are general pronouns, prepositions, verbs, nouns, adverbs, adjectives and conjugations.</p>\r\n\r\n        <h2>What is a booster?</h2>\r\n        <p>A booster is an addition to a collection. If you add a booster to a collection you get an additional 10 images and 100 words. These are integrated into your collection. You can\'t choose to play without a booster that you have added to a collection.</p>\r\n\r\n        <h2>Where do I find my collections?</h2>\r\n        <p>After you\'ve bought a collection you will find it on the page where you start a new game. In the list of collections to play with, you can now choose it.</p>\r\n\r\n        <h2>I can\'t find the words I like. Why?</h2>\r\n        <p>Our database of words will increase with time. Please help us add words to it by using the Suggest word-function.</p>\r\n    </article>\r\n</body>\r\n</html>'}),n("text!static/privacy.html",[],function(){return'<!DOCTYPE html>\r\n<html>\r\n<head prefix="og: http://ogp.me/ns#">\r\n    <title>Words of Oz Privacy Policy</title>\r\n\r\n    <meta charset="utf-8" />\r\n\r\n    <link rel="shortcut icon" href="../../images/icon.png" />\r\n    <link rel="apple-touch-icon" href="../../images/icon.png" />\r\n    <link rel="apple-touch-startup-image" href="../../images/icon.png" />\r\n\r\n    <style>\r\n        .document {\r\n            line-height: 1.3em;\r\n        }\r\n\r\n            .document h1 {\r\n                font-size: 1.5em;\r\n            }\r\n\r\n            .document h2 {\r\n                font-size: 1.2em;\r\n            }\r\n\r\n            .document ul {\r\n                padding: 0;\r\n                padding-left: 40px;\r\n            }\r\n\r\n            .document ol {\r\n                list-style: none;\r\n                padding: 0;\r\n                padding-left: 40px;\r\n            }\r\n\r\n                .document ol > li {\r\n                    margin-top: .4em;\r\n                    margin-left: 1.5em;\r\n                    position: relative;\r\n                }\r\n\r\n                    .document ol > li:before {\r\n                        position: absolute;\r\n                        left: -2.5em;\r\n                    }\r\n    </style>\r\n</head>\r\n<body>\r\n    <article class="document">\r\n        <h1>Privacy Policy</h1>\r\n        <h2>Introduction</h2>\r\n        <p>At Ozma we respect the privacy of everyone who uses our games, website(s) and all related services which we may provide to you (Services). In this document we refer to Ozma Speldesign AB as Ozma us, we or our and we refer to you as you and your.</p>\r\n        <p>This document explains how we collect, store and process any personal data belonging to you, meaning information about you which is personally identifiable such as your name, address, telephone number or email address. Such information is referred to in this policy as "Personal Information" or data.</p>\r\n        <p>By accessing and/or using our Services you consent to us collecting, storing, processing and sharing your Personal Information in the ways set out in this document. If you have any concerns about providing data to us or having it used in any manner permitted in this Privacy Policy, you should not use our Services.</p>\r\n\r\n        <h2>Ozma</h2>\r\n        <p>Ozma is a company registered in Sweden. Our registered office is Rdmansgatan 15 B, 211 46 Malm.</p>\r\n\r\n        <h2>Information collected</h2>\r\n        <p>\r\n            We may collect and process the following data about you:\r\n            <ul>\r\n                <li>information that you provide us with when you fill in forms when you create an account with us;</li>\r\n                <li>details of your use of our Services and the resources that you access (for example, information about how and when you play our games or visit our website(s), or what device you use to access our Services);</li>\r\n                <li>if you contact us or respond to messages and communications that we send to you, we may keep a record of that correspondence;</li>\r\n                <li>your interactions with us on our social media channels.</li>\r\n            </ul>\r\n        </p>\r\n\r\n        <h2>Payment Information</h2>\r\n        <p>We may collect certain payment information from you on behalf of our payment service providers, but this information is temporarily cached in a way that is unreadable by Ozma. </p>\r\n\r\n        <h2>How will we use your Personal Information?</h2>\r\n        <p>\r\n            You agree that we (or a supplier acting on our behalf and only under our instructions) may use your Personal Information for the purposes of:\r\n            <ul>\r\n                <li>managing your account and relationship with us and improving your experience when you use our Services;</li>\r\n                <li>contacting you, for example as part of customer service or to send you updates about our Services;</li>\r\n                <li>research, surveying, and engaging with you, for example by sending you communications (including by email) for these purposes;</li>\r\n                <li>marketing and promotion of our Services or related products, for example sending you communications (including by email) for these purposes. If you do not want us to use your data in this way please let us know by contacting us at <a href="mailto:support@ozmagames.com">support@ozmagames.com</a>;</li>\r\n                <li>to create reports, analysis or similar services for use by us for the purposes of research or business intelligence, for example to track potential problems or trends with our Services;</li>\r\n                <li>preventing cheating, crime or fraud. We may also need to pass your information to fraud prevention agencies and other organizations involved in crime and fraud prevention; and</li>\r\n                <li>as otherwise expressly set out in this Privacy Policy or as required by law.</li>\r\n            </ul>\r\n        </p>\r\n\r\n        <h2>Information shared with third parties</h2>\r\n        <p>\r\n            We will only share your data with third parties:\r\n            <ul>\r\n                <li>with your consent (including as set out in this Privacy Policy);</li>\r\n                <li>as reasonably necessary in order to provide the Services to you (for example, by providing your Personal Information to suppliers we may use to fulfill the Services or to communicate with you);</li>\r\n                <li>where your data is on an anonymous and aggregated basis, meaning you could not be personally identified from it;</li>\r\n                <li>where it is necessary to carry out your instructions (for example, to process a payment instruction we must provide your Personal Information to our payment processors);</li>\r\n                <li>when you submit information as part of a competition or otherwise interact with our social media channels (for example, by providing a testimonial about one of our Services) we may publish the information you submitted, alongside your name and home country on our website and social media channels;</li>\r\n                <li>as we reasonably believe is permitted by law or regulation;</li>\r\n                <li>in order to comply with any legal obligation, or in order to enforce or apply our terms and conditions and/or any other agreement with you; or to protect the rights, property, or safety of Ozma, our users, or others;</li>\r\n            </ul>\r\n        </p>\r\n\r\n        <h2>Interaction with third party social networks or platforms</h2>\r\n        <p>You can allow our Services to interact with a third party social network (like Facebook) or platform, which will provide data about you to us. These applications or websites are created and maintained by a third party, and thus not controlled by Ozma. You should ensure that you read their terms of service and privacy policies to understand how they treat your data and what data they might share with us.</p>\r\n        <p>You understand that where you allow your account with us to interact with any third party social network or platform, we may share data about you with your contacts (and vice versa) in order that you may enjoy playing socially. This data includes your name, your social media profile picture and your scores and/or progress in our games.</p>\r\n        <p>You can make changes to what data a third party social network or platform shares with us, or stop our Services interacting with that social network or platform by adjusting your settings with that third party provider, however you may find you are not able to enjoy all of the same features of our Services.</p>\r\n\r\n        <h2>Protecting your Personal Information</h2>\r\n        <p>We use the same level of skill in protecting your Personal Information as other similar games developers. However, since the internet is not a completely secure environment unfortunately we cannot guarantee that information you transmit via our Games will not be accessed, disclosed, altered or destroyed by breach of any of our safeguards.</p>\r\n        <p>We will retain your Personal Information for as long as is necessary to fulfill the purposes for which it was collected or as needed to provide you with Services. We may retain your Personal Information after you have closed any account you have with us or after we have ceased providing Services to you if retention of your Personal Information is reasonably necessary to comply with our legal obligations, meet regulatory requirements, resolve disputes between members, prevent fraud, cheating or abuse, or enforce this Privacy Policy or any other agreement we may have with a user.</p>\r\n\r\n        <h2>Your rights in relation to your Personal Information</h2>\r\n        <p>We want to make sure that your Personal Information is accurate and up to date. You may ask us to modify, correct or remove information by contacting us at the email address above.</p>\r\n        <p>Information that you have shared via our Services on any social network or third party platform cannot be amended or deleted by us where it is in the control of that social network or third party platform. In addition, where any third party copies information which you have made available via the use of our Services (for example, one of your friends on a social network you allow to interact with your account), we may not be able to amend or delete it because it may not be in our control.</p>\r\n        <p>You have the right to request a copy of the information that we hold about you. If you would like a copy of some or all of your Personal Information, please contact us at <a href="mailto:support@ozmagames.com">support@ozmagames.com</a> (we may make a small charge for this).</p>\r\n\r\n        <h2>How to contact us</h2>\r\n        <p>To find out more about how your Personal Information will be used please contact us by email at <a href="mailto:support@ozmagames.com">support@ozmagames.com</a>.</p>\r\n\r\n        <h2>Legal matters</h2>\r\n        <p>This Privacy Policy is governed by and interpreted in accordance with the laws of Sweden. Any dispute arising in connection with this Privacy Policy will be subject to the exclusive jurisdiction of the courts of Sweden unless you choose the courts of your home country.</p>\r\n        <p>If any court or other competent authority finds any of the terms of this Privacy Policy to be invalid or unenforceable, the other terms of this Privacy Policy will not be affected.</p>\r\n        <p>We may amend this Privacy Policy from time to time to reflect improvements or any other changes to our business. We will do our best to inform you about any significant changes to this Privacy Policy. If you object to any of the changes you should immediately stop using our Services and close any account you may have with us.</p>\r\n    </article>\r\n</body>\r\n</html>'}),n("text!static/terms.html",[],function(){return'<!DOCTYPE html>\r\n<html>\r\n<head prefix="og: http://ogp.me/ns#">\r\n    <title>WORDS OF OZ TERMS OF USE</title>\r\n\r\n    <meta charset="utf-8" />\r\n    \r\n    <link rel="shortcut icon" href="../../images/icon.png" />\r\n    <link rel="apple-touch-icon" href="../../images/icon.png" />\r\n    <link rel="apple-touch-startup-image" href="../../images/icon.png" />\r\n\r\n    <style>\r\n        .document {\r\n            line-height: 1.3em;\r\n        }\r\n\r\n            .document h1 {\r\n                counter-reset: h2counter;\r\n                font-size: 1.5em;\r\n            }\r\n\r\n            .document h2 {\r\n                font-size: 1em;\r\n            }\r\n\r\n                .document h2:before {\r\n                    content: counter(h2counter) ".\\0000a0\\0000a0";\r\n                    counter-increment: h2counter;\r\n                    counter-reset: h3counter;\r\n                }\r\n\r\n            .document ul {\r\n                padding: 0;\r\n                padding-left: 40px;\r\n            }\r\n\r\n            .document ol {\r\n                list-style: none;\r\n                padding: 0;\r\n                padding-left: 40px;\r\n            }\r\n\r\n                .document ol > li {\r\n                    counter-increment: h3counter;\r\n                    margin-top: .4em;\r\n                    margin-left: 1.5em;\r\n                    position: relative;\r\n                }\r\n\r\n                    .document ol > li:before {\r\n                        content: counter(h2counter) "." counter(h3counter) ".\\0000a0\\0000a0";\r\n                        position: absolute;\r\n                        left: -2.5em;\r\n                    }\r\n    </style>\r\n</head>\r\n<body>\r\n    <article class="document">\r\n        <h1>WORDS OF OZ TERMS OF USE</h1>\r\n        <h2>About these terms</h2>\r\n        <ol>\r\n            <li>These terms create a legal agreement between you (you or your) and Ozma Speldesign AB, Rdmansgatan 15 B, 211 46 Malm Sweden with VAT-number SE556711845901 (we, us or our) in relation to our website wordsofoz.com (Words of Oz, Game, Website). You agree that by accessing and/or using Words of Oz, you are agreeing to these terms and our Privacy Policy (see paragraph 10 below).</li>\r\n            <li>You agree that you are at least 13 years old and that if you are between 13 years and 18 years old, your legal guardian has reviewed and agreed to these terms and is happy for you to access and use our Game.</li>\r\n            <li>We can make changes to these terms at any time in accordance with paragraph 15 below and your continued use of our Game shall confirm your acceptance of the updated terms.</li>\r\n        </ol>\r\n\r\n        <h2>About using and accessing Words of Oz</h2>\r\n        <ol>\r\n            <li>The charge for any individual item you can purchase via our Website shall be as stated on our Website at the time you place the order, except in the case of obvious error. The charge is inclusive of all sales taxes and other charges. We accept payment via Paypal only. If your transaction with our payment processing partners is not successful then your purchase will not be fulfilled. Upon the completion of a successful payment transaction then your purchase will be fulfilled to you as soon as possible.</li>\r\n            <li>You are responsible for the internet connection and/or mobile charges that you may get for using our Game.</li>\r\n            <li>\r\n                We have the right to withdraw or modify our Game without liability to you from time to time:\r\n                <ul>\r\n                    <li>to allow us to improve the player experience</li>\r\n                    <li>for technical reasons (such as technical difficulties experienced by us or on the internet);</li>\r\n                    <li>where we have legal reasons for it;</li>\r\n                </ul>\r\n            </li>\r\n            <li>There may also be times when our Game available for technical or maintenance related reasons, whether on a scheduled or unscheduled basis.</li>\r\n        </ol>\r\n\r\n        <h2>Accounts</h2>\r\n        <ol>\r\n            <li>You agree that you shall take all steps necessary to protect your log in details and keep them secret. You agree that you shall not give your log in details to anyone else or allow anyone else to use your log in details or account. In these terms, references to log in details or account include your log in details and account for any social network or platform that you may allow our Game to interact with.</li>\r\n            <li>If you fail to keep your login details secret, or if you share your login details or account with someone else (whether intentionally or unintentionally), you accept full responsibility for the consequences of this (including any unauthorized purchases) and agree to fully compensate us for any losses or harm that may result.</li>\r\n            <li>We will not be responsible to you for any loss that you suffer as a result of an unauthorised person accessing your account and using our Game and we accept no responsibility for any losses or harm resulting from its unauthorised use, whether fraudulently or otherwise.</li>\r\n            <li>We reserve the right to delete your account if no activity is conducted by you in relation to the account for a period of 200 or more days. In such event, you will no longer be able to access and/or use any Virtual Currency (as defined below) associated with that account and no refund will be offered to you in relation to the same.</li>\r\n            <li>You understand that if you delete your account, or if we delete your account in accordance with these terms, you may lose access to any data previously associated with your account (including, without limitation, the level or score you have reached in our Game and any Virtual Currency associated with your account).</li>\r\n        </ol>\r\n\r\n        <h2>Virtual Currency</h2>\r\n        <ol>\r\n            <li>Our Game include a virtual currency called Besoz (Virtual Currency). You can buy Virtual Currency from us for real money if you are 18 years old or more. Virtual Currency can never be exchanged for real money, real goods or real services from us or anyone else. You agree that you will only obtain Virtual Currency from us, and not from any third party.</li>\r\n            <li>You do not own Virtual Currency but instead you purchase a limited personal revocable licence to use them  any balance of Virtual Currency does not reflect any stored value.</li>\r\n            <li>You agree that all sales by us to you of Virtual Currency are final and that we will not refund any transaction once it has been made. If you live in the European Union you have certain rights to withdraw from distance purchases. Note that when you purchase a licence to use Virtual Currency from us, the performance of our Game begins promptly once your purchase is complete and therefore your right of withdrawal is lost at this point.</li>\r\n            <li>We reserve the right to control, regulate, change or remove any Virtual Currency without any liability to you.</li>\r\n            <li>Without limiting paragraph 3.4, if we terminate or suspend your account in accordance with paragraph 7 of these terms you will lose any Virtual Currency that you may have and we will not compensate you for this loss or make any refund to you.</li>\r\n        </ol>\r\n\r\n\r\n        <h2>User conduct and content</h2>\r\n        <ol>\r\n            <li>You must comply with the laws that apply to you in the location that you access our Game from. If any laws applicable to you restrict or prohibit you from using our Game, you must comply with those legal restrictions or, if applicable, stop accessing and/or using our Game.</li>\r\n            <li>You promise that all the information you provide to us on accessing our Game is and shall remain true, accurate and complete at all times.</li>\r\n            <li>Information, data, software, graphics, photographs, video, sound, tags, or other materials may be sent, uploaded, communicated, transmitted or otherwise made available via our Game by you or another user (Content). You understand and agree that all Content that you may be sent when using our Game, is the sole responsibility of the person that sent the Content. This means that you, not us, are entirely responsible for all Content that you may upload, communicate, transmit or otherwise make available via our Game.</li>\r\n            <li>\r\n                You agree not to upload, communicate, transmit or otherwise make available any Content:\r\n                <ul>\r\n                    <li>that is or could reasonably be viewed as unlawful, harmful, harassing, defamatory, libelous, obscene or otherwise objectionable;</li>\r\n                    <li>that is or could reasonably be viewed as invasive of another\'s privacy;</li>\r\n                    <li>which infringes any intellectual property right or other proprietary right of others;</li>\r\n                    <li>that is likely to, or could reasonably be viewed as likely to incite violence or racial or ethnic hatred;</li>\r\n                    <li>which contains software viruses or any other computer code, files or programs designed to destroy or limit the functionality of any hardware or computer software or telecommunications equipment.</li>\r\n                </ul>\r\n            </li>\r\n            <li>\r\n                You agree that you will not:\r\n                <ul>\r\n                    <li>use our Game to harm anyone or to cause offence to or harass any person;</li>\r\n                    <li>sell, transfer or try to sell or transfer an account with us or any part of an account including any Virtual Currency;</li>\r\n                    <li>disrupt the normal flow of our Game or otherwise act in a manner that is likely to negatively affect other players\' ability to compete fairly when playing our Game or engaging in real time exchanges;</li>\r\n                    <li>disobey any requirements or regulations of any network connected to our Game;                                                                                                                                             </li>\r\n                    <li>use our Game in violation of any applicable law or regulation;                                                                                                                                                            </li>\r\n                    <li>use our Game to cheat or design or assist in cheating (for example, by using automated means or third party software to play), or to otherwise circumvent technological measures designed to control access to our Game;  </li>\r\n                    <li>create more than one account per platform to access our Game;                                                                                                                                                             </li>\r\n                    <li>use another person or entitys email address in order to sign up to use our Game;                                                                                                                                         </li>\r\n                    <li>use our Game for fraudulent or abusive purposes;                                                                                                                                                                          </li>\r\n                    <li>anonymize or hide your IP address or the source of any Content that you may upload;                                                                                                                                       </li>\r\n                    <li>use our Game for any commercial or business purpose or for the benefit of any third party or to send unsolicited communications;                                                                                          </li>\r\n                    <li>remove or amend any proprietary notices or other ownership information from our Game;                                                                                                                                     </li>\r\n                    <li>interfere with or disrupt our Game or networks that provide our Game;                                                                                                                                                     </li>\r\n                    <li>attempt to decompile, disassemble or hack any of our Game, or to defeat or overcome any of our encryption technologies or security measures or data transmitted, processed or stored by us;                               </li>\r\n                    <li>use our Game in any other way not permitted by these terms.                                                                                                                                                               </li>\r\n                </ul>\r\n            </li>\r\n            <li>We do not control Content posted in our Game by other people and therefore we do not guarantee the accuracy, integrity or quality of that Content. You understand that when using our Game, you may be exposed to Content that you may consider offensive, indecent or objectionable. Under no circumstances will we be liable in any way for any Content, including, but not limited to, any errors or omissions in any Content, or any losses or harm of any kind resulting from the use of any Content posted, emailed, transmitted or otherwise made available via our Game.</li>\r\n            <li>We have the right to remove uploaded Content from our Game if we decide in our sole discretion that it results in or from a breach of any part of these terms, or that it may bring us or our Game into disrepute. We do not actively monitor Content that is contributed by people that use our Game and we make no undertaking to do so.</li>\r\n            <li>You are solely responsible for your interactions with other users of our Game.</li>\r\n        </ol>\r\n\r\n        <h2>Playing our Games with other users</h2>\r\n        <ol>\r\n            <li>Our Game allow you to play against an opponent. You may be able to (i) choose to play against another user, or (ii) play against one of your contacts on a platform or social network which you have allowed our games to interact with. Our Game may also allow you to search for your friends (for example, by email address) in order to find them to play against.</li>\r\n            <li>Where we select another user for you, we may either select at random or use such criteria as we see fit to select your opponent (for example, your past scores, your location or level you have reached in the Game).</li>\r\n            <li>By accessing and/or playing our Game, you agree to your user name, scores, and other related details being displayed to other users. You also understand and agree that other users may find you by searching for you with your email address. Please note that we will only show your user name publically, and not your email address; another user must already know your email address in order to search for you.</li>\r\n        </ol>\r\n\r\n        <h2>Your breach of these terms</h2>\r\n        <ol>\r\n            <li>We reserve the right to suspend or terminate your access to our Game (including by deleting your account) if we reasonably believe that you are in material breach of these terms (including by repeated minor breaches). Without limitation, any breaches of paragraphs 5.4 or 5.5 are likely to be considered material breaches.</li>\r\n            <li>You agree to compensate us, according to law, for all harm, losses, claims and expenses that may arise from any breach of these terms by you.</li>\r\n        </ol>\r\n\r\n        <h2>Disclaimer and release</h2>\r\n        <ol>\r\n            <li>We will only be responsible for losses or harm which are a reasonably foreseeable consequence of our negligence or breach of these terms and conditions up to the value of the amount that you have paid to us in the 90 day period ending on the date of your claim. Losses and harm are foreseeable where they could be contemplated by you and us at the time of you agreeing to these terms and conditions.</li>\r\n            <li>\r\n                We are not responsible for:\r\n                <ul>\r\n                    <li>losses or harm not caused by our breach of these terms or negligence; or</li>\r\n                    <li>losses or harm which are not reasonably foreseeable by you and us at the time of you agreeing to these terms and conditions including those losses which happen as a side effect of foreseeable losses. This could include loss of data, loss of opportunity, service interruption, computer or other device failure or financial loss;</li>\r\n                    <li>any increase in loss or damage resulting from breach by you of any of these terms and conditions; or</li>\r\n                    <li>technical failures or the lack of availability of our Website, Game, and/or social media channels where these are not within our reasonable control.</li>\r\n                </ul>\r\n            </li>\r\n            <li>You acknowledge that your only right with respect to any problems or dissatisfaction with any of our Game is to discontinue your use of our Game and we are not responsible or liable for any interruptions or errors that you may experience while accessing our Game.</li>\r\n            <li>Any additional legal rights which you may have as a consumer remain unaffected by these terms.</li>\r\n        </ol>\r\n\r\n        <h2>Privacy</h2>\r\n        <ol>\r\n            <li>We are registered with the data protection authority in Sweden.</li>\r\n            <li>We will only collect, process, use and share your personal information in accordance with our Privacy Policy and as set out in these terms. By using our Game, you give your consent to us collecting, using, sharing and processing your personal data in this way.</li>\r\n            <li>Any personal information that we collect may also be subject to the policy of any social network that you may agree to link our Game to. If you play our Game and you agree to allow them to interact with a social network you are giving us permission to use any information that social network shares with us that will allow us to personally identify you. You are also granting us permission to help your contacts on that network find you so that you can play socially. This is intended to make our Game better for you and others that play our Game on that social network. If you do not agree to these practices you should not allow our Game to interact with your social network.</li>\r\n            <li>We may use cookies, or similar technologies (such as HTML5 Local Storage) to store certain types of information each time you use our Services. They may for example be used to help us recognize your computer and to ensure that your account is accessed by the person that inputs the correct username and password for that account. You can find out more about how we use cookies and other similar technologies by reading our Privacy Policy.</li>\r\n        </ol>\r\n\r\n        <h2>Intellectual property</h2>\r\n        <ol>\r\n            <li>You acknowledge that all copyright, trade marks, and other intellectual property rights in and relating to our Game (other than Content which is contributed and owned by players) is owned by or licensed to us.</li>\r\n            <li>Whilst you are in compliance with these terms, we grant you a personal, non-exclusive, non-transferable, revocable limited license to access and use our Game (but not the related object and source code) for your own personal private use, in each case provided that such use is in accordance with these terms. You agree not to use our Game for anything else.</li>\r\n            <li>You must not distribute, copy, make available to the public or create any derivative work from our Game or any part of our Game unless we have first agreed to this in writing.</li>\r\n            <li>In particular, and without limiting the application of paragraph 9.3, you must not make available any cheats or technological measures designed to control access to, or elements of, our Game, including providing access to any Virtual Currency, whether on a free of charge basis or otherwise.</li>\r\n            <li>\r\n                By submitting Content (as defined in paragraph 5.3) via our Game you:\r\n                <ul>\r\n                    <li>are representing that you are fully entitled to do so;</li>\r\n                    <li>grant us and our group companies the right to edit, adapt, publish and use your entry and any derivative works we may create from it, in any and all media (whether it exists now or in the future), for any purpose, in perpetuity, without any payment to you;</li>\r\n                    <li>acknowledge that you may have what are known as moral rights in the Content, for example the right to be named as the creator of your entry and the right not to have work subjected to derogatory treatment. You agree to waive any such moral rights you may have in the Content;</li>\r\n                    <li>agree that we have no obligation to monitor or protect your rights in any Content that you may submit to us, but you do give us the right to enforce your rights in that Content if we want to, including but not limited to taking legal action (at our cost) on your behalf.</li>\r\n                    </l>\r\n            </li>\r\n            <li>You must not distribute, copy, make available to the public or create any derivative work from any Content belonging to any other user of our Game.</li>\r\n        </ol>\r\n\r\n        <h2>Transferring these terms</h2>\r\n        <ol>\r\n            <li>We may wish to transfer all or a part of our rights or responsibilities under these terms to someone else without obtaining your consent. You agree that we may do so provided that the transfer does not significantly disadvantage you. You may not transfer any of the rights we give you under these terms unless we first agree to this in writing.</li>\r\n        </ol>\r\n\r\n        <h2>Entire agreement</h2>\r\n        <ol>\r\n            <li>These terms set out the entire agreement between you and us concerning our Game (as defined in paragraph 1) and they replace all earlier agreements and understandings between you and us. If you also access or play our Game via other platforms (for example, by downloading our Game to play via the App Store, Google Play or by accessing our Game via any other third party website or service, including, without limitation, Facebook) then different terms and conditions may apply in respect of those Games.</li>\r\n        </ol>\r\n\r\n        <h2>Severability</h2>\r\n        <ol>\r\n            <li>If any part of these terms is held to be invalid or unenforceable under any applicable local laws or by an applicable court, that part shall be interpreted in a manner consistent with applicable law to reflect as nearly as possible our original intentions and the remainder of these terms shall remain valid and enforceable.</li>\r\n        </ol>\r\n\r\n        <h2>Changes to these terms</h2>\r\n        <ol>\r\n            <li>We reserve the right to update these terms from time to time by posting the updated version on our Website. We may do so because we change the nature of our products or services, for technical or legal reasons, or because the needs of our business have changed. You agree that if you do not accept any amendment to our terms then you shall immediately stop accessing and/or using our Game.</li>\r\n        </ol>\r\n\r\n        <h2>Waivers of our rights</h2>\r\n        <ol>\r\n            <li>Our failure to exercise or enforce any of our rights under these terms does not waive our right to enforce such right. Any waiver of such rights shall only be effective if it is in writing and signed by us.</li>\r\n        </ol>\r\n\r\n        <h2>Complaints and dispute resolution</h2>\r\n        <ol>\r\n            <li>Most concerns can be solved quickly by contacting us at <a href="mailto:support@ozmagames.com">support@ozmagames.com</a>. In the unlikely event that we cannot solve your concern and you wish to bring legal action against us these terms shall be governed by and construed in accordance with the laws of Sweden.</li>\r\n        </ol>\r\n\r\n        <h2>Questions about these terms</h2>\r\n        <ol>\r\n            <li>If you have any questions about these terms or our Game you may contact us by email at <a href="mailto:support@ozmagames.com">support@ozmagames.com</a>.</li>\r\n            <li>These terms were last updated on 1 August 2014.</li>\r\n        </ol>\r\n    </article>\r\n\r\n</body>\r\n</html>'
}),n("text!views/static/faq.html",[],function(){return'<!DOCTYPE html>\r\n<html>\r\n<head prefix="og: http://ogp.me/ns#">\r\n    <title>Words of Oz Privacy Policy</title>\r\n\r\n    <meta charset="utf-8" />\r\n\r\n    <link rel="shortcut icon" href="../../images/icon.png" />\r\n    <link rel="apple-touch-icon" href="../../images/icon.png" />\r\n    <link rel="apple-touch-startup-image" href="../../images/icon.png" />\r\n\r\n    <style>\r\n        .document {\r\n            line-height: 1.3em;\r\n        }\r\n\r\n            .document h1 {\r\n                font-size: 1.5em;\r\n            }\r\n\r\n            .document h2 {\r\n                font-size: 1.2em;\r\n                padding: .3em 0;\r\n            }\r\n\r\n            .document ul {\r\n                padding: 0;\r\n                padding-left: 25px;\r\n            }\r\n\r\n            .document ol {\r\n                padding: 0;\r\n                padding-left: 25px;\r\n            }\r\n\r\n                .document ol > li {\r\n                    margin-top: .4em;\r\n                    margin-left: 1.5em;\r\n                    position: relative;\r\n                }\r\n\r\n                    .document ol > li:before {\r\n                        position: absolute;\r\n                        left: -2.5em;\r\n                    }\r\n        .document .centered {\r\n            text-align: center;\r\n        }\r\n\r\n        .document img {\r\n            margin: 10px;\r\n        }\r\n    </style>\r\n</head>\r\n<body>\r\n    <article class="document">\r\n        <h2>What is Besoz?</h2>\r\n        <p>Besoz are the internal currency in the game. You can see the amount of besoz you have in the top right corner above the red wand. Besoz can be used to buy new collections to play with and more storage space for archived games. It can also be used to make buy new words inside a game and to change verb endings.</p>\r\n        <p>To buy besoz either simply click the red wand in the top right corner, or go to the shop and select the besoz tab. Choose the number of besoz you wish to purchase. You will then be transferred to Paypal to finish your transaction.</p>\r\n\r\n        <h2>What is XP?</h2>\r\n        <p>XP or "Experience Points" are points you receive for doing things in the game. When you reach a certain amount of XP you will level up. Every time you level up you will receive an amount of besoz, our internal currency.</p>\r\n        <p>You will find the details about the XP you\'ve earned and how far you are from the next level on your Profile, which is displayed when you click your username in the top right corner inside a game.</p>\r\n        <p class="centered"><img src="images/faq/image00.png" /></p>\r\n\r\n        <h2>How do I earn XP?</h2>\r\n        <p>You will earn XP by doing the following things. We might add more in the future.</p>\r\n        <ul>\r\n            <li>Playing a single-player game to the end (3 XP)</li>\r\n            <li>Winning a two-player game (15 XP)</li>\r\n            <li>Losing a two-player game (5 XP)</li>\r\n            <li>Playing with a new friend gives 10 extra XP on top of the ones you earn for winning of losing (does not apply to a random opponent)</li>\r\n        </ul>\r\n        <p></p>\r\n\r\n        <h2>How do the Advancement levels work?</h2>\r\n        <p>There are three Advancement levels in the game:</p>\r\n        <ol>\r\n            <li>Apprentice of Poetry</li>\r\n            <li>Practitioner of Poetry</li>\r\n            <li>Master of Poetry</li>\r\n        </ol>\r\n        <p>You start out as an Apprentice of Poetry. You will become a Practitioner of Poetry when you reach level 2 and a Master of Poetry when you reach level 4. When you reach a new Advancement level you will get new game boards to play with and new bonus rules are unlocked.</p>\r\n\r\n        <h2>How do I add a friend?</h2>\r\n        <p>There are two ways to add a friend.</p>\r\n        <ol>\r\n            <li>\r\n                Go to New Game in the menu. Here you can search for a friend by using name, username or email address. The search will look for your friends among the registered Words of Oz players. If you find your friend in the search result, simply click the add friend symbol to add your friend.\r\n                <p class="centered"><img src="images/faq/image02.png" /></p>\r\n            </li>\r\n            <li>\r\n                The second way to add a friend is to click the username of the your opponent player inside a game. You will then see their profile. Use the Add friend-button on their profile to add them as a friend.\r\n                <p class="centered"><img src="images/faq/image01.png" /></p>\r\n            </li>\r\n        </ol>\r\n\r\n        <h2>How do I block a person?</h2>\r\n        <p>To block a person that has started a game with you, click the username of the your opponent player inside the game. You will then see their profile. Use the Block-button on their profile to block them. This means you will never receive new game requests from them again.</p>\r\n\r\n        <h2>What is a collection?</h2>\r\n        <p>A collection is a set of 20 images and 250 words. When you play with a certain collection, all the images and most of the words will be randomly picked from it. The rest of the words come from a set of basic words that are general pronouns, prepositions, verbs, nouns, adverbs, adjectives and conjugations.</p>\r\n\r\n        <h2>What is a booster?</h2>\r\n        <p>A booster is an addition to a collection. If you add a booster to a collection you get an additional 10 images and 100 words. These are integrated into your collection. You can\'t choose to play without a booster that you have added to a collection.</p>\r\n\r\n        <h2>Where do I find my collections?</h2>\r\n        <p>After you\'ve bought a collection you will find it on the page where you start a new game. In the list of collections to play with, you can now choose it.</p>\r\n\r\n        <h2>I can\'t find the words I like. Why?</h2>\r\n        <p>Our database of words will increase with time. Please help us add words to it by using the Suggest word-function.</p>\r\n    </article>\r\n</body>\r\n</html>'}),n("text!views/static/privacy.html",[],function(){return'<!DOCTYPE html>\r\n<html>\r\n<head prefix="og: http://ogp.me/ns#">\r\n    <title>Words of Oz Privacy Policy</title>\r\n\r\n    <meta charset="utf-8" />\r\n\r\n    <link rel="shortcut icon" href="../../images/icon.png" />\r\n    <link rel="apple-touch-icon" href="../../images/icon.png" />\r\n    <link rel="apple-touch-startup-image" href="../../images/icon.png" />\r\n\r\n    <style>\r\n        .document {\r\n            line-height: 1.3em;\r\n        }\r\n\r\n            .document h1 {\r\n                font-size: 1.5em;\r\n            }\r\n\r\n            .document h2 {\r\n                font-size: 1.2em;\r\n            }\r\n\r\n            .document ul {\r\n                padding: 0;\r\n                padding-left: 40px;\r\n            }\r\n\r\n            .document ol {\r\n                list-style: none;\r\n                padding: 0;\r\n                padding-left: 40px;\r\n            }\r\n\r\n                .document ol > li {\r\n                    margin-top: .4em;\r\n                    margin-left: 1.5em;\r\n                    position: relative;\r\n                }\r\n\r\n                    .document ol > li:before {\r\n                        position: absolute;\r\n                        left: -2.5em;\r\n                    }\r\n    </style>\r\n</head>\r\n<body>\r\n    <article class="document">\r\n        <h1>Privacy Policy</h1>\r\n        <h2>Introduction</h2>\r\n        <p>At Ozma we respect the privacy of everyone who uses our games, website(s) and all related services which we may provide to you (Services). In this document we refer to Ozma Speldesign AB as Ozma us, we or our and we refer to you as you and your.</p>\r\n        <p>This document explains how we collect, store and process any personal data belonging to you, meaning information about you which is personally identifiable such as your name, address, telephone number or email address. Such information is referred to in this policy as "Personal Information" or data.</p>\r\n        <p>By accessing and/or using our Services you consent to us collecting, storing, processing and sharing your Personal Information in the ways set out in this document. If you have any concerns about providing data to us or having it used in any manner permitted in this Privacy Policy, you should not use our Services.</p>\r\n\r\n        <h2>Ozma</h2>\r\n        <p>Ozma is a company registered in Sweden. Our registered office is Rdmansgatan 15 B, 211 46 Malm.</p>\r\n\r\n        <h2>Information collected</h2>\r\n        <p>\r\n            We may collect and process the following data about you:\r\n            <ul>\r\n                <li>information that you provide us with when you fill in forms when you create an account with us;</li>\r\n                <li>details of your use of our Services and the resources that you access (for example, information about how and when you play our games or visit our website(s), or what device you use to access our Services);</li>\r\n                <li>if you contact us or respond to messages and communications that we send to you, we may keep a record of that correspondence;</li>\r\n                <li>your interactions with us on our social media channels.</li>\r\n            </ul>\r\n        </p>\r\n\r\n        <h2>Payment Information</h2>\r\n        <p>We may collect certain payment information from you on behalf of our payment service providers, but this information is temporarily cached in a way that is unreadable by Ozma. </p>\r\n\r\n        <h2>How will we use your Personal Information?</h2>\r\n        <p>\r\n            You agree that we (or a supplier acting on our behalf and only under our instructions) may use your Personal Information for the purposes of:\r\n            <ul>\r\n                <li>managing your account and relationship with us and improving your experience when you use our Services;</li>\r\n                <li>contacting you, for example as part of customer service or to send you updates about our Services;</li>\r\n                <li>research, surveying, and engaging with you, for example by sending you communications (including by email) for these purposes;</li>\r\n                <li>marketing and promotion of our Services or related products, for example sending you communications (including by email) for these purposes. If you do not want us to use your data in this way please let us know by contacting us at <a href="mailto:support@ozmagames.com">support@ozmagames.com</a>;</li>\r\n                <li>to create reports, analysis or similar services for use by us for the purposes of research or business intelligence, for example to track potential problems or trends with our Services;</li>\r\n                <li>preventing cheating, crime or fraud. We may also need to pass your information to fraud prevention agencies and other organizations involved in crime and fraud prevention; and</li>\r\n                <li>as otherwise expressly set out in this Privacy Policy or as required by law.</li>\r\n            </ul>\r\n        </p>\r\n\r\n        <h2>Information shared with third parties</h2>\r\n        <p>\r\n            We will only share your data with third parties:\r\n            <ul>\r\n                <li>with your consent (including as set out in this Privacy Policy);</li>\r\n                <li>as reasonably necessary in order to provide the Services to you (for example, by providing your Personal Information to suppliers we may use to fulfill the Services or to communicate with you);</li>\r\n                <li>where your data is on an anonymous and aggregated basis, meaning you could not be personally identified from it;</li>\r\n                <li>where it is necessary to carry out your instructions (for example, to process a payment instruction we must provide your Personal Information to our payment processors);</li>\r\n                <li>when you submit information as part of a competition or otherwise interact with our social media channels (for example, by providing a testimonial about one of our Services) we may publish the information you submitted, alongside your name and home country on our website and social media channels;</li>\r\n                <li>as we reasonably believe is permitted by law or regulation;</li>\r\n                <li>in order to comply with any legal obligation, or in order to enforce or apply our terms and conditions and/or any other agreement with you; or to protect the rights, property, or safety of Ozma, our users, or others;</li>\r\n            </ul>\r\n        </p>\r\n\r\n        <h2>Interaction with third party social networks or platforms</h2>\r\n        <p>You can allow our Services to interact with a third party social network (like Facebook) or platform, which will provide data about you to us. These applications or websites are created and maintained by a third party, and thus not controlled by Ozma. You should ensure that you read their terms of service and privacy policies to understand how they treat your data and what data they might share with us.</p>\r\n        <p>You understand that where you allow your account with us to interact with any third party social network or platform, we may share data about you with your contacts (and vice versa) in order that you may enjoy playing socially. This data includes your name, your social media profile picture and your scores and/or progress in our games.</p>\r\n        <p>You can make changes to what data a third party social network or platform shares with us, or stop our Services interacting with that social network or platform by adjusting your settings with that third party provider, however you may find you are not able to enjoy all of the same features of our Services.</p>\r\n\r\n        <h2>Protecting your Personal Information</h2>\r\n        <p>We use the same level of skill in protecting your Personal Information as other similar games developers. However, since the internet is not a completely secure environment unfortunately we cannot guarantee that information you transmit via our Games will not be accessed, disclosed, altered or destroyed by breach of any of our safeguards.</p>\r\n        <p>We will retain your Personal Information for as long as is necessary to fulfill the purposes for which it was collected or as needed to provide you with Services. We may retain your Personal Information after you have closed any account you have with us or after we have ceased providing Services to you if retention of your Personal Information is reasonably necessary to comply with our legal obligations, meet regulatory requirements, resolve disputes between members, prevent fraud, cheating or abuse, or enforce this Privacy Policy or any other agreement we may have with a user.</p>\r\n\r\n        <h2>Your rights in relation to your Personal Information</h2>\r\n        <p>We want to make sure that your Personal Information is accurate and up to date. You may ask us to modify, correct or remove information by contacting us at the email address above.</p>\r\n        <p>Information that you have shared via our Services on any social network or third party platform cannot be amended or deleted by us where it is in the control of that social network or third party platform. In addition, where any third party copies information which you have made available via the use of our Services (for example, one of your friends on a social network you allow to interact with your account), we may not be able to amend or delete it because it may not be in our control.</p>\r\n        <p>You have the right to request a copy of the information that we hold about you. If you would like a copy of some or all of your Personal Information, please contact us at <a href="mailto:support@ozmagames.com">support@ozmagames.com</a> (we may make a small charge for this).</p>\r\n\r\n        <h2>How to contact us</h2>\r\n        <p>To find out more about how your Personal Information will be used please contact us by email at <a href="mailto:support@ozmagames.com">support@ozmagames.com</a>.</p>\r\n\r\n        <h2>Legal matters</h2>\r\n        <p>This Privacy Policy is governed by and interpreted in accordance with the laws of Sweden. Any dispute arising in connection with this Privacy Policy will be subject to the exclusive jurisdiction of the courts of Sweden unless you choose the courts of your home country.</p>\r\n        <p>If any court or other competent authority finds any of the terms of this Privacy Policy to be invalid or unenforceable, the other terms of this Privacy Policy will not be affected.</p>\r\n        <p>We may amend this Privacy Policy from time to time to reflect improvements or any other changes to our business. We will do our best to inform you about any significant changes to this Privacy Policy. If you object to any of the changes you should immediately stop using our Services and close any account you may have with us.</p>\r\n    </article>\r\n</body>\r\n</html>'}),n("text!views/static/terms.html",[],function(){return'<!DOCTYPE html>\r\n<html>\r\n<head prefix="og: http://ogp.me/ns#">\r\n    <title>WORDS OF OZ TERMS OF USE</title>\r\n\r\n    <meta charset="utf-8" />\r\n    \r\n    <link rel="shortcut icon" href="../../images/icon.png" />\r\n    <link rel="apple-touch-icon" href="../../images/icon.png" />\r\n    <link rel="apple-touch-startup-image" href="../../images/icon.png" />\r\n\r\n    <style>\r\n        .document {\r\n            line-height: 1.3em;\r\n        }\r\n\r\n            .document h1 {\r\n                counter-reset: h2counter;\r\n                font-size: 1.5em;\r\n            }\r\n\r\n            .document h2 {\r\n                font-size: 1em;\r\n            }\r\n\r\n                .document h2:before {\r\n                    content: counter(h2counter) ".\\0000a0\\0000a0";\r\n                    counter-increment: h2counter;\r\n                    counter-reset: h3counter;\r\n                }\r\n\r\n            .document ul {\r\n                padding: 0;\r\n                padding-left: 40px;\r\n            }\r\n\r\n            .document ol {\r\n                list-style: none;\r\n                padding: 0;\r\n                padding-left: 40px;\r\n            }\r\n\r\n                .document ol > li {\r\n                    counter-increment: h3counter;\r\n                    margin-top: .4em;\r\n                    margin-left: 1.5em;\r\n                    position: relative;\r\n                }\r\n\r\n                    .document ol > li:before {\r\n                        content: counter(h2counter) "." counter(h3counter) ".\\0000a0\\0000a0";\r\n                        position: absolute;\r\n                        left: -2.5em;\r\n                    }\r\n    </style>\r\n</head>\r\n<body>\r\n    <article class="document">\r\n        <h1>WORDS OF OZ TERMS OF USE</h1>\r\n        <h2>About these terms</h2>\r\n        <ol>\r\n            <li>These terms create a legal agreement between you (you or your) and Ozma Speldesign AB, Rdmansgatan 15 B, 211 46 Malm Sweden with VAT-number SE556711845901 (we, us or our) in relation to our website wordsofoz.com (Words of Oz, Game, Website). You agree that by accessing and/or using Words of Oz, you are agreeing to these terms and our Privacy Policy (see paragraph 10 below).</li>\r\n            <li>You agree that you are at least 13 years old and that if you are between 13 years and 18 years old, your legal guardian has reviewed and agreed to these terms and is happy for you to access and use our Game.</li>\r\n            <li>We can make changes to these terms at any time in accordance with paragraph 15 below and your continued use of our Game shall confirm your acceptance of the updated terms.</li>\r\n        </ol>\r\n\r\n        <h2>About using and accessing Words of Oz</h2>\r\n        <ol>\r\n            <li>The charge for any individual item you can purchase via our Website shall be as stated on our Website at the time you place the order, except in the case of obvious error. The charge is inclusive of all sales taxes and other charges. We accept payment via Paypal only. If your transaction with our payment processing partners is not successful then your purchase will not be fulfilled. Upon the completion of a successful payment transaction then your purchase will be fulfilled to you as soon as possible.</li>\r\n            <li>You are responsible for the internet connection and/or mobile charges that you may get for using our Game.</li>\r\n            <li>\r\n                We have the right to withdraw or modify our Game without liability to you from time to time:\r\n                <ul>\r\n                    <li>to allow us to improve the player experience</li>\r\n                    <li>for technical reasons (such as technical difficulties experienced by us or on the internet);</li>\r\n                    <li>where we have legal reasons for it;</li>\r\n                </ul>\r\n            </li>\r\n            <li>There may also be times when our Game available for technical or maintenance related reasons, whether on a scheduled or unscheduled basis.</li>\r\n        </ol>\r\n\r\n        <h2>Accounts</h2>\r\n        <ol>\r\n            <li>You agree that you shall take all steps necessary to protect your log in details and keep them secret. You agree that you shall not give your log in details to anyone else or allow anyone else to use your log in details or account. In these terms, references to log in details or account include your log in details and account for any social network or platform that you may allow our Game to interact with.</li>\r\n            <li>If you fail to keep your login details secret, or if you share your login details or account with someone else (whether intentionally or unintentionally), you accept full responsibility for the consequences of this (including any unauthorized purchases) and agree to fully compensate us for any losses or harm that may result.</li>\r\n            <li>We will not be responsible to you for any loss that you suffer as a result of an unauthorised person accessing your account and using our Game and we accept no responsibility for any losses or harm resulting from its unauthorised use, whether fraudulently or otherwise.</li>\r\n            <li>We reserve the right to delete your account if no activity is conducted by you in relation to the account for a period of 200 or more days. In such event, you will no longer be able to access and/or use any Virtual Currency (as defined below) associated with that account and no refund will be offered to you in relation to the same.</li>\r\n            <li>You understand that if you delete your account, or if we delete your account in accordance with these terms, you may lose access to any data previously associated with your account (including, without limitation, the level or score you have reached in our Game and any Virtual Currency associated with your account).</li>\r\n        </ol>\r\n\r\n        <h2>Virtual Currency</h2>\r\n        <ol>\r\n            <li>Our Game include a virtual currency called Besoz (Virtual Currency). You can buy Virtual Currency from us for real money if you are 18 years old or more. Virtual Currency can never be exchanged for real money, real goods or real services from us or anyone else. You agree that you will only obtain Virtual Currency from us, and not from any third party.</li>\r\n            <li>You do not own Virtual Currency but instead you purchase a limited personal revocable licence to use them  any balance of Virtual Currency does not reflect any stored value.</li>\r\n            <li>You agree that all sales by us to you of Virtual Currency are final and that we will not refund any transaction once it has been made. If you live in the European Union you have certain rights to withdraw from distance purchases. Note that when you purchase a licence to use Virtual Currency from us, the performance of our Game begins promptly once your purchase is complete and therefore your right of withdrawal is lost at this point.</li>\r\n            <li>We reserve the right to control, regulate, change or remove any Virtual Currency without any liability to you.</li>\r\n            <li>Without limiting paragraph 3.4, if we terminate or suspend your account in accordance with paragraph 7 of these terms you will lose any Virtual Currency that you may have and we will not compensate you for this loss or make any refund to you.</li>\r\n        </ol>\r\n\r\n\r\n        <h2>User conduct and content</h2>\r\n        <ol>\r\n            <li>You must comply with the laws that apply to you in the location that you access our Game from. If any laws applicable to you restrict or prohibit you from using our Game, you must comply with those legal restrictions or, if applicable, stop accessing and/or using our Game.</li>\r\n            <li>You promise that all the information you provide to us on accessing our Game is and shall remain true, accurate and complete at all times.</li>\r\n            <li>Information, data, software, graphics, photographs, video, sound, tags, or other materials may be sent, uploaded, communicated, transmitted or otherwise made available via our Game by you or another user (Content). You understand and agree that all Content that you may be sent when using our Game, is the sole responsibility of the person that sent the Content. This means that you, not us, are entirely responsible for all Content that you may upload, communicate, transmit or otherwise make available via our Game.</li>\r\n            <li>\r\n                You agree not to upload, communicate, transmit or otherwise make available any Content:\r\n                <ul>\r\n                    <li>that is or could reasonably be viewed as unlawful, harmful, harassing, defamatory, libelous, obscene or otherwise objectionable;</li>\r\n                    <li>that is or could reasonably be viewed as invasive of another\'s privacy;</li>\r\n                    <li>which infringes any intellectual property right or other proprietary right of others;</li>\r\n                    <li>that is likely to, or could reasonably be viewed as likely to incite violence or racial or ethnic hatred;</li>\r\n                    <li>which contains software viruses or any other computer code, files or programs designed to destroy or limit the functionality of any hardware or computer software or telecommunications equipment.</li>\r\n                </ul>\r\n            </li>\r\n            <li>\r\n                You agree that you will not:\r\n                <ul>\r\n                    <li>use our Game to harm anyone or to cause offence to or harass any person;</li>\r\n                    <li>sell, transfer or try to sell or transfer an account with us or any part of an account including any Virtual Currency;</li>\r\n                    <li>disrupt the normal flow of our Game or otherwise act in a manner that is likely to negatively affect other players\' ability to compete fairly when playing our Game or engaging in real time exchanges;</li>\r\n                    <li>disobey any requirements or regulations of any network connected to our Game;                                                                                                                                             </li>\r\n                    <li>use our Game in violation of any applicable law or regulation;                                                                                                                                                            </li>\r\n                    <li>use our Game to cheat or design or assist in cheating (for example, by using automated means or third party software to play), or to otherwise circumvent technological measures designed to control access to our Game;  </li>\r\n                    <li>create more than one account per platform to access our Game;                                                                                                                                                             </li>\r\n                    <li>use another person or entitys email address in order to sign up to use our Game;                                                                                                                                         </li>\r\n                    <li>use our Game for fraudulent or abusive purposes;                                                                                                                                                                          </li>\r\n                    <li>anonymize or hide your IP address or the source of any Content that you may upload;                                                                                                                                       </li>\r\n                    <li>use our Game for any commercial or business purpose or for the benefit of any third party or to send unsolicited communications;                                                                                          </li>\r\n                    <li>remove or amend any proprietary notices or other ownership information from our Game;                                                                                                                                     </li>\r\n                    <li>interfere with or disrupt our Game or networks that provide our Game;                                                                                                                                                     </li>\r\n                    <li>attempt to decompile, disassemble or hack any of our Game, or to defeat or overcome any of our encryption technologies or security measures or data transmitted, processed or stored by us;                               </li>\r\n                    <li>use our Game in any other way not permitted by these terms.                                                                                                                                                               </li>\r\n                </ul>\r\n            </li>\r\n            <li>We do not control Content posted in our Game by other people and therefore we do not guarantee the accuracy, integrity or quality of that Content. You understand that when using our Game, you may be exposed to Content that you may consider offensive, indecent or objectionable. Under no circumstances will we be liable in any way for any Content, including, but not limited to, any errors or omissions in any Content, or any losses or harm of any kind resulting from the use of any Content posted, emailed, transmitted or otherwise made available via our Game.</li>\r\n            <li>We have the right to remove uploaded Content from our Game if we decide in our sole discretion that it results in or from a breach of any part of these terms, or that it may bring us or our Game into disrepute. We do not actively monitor Content that is contributed by people that use our Game and we make no undertaking to do so.</li>\r\n            <li>You are solely responsible for your interactions with other users of our Game.</li>\r\n        </ol>\r\n\r\n        <h2>Playing our Games with other users</h2>\r\n        <ol>\r\n            <li>Our Game allow you to play against an opponent. You may be able to (i) choose to play against another user, or (ii) play against one of your contacts on a platform or social network which you have allowed our games to interact with. Our Game may also allow you to search for your friends (for example, by email address) in order to find them to play against.</li>\r\n            <li>Where we select another user for you, we may either select at random or use such criteria as we see fit to select your opponent (for example, your past scores, your location or level you have reached in the Game).</li>\r\n            <li>By accessing and/or playing our Game, you agree to your user name, scores, and other related details being displayed to other users. You also understand and agree that other users may find you by searching for you with your email address. Please note that we will only show your user name publically, and not your email address; another user must already know your email address in order to search for you.</li>\r\n        </ol>\r\n\r\n        <h2>Your breach of these terms</h2>\r\n        <ol>\r\n            <li>We reserve the right to suspend or terminate your access to our Game (including by deleting your account) if we reasonably believe that you are in material breach of these terms (including by repeated minor breaches). Without limitation, any breaches of paragraphs 5.4 or 5.5 are likely to be considered material breaches.</li>\r\n            <li>You agree to compensate us, according to law, for all harm, losses, claims and expenses that may arise from any breach of these terms by you.</li>\r\n        </ol>\r\n\r\n        <h2>Disclaimer and release</h2>\r\n        <ol>\r\n            <li>We will only be responsible for losses or harm which are a reasonably foreseeable consequence of our negligence or breach of these terms and conditions up to the value of the amount that you have paid to us in the 90 day period ending on the date of your claim. Losses and harm are foreseeable where they could be contemplated by you and us at the time of you agreeing to these terms and conditions.</li>\r\n            <li>\r\n                We are not responsible for:\r\n                <ul>\r\n                    <li>losses or harm not caused by our breach of these terms or negligence; or</li>\r\n                    <li>losses or harm which are not reasonably foreseeable by you and us at the time of you agreeing to these terms and conditions including those losses which happen as a side effect of foreseeable losses. This could include loss of data, loss of opportunity, service interruption, computer or other device failure or financial loss;</li>\r\n                    <li>any increase in loss or damage resulting from breach by you of any of these terms and conditions; or</li>\r\n                    <li>technical failures or the lack of availability of our Website, Game, and/or social media channels where these are not within our reasonable control.</li>\r\n                </ul>\r\n            </li>\r\n            <li>You acknowledge that your only right with respect to any problems or dissatisfaction with any of our Game is to discontinue your use of our Game and we are not responsible or liable for any interruptions or errors that you may experience while accessing our Game.</li>\r\n            <li>Any additional legal rights which you may have as a consumer remain unaffected by these terms.</li>\r\n        </ol>\r\n\r\n        <h2>Privacy</h2>\r\n        <ol>\r\n            <li>We are registered with the data protection authority in Sweden.</li>\r\n            <li>We will only collect, process, use and share your personal information in accordance with our Privacy Policy and as set out in these terms. By using our Game, you give your consent to us collecting, using, sharing and processing your personal data in this way.</li>\r\n            <li>Any personal information that we collect may also be subject to the policy of any social network that you may agree to link our Game to. If you play our Game and you agree to allow them to interact with a social network you are giving us permission to use any information that social network shares with us that will allow us to personally identify you. You are also granting us permission to help your contacts on that network find you so that you can play socially. This is intended to make our Game better for you and others that play our Game on that social network. If you do not agree to these practices you should not allow our Game to interact with your social network.</li>\r\n            <li>We may use cookies, or similar technologies (such as HTML5 Local Storage) to store certain types of information each time you use our Services. They may for example be used to help us recognize your computer and to ensure that your account is accessed by the person that inputs the correct username and password for that account. You can find out more about how we use cookies and other similar technologies by reading our Privacy Policy.</li>\r\n        </ol>\r\n\r\n        <h2>Intellectual property</h2>\r\n        <ol>\r\n            <li>You acknowledge that all copyright, trade marks, and other intellectual property rights in and relating to our Game (other than Content which is contributed and owned by players) is owned by or licensed to us.</li>\r\n            <li>Whilst you are in compliance with these terms, we grant you a personal, non-exclusive, non-transferable, revocable limited license to access and use our Game (but not the related object and source code) for your own personal private use, in each case provided that such use is in accordance with these terms. You agree not to use our Game for anything else.</li>\r\n            <li>You must not distribute, copy, make available to the public or create any derivative work from our Game or any part of our Game unless we have first agreed to this in writing.</li>\r\n            <li>In particular, and without limiting the application of paragraph 9.3, you must not make available any cheats or technological measures designed to control access to, or elements of, our Game, including providing access to any Virtual Currency, whether on a free of charge basis or otherwise.</li>\r\n            <li>\r\n                By submitting Content (as defined in paragraph 5.3) via our Game you:\r\n                <ul>\r\n                    <li>are representing that you are fully entitled to do so;</li>\r\n                    <li>grant us and our group companies the right to edit, adapt, publish and use your entry and any derivative works we may create from it, in any and all media (whether it exists now or in the future), for any purpose, in perpetuity, without any payment to you;</li>\r\n                    <li>acknowledge that you may have what are known as moral rights in the Content, for example the right to be named as the creator of your entry and the right not to have work subjected to derogatory treatment. You agree to waive any such moral rights you may have in the Content;</li>\r\n                    <li>agree that we have no obligation to monitor or protect your rights in any Content that you may submit to us, but you do give us the right to enforce your rights in that Content if we want to, including but not limited to taking legal action (at our cost) on your behalf.</li>\r\n                    </l>\r\n            </li>\r\n            <li>You must not distribute, copy, make available to the public or create any derivative work from any Content belonging to any other user of our Game.</li>\r\n        </ol>\r\n\r\n        <h2>Transferring these terms</h2>\r\n        <ol>\r\n            <li>We may wish to transfer all or a part of our rights or responsibilities under these terms to someone else without obtaining your consent. You agree that we may do so provided that the transfer does not significantly disadvantage you. You may not transfer any of the rights we give you under these terms unless we first agree to this in writing.</li>\r\n        </ol>\r\n\r\n        <h2>Entire agreement</h2>\r\n        <ol>\r\n            <li>These terms set out the entire agreement between you and us concerning our Game (as defined in paragraph 1) and they replace all earlier agreements and understandings between you and us. If you also access or play our Game via other platforms (for example, by downloading our Game to play via the App Store, Google Play or by accessing our Game via any other third party website or service, including, without limitation, Facebook) then different terms and conditions may apply in respect of those Games.</li>\r\n        </ol>\r\n\r\n        <h2>Severability</h2>\r\n        <ol>\r\n            <li>If any part of these terms is held to be invalid or unenforceable under any applicable local laws or by an applicable court, that part shall be interpreted in a manner consistent with applicable law to reflect as nearly as possible our original intentions and the remainder of these terms shall remain valid and enforceable.</li>\r\n        </ol>\r\n\r\n        <h2>Changes to these terms</h2>\r\n        <ol>\r\n            <li>We reserve the right to update these terms from time to time by posting the updated version on our Website. We may do so because we change the nature of our products or services, for technical or legal reasons, or because the needs of our business have changed. You agree that if you do not accept any amendment to our terms then you shall immediately stop accessing and/or using our Game.</li>\r\n        </ol>\r\n\r\n        <h2>Waivers of our rights</h2>\r\n        <ol>\r\n            <li>Our failure to exercise or enforce any of our rights under these terms does not waive our right to enforce such right. Any waiver of such rights shall only be effective if it is in writing and signed by us.</li>\r\n        </ol>\r\n\r\n        <h2>Complaints and dispute resolution</h2>\r\n        <ol>\r\n            <li>Most concerns can be solved quickly by contacting us at <a href="mailto:support@ozmagames.com">support@ozmagames.com</a>. In the unlikely event that we cannot solve your concern and you wish to bring legal action against us these terms shall be governed by and construed in accordance with the laws of Sweden.</li>\r\n        </ol>\r\n\r\n        <h2>Questions about these terms</h2>\r\n        <ol>\r\n            <li>If you have any questions about these terms or our Game you may contact us by email at <a href="mailto:support@ozmagames.com">support@ozmagames.com</a>.</li>\r\n            <li>These terms were last updated on 1 August 2014.</li>\r\n        </ol>\r\n    </article>\r\n\r\n</body>\r\n</html>'
}),n("text!widgets/list/view.html",[],function(){return'<ul class="custom-list centered" data-bind="css: { draggable: settings.draggable, noHover: settings.noHover }">\r\n   <!-- ko foreach: settings.splitters -->\r\n   <li class="splitter" data-bind="css: {fixed: fixed}">\r\n      <div class="container">\r\n         <hr /><div class="text curly" data-bind="text: text"></div><hr />\r\n      </div>      \r\n   </li>\r\n   <!-- /ko -->\r\n   <!-- ko foreach: {data: settings.items, afterRender: afterRenderItem}-->\r\n   <li>\r\n      <div data-part="item" data-bind="text: $data"></div>\r\n   </li>\r\n   <!-- /ko -->\r\n</ul>\r\n'}),n("text!widgets/poem/view.html",[],function(){return'<div class="slider">\r\n   <div data-bind="tile: {tile: tile()}" style="height: 422px" class="poem-mask">\r\n      <div data-part="text">\r\n         <div class="confiner">\r\n            <div class="poem-container" data-bind="css: $root.settings.lightColor() ? (\'light shade-\' + $root.settings.shade.value() ): (\'dark shade-\'+  $root.settings.shade.value())">\r\n               <div class="row" data-bind="css: {none: $root.title() == \'\' }"></div>\r\n               <div class="row" data-bind="css: {none: $root.title() == \'\' }">\r\n                  <h1 data-bind="text: $root.title, resizeText: {maxWidth: 220, size: {max: 1.5, min: 1.05 } }"></h1>\r\n               </div>\r\n               <div class="poem" data-bind="style: {fontSize: $root.settings.size.value() + \'px\'}">\r\n                  <!--ko foreach: $root.phrases -->\r\n                  <div class="phrase" data-bind="text: phrase"></div>\r\n                  <!-- /ko -->\r\n               </div>\r\n            </div>\r\n         </div>\r\n      </div>\r\n   </div>\r\n</div>'}),n("text!widgets/slider/view.html",[],function(){return'<div class="slider-container">\r\n   <div class="controls">\r\n      <div class="left" data-bind="visible: canLeft(), click: goLeft"></div>\r\n      <div class="right" data-bind="visible: canRight(), click: goRight"></div>\r\n   </div>\r\n   <div class="slider">\r\n      <ul data-bind="foreach: {data: settings.items, afterRender: afterRenderItem}, style: {width: !flex ? settings.items().length * 100 + \'%\': \'\' }">\r\n         <li data-bind="style: {width: !$parent.flex ? 100 / $parent.settings.items().length + \'%\': \'\' }">\r\n            <div data-part="item" data-bind="text: $data"></div>\r\n         </li>\r\n      </ul>\r\n   </div>\r\n</div>\r\n'}),n("text!widgets/tile/view.html",[],function(){return"<div class=\"tile active\">\r\n   <div class=\"tile-circle\" data-bind=\"css: settings.tile.imageName? '': 'empty'\">\r\n      <div data-part=\"text\"></div>\r\n      <div data-bind=\"if: 'imageName' in settings.tile, css: settings.tile.imageName? 'mask': ''\">\r\n         <div class=\"big\" data-bind=\"style: { backgroundImage: 'url(\\'' + settings.tile.imageName + '\\')' }\"></div>\r\n      </div>\r\n   </div>\r\n</div>"}),n("text!widgets/xp/view.html",[],function(){return'<div class="xp-circle">\r\n   <!-- ko foreach: sectors -->\r\n   <div class="sector" data-bind="style:{\'-webkit-transform\': \'rotate(\' + 13.84 * index + \'deg)\'}"><div class="circle" data-bind="css: {active: active}"></div></div>\r\n   <!-- /ko -->\r\n   <div class="text" data-bind="text: settings.value"></div>\r\n</div>'}),t(["main"])}();//# sourceMappingURL=main.js.map