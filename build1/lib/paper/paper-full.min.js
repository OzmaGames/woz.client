var paper=new function(){var n=new function(){function t(n,t,i,f,e,o){function l(f,o,s,l){var o=o||(o=r(t,f))&&(o.get?o:o.value);typeof o=="string"&&o[0]==="#"&&(o=n[o.substring(1)]||o);var v=typeof o=="function",a=o,p=e||v?o&&o.get?f in n:n[f]:null,y;!(s||o!==undefined&&t.hasOwnProperty(f))||e&&p||(v&&p&&(o.base=p),v&&h&&o.length===0&&(y=f.match(/^(get|is)(([A-Z])(.*))$/))&&h.push([y[3].toLowerCase()+y[4],y[2]]),a&&!v&&a.get||(a={value:a,writable:!0}),(r(n,f)||{configurable:!0}).configurable&&(a.configurable=!0,a.enumerable=i),u(n,f,a)),l&&v&&(!e||!l[f])&&(l[f]=function(t){return t&&n[f].apply(t,c.call(arguments,1))})}var h,a,v,w,p,y;if(t){h=[];for(a in t)t.hasOwnProperty(a)&&!s.test(a)&&l(a,null,!0,o);for(l("toString"),l("valueOf"),v=0,w=h&&h.length;v<w;v++)try{p=h[v],y=p[1],l(p[0],{get:n["get"+y]||n["is"+y],set:n["set"+y]},!0)}catch(b){}}return n}function f(t,i,r,u){try{t&&(u||typeof u=="undefined"&&v(t)?l:a).call(t,i,r=r||t)}catch(f){if(f!==n.stop)throw f;}return r}function o(n){return f(n,function(n,t){this[t]=n},new n.constructor)}var s=/^(statics|generics|preserve|enumerable|prototype|toString|valueOf)$/,h=Object.prototype.toString,e=Array.prototype,c=e.slice,l=e.forEach||function(n,t){for(var i=0,r=this.length;i<r;i++)n.call(t,this[i],i,this)},a=function(n,t){for(var i in this)this.hasOwnProperty(i)&&n.call(t,this[i],i,this)},v=Array.isArray=Array.isArray||function(n){return h.call(n)==="[object Array]"},i=Object.create||function(n){return{__proto__:n}},r=Object.getOwnPropertyDescriptor||function(n,t){var i=n.__lookupGetter__&&n.__lookupGetter__(t);return i?{get:i,set:n.__lookupSetter__(t),enumerable:!0,configurable:!0}:n.hasOwnProperty(t)?{value:n[t],enumerable:!0,configurable:!0,writable:!0}:null},y=Object.defineProperty||function(n,t,i){return(i.get||i.set)&&n.__defineGetter__?(i.get&&n.__defineGetter__(t,i.get),i.set&&n.__defineSetter__(t,i.set)):n[t]=i.value,n},u=function(n,t,i){return delete n[t],y(n,t,i)};return t(function(){},{inject:function(n){var i,e;if(n){var u=this.prototype,r=Object.getPrototypeOf(u).constructor,f=n.statics===!0?n:n.statics;f!=n&&t(u,n,n.enumerable,r&&r.prototype,n.preserve,n.generics&&this),t(this,f,!0,r,n.preserve)}for(i=1,e=arguments.length;i<e;i++)this.inject(arguments[i]);return this},extend:function(){for(var e=this,n,r=0,f=arguments.length;r<f;r++)if(n=arguments[r].initialize)break;return n=n||function(){e.apply(this,arguments)},n.prototype=i(this.prototype),u(n.prototype,"constructor",{value:n,writable:!0,configurable:!0}),t(n,this,!0),arguments.length?this.inject.apply(n,arguments):n}},!0).inject({inject:function(){for(var n=0,i=arguments.length;n<i;n++)t(this,arguments[n],arguments[n].enumerable);return this},extend:function(){var n=i(this);return n.inject.apply(n,arguments)},each:function(n,t){return f(this,n,t)},clone:function(){return o(this)},statics:{each:f,clone:o,define:u,describe:r,create:function(n){return i(n.prototype)},isPlainObject:function(t){var i=t!=null&&t.constructor;return i&&(i===Object||i===n||i.name==="Object")},check:function(n){return!!(n||n===0)},pick:function(){for(var n=0,t=arguments.length;n<t;n++)if(arguments[n]!==undefined)return arguments[n];return null},stop:{}}})};typeof module!="undefined"&&(module.exports=n),n.inject({generics:!0,clone:function(){return new this.constructor(this)},toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+n.each(this,function(n,t){if(!/^_/.test(t)){var i=typeof n;this.push(t+": "+(i==="number"?w.instance.number(n):i==="string"?"'"+n+"'":n))}},[]).join(", ")+" }"},exportJSON:function(t){return n.exportJSON(this,t)},toJSON:function(){return n.serialize(this)},_set:function(t,i){if(t&&n.isPlainObject(t)){for(var r in t)t.hasOwnProperty(r)&&r in this&&(!i||!i[r])&&(this[r]=t[r]);return!0}},statics:{exports:{},extend:function dt(){var t=dt.base.apply(this,arguments),i=t.prototype._class;return i&&!n.exports[i]&&(n.exports[i]=t),t},equals:function(t,i){function u(n,t){for(var i in n)if(n.hasOwnProperty(i)&&typeof t[i]=="undefined")return!1;return!0}var f,r;if(t===i)return!0;if(t&&t.equals)return t.equals(i);if(i&&i.equals)return i.equals(t);if(Array.isArray(t)&&Array.isArray(i)){if(t.length!==i.length)return!1;for(r=0,f=t.length;r<f;r++)if(!n.equals(t[r],i[r]))return!1;return!0}if(t&&typeof t=="object"&&i&&typeof i=="object"){if(!u(t,i)||!u(i,t))return!1;for(r in t)if(t.hasOwnProperty(r)&&!n.equals(t[r],i[r]))return!1;return!0}return!1},read:function(t,i,r,u){var s,f;if(this===n)return s=this.peek(t,i),t._index++,t.__read=1,s;var h=this.prototype,o=h._readIndex,e=i||o&&t._index||0;return(r||(r=t.length-e),f=t[e],f instanceof this||u&&u.readNull&&f==null&&r<=1)?(o&&(t._index=e+1),f&&u&&u.clone?f.clone():f):(f=n.create(this),o&&(f.__read=!0),u&&(f.__options=u),f=f.initialize.apply(f,e>0||r<t.length?Array.prototype.slice.call(t,e,e+r):t)||f,o&&(t._index=e+f.__read,t.__read=f.__read,delete f.__read,u&&delete f.__options),f)},peek:function(n,t){return n[n._index=t||n._index||0]},readAll:function(n,t,i){for(var u=[],f,r=t||0,e=n.length;r<e;r++)u.push(Array.isArray(f=n[r])?this.read(f,0,0,i):this.read(n,r,1,i));return u},readNamed:function(n,t,i,r,u){var f=this.getNamed(n,t);return this.read(f!=null?[f]:n,i,r,u)},getNamed:function(t,i){var r=t[0];return t._hasObject===undefined&&(t._hasObject=t.length===1&&n.isPlainObject(r)),t._hasObject?i?r[i]:r:void 0},hasNamed:function(n,t){return!!this.getNamed(n,t)},isPlainValue:function(n){return this.isPlainObject(n)||Array.isArray(n)},serialize:function(t,i,r,u){var s,f,o,h,e;if(i=i||{},s=!u,s&&(i.formatter=new w(i.precision),u={length:0,definitions:{},references:{},add:function(n,t){var i="#"+n._id,f=this.references[i],r,u;return f||(this.length++,r=t.call(n),u=n._class,u&&r[0]!==u&&r.unshift(u),this.definitions[i]=r,f=this.references[i]=[i]),f}}),t&&t._serialize)f=t._serialize(i,u),o=t._class,!o||r||f._compact||f[0]===o||f.unshift(o);else if(Array.isArray(t)){for(f=[],e=0,h=t.length;e<h;e++)f[e]=n.serialize(t[e],i,r,u);r&&(f._compact=!0)}else if(n.isPlainObject(t)){f={};for(e in t)t.hasOwnProperty(e)&&(f[e]=n.serialize(t[e],i,r,u))}else f=typeof t=="number"?i.formatter.number(t,i.precision):t;return s&&u.length>0?[["dictionary",u.definitions],f]:f},deserialize:function(t,i){var u=t,r,e,f,s,h,o;if(i=i||{},Array.isArray(t)){if(r=t[0],e=r==="dictionary",!e){if(i.dictionary&&t.length==1&&/^#/.test(r))return i.dictionary[r];r=n.exports[r]}for(u=[],f=r?1:0,s=t.length;f<s;f++)u.push(n.deserialize(t[f],i));e?i.dictionary=u[0]:r&&(h=u,u=n.create(r),r.apply(u,h))}else if(n.isPlainObject(t)){u={};for(o in t)u[o]=n.deserialize(t[o],i)}return u},exportJSON:function(t,i){return JSON.stringify(n.serialize(t,i))},importJSON:function(t){return n.deserialize(typeof t=="string"?JSON.parse(t):t)},splice:function(n,t,i,r){var s=t&&t.length,h=i===undefined,e,o,u,f;for(i=h?n.length:i,i>n.length&&(i=n.length),u=0;u<s;u++)t[u]._index=i+u;if(h)return n.push.apply(n,t),[];for(e=[i,r],t&&e.push.apply(e,t),o=n.splice.apply(n,e),u=0,f=o.length;u<f;u++)delete o[u]._index;for(u=i+s,f=n.length;u<f;u++)n[u]._index=u;return o},merge:function(){return n.each(arguments,function(t){n.each(t,function(n,t){this[t]=n},this)},new n,!0)},capitalize:function(n){return n.replace(/\b[a-z]/g,function(n){return n.toUpperCase()})},camelize:function(n){return n.replace(/-(.)/g,function(n,t){return t.toUpperCase()})},hyphenate:function(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var ut={attach:function(t,i){var u,r;if(typeof t!="string"){n.each(t,function(n,t){this.attach(t,n)},this);return}u=this._eventTypes[t],u&&(r=this._handlers=this._handlers||{},r=r[t]=r[t]||[],r.indexOf(i)==-1&&(r.push(i),u.install&&r.length==1&&u.install.call(this,t)))},detach:function(t,i){if(typeof t!="string"){n.each(t,function(n,t){this.detach(t,n)},this);return}var u=this._eventTypes[t],r=this._handlers&&this._handlers[t],f;u&&r&&(i&&((f=r.indexOf(i))==-1||r.length!=1)?f!=-1&&r.splice(f,1):(u.uninstall&&u.uninstall.call(this,t),delete this._handlers[t]))},once:function(n,t){this.attach(n,function(){t.apply(this,arguments),this.detach(n,t)})},fire:function(t,i){var r=this._handlers&&this._handlers[t],u;return r?(u=[].slice.call(arguments,1),n.each(r,function(n){n.apply(this,u)===!1&&i&&i.stop&&i.stop()},this),!0):!1},responds:function(n){return!!(this._handlers&&this._handlers[n])},on:"#attach",off:"#detach",trigger:"#fire",statics:{inject:function si(){for(var t,r,u,i=0,f=arguments.length;i<f;i++)t=arguments[i],r=t._events,r&&(u={},n.each(r,function(i,r){var o=typeof i=="string",f=o?i:r,s=n.capitalize(f),e=f.substring(2).toLowerCase();u[e]=o?{}:i,f="_"+f,t["get"+s]=function(){return this[f]},t["set"+s]=function(n){n?this.attach(e,n):this[f]&&this.detach(e,this[f]),this[f]=n}}),t._eventTypes=u),si.base.call(this,t);return this}}},it=n.extend({_class:"PaperScope",initialize:function it(n){if(paper=this,this.project=null,this.projects=[],this.tools=[],this.palettes=[],this._id=n&&(n.getAttribute("id")||n.src)||"paperscope-"+it._id++,n&&n.setAttribute("id",this._id),it._scopes[this._id]=this,!this.support){var t=p.getContext(1,1);it.prototype.support={nativeDash:"setLineDash"in t||"mozDash"in t,nativeBlendModes:kt.nativeModes},p.release(t)}},version:"0.9.9",getView:function(){return this.project&&this.project.view},getTool:function(){return this._tool||(this._tool=new er),this._tool},evaluate:function(n){var t=paper.PaperScript.evaluate(n,this);return h.updateFocus(),t},install:function(t){var r=this,i;n.each(["project","view","tool"],function(i){n.define(t,i,{configurable:!0,get:function(){return r[i]}})});for(i in this)/^(version|_id)/.test(i)||i in t||(t[i]=this[i])},setup:function(n){return paper=this,this.project=new yt(n),this},activate:function(){paper=this},clear:function(){for(var n=this.projects.length-1;n>=0;n--)this.projects[n].remove();for(n=this.tools.length-1;n>=0;n--)this.tools[n].remove();for(n=this.palettes.length-1;n>=0;n--)this.palettes[n].remove()},remove:function(){this.clear(),delete it._scopes[this._id]},statics:new function(){function n(n){return n+="Attribute",function(t,i){return t[n](i)||t[n]("data-paper-"+i)}}return{_scopes:{},_id:0,get:function(n){return typeof n=="object"&&(n=n.getAttribute("id")),this._scopes[n]||null},getAttribute:n("get"),hasAttribute:n("has")}}}),ht=n.extend(ut,{initialize:function(n){this._scope=paper,this._index=this._scope[this._list].push(this)-1,(n||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var n=this._scope[this._reference];return n&&n!=this&&n.fire("deactivate"),this._scope[this._reference]=this,this.fire("activate",n),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(n.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)}}),w=n.extend({initialize:function(n){this.precision=n||5,this.multiplier=Math.pow(10,this.precision)},number:function(n){return Math.round(n*this.multiplier)/this.multiplier},point:function(n,t){return this.number(n.x)+(t||",")+this.number(n.y)},size:function(n,t){return this.number(n.width)+(t||",")+this.number(n.height)},rectangle:function(n,t){return this.point(n,t)+(t||",")+this.size(n,t)}});w.instance=new w(5);var s=new function(){var r=[[.57735026918962573],[0,.7745966692414834],[.33998104358485626,.86113631159405257],[0,.53846931010568311,.906179845938664],[.23861918608319691,.66120938646626448,.932469514203152],[0,.40584515137739718,.74153118559939446,.94910791234275849],[.18343464249564981,.525532409916329,.79666647741362673,.96028985649753618],[0,.32425342340380892,.61337143270059036,.83603110732663577,.96816023950762609],[.14887433898163122,.43339539412924721,.67940956829902444,.86506336668898454,.97390652851717174],[0,.26954315595234496,.51909612920681181,.73015200557404936,.88706259976809532,.978228658146057],[.12523340851146891,.36783149899818018,.58731795428661748,.76990267419430469,.90411725637047491,.98156063424671924],[0,.2304583159551348,.44849275103644687,.64234933944034023,.80157809073330988,.91759839922297792,.98418305471858814],[.10805494870734367,.31911236892788974,.5152486363581541,.68729290481168548,.827201315069765,.92843488366357352,.98628380869681231],[0,.20119409399743451,.39415134707756339,.57097217260853883,.72441773136017007,.84820658341042721,.937273392400706,.98799251802048538],[.095012509837637441,.28160355077925892,.45801677765722737,.61787624440264377,.755404408355003,.86563120238783176,.9445750230732326,.98940093499164994]],u=[[1],[.88888888888888884,.55555555555555558],[.65214515486254609,.34785484513745385],[.56888888888888889,.47862867049936647,.23692688505618909],[.46791393457269104,.36076157304813861,.17132449237917036],[.4179591836734694,.38183005050511892,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.33023935500125978,.31234707704000286,.26061069640293544,.1806481606948574,.081274388361574412],[.29552422471475287,.26926671930999635,.21908636251598204,.14945134915058059,.066671344308688138],[.27292508677790062,.26280454451024665,.23319376459199048,.18629021092773426,.12558036946490461,.055668567116173663],[.24914704581340277,.23349253653835481,.20316742672306593,.16007832854334622,.10693932599531843,.047175336386511828],[.2325515532308739,.22628318026289723,.20781604753688851,.17814598076194574,.13887351021978725,.092121499837728452,.040484004765315877],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.080158087159760208,.03511946033175186],[.20257824192556126,.19843148532711158,.18616100001556221,.16626920581699392,.13957067792615432,.10715922046717194,.070366047488108124,.030753241996117269],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.095158511682492786,.062253523938647894,.027152459411754096]],n=Math.abs,t=Math.sqrt,f=Math.pow,i=Math.cos,e=Math.PI;return{TOLERANCE:1e-5,EPSILON:1e-11,KAPPA:4*(t(2)-1)/3,isZero:function(t){return n(t)<=this.EPSILON},integrate:function(n,t,i,f){for(var a=r[f-2],c=u[f-2],o=.5*(i-t),s=o+t,e=0,v=f+1>>1,l=f&1?c[e++]*n(s):0,h;e<v;)h=o*a[e],l+=c[e++]*(n(s+h)+n(s-h));return o*l},findRoot:function(t,i,r,u,f,e,o){for(var c,l,s,h=0;h<e;h++){if(c=t(r),l=c/i(r),n(l)<o)return r;s=r-l,c>0?(f=r,r=s<=u?.5*(u+f):s):(u=r,r=s>=f?.5*(u+f):s)}},solveQuadratic:function(i,r,u,f){var s=this.EPSILON,e,o;return n(i)<s?n(r)>=s?(f[0]=-u/r,1):n(u)<s?-1:0:(e=r*r-4*i*u,e<0)?0:(e=t(e),i*=2,o=0,f[o++]=(-r-e)/i,e>0&&(f[o++]=(-r+e)/i),o)},solveCubic:function(r,u,o,h,c){var y=this.EPSILON,l,w,d;if(n(r)<y)return s.solveQuadratic(u,o,h,c);u/=r,o/=r,h/=r;var g=u*u,v=(g-3*o)/9,a=(2*g*u-9*u*o+27*h)/54,tt=v*v*v,p=a*a-tt;if(u/=3,n(p)<y)return n(a)<y?(c[0]=-u,1):(l=t(v),w=a>0?1:-1,c[0]=-w*2*l-u,c[1]=w*l-u,2);if(p<0){var l=t(v),b=Math.acos(a/(l*l*l))/3,k=-2*l,nt=2*e/3;return c[0]=k*i(b)-u,c[1]=k*i(b+nt)-u,c[2]=k*i(b-nt)-u,3}return d=(a>0?-1:1)*f(n(a)+t(p),1/3),c[0]=d+v/d-u,1}}},t=n.extend({_class:"Point",_readIndex:!0,initialize:function(n,t){var r=typeof n,i;r==="number"?(i=typeof t=="number",this.x=n,this.y=i?t:n,this.__read&&(this.__read=i?2:1)):r==="undefined"||n===null?(this.x=this.y=0,this.__read&&(this.__read=n===null?1:0)):(Array.isArray(n)?(this.x=n[0],this.y=n.length>1?n[1]:n[0]):n.x!=null?(this.x=n.x,this.y=n.y):n.width!=null?(this.x=n.width,this.y=n.height):n.angle!=null?(this.x=n.length,this.y=0,this.setAngle(n.angle)):(this.x=this.y=0,this.__read&&(this.__read=0)),this.__read&&(this.__read=1))},set:function(n,t){return this.x=n,this.y=t,this},equals:function(n){return n===this||n&&(this.x===n.x&&this.y===n.y||Array.isArray(n)&&this.x===n[0]&&this.y===n[1])||!1},clone:function(){return new t(this.x,this.y)},toString:function(){var n=w.instance;return"{ x: "+n.number(this.x)+", y: "+n.number(this.y)+" }"},_serialize:function(n){var t=n.formatter;return[t.number(this.x),t.number(this.y)]},add:function(n){return n=t.read(arguments),new t(this.x+n.x,this.y+n.y)},subtract:function(n){return n=t.read(arguments),new t(this.x-n.x,this.y-n.y)},multiply:function(n){return n=t.read(arguments),new t(this.x*n.x,this.y*n.y)},divide:function(n){return n=t.read(arguments),new t(this.x/n.x,this.y/n.y)},modulo:function(n){return n=t.read(arguments),new t(this.x%n.x,this.y%n.y)},negate:function(){return new t(-this.x,-this.y)},transform:function(n){return n?n._transformPoint(this):this},getDistance:function(n,i){n=t.read(arguments);var r=n.x-this.x,u=n.y-this.y,f=r*r+u*u;return i?f:Math.sqrt(f)},getLength:function(){var n=this.x*this.x+this.y*this.y;return arguments.length&&arguments[0]?n:Math.sqrt(n)},setLength:function(n){var i,t;return this.isZero()?(i=this._angle||0,this.set(Math.cos(i)*n,Math.sin(i)*n)):(t=n/this.getLength(),s.isZero(t)&&this.getAngle(),this.set(this.x*t,this.y*t)),this},normalize:function(n){n===undefined&&(n=1);var i=this.getLength(),r=i!==0?n/i:0,u=new t(this.x*r,this.y*r);return u._angle=this._angle,u},getAngle:function(){return this.getAngleInRadians(arguments[0])*180/Math.PI},setAngle:function(n){if(n=this._angle=n*Math.PI/180,!this.isZero()){var t=this.getLength();this.set(Math.cos(n)*t,Math.sin(n)*t)}return this},getAngleInRadians:function(){if(arguments[0]===undefined)return this._angle==null&&(this._angle=Math.atan2(this.y,this.x)),this._angle;var n=t.read(arguments),i=this.getLength()*n.getLength();return s.isZero(i)?NaN:Math.acos(this.dot(n)/i)},getAngleInDegrees:function(){return this.getAngle(arguments[0])},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3},getDirectedAngle:function(n){return n=t.read(arguments),Math.atan2(this.cross(n),this.dot(n))*180/Math.PI},rotate:function(n,i){if(n===0)return this.clone();n=n*Math.PI/180;var r=i?this.subtract(i):this,u=Math.sin(n),f=Math.cos(n);return r=new t(r.x*f-r.y*u,r.y*f+r.x*u),i?r.add(i):r},isInside:function(n){return n.contains(this)},isClose:function(n,t){return this.getDistance(n)<t},isColinear:function(n){return this.cross(n)<1e-5},isOrthogonal:function(n){return this.dot(n)<1e-5},isZero:function(){return s.isZero(this.x)&&s.isZero(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},dot:function(n){return n=t.read(arguments),this.x*n.x+this.y*n.y},cross:function(n){return n=t.read(arguments),this.x*n.y-this.y*n.x},project:function(n){if(n=t.read(arguments),n.isZero())return new t(0,0);var i=this.dot(n)/n.dot(n);return new t(n.x*i,n.y*i)},statics:{min:function(){var n=t.read(arguments);return point2=t.read(arguments),new t(Math.min(n.x,point2.x),Math.min(n.y,point2.y))},max:function(){var n=t.read(arguments);return point2=t.read(arguments),new t(Math.max(n.x,point2.x),Math.max(n.y,point2.y))},random:function(){return new t(Math.random(),Math.random())}}},n.each(["round","ceil","floor","abs"],function(n){var i=Math[n];this[n]=function(){return new t(i(this.x),i(this.y))}},{})),ft=t.extend({initialize:function(n,t,i,r){this._x=n,this._y=t,this._owner=i,this._setter=r},set:function(n,t,i){return this._x=n,this._y=t,i||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(n){this._x=n,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(n){this._y=n,this._owner[this._setter](this)}}),e=n.extend({_class:"Size",_readIndex:!0,initialize:function(n,t){var r=typeof n,i;r==="number"?(i=typeof t=="number",this.width=n,this.height=i?t:n,this.__read&&(this.__read=i?2:1)):r==="undefined"||n===null?(this.width=this.height=0,this.__read&&(this.__read=n===null?1:0)):(Array.isArray(n)?(this.width=n[0],this.height=n.length>1?n[1]:n[0]):n.width!=null?(this.width=n.width,this.height=n.height):n.x!=null?(this.width=n.x,this.height=n.y):(this.width=this.height=0,this.__read&&(this.__read=0)),this.__read&&(this.__read=1))},set:function(n,t){return this.width=n,this.height=t,this},equals:function(n){return n===this||n&&(this.width===n.width&&this.height===n.height||Array.isArray(n)&&this.width===n[0]&&this.height===n[1])||!1},clone:function(){return new e(this.width,this.height)},toString:function(){var n=w.instance;return"{ width: "+n.number(this.width)+", height: "+n.number(this.height)+" }"},_serialize:function(n){var t=n.formatter;return[t.number(this.width),t.number(this.height)]},add:function(n){return n=e.read(arguments),new e(this.width+n.width,this.height+n.height)},subtract:function(n){return n=e.read(arguments),new e(this.width-n.width,this.height-n.height)},multiply:function(n){return n=e.read(arguments),new e(this.width*n.width,this.height*n.height)},divide:function(n){return n=e.read(arguments),new e(this.width/n.width,this.height/n.height)},modulo:function(n){return n=e.read(arguments),new e(this.width%n.width,this.height%n.height)},negate:function(){return new e(-this.width,-this.height)},isZero:function(){return s.isZero(this.width)&&s.isZero(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(n,t){return new e(Math.min(n.width,t.width),Math.min(n.height,t.height))},max:function(n,t){return new e(Math.max(n.width,t.width),Math.max(n.height,t.height))},random:function(){return new e(Math.random(),Math.random())}}},n.each(["round","ceil","floor","abs"],function(n){var t=Math[n];this[n]=function(){return new e(t(this.width),t(this.height))}},{})),ct=e.extend({initialize:function(n,t,i,r){this._width=n,this._height=t,this._owner=i,this._setter=r},set:function(n,t,i){return this._width=n,this._height=t,i||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(n){this._width=n,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(n){this._height=n,this._owner[this._setter](this)}}),f=n.extend({_class:"Rectangle",_readIndex:!0,initialize:function(i,r,u,f){var a=typeof i,o=0,s,c,h,l;a==="number"?(this.x=i,this.y=r,this.width=u,this.height=f,o=4):a==="undefined"||i===null?(this.x=this.y=this.width=this.height=0,o=i===null?1:0):arguments.length===1&&(Array.isArray(i)?(this.x=i[0],this.y=i[1],this.width=i[2],this.height=i[3],o=1):i.x!==undefined||i.width!==undefined?(this.x=i.x||0,this.y=i.y||0,this.width=i.width||0,this.height=i.height||0,o=1):i.from===undefined&&i.to===undefined&&(this.x=this.y=this.width=this.height=0,this._set(i),o=1)),o||(s=t.readNamed(arguments,"from"),c=n.peek(arguments),this.x=s.x,this.y=s.y,c&&c.x!==undefined||n.hasNamed(arguments,"to")?(h=t.readNamed(arguments,"to"),this.width=h.x-s.x,this.height=h.y-s.y,this.width<0&&(this.x=h.x,this.width=-this.width),this.height<0&&(this.y=h.y,this.height=-this.height)):(l=e.read(arguments),this.width=l.width,this.height=l.height),o=arguments._index),this.__read&&(this.__read=o)},set:function(n,t,i,r){return this.x=n,this.y=t,this.width=i,this.height=r,this},clone:function(){return new f(this.x,this.y,this.width,this.height)},equals:function(t){return n.isPlainValue(t)&&(t=f.read(arguments)),t===this||t&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height||!1},toString:function(){var n=w.instance;return"{ x: "+n.number(this.x)+", y: "+n.number(this.y)+", width: "+n.number(this.width)+", height: "+n.number(this.height)+" }"},_serialize:function(n){var t=n.formatter;return[t.number(this.x),t.number(this.y),t.number(this.width),t.number(this.height)]},getPoint:function(){return new(arguments[0]?t:ft)(this.x,this.y,this,"setPoint")},setPoint:function(n){n=t.read(arguments),this.x=n.x,this.y=n.y},getSize:function(){return new(arguments[0]?e:ct)(this.width,this.height,this,"setSize")},setSize:function(n){n=e.read(arguments),this._fixX&&(this.x+=(this.width-n.width)*this._fixX),this._fixY&&(this.y+=(this.height-n.height)*this._fixY),this.width=n.width,this.height=n.height,this._fixW=1,this._fixH=1},getLeft:function(){return this.x},setLeft:function(n){this._fixW||(this.width-=n-this.x),this.x=n,this._fixX=0},getTop:function(){return this.y},setTop:function(n){this._fixH||(this.height-=n-this.y),this.y=n,this._fixY=0},getRight:function(){return this.x+this.width},setRight:function(n){this._fixX!==undefined&&this._fixX!==1&&(this._fixW=0),this._fixW?this.x=n-this.width:this.width=n-this.x,this._fixX=1},getBottom:function(){return this.y+this.height},setBottom:function(n){this._fixY!==undefined&&this._fixY!==1&&(this._fixH=0),this._fixH?this.y=n-this.height:this.height=n-this.y,this._fixY=1},getCenterX:function(){return this.x+this.width*.5},setCenterX:function(n){this.x=n-this.width*.5,this._fixX=.5},getCenterY:function(){return this.y+this.height*.5},setCenterY:function(n){this.y=n-this.height*.5,this._fixY=.5},getCenter:function(){return new(arguments[0]?t:ft)(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(n){return n=t.read(arguments),this.setCenterX(n.x),this.setCenterY(n.y),this},isEmpty:function(){return this.width==0||this.height==0},contains:function(n){return n&&n.width!==undefined||(Array.isArray(n)?n:arguments).length==4?this._containsRectangle(f.read(arguments)):this._containsPoint(t.read(arguments))},_containsPoint:function(n){var t=n.x,i=n.y;return t>=this.x&&i>=this.y&&t<=this.x+this.width&&i<=this.y+this.height},_containsRectangle:function(n){var t=n.x,i=n.y;return t>=this.x&&i>=this.y&&t+n.width<=this.x+this.width&&i+n.height<=this.y+this.height},intersects:function(n){return n=f.read(arguments),n.x+n.width>this.x&&n.y+n.height>this.y&&n.x<this.x+this.width&&n.y<this.y+this.height},touches:function(n){return n=f.read(arguments),n.x+n.width>=this.x&&n.y+n.height>=this.y&&n.x<=this.x+this.width&&n.y<=this.y+this.height},intersect:function(n){n=f.read(arguments);var t=Math.max(this.x,n.x),i=Math.max(this.y,n.y),r=Math.min(this.x+this.width,n.x+n.width),u=Math.min(this.y+this.height,n.y+n.height);return new f(t,i,r-t,u-i)},unite:function(n){n=f.read(arguments);var t=Math.min(this.x,n.x),i=Math.min(this.y,n.y),r=Math.max(this.x+this.width,n.x+n.width),u=Math.max(this.y+this.height,n.y+n.height);return new f(t,i,r-t,u-i)},include:function(n){n=t.read(arguments);var i=Math.min(this.x,n.x),r=Math.min(this.y,n.y),u=Math.max(this.x+this.width,n.x),e=Math.max(this.y+this.height,n.y);return new f(i,r,u-i,e-r)},expand:function(n,t){return t===undefined&&(t=n),new f(this.x-n/2,this.y-t/2,this.width+n,this.height+t)},scale:function(n,t){return this.expand(this.width*n-this.width,this.height*(t===undefined?n:t)-this.height)}},new function(){return n.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(n,i){var r=n.join(""),u=/^[RL]/.test(r);i>=4&&(n[1]+=u?"Y":"X");var f=n[u?0:1],e=n[u?1:0],s="get"+f,h="get"+e,c="set"+f,l="set"+e,a="get"+r,o="set"+r;this[a]=function(){return new(arguments[0]?t:ft)(this[s](),this[h](),this,o)},this[o]=function(n){n=t.read(arguments),this[c](n.x),this[l](n.y)}},{})}),hi=f.extend({initialize:function(n,t,i,r,u,f){this.set(n,t,i,r,!0),this._owner=u,this._setter=f},set:function(n,t,i,r,u){return this._x=n,this._y=t,this._width=i,this._height=r,u||this._owner[this._setter](this),this}},new function(){var t=f.prototype;return n.each(["x","y","width","height"],function(t){var i=n.capitalize(t),r="_"+t;this["get"+i]=function(){return this[r]},this["set"+i]=function(n){this[r]=n,this._dontNotify||this._owner[this._setter](this)}},n.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(n){var i="set"+n;this[i]=function(){this._dontNotify=!0,t[i].apply(this,arguments),delete this._dontNotify,this._owner[this._setter](this)}},{isSelected:function(){return this._owner._boundsSelected},setSelected:function(n){var t=this._owner;t.setSelected&&(t._boundsSelected=n,t.setSelected(n||t._selectedSegmentState>0))}}))}),y=n.extend({_class:"Matrix",initialize:function y(n){var t=arguments.length,i=!0;if(t==6?this.set.apply(this,arguments):t==1?n instanceof y?this.set(n._a,n._c,n._b,n._d,n._tx,n._ty):Array.isArray(n)?this.set.apply(this,n):i=!1:t==0?this.reset():i=!1,!i)throw new Error("Unsupported matrix parameters");},set:function(n,t,i,r,u,f){return this._a=n,this._c=t,this._b=i,this._d=r,this._tx=u,this._ty=f,this},_serialize:function(t){return n.serialize(this.getValues(),t)},clone:function(){return new y(this._a,this._c,this._b,this._d,this._tx,this._ty)},equals:function(n){return n===this||n&&this._a==n._a&&this._b==n._b&&this._c==n._c&&this._d==n._d&&this._tx==n._tx&&this._ty==n._ty||!1},toString:function(){var n=w.instance;return"[["+[n.number(this._a),n.number(this._b),n.number(this._tx)].join(", ")+"], ["+[n.number(this._c),n.number(this._d),n.number(this._ty)].join(", ")+"]]"},reset:function(){return this._a=this._d=1,this._c=this._b=this._tx=this._ty=0,this},scale:function(){var n=t.read(arguments),i=t.read(arguments,0,0,{readNull:!0});return i&&this.translate(i),this._a*=n.x,this._c*=n.x,this._b*=n.y,this._d*=n.y,i&&this.translate(i.negate()),this},translate:function(n){n=t.read(arguments);var i=n.x,r=n.y;return this._tx+=i*this._a+r*this._b,this._ty+=i*this._c+r*this._d,this},rotate:function(n,i){i=t.read(arguments,1),n=n*Math.PI/180;var f=i.x,e=i.y,r=Math.cos(n),u=Math.sin(n),l=f-f*r+e*u,a=e-f*u-e*r,o=this._a,s=this._b,h=this._c,c=this._d;return this._a=r*o+u*s,this._b=-u*o+r*s,this._c=r*h+u*c,this._d=-u*h+r*c,this._tx+=l*o+a*s,this._ty+=l*h+a*c,this},shear:function(){var n=t.read(arguments),i=t.read(arguments,0,0,{readNull:!0}),r,u;return i&&this.translate(i),r=this._a,u=this._c,this._a+=n.y*this._b,this._c+=n.y*this._d,this._b+=n.x*r,this._d+=n.x*u,i&&this.translate(i.negate()),this},isIdentity:function(){return this._a==1&&this._c==0&&this._b==0&&this._d==1&&this._tx==0&&this._ty==0},isInvertible:function(){return!!this._getDeterminant()},isSingular:function(){return!this._getDeterminant()},concatenate:function(n){var t=this._a,i=this._b,r=this._c,u=this._d;return this._a=n._a*t+n._c*i,this._b=n._b*t+n._d*i,this._c=n._a*r+n._c*u,this._d=n._b*r+n._d*u,this._tx+=n._tx*t+n._ty*i,this._ty+=n._tx*r+n._ty*u,this},preConcatenate:function(n){var t=this._a,i=this._b,r=this._c,u=this._d,f=this._tx,e=this._ty;return this._a=n._a*t+n._b*r,this._b=n._a*i+n._b*u,this._c=n._c*t+n._d*r,this._d=n._c*i+n._d*u,this._tx=n._a*f+n._b*e+n._tx,this._ty=n._c*f+n._d*e+n._ty,this},transform:function(n,i,r,u,f){return arguments.length<5?this._transformPoint(t.read(arguments)):this._transformCoordinates(n,i,r,u,f)},_transformPoint:function(n,i,r){var u=n.x,f=n.y;return i||(i=new t),i.set(u*this._a+f*this._b+this._tx,u*this._c+f*this._d+this._ty,r)},_transformCoordinates:function(n,t,i,r,u){for(var f=t,s=r,h=t+2*u,e,o;f<h;)e=n[f++],o=n[f++],i[s++]=e*this._a+o*this._b+this._tx,i[s++]=e*this._c+o*this._d+this._ty;return i},_transformCorners:function(n){var t=n.x,i=n.y,r=t+n.width,u=i+n.height,f=[t,i,r,i,r,u,t,u];return this._transformCoordinates(f,0,f,0,4)},_transformBounds:function(n,t,i){for(var h=this._transformCorners(n),r=h.slice(0,2),s=h.slice(),e,o,u=2;u<8;u++)e=h[u],o=u&1,e<r[o]?r[o]=e:e>s[o]&&(s[o]=e);return t||(t=new f),t.set(r[0],r[1],s[0]-r[0],s[1]-r[1],i)},inverseTransform:function(){return this._inverseTransform(t.read(arguments))},_getDeterminant:function(){var n=this._a*this._d-this._b*this._c;return isFinite(n)&&!s.isZero(n)&&isFinite(this._tx)&&isFinite(this._ty)?n:null},_inverseTransform:function(n,i,r){var u=this._getDeterminant(),f,e;return u?(f=n.x-this._tx,e=n.y-this._ty,i||(i=new t),i.set((f*this._d-e*this._b)/u,(e*this._a-f*this._c)/u,r)):null},decompose:function(){var n=this._a,i=this._b,r=this._c,u=this._d,e,f,o;return s.isZero(n*u-i*r)?null:(e=Math.sqrt(n*n+i*i),n/=e,i/=e,f=n*r+i*u,r-=n*f,u-=i*f,o=Math.sqrt(r*r+u*u),r/=o,u/=o,f/=o,n*u<i*r&&(n=-n,i=-i,f=-f,e=-e),{translation:this.getTranslation(),scaling:new t(e,o),rotation:-Math.atan2(i,n)*180/Math.PI,shearing:f})},getValues:function(){return[this._a,this._c,this._b,this._d,this._tx,this._ty]},getTranslation:function(){return new t(this._tx,this._ty)},getScaling:function(){return(this.decompose()||{}).scaling},getRotation:function(){return(this.decompose()||{}).rotation},inverted:function(){var n=this._getDeterminant();return n&&new y(this._d/n,-this._c/n,-this._b/n,this._a/n,(this._b*this._ty-this._d*this._tx)/n,(this._c*this._tx-this._a*this._ty)/n)},shiftless:function(){return new y(this._a,this._c,this._b,this._d,0,0)},applyToContext:function(n){n.transform(this._a,this._c,this._b,this._d,this._tx,this._ty)}},new function(){return n.each({scaleX:"_a",scaleY:"_d",translateX:"_tx",translateY:"_ty",shearX:"_b",shearY:"_c"},function(t,i){i=n.capitalize(i),this["get"+i]=function(){return this[t]},this["set"+i]=function(n){this[t]=n}},{})}),b=n.extend({_class:"Line",initialize:function(n,t,i,r,u){var f=!1;arguments.length>=4?(this._px=n,this._py=t,this._vx=i,this._vy=r,f=u):(this._px=n.x,this._py=n.y,this._vx=t.x,this._vy=t.y,f=i),f||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new t(this._px,this._py)},getVector:function(){return new t(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(n,t){return b.intersect(this._px,this._py,this._vx,this._vy,n._px,n._py,n._vx,n._vy,!0,t)},getSide:function(n){return b.getSide(this._px,this._py,this._vx,this._vy,n.x,n.y,!0)},getDistance:function(n){return Math.abs(b.getSignedDistance(this._px,this._py,this._vx,this._vy,n.x,n.y,!0))},statics:{intersect:function(n,i,r,u,f,e,o,h,c,l){var a;if(c||(r-=n,u-=i,o-=f,h-=e),a=h*r-o*u,!s.isZero(a)){var y=n-f,p=i-e,v=(o*p-h*y)/a,w=(r*p-u*y)/a;if((l||0<=v&&v<=1)&&(l||0<=w&&w<=1))return new t(n+v*r,i+v*u)}},getSide:function(n,t,i,r,u,f,e){e||(i-=n,r-=t);var s=u-n,h=f-t,o=s*r-h*i;return o===0&&(o=s*i+h*r,o>0&&(s-=i,h-=r,o=s*i+h*r,o<0&&(o=0))),o<0?-1:o>0?1:0},getSignedDistance:function(n,t,i,r,u,f,e){e||(i-=n,r-=t);var o=r/i,s=t-o*n;return(f-o*u-s)/Math.sqrt(o*o+1)}}}),yt=ht.extend({_class:"Project",_list:"projects",_reference:"project",initialize:function(n){ht.call(this,!0),this.layers=[],this.symbols=[],this._currentStyle=new bt,this.activeLayer=new lt,n&&(this.view=n instanceof h?n:h.create(n)),this._selectedItems={},this._selectedItemCount=0,this._drawCount=0,this.options={}},_serialize:function(t,i){return n.serialize(this.layers,t,!0,i)},clear:function(){for(var n=this.layers.length-1;n>=0;n--)this.layers[n].remove();this.symbols=[]},remove:function ci(){return ci.base.call(this)?(this.view&&this.view.remove(),!0):!1},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(n){this._currentStyle.initialize(n)},getIndex:function(){return this._index},getSelectedItems:function(){var t=[],i,n;for(i in this._selectedItems)n=this._selectedItems[i],n._drawCount===this._drawCount&&t.push(n);return t},_updateSelection:function(n){n._selected?(this._selectedItemCount++,this._selectedItems[n._id]=n,n.isInserted()&&(n._drawCount=this._drawCount)):(this._selectedItemCount--,delete this._selectedItems[n._id])},selectAll:function(){for(var n=0,t=this.layers.length;n<t;n++)this.layers[n].setSelected(!0)},deselectAll:function(){for(var n in this._selectedItems)this._selectedItems[n].setSelected(!1)},hitTest:function(i,r){var u,f;for(i=t.read(arguments),r=d.getOptions(n.read(arguments)),u=this.layers.length-1;u>=0;u--)if(f=this.layers[u].hitTest(i,r),f)return f;return null},importJSON:function(t){return this.activate(),n.importJSON(t)},draw:function(i,r){var h,c,l,f,o,s,e,u;for(this._drawCount++,i.save(),r.applyToContext(i),h=n.merge({offset:new t(0,0),transforms:[r]}),u=0,c=this.layers.length;u<c;u++)this.layers[u].draw(i,h);if(i.restore(),this._selectedItemCount>0){i.save(),i.strokeWidth=1;for(l in this._selectedItems)if(f=this._selectedItems[l],f._drawCount===this._drawCount&&(f._drawSelected||f._boundsSelected)&&(o=f.getSelectedColor()||f.getLayer().getSelectedColor(),i.strokeStyle=i.fillStyle=o?o.toCanvasStyle(i):"#009dec",s=f._globalMatrix,f._drawSelected&&f._drawSelected(i,s),f._boundsSelected)){for(e=s._transformCorners(f._getBounds("getBounds")),i.beginPath(),u=0;u<8;u++)i[u===0?"moveTo":"lineTo"](e[u],e[++u]);for(i.closePath(),i.stroke(),u=0;u<8;u++)i.beginPath(),i.rect(e[u]-2,e[++u]-2,4,4),i.fill()}i.restore()}}}),nt=n.extend({_class:"Symbol",initialize:function nt(n,t){this._id=nt._id=(nt._id||0)+1,this.project=paper.project,this.project.symbols.push(this),n&&this.setDefinition(n,t),this._instances={}},_serialize:function(t,i){return i.add(this,function(){return n.serialize([this._class,this._definition],t,!1,i)})},_changed:function(t){n.each(this._instances,function(n){n._changed(t)})},getDefinition:function(){return this._definition},setDefinition:function(n){n._parentSymbol&&(n=n.clone()),this._definition&&delete this._definition._parentSymbol,this._definition=n,n.remove(),n.setSelected(!1),arguments[1]||n.setPosition(new t),n._parentSymbol=this,this._changed(5)},place:function(n){return new ti(this,n)},clone:function(){return new nt(this._definition.clone(!1))}}),k=n.extend(ut,{statics:{extend:function dt(t){t._serializeFields&&(t._serializeFields=n.merge(this.prototype._serializeFields,t._serializeFields));var i=dt.base.apply(this,arguments),r=i.prototype,u=r._class;return u&&(r._type=n.hyphenate(u)),i}},_class:"Item",_transformContent:!0,_boundsSelected:!1,_serializeFields:{name:null,matrix:new y,locked:!1,visible:!0,blendMode:"normal",opacity:1,guide:!1,clipMask:!1,data:{}},initialize:function(){},_initialize:function(n,t){if(this._id=k._id=(k._id||0)+1,!this._project){var i=paper.project,r=i.activeLayer;!r||n&&n.insert===!1?this._setProject(i):r.addChild(this)}return this._style=new bt(this._project._currentStyle,this),this._matrix=new y,t&&this._matrix.translate(t),n?this._set(n,{insert:!0}):!0},_events:new function(){var t={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}},i={install:function(n){var r=this._project.view._eventCounters,i;if(r)for(i in t)r[i]=(r[i]||0)+(t[i][n]||0)},uninstall:function(n){var r=this._project.view._eventCounters,i;if(r)for(i in t)r[i]-=t[i][n]||0}};return n.each(["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"],function(n){this[n]=i},{onFrame:{install:function(){this._project.view._animateItem(this,!0)},uninstall:function(){this._project.view._animateItem(this,!1)}},onLoad:{}})},_serialize:function(t,i){function u(u){var e,o;for(e in u)o=f[e],n.equals(o,u[e])||(r[e]=n.serialize(o,t,e!=="data",i))}var r={},f=this;return u(this._serializeFields),this instanceof g||u(this._style._defaults),[this._class,r]},_changed:function(n){var r=this._parent,t=this._project,u=this._parentSymbol,i;n&4&&(delete this._bounds,delete this._position),r&&n&12&&r._clearBoundsCache(),n&2&&this._clearBoundsCache(),t&&(n&1&&(t._needsRedraw=!0),t._changes&&(i=t._changesById[this._id],i?i.flags|=n:(i={item:this,flags:n},t._changesById[this._id]=i,t._changes.push(i)))),u&&u._changed(n)},set:function(n){return n&&this._set(n),this},getId:function(){return this._id},getType:function(){return this._type},getName:function(){return this._name},setName:function(n,t){if(this._name&&this._removeFromNamed(),n&&this._parent){for(var i=this._parent._children,r=this._parent._namedChildren,u=n,f=1;t&&i[n];)n=u+" "+f++;(r[n]=r[n]||[]).push(this),i[n]=this}this._name=n||undefined,this._changed(32)},getStyle:function(){return this._style},setStyle:function(n){this.getStyle().set(n)},hasFill:function(){return!!this.getStyle().getFillColor()},hasStroke:function(){var n=this.getStyle();return!!n.getStrokeColor()&&n.getStrokeWidth()>0}},n.each(["locked","visible","blendMode","opacity","guide"],function(t){var i=n.capitalize(t),t="_"+t;this["get"+i]=function(){return this[t]},this["set"+i]=function(n){n!=this[t]&&(this[t]=n,this._changed(t==="_locked"?32:33))}},{}),{_locked:!1,_visible:!0,_blendMode:"normal",_opacity:1,_guide:!1,isSelected:function(){if(this._children)for(var n=0,t=this._children.length;n<t;n++)if(this._children[n].isSelected())return!0;return this._selected},setSelected:function(n){if(this._children&&!arguments[1])for(var t=0,i=this._children.length;t<i;t++)this._children[t].setSelected(n);(n=!!n)!=this._selected&&(this._selected=n,this._project._updateSelection(this),this._changed(33))},_selected:!1,isFullySelected:function(){if(this._children&&this._selected){for(var n=0,t=this._children.length;n<t;n++)if(!this._children[n].isFullySelected())return!1;return!0}return this._selected},setFullySelected:function(n){if(this._children)for(var t=0,i=this._children.length;t<i;t++)this._children[t].setFullySelected(n);this.setSelected(n,!0)},isClipMask:function(){return this._clipMask},setClipMask:function(n){this._clipMask!=(n=!!n)&&(this._clipMask=n,n&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(33),this._parent&&this._parent._changed(256))},_clipMask:!1,getData:function(){return this._data||(this._data={}),this._data},setData:function(n){this._data=n},getPosition:function(){var n=this._position||(this._position=this.getBounds().getCenter(!0));return new(arguments[0]?t:ft)(n.x,n.y,this,"setPosition")},setPosition:function(){this.translate(t.read(arguments).subtract(this.getPosition(!0)))},getMatrix:function(){return this._matrix},setMatrix:function(n){this._matrix.initialize(n),this._changed(5)},isEmpty:function(){return this._children.length==0}},n.each(["getBounds","getStrokeBounds","getHandleBounds","getRoughBounds"],function(n){this[n]=function(){var i=this._boundsGetter,t=this._getCachedBounds(typeof i=="string"?i:i&&i[n]||n,arguments[0]);return n==="getBounds"?new hi(t.x,t.y,t.width,t.height,this,"setBounds"):t}},{_getCachedBounds:function(n,t,i){var r=(!t||t.equals(this._matrix))&&n,f,u,e,o;return(i&&this._parent&&(f=i._id,u=this._parent._boundsCache=this._parent._boundsCache||{ids:{},list:[]},u.ids[f]||(u.list.push(i),u.ids[f]=i)),r&&this._bounds&&this._bounds[r])?this._bounds[r].clone():(e=this._matrix.isIdentity(),t=!t||t.isIdentity()?e?null:this._matrix:e?t:t.clone().concatenate(this._matrix),o=this._getBounds(n,t,r?this:i),r&&(this._bounds||(this._bounds={}),this._bounds[r]=o.clone()),o)},_clearBoundsCache:function(){var n;if(this._boundsCache){for(var t=0,i=this._boundsCache.list,r=i.length;t<r;t++)n=i[t],delete n._bounds,n!=this&&n._boundsCache&&n._clearBoundsCache();delete this._boundsCache}},_getBounds:function(n,t,i){var e=this._children,h,a,c,u;if(!e||e.length==0)return new f;var r=Infinity,o=-r,s=r,l=o;for(h=0,a=e.length;h<a;h++)c=e[h],c._visible&&!c.isEmpty()&&(u=c._getCachedBounds(n,t,i),r=Math.min(u.x,r),s=Math.min(u.y,s),o=Math.max(u.x+u.width,o),l=Math.max(u.y+u.height,l));return isFinite(r)?new f(r,s,o-r,l-s):new f},setBounds:function(n){n=f.read(arguments);var t=this.getBounds(),i=new y,r=n.getCenter();i.translate(r),(n.width!=t.width||n.height!=t.height)&&i.scale(t.width!=0?n.width/t.width:1,t.height!=0?n.height/t.height:1),r=t.getCenter(),i.translate(-r.x,-r.y),this.transform(i)}}),{getProject:function(){return this._project},_setProject:function(n){if(this._project!=n&&(this._project=n,this._children))for(var t=0,i=this._children.length;t<i;t++)this._children[t]._setProject(n)},getLayer:function(){for(var n=this;n=n._parent;)if(n instanceof lt)return n;return null},getParent:function(){return this._parent},setParent:function(n){return n.addChild(this)},getChildren:function(){return this._children},setChildren:function(n){this.removeChildren(),this.addChildren(n)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){return this._parent&&this._parent._children[this._index+1]||null},getPreviousSibling:function(){return this._parent&&this._parent._children[this._index-1]||null},getIndex:function(){return this._index},isInserted:function(){return this._parent?this._parent.isInserted():!1},clone:function(n){return this._clone(new this.constructor({insert:!1}),n)},_clone:function(n,t){var f,i,r,u;if(n.setStyle(this._style),this._children)for(i=0,r=this._children.length;i<r;i++)n.addChild(this._children[i].clone(!1),!0);for((t||t===undefined)&&n.insertAbove(this),f=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],i=0,r=f.length;i<r;i++)u=f[i],this.hasOwnProperty(u)&&(n[u]=this[u]);return n._matrix.initialize(this._matrix),n.setSelected(this._selected),this._name&&n.setName(this._name,!0),n},copyTo:function(n){var t=this.clone();return n.layers?n.activeLayer.addChild(t):n.addChild(t),t},rasterize:function(t){var u=this.getStrokeBounds(),f=(t||72)/72,i=u.getTopLeft().floor(),o=u.getBottomRight().ceil(),r;return size=new e(o.subtract(i)),canvas=p.getCanvas(size),ctx=canvas.getContext("2d"),matrix=(new y).scale(f).translate(i.negate()),ctx.save(),matrix.applyToContext(ctx),this.draw(ctx,n.merge({transforms:[matrix]})),r=new et(canvas),r.setPosition(i.add(size.divide(2))),ctx.restore(),r},contains:function(){return!!this._contains(this._matrix._inverseTransform(t.read(arguments)))},_contains:function(n){if(this._children){for(var t=this._children.length-1;t>=0;t--)if(this._children[t].contains(n))return!0;return!1}return n.isInside(this._getBounds("getBounds"))},hitTest:function(i,r){function o(t,u){var f=s["get"+u]();if(i.getDistance(f)<r.tolerance)return new d(t,e,{name:n.hyphenate(u),point:f})}var e,u,s,h,f;if((i=t.read(arguments),r=d.getOptions(n.read(arguments)),this._locked||!this._visible||this._guide&&!r.guides)||!this._children&&!this.getRoughBounds().expand(r.tolerance)._containsPoint(i))return null;if(i=this._matrix._inverseTransform(i),e=this,(r.center||r.bounds)&&!(this instanceof lt&&!this._parent)&&(s=this._getBounds("getBounds"),r.center&&(u=o("center","Center")),!u&&r.bounds))for(h=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],f=0;f<8&&!u;f++)u=o("bounds",h[f]);return(u||(u=this._children||!(r.guides&&!this._guide||r.selected&&!this._selected)?this._hitTest(i,r):null))&&u.point&&(u.point=e._matrix.transform(u.point)),u},_hitTest:function(n,t){if(this._children){for(var i=this._children.length-1,r;i>=0;i--)if(r=this._children[i].hitTest(n,t))return r}else if(t.fill&&this.hasFill()&&this._contains(n))return new d("fill",this)},importJSON:function(t){return this.addChild(n.importJSON(t))},addChild:function(n,t){return this.insertChild(undefined,n,t)},insertChild:function(n,t,i){var r=this.insertChildren(n,[t],i);return r&&r[0]},addChildren:function(n,t){return this.insertChildren(this._children.length,n,t)},insertChildren:function(t,i,r,u){var o=this._children,f,s,e;if(o&&i&&i.length>0){for(i=Array.prototype.slice.apply(i),f=i.length-1;f>=0;f--)e=i[f],u&&e._type!==u?i.splice(f,1):e._remove(!0);for(n.splice(o,i,t,0),f=0,s=i.length;f<s;f++)e=i[f],e._parent=this,e._setProject(this._project),e._name&&e.setName(e._name);this._changed(7)}else i=null;return i},_insert:function(n,t,i){if(!t._parent)return null;var r=t._index+(n?1:0);return t._parent===this._parent&&r>this._index&&r--,t._parent.insertChild(r,this,i)},insertAbove:function(n,t){return this._insert(!0,n,t)},insertBelow:function(n,t){return this._insert(!1,n,t)},sendToBack:function(){return this._parent.insertChild(0,this)},bringToFront:function(){return this._parent.addChild(this)},appendTop:"#addChild",appendBottom:function(n){return this.insertChild(0,n)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",_removeFromNamed:function(){var i=this._parent._children,r=this._parent._namedChildren,t=this._name,n=r[t],u=n?n.indexOf(this):-1;u!=-1&&(i[t]==this&&delete i[t],n.splice(u,1),n.length?i[t]=n[n.length-1]:delete r[t])},_remove:function(t){return this._parent?(this._name&&this._removeFromNamed(),this._index!=null&&n.splice(this._parent._children,null,this._index,1),t&&this._parent._changed(7),this._parent=null,!0):!1},remove:function(){return this._remove(!0)},removeChildren:function(t,i){var r,u;if(!this._children)return null;for(t=t||0,i=n.pick(i,this._children.length),r=n.splice(this._children,null,t,i-t),u=r.length-1;u>=0;u--)r[u]._remove(!1);return r.length>0&&this._changed(7),r},reverseChildren:function(){if(this._children){this._children.reverse();for(var n=0,t=this._children.length;n<t;n++)this._children[n]._index=n;this._changed(7)}},isEditable:function(){for(var n=this;n;){if(!n._visible||n._locked)return!1;n=n._parent}return!0},_getOrder:function(n){function u(n){var t=[];do t.unshift(n);while(n=n._parent);return t}for(var i=u(this),r=u(n),t=0,f=Math.min(i.length,r.length);t<f;t++)if(i[t]!=r[t])return i[t]._index<r[t]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isAbove:function(n){return this._getOrder(n)===-1},isBelow:function(n){return this._getOrder(n)===1},isParent:function(n){return this._parent===n},isChild:function(n){return n&&n._parent===this},isDescendant:function(n){for(var t=this;t=t._parent;)if(t==n)return!0;return!1},isAncestor:function(n){return n?n.isDescendant(this):!1},isGroupedWith:function(n){for(var t=this._parent;t;){if(t._parent&&/^(group|layer|compound-path)$/.test(t._type)&&n.isDescendant(t))return!0;t=t._parent}return!1},scale:function(n,t,i){return(arguments.length<2||typeof t=="object")&&(i=t,t=n),this.transform((new y).scale(n,t,i||this.getPosition(!0)))},translate:function(){var n=new y;return this.transform(n.translate.apply(n,arguments))},rotate:function(n,t){return this.transform((new y).rotate(n,t||this.getPosition(!0)))},shear:function(n,t,i){return(arguments.length<2||typeof t=="object")&&(i=t,t=n),this.transform((new y).shear(n,t,i||this.getPosition(!0)))},transform:function(n){var i=this._bounds,u=this._position,f,r,t;if(this._matrix.preConcatenate(n),(this._transformContent||arguments[1])&&this.applyMatrix(!0),this._changed(5),i&&n.getRotation()%90==0){for(f in i)t=i[f],n._transformBounds(t,t);r=this._boundsGetter,t=i[r&&r.getBounds||r||"getBounds"],t&&(this._position=t.getCenter(!0)),this._bounds=i}else u&&(this._position=n._transformPoint(u,u));return this},_applyMatrix:function(n,t){var i=this._children,r,u;if(i&&i.length>0){for(r=0,u=i.length;r<u;r++)i[r].transform(n,t);return!0}},applyMatrix:function(n){var t=this._matrix;if(this._applyMatrix(t,!0)){var i=this._style,r=i.getFillColor(!0),u=i.getStrokeColor(!0);r&&r.transform(t),u&&u.transform(t),t.reset()}n||this._changed(5)},fitBounds:function(n,i){n=f.read(arguments);var r=this.getBounds(),u=r.height/r.width,o=n.height/n.width,s=(i?u>o:u<o)?n.width/r.width:n.height/r.height,h=new f(new t,new e(r.width*s,r.height*s));h.setCenter(n.getCenter()),this.setBounds(h)},_setStyles:function(n){var t=this._style,f=t.getStrokeWidth(),e=t.getStrokeJoin(),o=t.getStrokeCap(),s=t.getMiterLimit(),h=t.getFillColor(),c=t.getStrokeColor(),l=t.getShadowColor(),i,r,u;f!=null&&(n.lineWidth=f),e&&(n.lineJoin=e),o&&(n.lineCap=o),s&&(n.miterLimit=s),h&&(n.fillStyle=h.toCanvasStyle(n)),c&&(n.strokeStyle=c.toCanvasStyle(n),i=t.getDashArray(),r=t.getDashOffset(),paper.support.nativeDash&&i&&i.length&&("setLineDash"in n?(n.setLineDash(i),n.lineDashOffset=r):(n.mozDash=i,n.mozDashOffset=r))),l&&(n.shadowColor=l.toCanvasStyle(n),n.shadowBlur=t.getShadowBlur(),u=this.getShadowOffset(),n.shadowOffsetX=u.x,n.shadowOffsetY=u.y)},draw:function(n,t){var r;if(this._visible&&this._opacity!==0){this._drawCount=this._project._drawCount;var u=t.transforms,c=u[u.length-1],l=c.clone().concatenate(this._matrix);u.push(this._globalMatrix=l);var f=this._blendMode,o=this._opacity,a=f==="normal",v=kt.nativeModes[f],i=a&&o===1||(v||a&&o<1)&&this._canComposite(),y,s,h;if(!i){if(r=this.getStrokeBounds(c),!r.width||!r.height)return;h=t.offset,s=t.offset=r.getTopLeft().floor(),y=n,n=p.getContext(r.getSize().ceil().add(new e(1,1)))}n.save(),i?(n.globalAlpha=o,v&&(n.globalCompositeOperation=f)):n.translate(-s.x,-s.y),(i?this._matrix:l).applyToContext(n),!i&&t.clipItem&&t.clipItem.draw(n,t.extend({clip:!0})),this._draw(n,t),n.restore(),u.pop(),t.clip&&n.clip(),i||(kt.process(f,n,y,o,s.subtract(h)),p.release(n),t.offset=h)}},_canComposite:function(){return!1}},n.each(["down","drag","up","move"],function(t){this["removeOn"+n.capitalize(t)]=function(){var n={};return n[t]=!0,this.removeOn(n)}},{removeOn:function(n){var t;for(t in n)if(n[t]){var i="mouse"+t,u=this._project,r=u._removeSets=u._removeSets||{};r[i]=r[i]||{},r[i][this._id]=this}return this}})),g=k.extend({_class:"Group",_serializeFields:{children:[]},initialize:function(n){this._children=[],this._namedChildren={},this._initialize(n)||this.addChildren(Array.isArray(n)?n:arguments)},_changed:function gt(n){gt.base.call(this,n),n&2&&this._transformContent&&!this._matrix.isIdentity()&&this.applyMatrix(),n&258&&delete this._clipItem},_getClipItem:function(){var n,i,t;if(this._clipItem!==undefined)return this._clipItem;for(n=0,i=this._children.length;n<i;n++)if(t=this._children[n],t._clipMask)return this._clipItem=t;return this._clipItem=null},getTransformContent:function(){return this._transformContent},setTransformContent:function(n){this._transformContent=n,n&&this.applyMatrix()},isClipped:function(){return!!this._getClipItem()},setClipped:function(n){var t=this.getFirstChild();t&&t.setClipMask(n)},_draw:function(n,t){var r=t.clipItem=this._getClipItem(),i,f,u;for(r&&r.draw(n,t.extend({clip:!0})),i=0,f=this._children.length;i<f;i++)u=this._children[i],u!==r&&u.draw(n,t);t.clipItem=null}}),lt=g.extend({_class:"Layer",initialize:function(){this._project=paper.project,this._index=this._project.layers.push(this)-1,g.apply(this,arguments),this.activate()},_remove:function li(t){return this._parent?li.base.call(this,t):this._index!=null?(this._project.activeLayer===this&&(this._project.activeLayer=this.getNextSibling()||this.getPreviousSibling()),n.splice(this._project.layers,null,this._index,1),this._project._needsRedraw=!0,!0):!1},getNextSibling:function ai(){return this._parent?ai.base.call(this):this._project.layers[this._index+1]||null},getPreviousSibling:function vi(){return this._parent?vi.base.call(this):this._project.layers[this._index-1]||null},isInserted:function yi(){return this._parent?yi.base.call(this):this._index!=null},activate:function(){this._project.activeLayer=this},_insert:function pi(t,i,r){return i instanceof lt&&!i._parent&&this._remove(!0)?(n.splice(i._project.layers,[this],i._index+(t?1:0),0),this._setProject(i._project),this):pi.base.call(this,t,i,r)}}),wi=k.extend({_class:"Shape",_transformContent:!1,initialize:function(n,t,i,r){this._initialize(r,t),this._type=n,this._size=i},getSize:function(){var n=this._size;return new ct(n.width,n.height,this,"setSize")},setSize:function(){var n=e.read(arguments);this._size.equals(n)||(this._size.set(n.width,n.height),this._changed(5))},getRadius:function(){var n=this._size;return(n.width+n.height)/4},setRadius:function(n){var t=n*2;this.setSize(t,t)},_draw:function(n,t){var l=this._style,a=this._size,u=a.width,f=a.height,h=l.getFillColor(),c=l.getStrokeColor();if(h||c||t.clip){n.beginPath();switch(this._type){case"rect":n.rect(-u/2,-f/2,u,f);break;case"circle":n.arc(0,0,(u+f)/4,0,Math.PI*2,!0);break;case"ellipse":var i=u/2,r=f/2,v=s.KAPPA,e=i*v,o=r*v;n.moveTo(-i,0),n.bezierCurveTo(-i,-o,-e,-r,0,-r),n.bezierCurveTo(e,-r,i,-o,i,0),n.bezierCurveTo(i,o,e,r,0,r),n.bezierCurveTo(-e,r,-i,o,-i,0)}}!t.clip&&(h||c)&&(this._setStyles(n),h&&n.fill(),c&&n.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(n,t){var i=new f(this._size).setCenter(0,0);return n!=="getBounds"&&this.hasStroke()&&(i=i.expand(this.getStrokeWidth())),t?t._transformBounds(i):i},_contains:function bi(n){switch(this._type){case"rect":return bi.base.call(this,n);case"circle":case"ellipse":return n.divide(this._size).getLength()<=.5}},_hitTest:function ni(n){var i,t;if(this.hasStroke()){i=this._type,t=this.getStrokeWidth();switch(i){case"rect":var o=new f(this._size).setCenter(0,0),a=o.expand(t),v=o.expand(-t);if(a._containsPoint(n)&&!v._containsPoint(n))return new d("stroke",this);break;case"circle":case"ellipse":var s=this._size,r=s.width,u=s.height,e;if(i==="ellipse"){var h=n.getAngleInRadians(),c=r*Math.sin(h),l=u*Math.cos(h);e=r*u/(2*Math.sqrt(c*c+l*l))}else e=(r+u)/4;if(2*Math.abs(n.getLength()-e)<=t)return new d("stroke",this)}}return ni.base.apply(this,arguments)},statics:new function(){function i(t,i,r,u){return new wi(t,i,r,n.getNamed(u))}return{Circle:function(){var r=t.readNamed(arguments,"center"),u=n.readNamed(arguments,"radius");return i("circle",r,new e(u*2),arguments)},Rectangle:function(){var n=f.readNamed(arguments,"rectangle");return i("rect",n.getCenter(!0),n.getSize(!0),arguments)},Ellipse:function(){var n=f.readNamed(arguments,"rectangle");return i("ellipse",n.getCenter(!0),n.getSize(!0),arguments)}}}}),et=k.extend({_class:"Raster",_transformContent:!1,_boundsGetter:"getBounds",_boundsSelected:!0,_serializeFields:{source:null},initialize:function(n,i){this._initialize(n,i!==undefined&&t.read(arguments,1))||(n.getContext?this.setCanvas(n):typeof n=="string"?this.setSource(n):this.setImage(n)),this._size||(this._size=new e)},clone:function(n){var t={insert:!1},i=this._image,r;return i?t.image=i:this._canvas&&(r=t.canvas=p.getCanvas(this._size),r.getContext("2d").drawImage(this._canvas,0,0)),this._clone(new et(t),n)},getSize:function(){var n=this._size;return new ct(n.width,n.height,this,"setSize")},setSize:function(){var n=e.read(arguments),t;this._size.equals(n)||(t=this.getElement(),this.setCanvas(p.getCanvas(n)),t&&this.getContext(!0).drawImage(t,0,0,n.width,n.height))},getWidth:function(){return this._size.width},getHeight:function(){return this._size.height},isEmpty:function(){return this._size.width==0&&this._size.height==0},getPpi:function(){var n=this._matrix,i=new t(0,0).transform(n),r=new t(1,0).transform(n).subtract(i),u=new t(0,1).transform(n).subtract(i);return new e(72/r.getLength(),72/u.getLength())},getContext:function(){return this._context||(this._context=this.getCanvas().getContext("2d")),arguments[0]&&(this._image=null,this._changed(129)),this._context},setContext:function(n){this._context=n},getCanvas:function(){if(!this._canvas){var n=p.getContext(this._size);try{this._image&&n.drawImage(this._image,0,0),this._canvas=n.canvas}catch(t){p.release(n)}}return this._canvas},setCanvas:function(n){this._canvas&&p.release(this._canvas),this._canvas=n,this._size=new e(n.width,n.height),this._image=null,this._context=null,this._changed(133)},getImage:function(){return this._image},setImage:function(n){this._canvas&&p.release(this._canvas),this._image=n,this._size=new e(n.width,n.height),this._canvas=null,this._context=null,this._changed(5)},getSource:function(){return this._image&&this._image.src||this.toDataURL()},setSource:function(n){function r(){i.fire("load"),i._project.view&&i._project.view.draw(!0)}var i=this,t=document.getElementById(n)||new Image;t.width&&t.height?setTimeout(r,0):t.src||(a.add(t,{load:function(){i.setImage(t),r()}}),t.src=n),this.setImage(t)},getElement:function(){return this._canvas||this._image},getSubImage:function(n){n=f.read(arguments);var t=p.getContext(n.getSize());return t.drawImage(this.getCanvas(),n.x,n.y,n.width,n.height,0,0,n.width,n.height),t.canvas},toDataURL:function(){var t=this._image&&this._image.src,n;return/^data:/.test(t)?t:(n=this.getCanvas(),n?n.toDataURL():null)},drawImage:function(n,i){i=t.read(arguments,1),this.getContext(!0).drawImage(n,i.x,i.y)},getAverageColor:function(t){var r,l,a,d,o,i;t?t instanceof at?(l=t,r=t.getBounds()):t.width?r=new f(t):t.x&&(r=new f(t.x-.5,t.y-.5,1,1)):r=this.getBounds();var s=32,b=Math.min(r.width,s),k=Math.min(r.height,s),u=et._sampleContext;u?u.clearRect(0,0,s+1,s+1):u=et._sampleContext=p.getContext(new e(s)),u.save(),a=(new y).scale(b/r.width,k/r.height).translate(-r.x,-r.y),a.applyToContext(u),l&&l.draw(u,n.merge({clip:!0,transforms:[a]})),this._matrix.applyToContext(u),u.drawImage(this.getElement(),-this._size.width/2,-this._size.height/2),u.restore();var h=u.getImageData(.5,.5,Math.ceil(b),Math.ceil(k)).data,c=[0,0,0],w=0;for(i=0,d=h.length;i<d;i+=4)o=h[i+3],w+=o,o/=255,c[0]+=h[i]*o,c[1]+=h[i+1]*o,c[2]+=h[i+2]*o;for(i=0;i<3;i++)c[i]/=w;return w?v.read(c):null},getPixel:function(n){n=t.read(arguments);var i=this.getContext().getImageData(n.x,n.y,1,1).data;return new v("rgb",[i[0]/255,i[1]/255,i[2]/255],i[3]/255)},setPixel:function(){var r=t.read(arguments),u=v.read(arguments),i=u._convert("rgb"),f=u._alpha,e=this.getContext(!0),o=e.createImageData(1,1),n=o.data;n[0]=i[0]*255,n[1]=i[1]*255,n[2]=i[2]*255,n[3]=f!=null?f*255:255,e.putImageData(o,r.x,r.y)},createImageData:function(n){return n=e.read(arguments),this.getContext().createImageData(n.width,n.height)},getImageData:function(n){return n=f.read(arguments),n.isEmpty()&&(n=new f(this._size)),this.getContext().getImageData(n.x,n.y,n.width,n.height)},setImageData:function(n,i){i=t.read(arguments,1),this.getContext(!0).putImageData(n,i.x,i.y)},_getBounds:function(n,t){var i=new f(this._size).setCenter(0,0);return t?t._transformBounds(i):i},_hitTest:function(n){if(this._contains(n)){var t=this;return new d("pixel",t,{offset:n.add(t._size.divide(2)).round(),color:{get:function(){return t.getPixel(this.offset)}}})}},_draw:function(n){var t=this.getElement();t&&(n.globalAlpha=this._opacity,n.drawImage(t,-this._size.width/2,-this._size.height/2))},_canComposite:function(){return!0}}),ti=k.extend({_class:"PlacedSymbol",_transformContent:!1,_boundsGetter:{getBounds:"getStrokeBounds"},_boundsSelected:!0,_serializeFields:{symbol:null},initialize:function(n,i){this._initialize(n,i!==undefined&&t.read(arguments,1))||this.setSymbol(n instanceof nt?n:new nt(n))},getSymbol:function(){return this._symbol},setSymbol:function(n){this._symbol&&delete this._symbol._instances[this._id],this._symbol=n,n._instances[this._id]=this},clone:function(n){return this._clone(new ti({symbol:this.symbol,insert:!1}),n)},isEmpty:function(){return this._symbol._definition.isEmpty()},_getBounds:function(n,t){return this.symbol._definition._getCachedBounds(n,t)},_hitTest:function(n,t,i){var r=this._symbol._definition._hitTest(n,t,i);return r&&(r.item=this),r},_draw:function(n,t){this.symbol._definition.draw(n,t)}}),d=n.extend({_class:"HitResult",initialize:function(n,t,i){this.type=n,this.item=t,i&&(i.enumerable=!0,this.inject(i))},statics:{getOptions:function(t){return t&&t._merged?t:n.merge({type:null,tolerance:paper.project.options.hitTolerance||2,fill:!t,stroke:!t,segments:!t,handles:!1,ends:!1,center:!1,bounds:!1,guides:!1,selected:!1,_merged:!0},t)}}}),u=n.extend({_class:"Segment",initialize:function(n,t,i,r,u,f){var o=arguments.length,e,s,h;o===0||(o===1?n.point?(e=n.point,s=n.handleIn,h=n.handleOut):e=n:o<6?o==2&&t.x===undefined?e=[n,t]:(e=n,s=t,h=i):o===6&&(e=[n,t],s=[i,r],h=[u,f])),this._point=new pt(e,this),this._handleIn=new pt(s,this),this._handleOut=new pt(h,this)},_serialize:function(t){return n.serialize(this.isLinear()?this._point:[this._point,this._handleIn,this._handleOut],t,!0)},_changed:function(n){if(this._path){var t=this._path._curves&&this.getCurve(),i;t&&(t._changed(),(i=t[n==this._point||n==this._handleIn&&t._segment1==this?"getPrevious":"getNext"]())&&i._changed()),this._path._changed(5)}},getPoint:function(){return this._point},setPoint:function(n){n=t.read(arguments),this._point.set(n.x,n.y)},getHandleIn:function(){return this._handleIn},setHandleIn:function(n){n=t.read(arguments),this._handleIn.set(n.x,n.y)},getHandleOut:function(){return this._handleOut},setHandleOut:function(n){n=t.read(arguments),this._handleOut.set(n.x,n.y)},isLinear:function(){return this._handleIn.isZero()&&this._handleOut.isZero()},setLinear:function(){this._handleIn.set(0,0),this._handleOut.set(0,0)},_isSelected:function(n){var t=this._selectionState;return n==this._point?!!(t&4):n==this._handleIn?!!(t&1):n==this._handleOut?!!(t&2):!1},_setSelected:function(n,t){var e=this._path,t=!!t,r=this._selectionState||0,i=[!!(r&4),!!(r&1),!!(r&2)],u,f,o;n==this._point?(t?i[1]=i[2]=!1:(u=this.getPrevious(),f=this.getNext(),i[1]=u&&(u._point.isSelected()||u._handleOut.isSelected()),i[2]=f&&(f._point.isSelected()||f._handleIn.isSelected())),i[0]=t):(o=n==this._handleIn?1:2,i[o]!=t&&(t&&(i[0]=!1),i[o]=t)),this._selectionState=(i[0]?4:0)|(i[1]?1:0)|(i[2]?2:0),e&&r!=this._selectionState&&(e._updateSelection(this,r,this._selectionState),e._changed(33))},isSelected:function(){return this._isSelected(this._point)},setSelected:function(n){this._setSelected(this._point,n)},getIndex:function(){return this._index!==undefined?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var n=this._path,t=this._index;return n?(n._closed||t!=n._segments.length-1||t--,n.getCurves()[t]||null):null},getLocation:function(){var n=this.getCurve();return n?new tt(n,n.getNext()?0:1):null},getNext:function(){var n=this._path&&this._path._segments;return n&&(n[this._index+1]||this._path._closed&&n[0])||null},getPrevious:function(){var n=this._path&&this._path._segments;return n&&(n[this._index-1]||this._path._closed&&n[n.length-1])||null},reverse:function(){return new u(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new u(this._point,this._handleIn,this._handleOut)},equals:function(n){return n===this||n&&this._point.equals(n._point)&&this._handleIn.equals(n._handleIn)&&this._handleOut.equals(n._handleOut)||!1},toString:function(){var n=["point: "+this._point];return this._handleIn.isZero()||n.push("handleIn: "+this._handleIn),this._handleOut.isZero()||n.push("handleOut: "+this._handleOut),"{ "+n.join(", ")+" }"},_transformCoordinates:function(n,t,i){var s=this._point,e=!i||!this._handleIn.isZero()?this._handleIn:null,o=!i||!this._handleOut.isZero()?this._handleOut:null,u=s._x,f=s._y,r=2;return t[0]=u,t[1]=f,e&&(t[r++]=e._x+u,t[r++]=e._y+f),o&&(t[r++]=o._x+u,t[r++]=o._y+f),n&&(n._transformCoordinates(t,0,t,0,r/2),u=t[0],f=t[1],i?(s._x=u,s._y=f,r=2,e&&(e._x=t[r++]-u,e._y=t[r++]-f),o&&(o._x=t[r++]-u,o._y=t[r++]-f)):(e||(t[r++]=u,t[r++]=f),o||(t[r++]=u,t[r++]=f))),t}}),pt=t.extend({initialize:function(n,i){var r,u,f;n?(r=n[0])!==undefined?u=n[1]:((r=n.x)===undefined&&(n=t.read(arguments),r=n.x),u=n.y,f=n.selected):r=u=0,this._x=r,this._y=u,this._owner=i,f&&this.setSelected(!0)},set:function(n,t){return this._x=n,this._y=t,this._owner._changed(this),this},getX:function(){return this._x},setX:function(n){this._x=n,this._owner._changed(this)},getY:function(){return this._y},setY:function(n){this._y=n,this._owner._changed(this)},isZero:function(){return s.isZero(this._x)&&s.isZero(this._y)},setSelected:function(n){this._owner._setSelected(this,n)},isSelected:function(){return this._owner._isSelected(this)}}),r=n.extend({_class:"Curve",initialize:function(n,t,i,r,f,e,o,s){var h=arguments.length,c,l,a,v;h===3?(this._path=n,this._segment1=t,this._segment2=i):h===0?(this._segment1=new u,this._segment2=new u):h===1?(this._segment1=new u(n.segment1),this._segment2=new u(n.segment2)):h===2?(this._segment1=new u(n),this._segment2=new u(t)):(h===4?(c=n,l=t,a=i,v=r):h===8&&(c=[n,t],v=[o,s],l=[i-n,r-t],a=[f-o,e-s]),this._segment1=new u(c,null,l),this._segment2=new u(v,a,null))},_changed:function(){delete this._length,delete this._bounds},getPoint1:function(){return this._segment1._point},setPoint1:function(n){n=t.read(arguments),this._segment1._point.set(n.x,n.y)},getPoint2:function(){return this._segment2._point},setPoint2:function(n){n=t.read(arguments),this._segment2._point.set(n.x,n.y)},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(n){n=t.read(arguments),this._segment1._handleOut.set(n.x,n.y)},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(n){n=t.read(arguments),this._segment2._handleIn.set(n.x,n.y)},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var n=this._path&&this._path._curves;return n&&(n[this._segment1._index+1]||this._path._closed&&n[0])||null},getPrevious:function(){var n=this._path&&this._path._curves;return n&&(n[this._segment1._index-1]||this._path._closed&&n[n.length-1])||null},isSelected:function(){return this.getHandle1().isSelected()&&this.getHandle2().isSelected()},setSelected:function(n){this.getHandle1().setSelected(n),this.getHandle2().setSelected(n)},getValues:function(){return r.getValues(this._segment1,this._segment2)},getPoints:function(){for(var i=this.getValues(),r=[],n=0;n<8;n+=2)r.push(new t(i[n],i[n+1]));return r},getLength:function(){var t=arguments[0],i=arguments[1],u=arguments.length===0||t===0&&i===1,n;return u&&this._length!=null?this._length:(n=r.getLength(this.getValues(),t,i),u&&(this._length=n),n)},getArea:function(){return r.getArea(this.getValues())},getPart:function(n,t){return new r(r.getPart(this.getValues(),n,t))},isLinear:function(){return this._segment1._handleOut.isZero()&&this._segment2._handleIn.isZero()},getIntersections:function(n){return r.getIntersections(this.getValues(),n.getValues(),this,n,[])},reverse:function(){return new r(this._segment2.reverse(),this._segment1.reverse())},_getParameter:function(n,t){return t?n:n&&n.curve===this?n.parameter:n===undefined&&t===undefined?.5:this.getParameterAt(n,0)},divide:function(n,i){var s=this._getParameter(n,i),h=null,y;if(s>0&&s<1){var v=r.subdivide(this.getValues(),s),c=this.isLinear(),f=v[0],e=v[1];c||(this._segment1._handleOut.set(f[2]-f[0],f[3]-f[1]),this._segment2._handleIn.set(e[4]-e[6],e[5]-e[7]));var l=f[6],a=f[7],o=new u(new t(l,a),!c&&new t(f[4]-l,f[5]-a),!c&&new t(e[2]-l,e[3]-a));this._path?(this._segment1._index>0&&this._segment2._index===0?this._path.add(o):this._path.insert(this._segment2._index,o),h=this):(y=this._segment2,this._segment2=o,h=new r(o,y))}return h},split:function(n,t){return this._path?this._path.split(this._segment1._index,this._getParameter(n,t)):null},clone:function(){return new r(this._segment1,this._segment2)},toString:function(){var n=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||n.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||n.push("handle2: "+this._segment2._handleIn),n.push("point2: "+this._segment2._point),"{ "+n.join(", ")+" }"},statics:{getValues:function(n,t){var i=n._point,u=n._handleOut,f=t._handleIn,r=t._point;return[i._x,i._y,i._x+u._x,i._y+u._y,r._x+f._x,r._y+f._y,r._x,r._y]},evaluate:function(n,i,r){var e=n[0],o=n[1],s=n[2],h=n[3],y=n[4],p=n[5],w=n[6],b=n[7],u,f,g,nt,tt;if(r===0&&(i===0||i===1))u=i===0?e:w,f=i===0?o:b;else{var c=3*(s-e),l=3*(y-s)-c,k=w-e-c-l,a=3*(h-o),v=3*(p-h)-a,d=b-o-a-v;if(r===0)u=((k*i+l)*i+c)*i+e,f=((d*i+v)*i+a)*i+o;else if(g=1e-5,i<g&&s==e&&h==o||i>1-g&&y==w&&p==b?(u=y-s,f=p-h):(u=(3*k*i+2*l)*i+c,f=(3*d*i+2*v)*i+a),r===3)return nt=6*k*i+2*l,tt=6*d*i+2*v,(u*tt-f*nt)/Math.pow(u*u+f*f,3/2)}return r==2?new t(f,-u):new t(u,f)},subdivide:function(n,t){var r=n[0],u=n[1],f=n[2],e=n[3],o=n[4],s=n[5],h=n[6],c=n[7];t===undefined&&(t=.5);var i=1-t,l=i*r+t*f,a=i*u+t*e,v=i*f+t*o,y=i*e+t*s,p=i*o+t*h,w=i*s+t*c,b=i*l+t*v,k=i*a+t*y,d=i*v+t*p,g=i*y+t*w,nt=i*b+t*d,tt=i*k+t*g;return[[r,u,l,a,b,k,nt,tt],[nt,tt,d,g,p,w,h,c]]},solveCubic:function(n,t,i,r){var u=n[t],e=n[t+2],h=n[t+4],c=n[t+6],f=3*(e-u),o=3*(h-e)-f,l=c-u-f-o;return s.solveCubic(l,o,f,u-i,r)},getParameterOf:function(n,t,i){var s,h;if(Math.abs(n[0]-t)<1e-5&&Math.abs(n[1]-i)<1e-5)return 0;if(Math.abs(n[6]-t)<1e-5&&Math.abs(n[7]-i)<1e-5)return 1;var c=[],l=[],e=r.solveCubic(n,0,t,c),o=r.solveCubic(n,1,i,l),u,f;for(s=0;e==-1||s<e;)if(e==-1||(u=c[s++])>=0&&u<=1){for(h=0;o==-1||h<o;)if((o==-1||(f=l[h++])>=0&&f<=1)&&(e==-1?u=f:o==-1&&(f=u),Math.abs(u-f)<1e-5))return(u+f)*.5;if(e==-1)break}return null},getPart:function(n,t,i){return t>0&&(n=r.subdivide(n,t)[1]),i<1&&(n=r.subdivide(n,(i-t)/(1-t))[0]),n},isLinear:function(n){return n[0]===n[2]&&n[1]===n[3]&&n[4]===n[6]&&n[5]===n[7]},isFlatEnough:function(n,t){var i=n[0],r=n[1],c=n[2],l=n[3],a=n[4],v=n[5],u=n[6],f=n[7],e=3*c-2*i-u,o=3*l-2*r-f,s=3*a-2*u-i,h=3*v-2*f-r;return Math.max(e*e,s*s)+Math.max(o*o,h*h)<10*t*t},getArea:function(n){var t=n[0],i=n[1],r=n[2],u=n[3],f=n[4],e=n[5],o=n[6],s=n[7];return(3*u*t-1.5*u*f-1.5*u*o-3*i*r-1.5*i*f-.5*i*o+1.5*e*t+1.5*e*r-3*e*o+.5*s*t+1.5*s*r+3*s*f)/10},getBounds:function(n){for(var i=n.slice(0,2),u=i.slice(),e=[0,0],t=0;t<2;t++)r._addBounds(n[t],n[t+2],n[t+4],n[t+6],t,0,i,u,e);return new f(i[0],i[1],u[0]-i[0],u[1]-i[1])},_getCrossings:function(n,t,i,u,f){function p(n){return r.evaluate(t,1,1).y*n.y>0}var c=r.solveCubic(n,1,u,f),v=0,e=1e-5,y=Math.abs,h,o,l,s,a;for(c===-1&&(f[0]=r.getParameterOf(n,i,u),c=f[0]!==null?1:0),h=0;h<c;h++)if(o=f[h],o>-e&&o<1-e&&(l=r.evaluate(n,o,0),i<l.x+e)){if(s=r.evaluate(n,o,1),y(l.x-i)<e){if(a=s.getAngle(),a>-180&&a<0&&(o>e||p(s)))continue}else if(y(s.y)<e||o<e&&!p(s))continue;v++}return v},_addBounds:function(n,t,i,r,u,f,e,o,h){function v(n,t){var i=n-t,r=n+t;i<e[u]&&(e[u]=i),r>o[u]&&(o[u]=r)}var p=3*(t-i)-n+r,w=2*(n+i)-4*t,b=t-n,k=s.solveQuadratic(p,w,b,h),y=1e-5,d=1-y,a,c,l;for(v(r,0),a=0;a<k;a++)c=h[a],l=1-c,y<c&&c<d&&v(l*l*l*n+3*l*l*c*t+3*l*c*c*i+c*c*c*r,f)}}},n.each(["getBounds","getStrokeBounds","getHandleBounds","getRoughBounds"],function(n){this[n]=function(){this._bounds||(this._bounds={});var t=this._bounds[n];return t||(t=this._bounds[n]=c[n]([this._segment1,this._segment2],!1,this._path.getStyle())),t.clone()}},{}),n.each(["getPoint","getTangent","getNormal","getCurvature"],function(n,t){this[n+"At"]=function(n,i){var u=this.getValues();return r.evaluate(u,i?n:r.getParameterAt(u,n,0),t)},this[n]=function(n){return r.evaluate(this.getValues(),n,t)}},{getParameterAt:function(n,t){return r.getParameterAt(this.getValues(),n,t!==undefined?t:n<0?1:0)},getParameterOf:function(n){return n=t.read(arguments),r.getParameterOf(this.getValues(),n.x,n.y)},getLocationAt:function(n,t){return t||(n=this.getParameterAt(n)),new tt(this,n)},getLocationOf:function(n){n=t.read(arguments);var i=this.getParameterOf(n);return i!=null?new tt(this,i):null},getNearestLocation:function(n){function o(t){if(t>=0&&t<=1){var u=n.getDistance(r.evaluate(c,t,0),!0);if(u<l)return l=u,i=t,!0}}var f,u,h;n=t.read(arguments);var c=this.getValues(),e=100,a=s.TOLERANCE,l=Infinity,i=0;for(f=0;f<=e;f++)o(f/e);for(u=1/(e*2);u>a;)o(i-u)||o(i+u)||(u/=2);return h=r.evaluate(c,i,0),new tt(this,i,h,null,null,null,n.getDistance(h))},getNearestPoint:function(n){return n=t.read(arguments),this.getNearestLocation(n).getPoint()}}),new function(){function t(n){var t=n[0],i=n[1],r=n[2],u=n[3],f=n[4],e=n[5],o=n[6],s=n[7],h=9*(r-f)+3*(o-t),c=6*(t+f)-12*r,l=3*(r-t),a=9*(u-e)+3*(s-i),v=6*(i+e)-12*u,y=3*(u-i);return function(n){var t=(h*n+c)*n+l,i=(a*n+v)*n+y;return Math.sqrt(t*t+i*i)}}function n(n,t){return Math.max(2,Math.min(16,Math.ceil(Math.abs(t-n)*32)))}return{statics:!0,getLength:function(i,r,u){var f,e,o;return(r===undefined&&(r=0),u===undefined&&(u=1),i[0]==i[2]&&i[1]==i[3]&&i[6]==i[4]&&i[7]==i[5])?(f=i[6]-i[0],e=i[7]-i[1],(u-r)*Math.sqrt(f*f+e*e)):(o=t(i),s.integrate(o,r,u,n(r,u)))},getParameterAt:function(i,r,u){function v(t){var i=n(u,t);return l+=u<t?s.integrate(h,u,t,i):-s.integrate(h,t,u,i),u=t,l-r}var c,l;if(r===0)return u;var o=r>0,f=o?u:0,e=o?1:u,r=Math.abs(r),h=t(i),a=s.integrate(h,f,e,n(f,e));return r>=a?o?e:f:(c=r/a,l=0,s.findRoot(v,h,o?f+c:e-c,f,e,16,1e-5))}}},new function(){function t(n,t,i,r,u,f,e){var o=n[0],s=n[n.length-1];o&&r.equals(o._point)||s&&r.equals(s._point)||n.push(new tt(t,i,r,u,f,e))}function n(u,f,e,o,s,h,c,l){var y,v,p,a,k,d;if(l=(l||0)+1,!(l>20)){h=h||[0,1],c=c||[0,1];for(var w=r.getPart(u,h[0],h[1]),b=r.getPart(f,c[0],c[1]),g=0;g++<20;){if(v=i(w,b,y=c.slice()),p=0,v===0)break;if(v>0){if(c=y,b=r.getPart(f,c[0],c[1]),p=i(b,w,y=h.slice()),p===0)break;v>0&&(h=y,w=r.getPart(u,h[0],h[1]))}if(v<0||p<0)if(h[1]-h[0]>c[1]-c[0]){a=(h[0]+h[1])/2,n(u,f,e,o,s,[h[0],a],c,l),n(u,f,e,o,s,[a,h[1]],c,l);break}else{a=(c[0]+c[1])/2,n(u,f,e,o,s,h,[c[0],a],l),n(u,f,e,o,s,h,[a,c[1]],l);break}if(Math.abs(h[1]-h[0])<=1e-5&&Math.abs(c[1]-c[0])<=1e-5){k=(h[0]+h[1])/2,d=(c[0]+c[1])/2,t(s,e,k,r.evaluate(u,k,0),o,d,r.evaluate(f,d,0));break}}}}function i(n,t,i){var c=n[0],l=n[1],bt=n[2],kt=n[3],dt=n[4],gt=n[5],a=n[6],v=n[7],ni=t[0],ti=t[1],ii=t[2],ri=t[3],ui=t[4],fi=t[5],ei=t[6],oi=t[7],y=b.getSignedDistance,ft=y(c,l,a,v,bt,kt)||0,et=y(c,l,a,v,dt,gt)||0,pt=ft*et>0?3/4:4/9,e=pt*Math.min(0,ft,et),o=pt*Math.max(0,ft,et),p=y(c,l,a,v,ni,ti),ot=y(c,l,a,v,ii,ri),st=y(c,l,a,v,ui,fi),w=y(c,l,a,v,ei,oi),it,rt,g,ct,k,d,f,vt,yt,ut,tt;if(e>Math.max(p,ot,st,w)||o<Math.min(p,ot,st,w))return 0;it=u(p,ot,st,w),w<p&&(rt=e,e=o,o=rt);var ht=-Infinity,s=Infinity,h=-Infinity;for(g=0,ct=it.length;g<ct;g++){k=it[g],d=it[(g+1)%ct],d[1]<k[1]&&(rt=d,d=k,k=rt);var lt=k[0],nt=k[1],si=d[0],at=d[1],wt=(at-nt)/(si-lt);e>=nt&&e<=at&&(f=lt+(e-nt)/wt,f<s&&(s=f),f>ht&&(ht=f)),o>=nt&&o<=at&&(f=lt+(o-nt)/wt,f>h&&(h=f),f<s&&(s=0))}return s!==Infinity&&h!==-Infinity&&(vt=Math.min(e,o),yt=Math.max(e,o),w>vt&&w<yt&&(h=1),p>vt&&p<yt&&(s=0),ht>h&&(h=1),ut=i[0],tt=i[1]-ut,i[0]=ut+s*tt,i[1]=ut+h*tt,(tt-(i[1]-i[0]))/tt>=.2)?1:r.getBounds(n).touches(r.getBounds(t))?-1:0}function u(n,t,i,r){var u=[0,n],f=[1/3,t],e=[2/3,i],o=[1,r],c=b.getSignedDistance,l=c(0,n,1,r,1/3,t),a=c(0,n,1,r,2/3,i),s,h;return l*a<0?[u,f,o,e]:(Math.abs(l)>Math.abs(a)?(s=f,h=(r-i-(r-n)/3)*(2*(r-i)-r+t)/3):(s=e,h=(t-n+(n-r)/3)*(-2*(n-t)+n-i)/3),h<0?[u,s,o]:[u,f,e,o])}function f(n,i,u,f,e){for(var h=r.isLinear(n),l=h?i:n,c=h?n:i,d=c[0],g=c[1],ut=c[6],ft=c[7],nt=ut-d,tt=ft-g,it=Math.atan2(-tt,nt),a=Math.sin(it),v=Math.cos(it),et=nt*v-tt*a,y=[],p,w,b,rt,s,k,o=0;o<8;o+=2)p=l[o]-d,w=l[o+1]-g,y.push(p*v-w*a,w*v+p*a);for(b=[],rt=r.solveCubic(y,1,0,b),o=0;o<rt;o++)s=b[o],s>=0&&s<=1&&(k=r.evaluate(y,s,0),k.x>=0&&k.x<=et&&t(e,h?f:u,s,r.evaluate(l,s,0),h?u:f))}function e(n,i,r,u,f){var e=b.intersect(n[0],n[1],n[6],n[7],i[0],i[1],i[6],i[7]);e&&t(f,r,null,e,u)}return{statics:{getIntersections:function(t,i,u,o,s){var h=r.isLinear(t),c=r.isLinear(i);return(h&&c?e:h||c?f:n)(t,i,u,o,s),s}}}}),tt=n.extend({_class:"CurveLocation",initialize:function tt(n,t,i,r,u,f,e){this._id=tt._id=(tt._id||0)+1,this._curve=n,this._segment1=n._segment1,this._segment2=n._segment2,this._parameter=t,this._point=i,this._curve2=r,this._parameter2=u,this._point2=f,this._distance=e},getSegment:function(){if(!this._segment){var n=this.getCurve(),t=this.getParameter();if(t===1)this._segment=n._segment2;else if(t===0||arguments[0])this._segment=n._segment1;else{if(t==null)return null;this._segment=n.getLength(0,t)<n.getLength(t,1)?n._segment1:n._segment2}}return this._segment},getCurve:function(){return(!this._curve||arguments[0])&&(this._curve=this._segment1.getCurve(),this._curve.getParameterOf(this._point)==null&&(this._curve=this._segment2.getPrevious().getCurve())),this._curve},getIntersection:function(){var n=this._intersection,t;return!n&&this._curve2&&(t=this._parameter2,this._intersection=n=new tt(this._curve2,t,this._point2||this._point,this),n._intersection=this),n},getPath:function(){var n=this.getCurve();return n&&n._path},getIndex:function(){var n=this.getCurve();return n&&n.getIndex()},getOffset:function(){var n=this.getPath();return n&&n._getOffset(this)},getCurveOffset:function(){var n=this.getCurve(),t=this.getParameter();return t!=null&&n&&n.getLength(0,t)},getParameter:function(){if((this._parameter==null||arguments[0])&&this._point){var n=this.getCurve(arguments[0]&&this._point);this._parameter=n&&n.getParameterOf(this._point)}return this._parameter},getPoint:function(){if((!this._point||arguments[0])&&this._parameter!=null){var n=this.getCurve();this._point=n&&n.getPointAt(this._parameter,!0)}return this._point},getTangent:function(){var n=this.getParameter(),t=this.getCurve();return n!=null&&t&&t.getTangentAt(n,!0)},getNormal:function(){var n=this.getParameter(),t=this.getCurve();return n!=null&&t&&t.getNormalAt(n,!0)},getDistance:function(){return this._distance},divide:function(){var n=this.getCurve(!0);return n&&n.divide(this.getParameter(!0),!0)},split:function(){var n=this.getCurve(!0);return n&&n.split(this.getParameter(!0),!0)},toString:function(){var n=[],r=this.getPoint(),u=w.instance,t,i;return r&&n.push("point: "+r),t=this.getIndex(),t!=null&&n.push("index: "+t),i=this.getParameter(),i!=null&&n.push("parameter: "+u.number(i)),this._distance!=null&&n.push("distance: "+u.number(this._distance)),"{ "+n.join(", ")+" }"}}),at=k.extend({_class:"PathItem",initialize:function(){},getIntersections:function(n){var t,c,f,l,i;if(!this.getBounds().touches(n.getBounds()))return[];var e=[],o=this.getCurves(),u=n.getCurves(),s=u.length,h=[];for(t=0;t<s;t++)h[t]=u[t].getValues();for(t=0,c=o.length;t<c;t++)for(f=o[t],l=f.getValues(),i=0;i<s;i++)r.getIntersections(l,h[i],f,u[i],e);return e},setPathData:function(n){function c(n,t,i){var r=parseFloat(h[n]);return a&&(r+=e[t]),i&&(e[t]=r),r}function r(n,i){return new t(c(n,"x",i),c(n+1,"y",i))}var l=n.match(/[a-z][^a-z]*/ig),h,a=!1,f,e=new t,o,v,u,w,i;for(this._type==="path"?this.removeSegments():this.removeChildren(),o=0,v=l.length;o<v;o++){var y=l[o],p=y[0],s=p.toLowerCase();h=y.slice(1).trim().split(/[\s,]+|(?=[+-])/),a=p===s,u=h.length;switch(s){case"m":case"l":for(i=0;i<u;i+=2)this[i===0&&s==="m"?"moveTo":"lineTo"](r(i,!0));break;case"h":case"v":for(w=s=="h"?"x":"y",i=0;i<u;i++)c(i,w,!0),this.lineTo(e);break;case"c":for(i=0;i<u;i+=6)this.cubicCurveTo(r(i),f=r(i+2),r(i+4,!0));break;case"s":for(i=0;i<u;i+=4)this.cubicCurveTo(e.multiply(2).subtract(f),f=r(i),r(i+2,!0));break;case"q":for(i=0;i<u;i+=4)this.quadraticCurveTo(f=r(i),r(i+2,!0));break;case"t":for(i=0;i<u;i+=2)this.quadraticCurveTo(f=e.multiply(2).subtract(f),r(i,!0));break;case"z":this.closePath()}}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())}}),c=at.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(n){this._closed=!1,this._segments=[];var t=Array.isArray(n)?typeof n[0]=="object"?n:arguments:n&&(n.point!==undefined&&n.size===undefined||n.x!==undefined)?arguments:null;this.setSegments(t||[]),this._initialize(!t&&n)},clone:function(n){var t=this._clone(new c({segments:this._segments,insert:!1}),n);return t._closed=this._closed,this._clockwise!==undefined&&(t._clockwise=this._clockwise),t},_changed:function gt(n){if(gt.base.call(this,n),n&4){if(delete this._length,delete this._clockwise,this._curves)for(var t=0,i=this._curves.length;t<i;t++)this._curves[t]._changed(5)}else n&8&&delete this._bounds},getSegments:function(){return this._segments},setSegments:function(n){this._selectedSegmentState=0,this._segments.length=0,delete this._curves,this._add(u.readAll(n))},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var t=this._curves,i=this._segments,u,n;if(!t)for(u=this._countCurves(),t=this._curves=new Array(u),n=0;n<u;n++)t[n]=new r(this,i[n],i[n+1]||i[0]);return t},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var n=this.getCurves();return n[n.length-1]},getPathData:function(){function f(n,r,f){var c=n._point,o=r._point,s=n._handleOut,h=r._handleIn,e;s.isZero()&&h.isZero()?f||i.push("L"+t.point(o,u)):(e=o.subtract(c),i.push("c"+t.point(s,u)+" "+t.point(e.add(h),u)+" "+t.point(e,u)))}var n=this._segments,u=arguments[0],t=w.instance,i=[],r,e;if(n.length===0)return"";for(i.push("M"+t.point(n[0]._point)),r=0,e=n.length-1;r<e;r++)f(n[r],n[r+1],!1);return this._closed&&(f(n[n.length-1],n[0],!0),i.push("z")),i.join("")},isClosed:function(){return this._closed},setClosed:function(n){if(this._closed!=(n=!!n)){if(this._closed=n,this._curves){var t=this._curves.length=this._countCurves();n&&(this._curves[t-1]=new r(this,this._segments[t-1],this._segments[0]))}this._changed(5)}},isEmpty:function(){return this._segments.length===0},isPolygon:function(){for(var n=0,t=this._segments.length;n<t;n++)if(!this._segments[n].isLinear())return!1;return!0},_applyMatrix:function(n){for(var r=new Array(6),t=0,i=this._segments.length;t<i;t++)this._segments[t]._transformCoordinates(n,r,!0);return!0},_add:function(n,t){for(var f=this._segments,e=this._curves,s=n.length,h=t==null,t=h?f.length:t,v=this.isFullySelected(),u,c,i=0;i<s;i++)u=n[i],u._path&&(u=n[i]=u.clone()),u._path=this,u._index=t+i,v&&(u._selectionState=4),u._selectionState&&this._updateSelection(u,0,u._selectionState);if(h)f.push.apply(f,n);else for(f.splice.apply(f,[t,0].concat(n)),i=t+s,c=f.length;i<c;i++)f[i]._index=i;if(e||n._curves){e||(e=this._curves=[]);var o=t>0?t-1:t,l=o,a=Math.min(o+s,this._countCurves());for(n._curves&&(e.splice.apply(e,[o,0].concat(n._curves)),l+=n._curves.length),i=l;i<a;i++)e.splice(i,0,new r(this,null,null));this._adjustCurves(o,a)}return this._changed(5),n},_adjustCurves:function(n,t){for(var r=this._segments,f=this._curves,i,u=n;u<t;u++)i=f[u],i._path=this,i._segment1=r[u],i._segment2=r[u+1]||r[0];(i=f[this._closed&&n===0?r.length-1:n-1])&&(i._segment2=r[n]||r[0]),(i=f[t])&&(i._segment1=r[t])},_countCurves:function(){var n=this._segments.length;return!this._closed&&n>0?n-1:n},add:function(n){return arguments.length>1&&typeof n!="number"?this._add(u.readAll(arguments)):this._add([u.read(arguments)])[0]},insert:function(n,t){return arguments.length>2&&typeof t!="number"?this._add(u.readAll(arguments,1),n):this._add([u.read(arguments,1)],n)[0]},addSegment:function(){return this._add([u.read(arguments)])[0]},insertSegment:function(n){return this._add([u.read(arguments,1)],n)[0]},addSegments:function(n){return this._add(u.readAll(n))},insertSegments:function(n,t){return this._add(u.readAll(t),n)},removeSegment:function(n){return this.removeSegments(n,n+1)[0]||null},removeSegments:function(t,i){var u,r,c,s,f;t=t||0,i=n.pick(i,this._segments.length);var o=this._segments,f=this._curves,l=o.length,e=o.splice(t,i-t),h=e.length;if(!h)return e;for(r=0;r<h;r++)u=e[r],u._selectionState&&this._updateSelection(u,u._selectionState,0),delete u._index,delete u._path;for(r=t,c=o.length;r<c;r++)o[r]._index=r;return f&&(s=t>0&&i===l+(this._closed?1:0)?t-1:t,f=f.splice(s,h),arguments[2]&&(e._curves=f.slice(1)),this._adjustCurves(s,s)),this._changed(5),e},isFullySelected:function(){return this._selected&&this._selectedSegmentState==this._segments.length*4},setFullySelected:function(n){n&&this._selectSegments(!0),this.setSelected(n)},setSelected:function ki(n){n||this._selectSegments(!1),ki.base.call(this,n)},_selectSegments:function(n){var i=this._segments.length,t;for(this._selectedSegmentState=n?i*4:0,t=0;t<i;t++)this._segments[t]._selectionState=n?4:0},_updateSelection:function(n,t,i){n._selectionState=i;var r=this._selectedSegmentState+=i-t;r>0&&this.setSelected(!0)},flatten:function(n){for(var t=new ii(this),i=0,r=t.length/Math.ceil(t.length/n),e=t.length+(this._closed?-r:r)/2,f=[];i<=e;)f.push(new u(t.evaluate(i,0))),i+=r;this.setSegments(f)},simplify:function(n){if(this._segments.length>2){var t=new gi(this,n||2.5);this.setSegments(t.fit())}},split:function(n,t){var i,u,f,r;if(t!==null)return(arguments.length===1&&(i=n,typeof i=="number"&&(i=this.getLocationAt(i)),n=i.index,t=i.parameter),t>=1&&(n++,t--),u=this.getCurves(),n>=0&&n<u.length)?(t>0&&u[n++].divide(t,!0),f=this.removeSegments(n,this._segments.length,!0),this._closed?(this.setClosed(!1),r=this):n>0&&(r=this._clone((new c).insertAbove(this,!0))),r._add(f,0),this.addSegment(f[0]),r):null},isClockwise:function(){return this._clockwise!==undefined?this._clockwise:c.isClockwise(this._segments)},setClockwise:function(n){this.isClockwise()!=(n=!!n)&&this.reverse(),this._clockwise=n},reverse:function(){var t,i,n,r;for(this._segments.reverse(),t=0,i=this._segments.length;t<i;t++)n=this._segments[t],r=n._handleIn,n._handleIn=n._handleOut,n._handleOut=r,n._index=t;delete this._curves,this._clockwise!==undefined&&(this._clockwise=!this._clockwise)},join:function(n){var i,f;if(n){var r=n._segments,t=this.getLastSegment(),u=n.getLastSegment();return t._point.equals(u._point)&&n.reverse(),f=n.getFirstSegment(),t._point.equals(f._point)?(t.setHandleOut(f._handleOut),this._add(r.slice(1))):(i=this.getFirstSegment(),i._point.equals(f._point)&&n.reverse(),u=n.getLastSegment(),i._point.equals(u._point)?(i.setHandleIn(u._handleIn),this._add(r.slice(0,r.length-1),0)):this._add(r.slice())),n.closed&&this._add([r[0]]),n.remove(),i=this.getFirstSegment(),t=this.getLastSegment(),t._point.equals(i._point)&&(i.setHandleIn(t._handleIn),t.remove(),this.setClosed(!0)),this._changed(5),!0}return!1},reduce:function(){return this},getLength:function(){var t,n,i;if(this._length==null)for(t=this.getCurves(),this._length=0,n=0,i=t.length;n<i;n++)this._length+=t[n].getLength();return this._length},getArea:function(){for(var t=this.getCurves(),i=0,n=0,r=t.length;n<r;n++)i+=t[n].getArea();return i},_getOffset:function(n){var i=n&&n.getIndex(),r,u,t,f;if(i!=null){for(r=this.getCurves(),u=0,t=0;t<i;t++)u+=r[t].getLength();return f=r[i],u+f.getLength(0,n.getParameter())}return null},getLocationOf:function(n){var r,i,f,u;for(n=t.read(arguments),r=this.getCurves(),i=0,f=r.length;i<f;i++)if(u=r[i].getLocationOf(n),u)return u;return null},getLocationAt:function(n,t){var i=this.getCurves(),u=0,f,r,o,s,e;if(t)return f=~~n,i[f].getLocationAt(n-f,!0);for(r=0,o=i.length;r<o;r++)if(s=u,e=i[r],u+=e.getLength(),u>=n)return e.getLocationAt(n-s);return n<=this.getLength()?new tt(i[i.length-1],1):null},getPointAt:function(n,t){var i=this.getLocationAt(n,t);return i&&i.getPoint()},getTangentAt:function(n,t){var i=this.getLocationAt(n,t);return i&&i.getTangent()},getNormalAt:function(n,t){var i=this.getLocationAt(n,t);return i&&i.getNormal()},getNearestLocation:function(n){var i,o,r;n=t.read(arguments);var u=this.getCurves(),f=Infinity,e=null;for(i=0,o=u.length;i<o;i++)r=u[i].getNearestLocation(n),r._distance<f&&(f=r._distance,e=r);return e},getNearestPoint:function(n){return n=t.read(arguments),this.getNearestLocation(n).getPoint()},getStyle:function(){var n=this._parent;return(n&&n._type==="compound-path"?n:this)._style},_contains:function(n){var f=this._closed,u,v;if(!f&&!this.hasFill()||!this._getBounds("getRoughBounds")._containsPoint(n))return!1;var i=this.getCurves(),e=this._segments,o=0,l=new Array(3),a=(f?i[i.length-1]:new r(e[e.length-1]._point,e[0]._point)).getValues(),s=a;for(u=0,v=i.length;u<v;u++){var t=i[u].getValues(),h=t[0],c=t[1];h===t[2]&&c===t[3]&&h===t[4]&&c===t[5]&&h===t[6]&&c===t[7]||(o+=r._getCrossings(t,s,n.x,n.y,l),s=t)}return f||(o+=r._getCrossings(a,s,n.x,n.y,l)),(o&1)==1},_hitTest:function(n,t){function w(t,i,r){if(n.getDistance(i)<nt)return new d(r,ut,{segment:t,point:i})}function b(n,i){var r=n._point;return(i||t.segments)&&w(n,r,"segment")||!i&&t.handles&&(w(n,r.add(n._handleIn),"handle-in")||w(n,r.add(n._handleOut),"handle-out"))}function tt(n){o.push(n)}function it(n){var t=o[n],i=o[(n+1)%o.length];return[t.x,t.y,t.x,t.y,i.x,i.y,i.x,i.y]}function ft(n){for(var u=o.length,f=it(u-1),s=new Array(3),e=0,i,t=0;t<u;t++)i=it(t),e+=r._getCrossings(i,f,n.x,n.y,s),f=i;return(e&1)==1}function rt(t){return(h!=="round"||a!=="round")&&(o=[],g||t._index>0&&t._index<f.length-1?h!=="round"&&(t._handleIn.isZero()||t._handleOut.isZero())&&c._addSquareJoin(t,h,e,p,tt,!0):a!=="round"&&c._addSquareCap(t,a,e,tt,!0),o.length>0)?ft(n):n.getDistance(t._point)<=e}var s=this.getStyle(),f=this._segments,g=this._closed,nt=t.tolerance||0,e=0,h,a,p,ut=this,o,i,v,k,u,l,y;if(t.stroke&&s.getStrokeColor()&&(h=s.getStrokeJoin(),a=s.getStrokeCap(),e=s.getStrokeWidth()/2+nt,p=e*s.getMiterLimit()),!t.ends||t.segments||g){if(t.segments||t.handles)for(u=0,l=f.length;u<l;u++)if(v=b(f[u]))return v}else if(v=b(f[0],!0)||b(f[f.length-1],!0))return v;if(e>0&&(i=this.getNearestLocation(n),i&&(k=i.getParameter(),k===0||k===1?rt(i.getSegment())||(i=null):i._distance>e&&(i=null)),!i&&h==="miter"))for(u=0,l=f.length;u<l;u++)if(y=f[u],n.getDistance(y._point)<=p&&rt(y)){i=y.getLocation();break}return!i&&t.fill&&this.hasFill()&&this.contains(n)?new d("fill",this):i?new d("stroke",this,{location:i}):null}},new function(){function t(n,t,i,r){function a(t){var i=f[t],r=f[t+1];(o!=i||s!=r)&&(n.beginPath(),n.moveTo(o,s),n.lineTo(i,r),n.stroke(),n.beginPath(),n.arc(i,r,u,0,Math.PI*2,!0),n.fill())}for(var u=r/2,f=new Array(6),h,e=0,v=t.length;e<v;e++){h=t[e],h._transformCoordinates(i,f,!1);var c=h._selectionState,l=c&4,o=f[0],s=f[1];(l||c&1)&&a(2),(l||c&2)&&a(4),n.save(),n.beginPath(),n.rect(o-u,s-u,r,r),n.fill(),l||(n.beginPath(),n.rect(o-u+1,s-u+1,r-2,r-2),n.fillStyle="#ffffff",n.fill()),n.restore()}}function n(n,t,i){function w(t){var y=v[t],w,c;i?(y._transformCoordinates(i,f,!1),r=f[0],u=f[1]):(w=y._point,r=w._x,u=w._y),p?(n.moveTo(r,u),p=!1):(i?(e=f[2],o=f[3]):(c=y._handleIn,e=r+c._x,o=u+c._y),e==r&&o==u&&s==l&&h==a?n.lineTo(r,u):n.bezierCurveTo(s,h,e,o,r,u)),l=r,a=u,i?(s=f[4],h=f[5]):(c=y._handleOut,s=l+c._x,h=a+c._y)}for(var v=t._segments,y=v.length,f=new Array(6),p=!0,r,u,l,a,e,o,s,h,c=0;c<y;c++)w(c);t._closed&&y>1&&w(0)}return{_draw:function(t,i){var c=i.clip,o=i.compound;o||t.beginPath();var u=this.getStyle(),s=u.getFillColor(),f=u.getStrokeColor(),r=u.getDashArray(),l=!paper.support.nativeDash&&f&&r&&r.length;if((s||f&&!l||o||c)&&n(t,this),this._closed&&t.closePath(),!c&&!o&&(s||f)&&(this._setStyles(t),s&&t.fill(),f)){if(l){t.beginPath();for(var a=new ii(this),e=u.getDashOffset(),h,v=0;e<a.length;)h=e+r[v++%r.length],a.drawPart(t,e,h),e=h+r[v++%r.length]}t.stroke()}},_drawSelected:function(i,r){i.beginPath(),n(i,this,r),i.stroke(),t(i,this._segments,r,this._project.options.handleSize||4)}}},new function(){function n(n){var i=n.length,r=[],f=[],u=2,t;for(r[0]=n[0]/u,t=1;t<i;t++)f[t]=1/u,u=(t<i-1?4:2)-f[t],r[t]=(n[t]-r[t-1])/u;for(t=1;t<i;t++)r[i-t-1]-=f[i-t]*r[i-t];return r}return{smooth:function(){var v=this._segments,c=v.length,u=c,f,r,s,e,o,l,a,i,h;if(!(c<=2)){for(this._closed?(f=Math.min(c,4),u+=Math.min(c,f)*2):f=0,r=[],i=0;i<c;i++)r[i+f]=v[i]._point;if(this._closed)for(i=0;i<f;i++)r[i]=v[i+c-f]._point,r[i+c+f]=v[i]._point;else u--;for(s=[],i=1;i<u-1;i++)s[i]=4*r[i]._x+2*r[i+1]._x;for(s[0]=r[0]._x+2*r[1]._x,s[u-1]=3*r[u-1]._x,e=n(s),i=1;i<u-1;i++)s[i]=4*r[i]._y+2*r[i+1]._y;if(s[0]=r[0]._y+2*r[1]._y,s[u-1]=3*r[u-1]._y,o=n(s),this._closed){for(i=0,l=c;i<f;i++,l++){var y=i/f,p=1-y,b=i+f,w=l+f;e[l]=e[i]*y+e[l]*p,o[l]=o[i]*y+o[l]*p,e[w]=e[b]*p+e[w]*y,o[w]=o[b]*p+o[w]*y}u--}for(a=null,i=f;i<=u-f;i++)h=v[i-f],a&&h.setHandleIn(a.subtract(h._point)),i<u&&(h.setHandleOut(new t(e[i],o[i]).subtract(h._point)),a=i<u-1?new t(2*r[i+1]._x-e[i+1],2*r[i+1]._y-o[i+1]):new t((r[u]._x+e[u-1])/2,(r[u]._y+o[u-1])/2));this._closed&&a&&(h=this._segments[0],h.setHandleIn(a.subtract(h._point)))}}}},new function(){function i(n){var t=n._segments;if(t.length==0)throw new Error("Use a moveTo() command first");return t[t.length-1]}return{moveTo:function(){this._segments.length===1&&this.removeSegment(0),this._segments.length||this._add([new u(t.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.");},lineTo:function(){this._add([new u(t.read(arguments))])},cubicCurveTo:function(){var f=t.read(arguments),e=t.read(arguments),n=t.read(arguments),r=i(this);r.setHandleOut(f.subtract(r._point)),this._add([new u(n,e.subtract(n))])},quadraticCurveTo:function(){var n=t.read(arguments),r=t.read(arguments),u=i(this)._point;this.cubicCurveTo(n.add(u.subtract(n).multiply(1/3)),n.add(r.subtract(n).multiply(1/3)),r)},curveTo:function(){var o=t.read(arguments),f=t.read(arguments),r=n.pick(n.read(arguments),.5),u=1-r,s=i(this)._point,e=o.subtract(s.multiply(u*u)).subtract(f.multiply(r*r)).divide(2*r*u);if(e.isNaN())throw new Error("Cannot put a curve through points with parameter = "+r);this.quadraticCurveTo(e,f)},arcTo:function(r,f){var w=i(this),o=w._point,k=t.read(arguments),d=n.pick(n.peek(arguments),!0),v,e,c,et,p;typeof d=="boolean"?(r=k,f=d,v=o.add(r).divide(2),e=v.add(v.subtract(o).rotate(f?-90:90))):(e=k,r=t.read(arguments));var ot=new b(o.add(e).divide(2),e.subtract(o).rotate(90),!0),st=new b(e.add(r).divide(2),r.subtract(e).rotate(90),!0),l=ot.intersect(st,!0),g=new b(o,r),y=g.getSide(e);if(!l){if(!y)return this.lineTo(r);throw new Error("Cannot put an arc through the given points: "+[o,e,r]);}var s=o.subtract(l),h=s.getDirectedAngle(r.subtract(l)),nt=g.getSide(l);nt==0?h=y*Math.abs(h):y==nt&&(h-=360*(h<0?-1:1));var tt=Math.abs(h),a=tt>=360?4:Math.ceil(tt/90),it=h/a,rt=it*Math.PI/360,ut=4/3*Math.sin(rt)/(1+Math.cos(rt)),ft=[];for(c=0;c<=a;c++)et=c<a?l.add(s):r,p=c<a?s.rotate(90).multiply(ut):null,c==0?w.setHandleOut(p):ft.push(new u(et,s.rotate(-90).multiply(ut),p)),s=s.rotate(it);this._add(ft)},lineBy:function(n){n=t.read(arguments);var r=i(this);this.lineTo(r._point.add(n))},curveBy:function(n,r,u){n=t.read(n),r=t.read(r);var f=i(this)._point;this.curveTo(f.add(n),f.add(r),u)},arcBy:function(n,r){n=t.read(n),r=t.read(r);var u=i(this)._point;this.arcTo(u.add(n),u.add(r))},closePath:function(){var t=this.getFirstSegment(),n=this.getLastSegment();t._point.equals(n._point)&&(t.setHandleIn(n._handleIn),n.remove()),this.setClosed(!0)}}},{_getBounds:function(n,t){return c[n](this._segments,this._closed,this.getStyle(),t)},statics:{isClockwise:function(n){function i(n,t){h&&(e+=(o-n)*(t+s)),o=n,s=t,h=!0}for(var e=0,o,s,h=!1,t=0,f=n.length;t<f;t++){var c=n[t],l=n[t+1<f?t+1:0],r=c._point,a=c._handleOut,v=l._handleIn,u=l._point;i(r._x,r._y),i(r._x+a._x,r._y+a._y),i(u._x+v._x,u._y+v._y),i(u._x,u._y)}return e>0},getBounds:function(n,t,i,u,e){function v(n){var t,i;for(n._transformCoordinates(u,s,!1),t=0;t<2;t++)r._addBounds(h[t],h[t+4],s[t+2],s[t],t,e?e[t]:0,o,a,p);i=h,h=s,s=i}var l=n[0],c,y;if(!l)return new f;var s=new Array(6),h=l._transformCoordinates(u,new Array(6),!1),o=h.slice(0,2),a=o.slice(),p=new Array(2);for(c=1,y=n.length;c<y;c++)v(n[c]);return t&&v(l),new f(o[0],o[1],a[0]-o[0],a[1]-o[1])},getStrokeBounds:function(n,i,r,u){function b(n,i){if(!i)return[n,n];var e=i.shiftless(),o=e.transform(new t(n,0)),v=e.transform(new t(0,n)),f=o.getAngleInRadians(),r=o.getLength(),u=v.getLength(),s=Math.sin(f),h=Math.cos(f),c=Math.tan(f),l=-Math.atan(u*c/r),a=Math.atan(u/(c*r));return[Math.abs(r*Math.cos(l)*h-u*Math.sin(l)*s),Math.abs(u*Math.sin(a)*h+r*Math.cos(a)*s)]}function p(n){o=o.include(u?u._transformPoint(n,n):n)}function l(n,t){t!=="round"&&(n._handleIn.isZero()||n._handleOut.isZero())?c._addSquareJoin(n,t,s,d,p):o=o.unite(g.setCenter(u?u._transformPoint(n._point):n._point))}function w(n,t){switch(t){case"round":l(n,t);break;case"butt":case"square":c._addSquareCap(n,t,s,p)}}var h;if(!r.getStrokeColor()||!r.getStrokeWidth())return c.getBounds(n,i,r,u);var k=n.length-(i?0:1),s=r.getStrokeWidth()/2,a=b(s,u),o=c.getBounds(n,i,r,u,a),v=r.getStrokeJoin(),y=r.getStrokeCap(),d=s*r.getMiterLimit(),g=new f(new e(a).multiply(2));for(h=1;h<k;h++)l(n[h],v);return i?l(n[0],v):(w(n[0],y),w(n[n.length-1],y)),o},_addSquareJoin:function(n,i,r,u,f,e){var l=n.getCurve(),v=l.getPrevious(),o=l.getPointAt(0,!0),s=v.getNormalAt(1,!0),h=l.getNormalAt(0,!0),a=s.getDirectedAngle(h)<0?-r:r,c;(s.setLength(a),h.setLength(a),e&&(f(o),f(o.add(s))),i==="miter"&&(c=new b(o.add(s),new t(-s.y,s.x),!0).intersect(new b(o.add(h),new t(-h.y,h.x),!0),!0),c&&o.getDistance(c)<=u&&(f(c),!e)))||(e||f(o.add(s)),f(o.add(h)))},_addSquareCap:function(n,t,i,r,u){var f=n._point,o=n.getLocation(),e=o.getNormal().normalize(i);u&&(r(f.subtract(e)),r(f.add(e))),t==="square"&&(f=f.add(e.rotate(o.getParameter()==0?-90:90))),r(f.add(e)),r(f.subtract(e))},getHandleBounds:function(n,t,i,r,u,e){var v=new Array(6),o=Infinity,h=-o,c=o,y=h,l,p,w,s;for(u=u/2||0,e=e/2||0,l=0,p=n.length;l<p;l++)for(w=n[l],w._transformCoordinates(r,v,!1),s=0;s<6;s+=2){var a=s==0?e:u,b=v[s],k=v[s+1],d=b-a,g=b+a,nt=k-a,tt=k+a;d<o&&(o=d),g>h&&(h=g),nt<c&&(c=nt),tt>y&&(y=tt)}return new f(o,c,h-o,y-c)},getRoughBounds:function(n,t,i,r){var u=i.getStrokeColor()?i.getStrokeWidth():0,f=u;return u>0&&(i.getStrokeJoin()==="miter"&&(f=u*i.getMiterLimit()),i.getStrokeCap()==="square"&&(f=Math.max(f,u*Math.sqrt(2)))),c.getHandleBounds(n,t,i,r,u,f)}}});c.inject({statics:new function(){function r(t){return new c(n.getNamed(t))}function h(){var o=f.readNamed(arguments,"rectangle"),n=e.readNamed(arguments,"radius",0,0,{readNull:!0}),h=o.getBottomLeft(!0),c=o.getTopLeft(!0),l=o.getTopRight(!0),a=o.getBottomRight(!0),s=r(arguments),t;return!n||n.isZero()?s._add([new u(h),new u(c),new u(l),new u(a)]):(n=e.min(n,o.getSize(!0).divide(2)),t=n.multiply(i*2),s._add([new u(h.add(n.width,0),null,[-t.width,0]),new u(h.subtract(0,n.height),[0,t.height],null),new u(c.add(0,n.height),null,[0,-t.height]),new u(c.add(n.width,0),[-t.width,0],null),new u(l.subtract(n.width,0),null,[t.width,0]),new u(l.add(0,n.height),[0,-t.height],null),new u(a.subtract(0,n.height),null,[0,t.height]),new u(a.subtract(n.width,0),[t.width,0],null)])),s._closed=!0,s}function o(){for(var o=f.readNamed(arguments,"rectangle"),i=r(arguments),h=o.getPoint(!0),e=o.getSize(!0),s=new Array(4),t,n=0;n<4;n++)t=l[n],s[n]=new u(t._point.multiply(e).add(h),t._handleIn.multiply(e),t._handleOut.multiply(e));return i._add(s),i._closed=!0,i}var i=s.KAPPA/2,l=[new u([0,.5],[0,i],[0,-i]),new u([.5,0],[-i,0],[i,0]),new u([1,.5],[0,-i],[0,i]),new u([.5,1],[i,0],[-i,0])];return{Line:function(){return new c(t.readNamed(arguments,"from"),t.readNamed(arguments,"to")).set(n.getNamed(arguments))},Circle:function(){var r=t.readNamed(arguments,"center"),i=n.readNamed(arguments,"radius");return o(new f(r.subtract(i),new e(i*2,i*2))).set(n.getNamed(arguments))},Rectangle:h,RoundRectangle:h,Ellipse:o,Oval:o,Arc:function(){var i=t.readNamed(arguments,"from"),u=t.readNamed(arguments,"through"),f=t.readNamed(arguments,"to"),n=r(arguments);return n.moveTo(i),n.arcTo(u,f),n},RegularPolygon:function(){for(var c=t.readNamed(arguments,"center"),f=n.readNamed(arguments,"sides"),o=n.readNamed(arguments,"radius"),e=r(arguments),l=360/f,s=!(f%3),a=new t(0,s?-o:o),v=s?-1:.5,h=new Array(f),i=0;i<f;i++)h[i]=new u(c.add(a.rotate((i+v)*l)));return e._add(h),e._closed=!0,e},Star:function(){for(var s=t.readNamed(arguments,"center"),f=n.readNamed(arguments,"points")*2,h=n.readNamed(arguments,"radius1"),c=n.readNamed(arguments,"radius2"),e=r(arguments),l=360/f,a=new t(0,-1),o=new Array(f),i=0;i<f;i++)o[i]=new u(s.add(a.rotate(l*i).multiply(i%2?c:h)));return e._add(o),e._closed=!0,e}}}});var rt=at.extend({_class:"CompoundPath",_serializeFields:{children:[]},initialize:function(n){this._children=[],this._namedChildren={},this._initialize(n)||this.addChildren(Array.isArray(n)?n:arguments)},insertChildren:function di(n,t,i){var r,f,u;for(t=di.base.call(this,n,t,i,"path"),r=0,f=!i&&t&&t.length;r<f;r++)u=t[r],u._clockwise===undefined&&u.setClockwise(u._index===0);return t},reduce:function(){if(this._children.length==1){var n=this._children[0];return n.insertAbove(this),this.remove(),n}return this},reverse:function(){for(var t=this._children,n=0,i=t.length;n<i;n++)t[n].reverse()},smooth:function(){for(var n=0,t=this._children.length;n<t;n++)this._children[n].smooth()},isClockwise:function(){var n=this.getFirstChild();return n&&n.isClockwise()},setClockwise:function(n){this.isClockwise()!=!!n&&this.reverse()},getFirstSegment:function(){var n=this.getFirstChild();return n&&n.getFirstSegment()},getLastSegment:function(){var n=this.getLastChild();return n&&n.getLastSegment()},getCurves:function(){for(var i=this._children,t=[],n=0,r=i.length;n<r;n++)t=t.concat(i[n].getCurves());return t},getFirstCurve:function(){var n=this.getFirstChild();return n&&n.getFirstCurve()},getLastCurve:function(){var n=this.getLastChild();return n&&n.getFirstCurve()},getArea:function(){for(var t=this._children,i=0,n=0,r=t.length;n<r;n++)i+=t[n].getArea();return i},getPathData:function(){for(var t=this._children,i=[],n=0,r=t.length;n<r;n++)i.push(t[n].getPathData(arguments[0]));return i.join(" ")},_contains:function(n){for(var i=[],r,t=0,u=this._children.length;t<u;t++)r=this._children[t],r.contains(n)&&i.push(r);return(i.length&1)==1&&i},_hitTest:function ni(t,i){var r=ni.base.call(this,t,n.merge(i,{fill:!1}));return!r&&i.fill&&this.hasFill()&&(r=this._contains(t),r=r?new d("fill",r[0]):null),r},_draw:function(n,t){var r=this._children,u=this._style,i,f;if(r.length!==0){for(n.beginPath(),t=t.extend({compound:!0}),i=0,f=r.length;i<f;i++)r[i].draw(n,t);t.clip||(this._setStyles(n),u.getFillColor()&&n.fill(),u.getStrokeColor()&&n.stroke())}}},new function(){function i(n){if(!n._children.length)throw new Error("Use a moveTo() command first");return n._children[n._children.length-1]}var r={moveTo:function(){var n=new c;this.addChild(n),n.moveTo.apply(n,arguments)},moveBy:function(){this.moveTo(i(this).getLastSegment()._point.add(t.read(arguments)))},closePath:function(){i(this).closePath()}};return n.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","curveBy","arcBy"],function(n){r[n]=function(){var t=i(this);t[n].apply(t,arguments)}}),r}),ii=n.extend({initialize:function(n){function o(n,t){var i=r.getValues(n,t);e.curves.push(i),e._computeParts(i,n._index,0,1)}var u,s;this.curves=[],this.parts=[],this.length=0,this.index=0;var t=n._segments,f=t[0],i,e=this;for(u=1,s=t.length;u<s;u++)i=t[u],o(f,i),f=i;n._closed&&o(i,t[0])},_computeParts:function(n,t,i,u){var f,e;if(u-i>1/32&&!r.isFlatEnough(n,.25))f=r.subdivide(n),e=(i+u)/2,this._computeParts(f[0],t,i,e),this._computeParts(f[1],t,e,u);else{var o=n[6]-n[0],s=n[7]-n[1],h=Math.sqrt(o*o+s*s);h>1e-5&&(this.length+=h,this.parts.push({offset:this.length,value:u,index:t}))}},getParameterAt:function(n){for(var i,u=this.index,f,t;;)if(i=u,u==0||this.parts[--u].offset<n)break;for(f=this.parts.length;i<f;i++)if(t=this.parts[i],t.offset>=n){this.index=i;var r=this.parts[i-1],e=r&&r.index==t.index?r.value:0,o=r?r.offset:0;return{value:e+(t.value-e)*(n-o)/(t.offset-o),index:t.index}}return t=this.parts[this.parts.length-1],{value:1,index:t.index}},evaluate:function(n,t){var i=this.getParameterAt(n);return r.evaluate(this.curves[i.index],i.value,t)},drawPart:function(n,t,i){var u,f;for(t=this.getParameterAt(t),i=this.getParameterAt(i),u=t.index;u<=i.index;u++)f=r.getPart(this.curves[u],u==t.index?t.value:0,u==i.index?i.value:1),u==t.index&&n.moveTo(f[0],f[1]),n.bezierCurveTo.apply(n,f.slice(2))}}),gi=n.extend({initialize:function(n,t){var u,f,i,e,r;for(this.points=[],u=n._segments,i=0,e=u.length;i<e;i++)r=u[i].point.clone(),f&&f.equals(r)||(this.points.push(r),f=r);this.error=t},fit:function(){var n=this.points,t=n.length;return this.segments=t>0?[new u(n[0])]:[],t>1&&this.fitCubic(0,t-1,n[1].subtract(n[0]).normalize(),n[t-2].subtract(n[t-1]).normalize()),this.segments},fitCubic:function(n,t,i,r){var e,c,u,l,o,f;if(t-n==1){var s=this.points[n],h=this.points[t],a=s.getDistance(h)/3;this.addCurve([s,s.add(i.normalize(a)),h.add(r.normalize(a)),h]);return}for(e=this.chordLengthParameterize(n,t),c=Math.max(this.error,this.error*this.error),l=0;l<=4;l++){if(o=this.generateBezier(n,t,e,i,r),f=this.findMaxError(n,t,o,e),f.error<this.error){this.addCurve(o);return}if(u=f.index,f.error>=c)break;this.reparameterize(n,t,e,o),c=f.error}var y=this.points[u-1].subtract(this.points[u]),p=this.points[u].subtract(this.points[u+1]),v=y.add(p).divide(2).normalize();this.fitCubic(n,u,i,v),this.fitCubic(u,t,v.negate(),r)},addCurve:function(n){var t=this.segments[this.segments.length-1];t.setHandleOut(n[1].subtract(n[0])),this.segments.push(new u(n[3],n[2].subtract(n[3])))},generateBezier:function(n,t,i,r,u){for(var s=1e-11,v=this.points[n],y=this.points[t],f=[[0,0],[0,0]],e=[0,0],b,a,o,ft,et,k,d,g,c=0,nt=t-n+1;c<nt;c++){var h=i[c],l=1-h,tt=3*h*l,ot=l*l*l,it=tt*l,rt=tt*h,st=h*h*h,p=r.normalize(it),w=u.normalize(rt),ut=this.points[n+c].subtract(v.multiply(ot+it)).subtract(y.multiply(rt+st));f[0][0]+=p.dot(p),f[0][1]+=p.dot(w),f[1][0]=f[0][1],f[1][1]+=w.dot(w),e[0]+=p.dot(ut),e[1]+=w.dot(ut)}return b=f[0][0]*f[1][1]-f[1][0]*f[0][1],Math.abs(b)>s?(ft=f[0][0]*e[1]-f[1][0]*e[0],et=e[0]*f[1][1]-e[1]*f[0][1],a=et/b,o=ft/b):(k=f[0][0]+f[0][1],d=f[1][0]+f[1][1],a=Math.abs(k)>s?o=e[0]/k:Math.abs(d)>s?o=e[1]/d:o=0),g=y.getDistance(v),s*=g,(a<s||o<s)&&(a=o=g/3),[v,v.add(r.normalize(a)),y.add(u.normalize(o)),y]},reparameterize:function(n,t,i,r){for(var u=n;u<=t;u++)i[u-n]=this.findRoot(r,this.points[u],i[u-n])},findRoot:function(n,t,i){for(var u=[],e=[],r=0;r<=2;r++)u[r]=n[r+1].subtract(n[r]).multiply(3);for(r=0;r<=1;r++)e[r]=u[r+1].subtract(u[r]).multiply(2);var h=this.evaluate(3,n,i),f=this.evaluate(2,u,i),c=this.evaluate(1,e,i),o=h.subtract(t),s=f.dot(f)+o.dot(c);return Math.abs(s)<1e-5?i:i-o.dot(f)/s},evaluate:function(n,t,i){for(var u=t.slice(),r,f=1;f<=n;f++)for(r=0;r<=n-f;r++)u[r]=u[r].multiply(1-i).add(u[r+1].multiply(i));return u[0]},chordLengthParameterize:function(n,t){for(var r=[0],u,i=n+1;i<=t;i++)r[i-n]=r[i-n-1]+this.points[i].getDistance(this.points[i-1]);for(i=1,u=t-n;i<=u;i++)r[i]/=r[u];return r},findMaxError:function(n,t,i,r){for(var o=Math.floor((t-n+1)/2),e=0,u=n+1;u<t;u++){var h=this.evaluate(3,i,r[u-n]),f=h.subtract(this.points[u]),s=f.x*f.x+f.y*f.y;s>=e&&(e=s,o=u)}return{error:e,index:o}}});at.inject(new function(){function i(n,t){var i,r;for(n.sort(function(n,t){var i=n.getPath(),r=t.getPath();return i===r?n.getIndex()+n.getParameter()-(t.getIndex()+t.getParameter()):i._id-r._id}),i=t&&[],r=n.length-1;r>=0;r--){var u=n[r],f=u.getIntersection(),e=u.divide(),o=e&&e.getSegment1()||u.getSegment();i&&i.push(f),o._intersection=f}return i}function r(n){var t,i;if(n instanceof rt){var u=n._children,r=u.length,f=new Array(r),e=new Array(r),o=u[0].isClockwise();for(t=0;t<r;t++)f[t]=u[t].getBounds(),e[t]=0;for(t=0;t<r;t++){for(i=1;i<r;i++)t!==i&&f[t].contains(f[i])&&e[i]++;t>0&&e[t]%2==0&&u[t].setClockwise(o)}}return n}function n(n,e,o,s){var y,a,v,h,w,g;n=r(n.clone(!1)),e=r(e.clone(!1));var ot=n.isClockwise(),b=e.isClockwise(),st=n.getIntersections(e);i(i(st,!0)),s&&(e.reverse(),b=!b);var nt=[].concat(n._children||[n]).concat(e._children||[e]),k=[],tt=new rt;for(a=0,v=nt.length;a<v;a++){var l=nt[a],it=l._parent,ut=l.isClockwise(),ft=l._segments;for(l=it instanceof rt?it:l,y=ft.length-1;y>=0;y--){var h=ft[y],p=h.getCurve().getPoint(.5),ht=l!==n&&n.contains(p)&&(ut===ot||s||!f(n,p)),ct=l!==e&&e.contains(p)&&(ut===b||!f(e,p));o(l===n,ht,ct)?h._invalid=!0:k.push(h)}}for(a=0,v=k.length;a<v;a++)if(h=k[a],!h._visited){var l=new c,et=h._intersection,d=et&&et.getSegment(!0);h.getPrevious()._invalid&&h.setHandleIn(d?d._handleIn:new t(0,0));do h._visited=!0,h._invalid&&h._intersection?(w=h._intersection.getSegment(!0),l.add(new u(h._point,h._handleIn,w._handleOut)),w._visited=!0,h=w):l.add(h.clone()),h=h.getNext();while(h&&!h._visited&&h!==d);g=l._segments.length,g>1&&(g>2||!l.isPolygon())?(l.setClosed(!0),tt.addChild(l,!0)):l.remove()}return n.remove(),e.remove(),tt.reduce()}function f(n,t){var u=n.getCurves(),e=n.getBounds(),i,f,r;if(e.contains(t))for(i=0,f=u.length;i<f;i++)if(r=u[i],r.getBounds().contains(t)&&r.getParameterOf(t))return!0;return!1}return{unite:function(t){return n(this,t,function(n,t,i){return t||i})},intersect:function(t){return n(this,t,function(n,t,i){return!(t||i)})},subtract:function(t){return n(this,t,function(n,t,i){return n&&i||!n&&!t},!0)},exclude:function(n){return new g([this.subtract(n),n.subtract(this)])},divide:function(n){return new g([this.subtract(n),this.intersect(n)])}}});var wt=k.extend({_class:"TextItem",_boundsSelected:!0,_serializeFields:{content:null},_boundsGetter:"getBounds",initialize:function(i){this._content="",this._lines=[];var r=i&&n.isPlainObject(i)&&i.x===undefined&&i.y===undefined;this._initialize(r&&i,!r&&t.read(arguments))},_clone:function nr(n){return n.setContent(this._content),nr.base.call(this,n)},getContent:function(){return this._content},setContent:function(n){this._content=""+n,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(69)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),ri=wt.extend({_class:"PointText",initialize:function(){wt.apply(this,arguments)},clone:function(n){return this._clone(new ri({insert:!1}),n)},getPoint:function(){var n=this._matrix.getTranslation();return new ft(n.x,n.y,this,"setPoint")},setPoint:function(n){n=t.read(arguments),this.translate(n.subtract(this._matrix.getTranslation()))},_draw:function(n){var i,f,r;if(this._content){this._setStyles(n);var t=this._style,u=this._lines,e=t.getLeading();for(n.font=t.getFontStyle(),n.textAlign=t.getJustification(),i=0,f=u.length;i<f;i++)r=u[i],t.getFillColor()&&n.fillText(r,0,0),t.getStrokeColor()&&n.strokeText(r,0,0),n.translate(0,e)}}},new function(){var n=null;return{_getBounds:function(t,i){var r,u,e;n||(n=p.getContext(1,1));var o=this._style,h=this._lines,s=h.length,c=o.getJustification(),l=o.getLeading(),a=0;for(n.font=o.getFontStyle(),r=0,u=0;u<s;u++)r=Math.max(r,n.measureText(h[u]).width);return c!=="left"&&(a-=r/(c==="center"?2:1)),e=new f(a,s?-.75*l:0,r,s*l),i?i._transformBounds(e,e):e}}}),v=n.extend(new function(){function o(n){var i=e[n],t;return i||(r||(r=p.getContext(1,1),r.globalCompositeOperation="copy"),r.fillStyle="rgba(0,0,0,0)",r.fillStyle=n,r.fillRect(0,0,1,1),t=r.getImageData(0,0,1,1).data,i=e[n]=[t[0]/255,t[1]/255,t[2]/255]),i.slice()}function s(n){var u=n.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/),r,t,i;if(u.length>=4){for(r=[0,0,0],t=0;t<3;t++)i=u[t+1],r[t]=parseInt(i.length==1?i+i:i,16)/255;return r}}var i={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},u={},e={},r,h=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],f={"rgb-hsb":function(n,t,i){var r=Math.max(n,t,i),f=Math.min(n,t,i),u=r-f,e=u===0?0:(r==n?(t-i)/u+(t<i?6:0):r==t?(i-n)/u+2:(n-t)/u+4)*60;return[e,r===0?0:u/r,r]},"hsb-rgb":function(n,t,i){var n=n/60%6,r=Math.floor(n),f=n-r,r=h[r],u=[i,i*(1-t),i*(1-t*f),i*(1-t*(1-f))];return[u[r[0]],u[r[1]],u[r[2]]]},"rgb-hsl":function(n,t,i){var r=Math.max(n,t,i),f=Math.min(n,t,i),u=r-f,e=u===0,s=e?0:(r==n?(t-i)/u+(t<i?6:0):r==t?(i-n)/u+2:(n-t)/u+4)*60,o=(r+f)/2,h=e?0:o<.5?u/(r+f):u/(2-r-f);return[s,h,o]},"hsl-rgb":function(n,t,i){var f,r;if(n/=360,t===0)return[i,i,i];var s=[n+1/3,n,n-1/3],e=i<.5?i*(1+t):i+t-i*t,u=2*i-e,o=[];for(f=0;f<3;f++)r=s[f],r<0&&(r+=1),r>1&&(r-=1),o[f]=6*r<1?u+(e-u)*6*r:2*r<1?e:3*r<2?u+(e-u)*(2/3-r)*6:u;return o},"rgb-gray":function(n,t,i){return[n*.2989+t*.587+i*.114]},"gray-rgb":function(n){return[n,n,n]},"gray-hsb":function(n){return[0,0,n]},"gray-hsl":function(n){return[0,0,n]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return n.each(i,function(r,f){u[f]=[],n.each(r,function(r,e){var o=n.capitalize(r),s=/^(hue|saturation)$/.test(r),h=u[f][e]=r==="gradient"?function(n){var t=this._components[0];return n=ot.read(Array.isArray(n)?n:arguments,0,0,{readNull:!0}),t!==n&&(t&&t._removeOwner(this),n&&n._addOwner(this)),n}:r==="hue"?function(n){return isNaN(n)?0:(n%360+360)%360}:f==="gradient"?function(){return t.read(arguments,0,0,{readNull:r==="highlight",clone:!0})}:function(n){return isNaN(n)?0:Math.min(Math.max(n,0),1)};this["get"+o]=function(){return this._type===f||s&&/^hs[bl]$/.test(this._type)?this._components[e]:this._convert(f)[e]},this["set"+o]=function(n){this._type===f||s&&/^hs[bl]$/.test(this._type)||(this._components=this._convert(f),this._properties=i[f],this._type=f),n=h.call(this,n),n!=null&&(this._components[e]=n,this._changed())}},this)},{_class:"Color",_readIndex:!0,initialize:function v(n){var nt=Array.prototype.slice,c=arguments,b=0,k=!0,r,f,y,h,a,p,d,g,w,t,l,e;if(Array.isArray(n)&&(c=n,n=c[0]),a=n!=null&&typeof n,a==="string"&&n in i&&(r=n,n=c[1],Array.isArray(n)?(f=n,y=c[2]):(this.__read&&(b=1),c=nt.call(c,1),a=typeof n)),!f){if(k=!(this.__options&&this.__options.dontParse),h=a==="number"?c:a==="object"&&n.length!=null?n:null,h)r||(r=h.length>=3?"rgb":"gray"),p=i[r].length,y=h[p],this.__read&&(b+=h===arguments?p+(y!=null?1:0):1),h.length>p&&(h=nt.call(h,0,p));else if(a==="string")f=n.match(/^#[0-9a-f]{3,6}$/i)?s(n):o(n),r="rgb";else if(a==="object")if(n.constructor===v){if(r=n._type,f=n._components.slice(),y=n._alpha,r==="gradient")for(t=1,l=f.length;t<l;t++)d=f[t],d&&(f[t]=d.clone())}else if(n.constructor===ot)r="gradient",h=c;else{for(r=("hue"in n)?("lightness"in n)?"hsl":"hsb":("gradient"in n)||("stops"in n)||("radial"in n)?"gradient":("gray"in n)?"gray":"rgb",g=i[r],w=k&&u[r],this._components=f=[],t=0,l=g.length;t<l;t++)e=n[g[t]],e==null&&t===0&&r==="gradient"&&"stops"in n&&(e={stops:n.stops,radial:n.radial}),k&&(e=w[t].call(this,e)),e!=null&&(f[t]=e);y=n.alpha}this.__read&&r&&(b=1)}if(this._type=r||"rgb",r==="gradient"&&(this._id=v._id=(v._id||0)+1),!f)for(this._components=f=[],w=u[this._type],t=0,l=w.length;t<l;t++)e=h&&h[t],k&&(e=w[t].call(this,e)),e!=null&&(f[t]=e);this._components=f,this._properties=i[this._type],this._alpha=y,this.__read&&(this.__read=b)},_serialize:function(t,i){var r=this.getComponents();return n.serialize(/^(gray|rgb)$/.test(this._type)?r:[this._type].concat(r),t,!0,i)},_changed:function(){this._canvasStyle=null,this._owner&&this._owner._changed(17)},clone:function(){return new v(this._type,this._components.slice(),this._alpha)},_convert:function(n){var t;return this._type===n?this._components.slice():(t=f[this._type+"-"+n])?t.apply(this,this._components):f["rgb-"+n].apply(this,f[this._type+"-rgb"].apply(this,this._components))},convert:function(n){return new v(n,this._convert(n),this._alpha)},getType:function(){return this._type},setType:function(n){this._components=this._convert(n),this._properties=i[n],this._type=n},getComponents:function(){var n=this._components.slice();return this._alpha!=null&&n.push(this._alpha),n},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(n){this._alpha=n==null?null:Math.min(Math.max(n,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(t){return n.isPlainValue(t)&&(t=v.read(arguments)),t===this||t&&this._type===t._type&&this._alpha===t._alpha&&n.equals(this._components,t._components)||!1},toString:function(){for(var r=this._properties,i=[],e=this._type==="gradient",u=w.instance,t,n=0,f=r.length;n<f;n++)t=this._components[n],t!=null&&i.push(r[n]+": "+(e?t:u.number(t)));return this._alpha!=null&&i.push("alpha: "+u.number(this._alpha)),"{ "+i.join(", ")+" }"},toCSS:function(n){var t=this._convert("rgb"),i=n||this._alpha==null?1:this._alpha;return t=[Math.round(t[0]*255),Math.round(t[1]*255),Math.round(t[2]*255)],i<1&&t.push(i),(t.length==4?"rgba(":"rgb(")+t.join(",")+")"},toCanvasStyle:function(n){var f,i,s,h,e,v,c;if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var r=this._components,l=r[0],a=l._stops,t=r[1],o=r[2],u;for(l._radial?(f=o.getDistance(t),i=r[3],i&&(s=i.subtract(t),s.getLength()>f&&(i=t.add(s.normalize(f-.1)))),h=i||t,u=n.createRadialGradient(h.x,h.y,0,t.x,t.y,f)):u=n.createLinearGradient(t.x,t.y,o.x,o.y),e=0,v=a.length;e<v;e++)c=a[e],u.addColorStop(c._rampPoint,c._color.toCanvasStyle());return this._canvasStyle=u},transform:function(n){var i,t,u,r;if(this._type==="gradient"){for(i=this._components,t=1,u=i.length;t<u;t++)r=i[t],n._transformPoint(r,r,!0);this._changed()}},statics:{_types:i,random:function(){var n=Math.random;return new v(n(),n(),n())}}})},new function(){function t(n,t){return n<0?0:t&&n>360?360:!t&&n>1?1:n}var i={add:function(n,i,r){return t(n+i,r)},subtract:function(n,i,r){return t(n-i,r)},multiply:function(n,i,r){return t(n*i,r)},divide:function(n,i,r){return t(n/i,r)}};return n.each(i,function(n,t){var i={dontParse:/^(multiply|divide)$/.test(t)};this[t]=function(t){var r,o;t=v.read(arguments,0,0,i);var f=this._type,s=this._properties,e=this._components,u=t._convert(f);for(r=0,o=e.length;r<o;r++)u[r]=n(e[r],u[r],s[r]==="hue");return new v(f,u,this._alpha!=null?n(this._alpha,t.getAlpha()):null)}},{})});n.each(v._types,function(t,i){var u=this[n.capitalize(i)+"Color"]=function(n){var t=n!=null&&typeof n,r=t==="object"&&n.length!=null?n:t==="string"?null:arguments;return r?new v(i,r):new v(n)},r;i.length==3&&(r=i.toUpperCase(),v[r]=this[r+"Color"]=u)},n.exports);var ot=n.extend({_class:"Gradient",initialize:function ot(n,t){this._id=ot._id=(ot._id||0)+1,n&&this._set(n)&&(n=t=null),this._stops||this.setStops(n||["white","black"]),this._radial==null&&this.setRadial(typeof t=="string"&&t==="radial"||t||!1)},_serialize:function(t,i){return i.add(this,function(){return n.serialize([this._stops,this._radial],t,!0,i)})},_changed:function(){for(var n=0,t=this._owners&&this._owners.length;n<t;n++)this._owners[n]._changed()},_addOwner:function(n){this._owners||(this._owners=[]),this._owners.push(n)},_removeOwner:function(n){var t=this._owners?this._owners.indexOf(n):-1;t!=-1&&(this._owners.splice(t,1),this._owners.length===0&&delete this._owners)},clone:function(){for(var t=[],n=0,i=this._stops.length;n<i;n++)t[n]=this._stops[n].clone();return new this.constructor(t)},getStops:function(){return this._stops},setStops:function(n){var t,i,r;if(this.stops)for(t=0,i=this._stops.length;t<i;t++)delete this._stops[t]._owner;if(n.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");for(this._stops=vt.readAll(n,0,!1,!0),t=0,i=this._stops.length;t<i;t++)r=this._stops[t],r._owner=this,r._defaultRamp&&r.setRampPoint(t/(i-1));this._changed()},getRadial:function(){return this._radial},setRadial:function(n){this._radial=n,this._changed()},equals:function(n){if(n&&n.constructor==this.constructor&&this._stops.length==n._stops.length){for(var t=0,i=this._stops.length;t<i;t++)if(!this._stops[t].equals(n._stops[t]))return!1;return!0}return!1}}),vt=n.extend({_class:"GradientStop",initialize:function(n,t){if(n){var i,r;t===undefined&&Array.isArray(n)?(i=n[0],r=n[1]):n.color?(i=n.color,r=n.rampPoint):(i=n,r=t),this.setColor(i),this.setRampPoint(r)}},clone:function(){return new vt(this._color.clone(),this._rampPoint)},_serialize:function(t,i){return n.serialize([this._color,this._rampPoint],t,!0,i)},_changed:function(){this._owner&&this._owner._changed(17)},getRampPoint:function(){return this._rampPoint},setRampPoint:function(n){this._defaultRamp=n==null,this._rampPoint=n||0,this._changed()},getColor:function(){return this._color},setColor:function(n){this._color=v.read(arguments),this._color===n&&(this._color=n.clone()),this._color._owner=this,this._changed()},equals:function(n){return n===this||n instanceof vt&&this._color.equals(n._color)&&this._rampPoint==n._rampPoint||!1}}),bt=n.extend(new function(){var i={fillColor:undefined,strokeColor:undefined,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",miterLimit:10,dashOffset:0,dashArray:[],shadowColor:undefined,shadowBlur:0,shadowOffset:new t,selectedColor:undefined,font:"sans-serif",fontSize:12,leading:null,justification:"left"},f={strokeWidth:25,strokeCap:25,strokeJoin:25,miterLimit:25,font:5,fontSize:5,leading:5,justification:5},r={},u={_defaults:i,_textDefaults:n.merge(i,{fillColor:new v})};return n.each(i,function(t,i){var s=/Color$/.test(i),h=n.capitalize(i),c=f[i],e="set"+h,o="get"+h;u[e]=function(n){var t=this._item&&this._item._children,r,f,u;if(t&&t.length>0&&this._item._type!=="compound-path")for(r=0,f=t.length;r<f;r++)t[r]._style[e](n);else u=this._values[i],u!=n&&(s&&(u&&delete u._owner,n&&n.constructor===v&&(n._owner=this._item)),this._values[i]=n,this._item&&this._item._changed(c||17))},u[o]=function(){var u=this._item&&this._item._children,t,r,e,f;if(!u||u.length===0||arguments[0]||this._item._type==="compound-path")return t=this._values[i],t===undefined?(t=this._defaults[i],t&&t.clone&&(t=t.clone()),this._values[i]=t):!s||t&&t.constructor===v||(this._values[i]=t=v.read([t],0,0,{readNull:!0,clone:!0}),t&&(t._owner=this._item)),t;for(r=0,e=u.length;r<e;r++)if(f=u[r]._style[o](),r===0)t=f;else if(!n.equals(t,f))return undefined;return t},r[o]=function(){return this._style[o]()},r[e]=function(n){this._style[e](n)}}),k.inject(r),u},{_class:"Style",initialize:function(n,t){this._values={},this._item=t,t instanceof wt&&(this._defaults=this._textDefaults),n&&this.set(n)},set:function(n){var u=n instanceof bt,r=u?n._values:n,i,t;if(r)for(i in r)i in this._defaults&&(t=r[i],this[i]=t&&u&&t.clone?t.clone():t)},getLeading:function tr(){var n=tr.base.call(this);return n!=null?n:this.getFontSize()*1.2},getFontStyle:function(){var n=this.getFontSize();return(/[a-z]/i.test(n)?n+" ":n+"px ")+this.getFont()}}),o=new function(){function r(t,i){for(var e=[],u,f=0,s=t&&t.length;f<s;){if(u=t[f++],typeof u=="string")u=document.createElement(u);else if(!u||!u.nodeType)continue;n.isPlainObject(t[f])&&o.set(u,t[f++]),Array.isArray(t[f])&&r(t[f++],u),i&&i.appendChild(u),e.push(u)}return e}var i=/^(checked|value|selected|disabled)$/i,t={text:"textContent",html:"innerHTML"},u={lineHeight:1,zoom:1,zIndex:1,opacity:1};return{create:function(n,t){var u=Array.isArray(n),i=r(u?n:arguments,u?t:null);return i.length==1?i[0]:i},find:function(n,t){return(t||document).querySelector(n)},findAll:function(n,t){return(t||document).querySelectorAll(n)},get:function(n,r){return n?i.test(r)?r==="value"||typeof n[r]!="string"?n[r]:!0:r in t?n[t[r]]:n.getAttribute(r):null},set:function(n,r,u){if(typeof r!="string")for(var f in r)r.hasOwnProperty(f)&&this.set(n,f,r[f]);else if(n&&u!==undefined)i.test(r)?n[r]=u:r in t?n[t[r]]=u:r==="style"?this.setStyle(n,u):r==="events"?a.add(n,u):n.setAttribute(r,u);else return n;return n},getStyles:function(n){var t=n&&n.ownerDocument.defaultView;return t&&t.getComputedStyle(n,"")},getStyle:function(n,t){return n&&n.style[t]||this.getStyles(n)[t]||null},setStyle:function(n,t,i){if(typeof t!="string")for(var r in t)t.hasOwnProperty(r)&&this.setStyle(n,r,t[r]);else!/^-?[\d\.]+$/.test(i)||t in u||(i+="px"),n.style[t]=i;return n},hasClass:function(n,t){return new RegExp("\\s*"+t+"\\s*").test(n.className)},addClass:function(n,t){n.className=(n.className+" "+t).trim()},removeClass:function(n,t){n.className=n.className.replace(new RegExp("\\s*"+t+"\\s*")," ").trim()},remove:function(n){n.parentNode&&n.parentNode.removeChild(n)},removeChildren:function(n){while(n.firstChild)n.removeChild(n.firstChild)},getBounds:function(n,t){var e=n.ownerDocument,r=e.body,u=e.documentElement,i,o,s,h;try{i=n.getBoundingClientRect()}catch(c){i={left:0,top:0,width:0,height:0}}return o=i.left-(u.clientLeft||r.clientLeft||0),s=i.top-(u.clientTop||r.clientTop||0),t||(h=e.defaultView,o+=h.pageXOffset||u.scrollLeft||r.scrollLeft,s+=h.pageYOffset||u.scrollTop||r.scrollTop),new f(o,s,i.width,i.height)},getViewportBounds:function(n){var t=n.ownerDocument,i=t.defaultView,r=t.documentElement;return new f(0,0,i.innerWidth||r.clientWidth,i.innerHeight||r.clientHeight)},getOffset:function(n,t){return this.getBounds(n,t).getPoint()},getSize:function(n){return this.getBounds(n,!0).getSize()},isInvisible:function(n){return this.getSize(n).equals(new e(0,0))},isInView:function(n){return!this.isInvisible(n)&&this.getViewportBounds(n).intersects(this.getBounds(n,!0))}}},a={add:function(n,t){var i,r;for(i in t)r=t[i],n.addEventListener?n.addEventListener(i,r,!1):n.attachEvent&&n.attachEvent("on"+i,r.bound=function(){r.call(n,window.event)})},remove:function(n,t){var i,r;for(i in t)r=t[i],n.removeEventListener?n.removeEventListener(i,r,!1):n.detachEvent&&n.detachEvent("on"+i,r.bound)},getPoint:function(n){var i=n.targetTouches?n.targetTouches.length?n.targetTouches[0]:n.changedTouches[0]:n;return new t(i.pageX||i.clientX+document.documentElement.scrollLeft,i.pageY||i.clientY+document.documentElement.scrollTop)},getTarget:function(n){return n.target||n.srcElement},getOffset:function(n,t){return a.getPoint(n).subtract(o.getOffset(t||a.getTarget(n)))},preventDefault:function(n){n.preventDefault?n.preventDefault():n.returnValue=!1},stopPropagation:function(n){n.stopPropagation?n.stopPropagation():n.cancelBubble=!0},stop:function(n){a.stopPropagation(n),a.preventDefault(n)}};a.requestAnimationFrame=new function(){var n="equestAnimationFrame",t=window["r"+n]||window["webkitR"+n]||window["mozR"+n]||window["oR"+n]||window["msR"+n],i,r,u;return t&&t(function(n){n==null&&(t=null)}),i=[],r=!0,a.add(window,{focus:function(){r=!0},blur:function(){r=!1}}),function(n,f){if(t)return t(n,f);(i.push([n,f]),u)||(u=setInterval(function(){for(var n=i.length-1;n>=0;n--){var u=i[n],f=u[0],t=u[1];(!t||(it.getAttribute(t,"keepalive")=="true"||r)&&o.isInView(t))&&(i.splice(n,1),f(Date.now()))}},1e3/60))}};var h=n.extend(ut,{_class:"View",initialize:function h(n){var t,i,u;if(this._scope=paper,this._project=paper.project,this._element=n,this._id=n.getAttribute("id"),this._id==null&&n.setAttribute("id",this._id="view-"+h._id++),a.add(n,this._viewHandlers),it.hasAttribute(n,"resize")?(i=o.getOffset(n,!0),u=this,t=o.getViewportBounds(n).getSize().subtract(i),this._windowHandlers={resize:function(){o.isInvisible(n)||(i=o.getOffset(n,!0)),u.setViewSize(o.getViewportBounds(n).getSize().subtract(i))}},a.add(window,this._windowHandlers)):(t=new e(parseInt(n.getAttribute("width"),10),parseInt(n.getAttribute("height"),10)),t.isNaN()&&(t=o.getSize(n))),n.width=t.width,n.height=t.height,it.hasAttribute(n,"stats")&&typeof Stats!="undefined"){this._stats=new Stats;var f=this._stats.domElement,r=f.style,i=o.getOffset(n);r.position="absolute",r.left=i.x+"px",r.top=i.y+"px",document.body.appendChild(f)}h._views.push(this),h._viewsById[this._id]=this,this._viewSize=new ct(t.width,t.height,this,"setViewSize"),this._matrix=new y,this._zoom=1,h._focused||(h._focused=this),this._frameItems={},this._frameItemCount=0},remove:function(){return this._project?(h._focused==this&&(h._focused=null),h._views.splice(h._views.indexOf(this),1),delete h._viewsById[this._id],this._project.view==this&&(this._project.view=null),a.remove(this._element,this._viewHandlers),a.remove(window,this._windowHandlers),this._element=this._project=null,this.detach("frame"),this._frameItems={},!0):!1},_events:{onFrame:{install:function(){this._requested||(this._animate=!0,this._requestFrame())},uninstall:function(){this._animate=!1}},onResize:{}},_animate:!1,_time:0,_count:0,_requestFrame:function(){var n=this;a.requestAnimationFrame(function(){(n._requested=!1,n._animate)&&(n._requestFrame(),n._handleFrame())},this._element),this._requested=!0},_handleFrame:function(){paper=this._scope;var t=Date.now()/1e3,i=this._before?t-this._before:0;this._before=t,this._handlingFrame=!0,this.fire("frame",n.merge({delta:i,time:this._time+=i,count:this._count++})),this._stats&&this._stats.update(),this._handlingFrame=!1,this.draw(!0)},_animateItem:function(n,t){var i=this._frameItems;t?(i[n._id]={item:n,time:0,count:0},++this._frameItemCount==1&&this.attach("frame",this._handleFrameItems)):(delete i[n._id],--this._frameItemCount==0&&this.detach("frame",this._handleFrameItems))},_handleFrameItems:function(t){var r,i;for(r in this._frameItems)i=this._frameItems[r],i.item.fire("frame",n.merge(t,{time:i.time+=t.delta,count:i.count++}))},_redraw:function(){(this._project._needsRedraw=!0,this._handlingFrame)||(this._animate?this._handleFrame():this.draw())},_transform:function(n){this._matrix.concatenate(n),this._bounds=null,this._inverse=null,this._redraw()},getElement:function(){return this._element},getViewSize:function(){return this._viewSize},setViewSize:function(n){n=e.read(arguments);var t=n.subtract(this._viewSize);t.isZero()||(this._element.width=n.width,this._element.height=n.height,this._viewSize.set(n.width,n.height,!0),this._bounds=null,this.fire("resize",{size:n,delta:t}),this._redraw())},getBounds:function(){return this._bounds||(this._bounds=this._getInverse()._transformBounds(new f(new t,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize(arguments[0])},getCenter:function(){return this.getBounds().getCenter(arguments[0])},setCenter:function(n){n=t.read(arguments),this.scrollBy(n.subtract(this.getCenter()))},getZoom:function(){return this._zoom},setZoom:function(n){this._transform((new y).scale(n/this._zoom,this.getCenter())),this._zoom=n},isVisible:function(){return o.isInView(this._element)},scrollBy:function(){this._transform((new y).translate(t.read(arguments).negate()))},projectToView:function(){return this._matrix._transformPoint(t.read(arguments))},viewToProject:function(){return this._getInverse()._transformPoint(t.read(arguments))},_getInverse:function(){return this._inverse||(this._inverse=this._matrix.inverted()),this._inverse}},{statics:{_views:[],_viewsById:{},_id:0,create:function(n){return typeof n=="string"&&(n=document.getElementById(n)),new ir(n)}}},new function(){function e(n){var t=a.getTarget(n);return t.getAttribute&&h._viewsById[t.getAttribute("id")]}function u(n,t){return n.viewToProject(a.getOffset(t,n._element))}function r(){var n,r,t;if(!h._focused||!h._focused.isVisible())for(n=0,r=h._views.length;n<r;n++)if(t=h._views[n],t&&t.isVisible()){h._focused=i=t;break}}function o(i){var r=h._focused=e(i),f=u(r,i);t=!0,r._onMouseDown&&r._onMouseDown(i,f),(n=r._scope._tool)&&n._onHandleEvent("mousedown",f,i),r.draw(!0)}function s(o){var s,c;(t||(s=e(o),s?(f=h._focused,h._focused=i=s):i&&i==h._focused&&(h._focused=f,r())),s=s||h._focused)&&(c=o&&u(s,o),s._onMouseMove&&s._onMouseMove(o,c),(n=s._scope._tool)&&n._onHandleEvent(t&&n.responds("mousedrag")?"mousedrag":"mousemove",c,o)&&a.stop(o),s.draw(!0))}function c(i){var r=h._focused,f;r&&t&&(f=u(r,i),curPoint=null,t=!1,r._onMouseUp&&r._onMouseUp(i,f),n&&n._onHandleEvent("mouseup",f,i)&&a.stop(i),r.draw(!0))}function l(n){t&&a.stop(n)}var n,f,i,t=!1;return a.add(document,{mousemove:s,mouseup:c,touchmove:s,touchend:c,selectstart:l,scroll:r}),a.add(window,{load:r}),{_viewHandlers:{mousedown:o,touchstart:o,selectstart:l},statics:{updateFocus:r}}}),ir=h.extend({_class:"CanvasView",initialize:function(n){if(!(n instanceof HTMLCanvasElement)){var t=e.read(arguments,1);t.isZero()&&(t=new e(1024,768)),n=p.getCanvas(t)}this._context=n.getContext("2d"),this._eventCounters={},h.call(this,n)},draw:function(n){if(n&&!this._project._needsRedraw)return!1;var t=this._context,i=this._viewSize;return t.clearRect(0,0,i._width+1,i._height+1),this._project.draw(t,this._matrix),this._project._needsRedraw=!1,!0}},new function(){function t(n,t,i,r,u,f){for(var e=r,o;e;){if(e.responds(n)&&(o||(o=new ur(n,t,i,r,u?i.subtract(u):null)),e.fire(n,o)&&(!f||o._stopped)))return!1;e=e.getParent()}return!0}function s(n,i,r,e,o){if(n._eventCounters[i]){var h=n._project,c=h.hitTest(e,{tolerance:h.options.hitTolerance||0,fill:!0,stroke:!0}),s=c&&c.item;if(s)return i==="mousemove"&&s!=u&&(o=e),i==="mousemove"&&f||t(i,r,e,s,o),s}}var e,i,r,n,h,u,f,o,c;return{_onMouseDown:function(t,u){var l=s(this,"mousedown",t,u);o=h==l&&Date.now()-c<300,n=h=l,e=i=r=u,f=n&&n.responds("mousedrag")},_onMouseUp:function(u,h){var l=s(this,"mouseup",u,h);f&&(i&&!i.equals(h)&&t("mousedrag",u,h,n,i),l!=n&&(r=h,t("mousemove",u,h,l,r))),l===n&&(c=Date.now(),(!o||t("doubleclick",u,e,l))&&t("click",u,e,l),o=!1),n=null,f=!1},_onMouseMove:function(f,e){n&&t("mousedrag",f,e,n,i);var o=s(this,"mousemove",f,e,r);i=r=e,o!==u&&(t("mouseleave",f,e,u),u=o,t("mouseenter",f,e,o))}}}),st=n.extend({_class:"Event",initialize:function(n){this.event=n},preventDefault:function(){this._prevented=!0,a.preventDefault(this.event)},stopPropagation:function(){this._stopped=!0,a.stopPropagation(this.event)},stop:function(){this.stopPropagation(),this.preventDefault()},getModifiers:function(){return ui.modifiers}}),rr=st.extend({_class:"KeyEvent",initialize:function(n,t,i,r){st.call(this,r),this.type=n?"keydown":"keyup",this.key=t,this.character=i},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),ui=new function(){function f(n,t,i,r){var s=String.fromCharCode(i),c=u[t]||s.toLowerCase(),l=n?"keydown":"keyup",f=h._focused,a=f&&f.isVisible()&&f._scope,o=a&&a._tool;e[c]=n,o&&o.responds(l)&&(o.fire(l,new rr(n,c,s,r)),f&&f.draw(!0))}var u={8:"backspace",9:"tab",13:"enter",16:"shift",17:"control",18:"option",19:"pause",20:"caps-lock",27:"escape",32:"space",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",46:"delete",91:"command",93:"command",224:"command"},t=n.merge({shift:!1,control:!1,option:!1,command:!1,capsLock:!1,space:!1}),i={},e={},r;return a.add(document,{keydown:function(e){var o=e.which||e.keyCode,s=u[o],h;s?((h=n.camelize(s))in t&&(t[h]=!0),i[o]=0,f(!0,o,null,e)):r=o},keypress:function(n){if(r!=null){var t=n.which||n.keyCode;i[r]=t,f(!0,r,t,n),r=null}},keyup:function(r){var e=r.which||r.keyCode,o=u[e],s;o&&(s=n.camelize(o))in t&&(t[s]=!1),i[e]!=null&&(f(!1,e,i[e],r),delete i[e])}}),{modifiers:t,isDown:function(n){return!!e[n]}}},ur=st.extend({_class:"MouseEvent",initialize:function(n,t,i,r,u){st.call(this,t),this.type=n,this.point=i,this.target=r,this.delta=u},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}});n.extend(ut,{_class:"Palette",_events:["onChange"],initialize:function(t,i,r){var e=o.find(".palettejs-panel")||o.find("body").appendChild(o.create("div",{"class":"palettejs-panel"})),f,u;this._element=e.appendChild(o.create("table",{"class":"palettejs-pane"})),this._title=t,r||(r={});for(f in this._components=i)u=i[f],u instanceof fi||(u.value==null&&(u.value=r[f]),u.name=f,u=i[f]=new fi(u)),this._element.appendChild(u._element),u._palette=this,r[f]===undefined&&(r[f]=u.value);this._values=n.each(r,function(t,u){var f=i[u];f&&n.define(r,u,{enumerable:!0,configurable:!0,get:function(){return f._value},set:function(n){f.setValue(n)}})}),window.paper&&paper.palettes.push(this)},reset:function(){for(var n in this._components)this._components[n].reset()},remove:function(){o.remove(this._element)}});var fi=n.extend(ut,{_class:"Component",_events:["onChange","onClick"],_types:{boolean:{type:"checkbox",value:"checked"},string:{type:"text"},number:{type:"number",number:!0},button:{type:"button"},text:{tag:"div",value:"text"},slider:{type:"range",number:!0},list:{tag:"select",options:function(){o.removeChildren(this._inputItem),o.create(n.each(this._options,function(n){this.push("option",{value:n,text:n})},[]),this._inputItem)}}},initialize:function(t){this._type=t.type in this._types?t.type:"options"in t?"list":"onClick"in t?"button":typeof t.value,this._info=this._types[this._type]||{type:this._type};var i=this,r=!1;this._inputItem=o.create(this._info.tag||"input",{type:this._info.type,events:{change:function(){i.setValue(o.get(this,i._info.value||"value")),r&&(i._palette.fire("change",i,i.name,i._value),i.fire("change",i._value))},click:function(){i.fire("click")}}}),this._element=o.create("tr",[this._labelItem=o.create("td"),"td",[this._inputItem]]),n.each(t,function(n,t){this[t]=n},this),this._defaultValue=this._value,r=!0},getType:function(){return this._type},getLabel:function(){return this._label},setLabel:function(n){this._label=n,o.set(this._labelItem,"text",n+":")},getOptions:function(){return this._options},setOptions:function(n){this._options=n,this._info.options&&this._info.options.call(this)},getValue:function(){return this._value},setValue:function(n){var t=this._info.value||"value";o.set(this._inputItem,t,n),n=o.get(this._inputItem,t),this._value=this._info.number?parseFloat(n,10):n},getRange:function(){return[parseFloat(o.get(this._inputItem,"min")),parseFloat(o.get(this._inputItem,"max"))]},setRange:function(n,t){var i=Array.isArray(n)?n:[n,t];o.set(this._inputItem,{min:i[0],max:i[1]})},getMin:function(){return this.getRange()[0]},setMin:function(n){this.setRange(n,this.getMax())},getMax:function(){return this.getRange()[1]},setMax:function(n){this.setRange(this.getMin(),n)},getStep:function(){return parseFloat(o.get(this._inputItem,"step"))},setStep:function(n){o.set(this._inputItem,"step",n)},reset:function(){this.setValue(this._defaultValue)}}),fr=st.extend({_class:"ToolEvent",_item:null,initialize:function(n,t,i){this.tool=n,this.type=t,this.event=i},_choosePoint:function(n,t){return n?n:t?t.clone():null},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(n){this._point=n},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(n){this._lastPoint=n},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(n){this._downPoint=n},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(n){this._middlePoint=n},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(n){this._delta=n},getCount:function(){return/^mouse(down|up)$/.test(this.type)?this.tool._downCount:this.tool._count},setCount:function(n){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=n},getItem:function(){var i,t,n;if(!this._item&&(i=this.tool._scope.project.hitTest(this.getPoint()),i)){for(t=i.item,n=t._parent;/^(group|compound-path)$/.test(n._type);)t=n,n=n._parent;this._item=t}return this._item},setItem:function(n){this._item=n},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),er=ht.extend({_class:"Tool",_list:"tools",_reference:"_tool",_events:["onActivate","onDeactivate","onEditOptions","onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onKeyDown","onKeyUp"],initialize:function(n){ht.call(this),this._firstMove=!0,this._count=0,this._downCount=0,this._set(n)},getMinDistance:function(){return this._minDistance},setMinDistance:function(n){this._minDistance=n,this._minDistance!=null&&this._maxDistance!=null&&this._minDistance>this._maxDistance&&(this._maxDistance=this._minDistance)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(n){this._maxDistance=n,this._minDistance!=null&&this._maxDistance!=null&&this._maxDistance<this._minDistance&&(this._minDistance=n)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(n){this._minDistance=n,this._maxDistance=n},_updateEvent:function(n,t,i,r,u,f,e){var o;if(!u){if(i!=null||r!=null){var c=i!=null?i:0,s=t.subtract(this._point),h=s.getLength();if(h<c)return!1;if(o=r!=null?r:0,o!=0)if(h>o)t=this._point.add(s.normalize(o));else if(e)return!1}if(f&&t.equals(this._point))return!1}this._lastPoint=u&&n=="mousemove"?t:this._point,this._point=t;switch(n){case"mousedown":this._lastPoint=this._downPoint,this._downPoint=this._point,this._downCount++;break;case"mouseup":this._lastPoint=this._downPoint}return this._count=u?0:this._count+1,!0},_fireEvent:function(n,t){var i=paper.project._removeSets,r,e,f,o,u;if(i&&(n==="mouseup"&&(i.mousedrag=null),r=i[n],r)){for(e in r){f=r[e];for(o in i)u=i[o],u&&u!=r&&delete u[f._id];f.remove()}i[n]=null}return this.responds(n)&&this.fire(n,new fr(this,n,t))},_onHandleEvent:function(n,t,i){var r,u,f;paper=this._scope,r=!1;switch(n){case"mousedown":this._updateEvent(n,t,null,null,!0,!1,!1),r=this._fireEvent(n,i);break;case"mousedrag":for(u=!1,f=!1;this._updateEvent(n,t,this.minDistance,this.maxDistance,!1,u,f);)r=this._fireEvent(n,i)||r,u=!0,f=!0;break;case"mouseup":!t.equals(this._point)&&this._updateEvent("mousedrag",t,this.minDistance,this.maxDistance,!1,!1,!1)&&(r=this._fireEvent("mousedrag",i)),this._updateEvent(n,t,null,this.maxDistance,!1,!1,!1),r=this._fireEvent(n,i)||r,this._updateEvent(n,t,null,null,!0,!1,!1),this._firstMove=!0;break;case"mousemove":while(this._updateEvent(n,t,this.minDistance,this.maxDistance,this._firstMove,!0,!1))r=this._fireEvent(n,i)||r,this._firstMove=!1}return r}}),p={canvases:[],getCanvas:function(n,t){var r=t===undefined?n:new e(n,t),i,u;return i=this.canvases.length?this.canvases.pop():document.createElement("canvas"),u=i.getContext("2d"),u.save(),i.width===r.width&&i.height===r.height?!0&&u.clearRect(0,0,r.width+1,r.height+1):(i.width=r.width,i.height=r.height),i},getContext:function(n,t){return this.getCanvas(n,t).getContext("2d")},release:function(n){var t=n.canvas?n.canvas:n;t.getContext("2d").restore(),this.canvases.push(t)}},kt=new function(){function v(n,t,i){return.2989*n+.587*t+.114*i}function y(n,t,i,r){var a=r-v(n,t,i),o,s,h;u=n+a,f=t+a,e=i+a;var r=v(u,f,e),y=c(u,f,e),p=l(u,f,e);y<0&&(o=r-y,u=r+(u-r)*r/o,f=r+(f-r)*r/o,e=r+(e-r)*r/o),p>255&&(s=255-r,h=p-r,u=r+(u-r)*s/h,f=r+(f-r)*s/h,e=r+(e-r)*s/h)}function d(n,t,i){return l(n,t,i)-c(n,t,i)}function g(n,t,i,r){var o=[n,t,i],s=l(n,t,i),h=c(n,t,i),a;h=h===n?0:h===t?1:2,s=s===n?0:s===t?1:2,a=c(h,s)===0?l(h,s)===1?2:1:0,o[s]>o[h]?(o[a]=(o[a]-o[h])*r/(o[s]-o[h]),o[s]=r):o[a]=o[s]=0,o[h]=0,u=o[0],f=o[1],e=o[2]}var c=Math.min,l=Math.max,w=Math.abs,o,s,h,b,t,i,r,k,u,f,e,nt={multiply:function(){u=t*o/255,f=i*s/255,e=r*h/255},screen:function(){u=t+o-t*o/255,f=i+s-i*s/255,e=r+h-r*h/255},overlay:function(){u=t<128?2*t*o/255:255-2*(255-t)*(255-o)/255,f=i<128?2*i*s/255:255-2*(255-i)*(255-s)/255,e=r<128?2*r*h/255:255-2*(255-r)*(255-h)/255},"soft-light":function(){var n=o*t/255;u=n+t*(255-(255-t)*(255-o)/255-n)/255,n=s*i/255,f=n+i*(255-(255-i)*(255-s)/255-n)/255,n=h*r/255,e=n+r*(255-(255-r)*(255-h)/255-n)/255},"hard-light":function(){u=o<128?2*o*t/255:255-2*(255-o)*(255-t)/255,f=s<128?2*s*i/255:255-2*(255-s)*(255-i)/255,e=h<128?2*h*r/255:255-2*(255-h)*(255-r)/255},"color-dodge":function(){u=t===0?0:o===255?255:c(255,255*t/(255-o)),f=i===0?0:s===255?255:c(255,255*i/(255-s)),e=r===0?0:h===255?255:c(255,255*r/(255-h))},"color-burn":function(){u=t===255?255:o===0?0:l(0,255-(255-t)*255/o),f=i===255?255:s===0?0:l(0,255-(255-i)*255/s),e=r===255?255:h===0?0:l(0,255-(255-r)*255/h)},darken:function(){u=t<o?t:o,f=i<s?i:s,e=r<h?r:h},lighten:function(){u=t>o?t:o,f=i>s?i:s,e=r>h?r:h},difference:function(){u=t-o,u<0&&(u=-u),f=i-s,f<0&&(f=-f),e=r-h,e<0&&(e=-e)},exclusion:function(){u=t+o*(255-t-t)/255,f=i+s*(255-i-i)/255,e=r+h*(255-r-r)/255},hue:function(){g(o,s,h,d(t,i,r)),y(u,f,e,v(t,i,r))},saturation:function(){g(t,i,r,d(o,s,h)),y(u,f,e,v(t,i,r))},luminosity:function(){y(t,i,r,v(o,s,h))},color:function(){y(o,s,h,v(t,i,r))},add:function(){u=c(t+o,255),f=c(i+s,255),e=c(r+h,255)},subtract:function(){u=l(t-o,0),f=l(i-s,0),e=l(r-h,0)},average:function(){u=(t+o)/2,f=(i+s)/2,e=(r+h)/2},negation:function(){u=255-w(255-o-t),f=255-w(255-s-i),e=255-w(255-h-r)}},tt=this.nativeModes=n.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(n){this[n]=!0},{}),a=p.getContext(1,1);n.each(nt,function(n,t){a.save();var i=t==="darken",r=!1;a.fillStyle=i?"#300":"#a00",a.fillRect(0,0,1,1),a.globalCompositeOperation=t,a.globalCompositeOperation===t&&(a.fillStyle=i?"#a00":"#300",a.fillRect(0,0,1,1),r=a.getImageData(0,0,1,1).data[0]!==(i?170:51)),tt[t]=r,a.restore()}),p.release(a),this.process=function(n,c,l,a,v){var w=c.canvas,ut=n==="normal",rt,y,et,d,g;if(ut||tt[n])l.save(),l.setTransform(1,0,0,1,0,0),l.globalAlpha=a,ut||(l.globalCompositeOperation=n),l.drawImage(w,v.x,v.y),l.restore();else{if(rt=nt[n],!rt)return;var ft=l.getImageData(v.x,v.y,w.width,w.height),p=ft.data,it=c.getImageData(0,0,w.width,w.height).data;for(y=0,et=p.length;y<et;y+=4)o=it[y],t=p[y],s=it[y+1],i=p[y+1],h=it[y+2],r=p[y+2],b=it[y+3],k=p[y+3],rt(),d=b*a/255,g=1-d,p[y]=d*u+g*t,p[y+1]=d*f+g*i,p[y+2]=d*e+g*r,p[y+3]=b*a+g*k;l.putImageData(ft,v.x,v.y)}}},ei=n.each({fillColor:["fill","color"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],font:["font-family","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","string"]},function(t,i){var u=n.capitalize(i),r=t[2];this[i]={type:t[1],property:i,attribute:t[0],toSVG:r,fromSVG:r&&n.each(r,function(n,t){this[n]=t},{}),get:"get"+u,set:"set"+u}},{}),oi={href:"http://www.w3.org/1999/xlink",xlink:"http://www.w3.org/2000/xmlns"};return new function(){function h(n,t){var u,i,f;for(u in t)i=t[u],f=oi[u],typeof i=="number"&&(i=r.number(i)),f?n.setAttributeNS(f,u,i):n.setAttribute(u,i);return n}function t(n,t){return h(document.createElementNS("http://www.w3.org/2000/svg",n),t)}function u(n,t,i){return n[t]._point.getDistance(n[i]._point)}function e(n,t){var i=n._matrix,f=i.getTranslation(),u={},h,e;if(t&&(i=i.shiftless(),h=i._inverseTransform(f),u.x=h.x,u.y=h.y,f=null),i.isIdentity())return u;if(e=i.decompose(),e&&!e.shearing){var o=[],l=e.rotation,c=e.scaling;f&&!f.isZero()&&o.push("translate("+r.point(f)+")"),s.isZero(c.x-1)&&s.isZero(c.y-1)||o.push("scale("+r.point(c)+")"),l&&o.push("rotate("+r.number(l)+")"),u.transform=o.join(" ")}else u.transform="matrix("+i.getValues().join(",")+")";return u}function g(n,t,i,r){var u=i==="rect"?t[1]._point.add(t[2]._point).divide(2):i==="roundrect"?t[3]._point.add(t[4]._point).divide(2):i==="circle"||i==="ellipse"?t[1]._point:null,f=u&&u.subtract(r).getAngle()+90;return s.isZero(f||0)?0:f}function nt(n,t){function r(n,i){var r=t[n],f=r.getNext(),u=t[i],e=u.getNext();return r._handleOut.isZero()&&f._handleIn.isZero()&&u._handleOut.isZero()&&e._handleIn.isZero()&&f._point.subtract(r._point).isColinear(e._point.subtract(u._point))}function i(n){var i=t[n],e=i.getNext(),r=i._handleOut,u=e._handleIn,o=s.KAPPA;if(r.isOrthogonal(u)){var h=i._point,c=e._point,f=new b(h,r,!0).intersect(new b(c,u,!0),!0);return f&&s.isZero(r.getLength()/f.subtract(h).getLength()-o)&&s.isZero(u.getLength()/f.subtract(c).getLength()-o)}}if(n.isPolygon())return t.length===4&&n._closed&&r(0,2)&&r(1,3)?"rect":t.length===0?"empty":t.length>=3?n._closed?"polygon":"polyline":"line";if(n._closed){if(t.length===8&&i(0)&&i(2)&&i(4)&&i(6)&&r(1,5)&&r(3,7))return"roundrect";if(t.length===4&&i(0)&&i(1)&&i(2)&&i(3))return s.isZero(u(t,0,2)-u(t,1,3))?"circle":"ellipse"}return"path"}function v(n){for(var v=e(n),c=n._children,s=t("g",v),r,u,f,i=0,l=c.length;i<l;i++)r=c[i],u=o(r),u&&(r.isClipMask()?(f=t("clipPath"),f.appendChild(u),a(r,f,"clip"),h(s,{"clip-path":"url(#"+f.id+")"})):s.appendChild(u));return s}function tt(n){var i=e(n,!0),r=n.getSize();return i.x-=r.width/2,i.y-=r.height/2,i.width=r.width,i.height=r.height,i.href=n.toDataURL(),t("image",i)}function it(n){var f=n._segments,e=n.getPosition(!0),a=nt(n,f),s=g(n,f,a,e),o,b,k,d,tt,rt,c,w;switch(a){case"empty":return null;case"path":b=n.getPathData(),o=b&&{d:b};break;case"polyline":case"polygon":for(k=[],i=0,l=f.length;i<l;i++)k.push(r.point(f[i]._point));o={points:k.join(" ")};break;case"rect":var v=u(f,0,3),p=u(f,0,1),h=f[1]._point.rotate(-s,e);o={x:h.x,y:h.y,width:v,height:p};break;case"roundrect":a="rect";var v=u(f,1,6),p=u(f,0,3),c=(v-u(f,0,7))/2,w=(p-u(f,1,2))/2,it=f[3]._point,ut=f[4]._point,h=it.subtract(ut.subtract(it).normalize(c)).rotate(-s,e);o={x:h.x,y:h.y,width:v,height:p,rx:c,ry:w};break;case"line":d=f[0]._point,tt=f[f.length-1]._point,o={x1:d.x,y1:d.y,x2:tt.x,y2:tt.y};break;case"circle":rt=u(f,0,2)/2,o={cx:e.x,cy:e.y,r:rt};break;case"ellipse":c=u(f,2,0)/2,w=u(f,3,1)/2,o={cx:e.x,cy:e.y,rx:c,ry:w}}return s&&(o.transform="rotate("+r.number(s)+","+r.point(e)+")",n._gradientMatrix=(new y).rotate(-s,e)),t(a,o)}function rt(n){var i=e(n,!0),r=n.getPathData();return r&&(i.d=r),t("path",i)}function ut(n){var i=e(n,!0),f=n.getSymbol(),u=c(f,"symbol");return definition=f.getDefinition(),bounds=definition.getBounds(),u||(u=t("symbol",{viewBox:r.rectangle(bounds)}),u.appendChild(o(definition)),a(f,u,"symbol")),i.href="#"+u.id,i.x+=bounds.x,i.y+=bounds.y,i.width=r.number(bounds.width),i.height=r.number(bounds.height),t("use",i)}function ft(n,i){var f=c(n,"color"),u,l,o,p;if(!f){var v=n.getGradient(),y=v._radial,s=i._gradientMatrix,e=n.getOrigin().transform(s),h=n.getDestination().transform(s),r;for(y?(r={cx:e.x,cy:e.y,r:e.getDistance(h)},u=n.getHighlight(),u&&(u=u.transform(s),r.fx=u.x,r.fy=u.y)):r={x1:e.x,y1:e.y,x2:h.x,y2:h.y},r.gradientUnits="userSpaceOnUse",f=t((y?"radial":"linear")+"Gradient",r),l=v._stops,o=0,p=l.length;o<p;o++){var w=l[o],b=w._color,k=b.getAlpha();r={offset:w._rampPoint,"stop-color":b.toCSS(!0)},k<1&&(r["stop-opacity"]=k),f.appendChild(t("stop",r))}a(n,f,"color")}return"url(#"+f.id+")"}function et(n){var i=t("text",e(n,!0));return i.textContent=n._content,i}function st(t,i){var u={},f=t.getParent();return t._name!=null&&(u.id=t._name),n.each(ei,function(i){var h=i.get,o=i.type,e=t[h](),s;f&&n.equals(f[h](),e)||(o==="color"&&e!=null&&(s=e.getAlpha(),s<1&&(u[i.attribute+"-opacity"]=s)),u[i.attribute]=e==null?"none":o==="number"?r.number(e):o==="color"?e.gradient?ft(e,t):e.toCSS(!0):o==="array"?e.join(","):o==="lookup"?i.toSVG[e]:e)}),u.opacity===1&&delete u.opacity,t._visibility==null||t._visibility||(u.visibility="hidden"),delete t._gradientMatrix,h(i,u)}function c(n,t){return f||(f={ids:{},svgs:{}}),n&&f.svgs[t+"-"+n._id]}function a(n,t,i){f||c();var r=f.ids[i]=(f.ids[i]||0)+1;t.id=i+"-"+r,f.svgs[i+"-"+n._id]=t}function p(n,i){var r,u,e;if(!f)return n;r=n.nodeName.toLowerCase()==="svg"&&n,u=null;for(e in f.svgs)u||(r||(r=t("svg"),r.appendChild(n)),u=r.insertBefore(t("defs"),r.firstChild)),u.appendChild(f.svgs[e]);return f=null,i&&i.asString?(new XMLSerializer).serializeToString(r):r}function o(n){var i=ot[n._type],t=i&&i(n,n._type);return t&&n._data&&t.setAttribute("data-paper-data",JSON.stringify(n._data)),t&&st(n,t)}function d(n){r=n&&n.precision?new w(n.precision):w.instance}var r,ot={group:v,layer:v,raster:tt,path:it,"compound-path":rt,"placed-symbol":ut,"point-text":et},f;k.inject({exportSVG:function(n){return d(n),p(o(this),n)}}),yt.inject({exportSVG:function(n){var i,e;d(n);var r=this.layers,u=this.view.getSize(),f=t("svg",{x:0,y:0,width:u.width,height:u.height,version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"});for(i=0,e=r.length;i<e;i++)f.appendChild(o(r[i]));return p(f,n)}})},new function(){function r(n,t,i,r){var f=oi[t],u=f?n.getAttributeNS(f,t):n.getAttribute(t);return u==="null"&&(u=null),u==null?r?null:i?"":0:i?u:parseFloat(u)}function i(n,i,u,f){return i=r(n,i,!1,f),u=r(n,u,!1,f),f&&i==null&&u==null?null:new t(i||0,u||0)}function u(n,t,i,u){return t=r(n,t,!1,u),i=r(n,i,!1,u),u&&t==null&&i==null?null:new e(t||0,i||0)}function p(n,t,i){return n==="none"?null:t==="number"?parseFloat(n):t==="array"?n?n.split(/[\s,]+/g).map(parseFloat):[]:t==="color"?ut(n)||n:t==="lookup"?i[n]:n}function s(n,t){var c=n.childNodes,u=t==="clippath",i=u?new rt:new g,o=i._project,v=o._currentStyle,f=[],e,l,s,r;for(u||(i._transformContent=!1,i=h(i,n),o._currentStyle=i._style.clone()),e=0,l=c.length;e<l;e++)s=c[e],s.nodeType==1&&(r=a(s))&&(u&&r instanceof rt?(f.push.apply(f,r.removeChildren()),r.remove()):r instanceof nt||f.push(r));return i.addChildren(f),u&&(i=h(i.reduce(),n)),o._currentStyle=v,(u||t==="defs")&&(i.remove(),i=null),i}function w(n,t){var i=new c,u=n.points,r,f;for(i.moveTo(u.getItem(0)),r=1,f=u.numberOfItems;r<f;r++)i.lineTo(u.getItem(r));return t==="polygon"&&i.closePath(),i}function ft(n){var t=n.getAttribute("d"),i=t.match(/m/gi).length>1?new rt:new c;return i.setPathData(t),i}function b(n,t){for(var c=n.childNodes,l=[],e,o,y,f,s,p,u=0,a=c.length;u<a;u++)e=c[u],e.nodeType==1&&l.push(h(new vt,e));return o=t==="radialgradient",y=new ot(l,o),o?(f=i(n,"cx","cy"),s=f.add(r(n,"r"),0),p=i(n,"fx","fy",!0)):(f=i(n,"x1","y1"),s=i(n,"x2","y2")),h(new v(y,f,s,p),n),null}function d(n,t,i,r){for(var c=(r.getAttribute(i)||"").split(/\)\s*/g),f=new y,s,e,p,t,h,o=0,l=c.length;o<l;o++){if(s=c[o],!s)break;var a=s.split("("),v=a[0],u=a[1].split(/[\s,]+/g);for(e=0,p=u.length;e<p;e++)u[e]=parseFloat(u[e]);switch(v){case"matrix":f.concatenate(new y(u[0],u[2],u[1],u[3],u[4],u[5]));break;case"rotate":f.rotate(u[0],u[1],u[2]);break;case"translate":f.translate(u[0],u[1]);break;case"scale":f.scale(u);break;case"skewX":case"skewY":t=Math.tan(u[0]*Math.PI/180),h=v=="skewX",f.shear(h?t:0,h?0:t)}}n.transform(f)}function tt(n,t,i){var r=n[i==="fill-opacity"?"getFillColor":"getStrokeColor"]();r&&r.setAlpha(parseFloat(t))}function it(t,i,r){var e=t.attributes[i],u=e&&e.value,f;return u||(f=n.camelize(i),u=t.style[f],u||r.node[f]===r.parent[f]||(u=r.node[f])),u?u==="none"?null:u:undefined}function h(t,i){var r={node:o.getStyles(i)||{},parent:o.getStyles(i.parentNode)||{}};return n.each(ht,function(u,f){var e=it(i,f,r);e!==undefined&&(t=n.pick(u(t,e,f,i,r),t))}),t}function ut(n){var t=n&&n.match(/\((?:#|)([^)']+)/);return t&&l[t[1]]}function a(n,t){typeof n=="string"&&(n=(new DOMParser).parseFromString(n,"image/svg+xml"));var r=n.nodeName.toLowerCase(),u=st[r],i=u&&u(n,r),f=n.getAttribute("data-paper-data");return!i||i instanceof g||(i=h(i,n)),i&&f&&(i._data=JSON.parse(f)),t&&(l={}),i}var st={g:s,svg:s,clippath:s,polygon:w,polyline:w,path:ft,lineargradient:b,radialgradient:b,image:function(n){var t=new et(r(n,"href",!0));return t.attach("load",function(){var t=u(n,"width","height");this.setSize(t),this.translate(i(n,"x","y").add(t.divide(2)))}),t},symbol:function(n,t){return new nt(s(n,t),!0)},defs:s,use:function(n){var f=(r(n,"href",!0)||"").substring(1),t=l[f],u=i(n,"x","y");return t?t instanceof nt?t.place(u):t.clone().translate(u):null},circle:function(n){return new c.Circle(i(n,"cx","cy"),r(n,"r"))},ellipse:function(n){var t=i(n,"cx","cy"),r=u(n,"rx","ry");return new c.Ellipse(new f(t.subtract(r),t.add(r)))},rect:function(n){var t=i(n,"x","y"),r=u(n,"width","height"),e=u(n,"rx","ry");return new c.Rectangle(new f(t,r),e)},line:function(n){return new c.Line(i(n,"x1","y1"),i(n,"x2","y2"))},text:function(n){var t=new ri(i(n,"x","y",!1).add(i(n,"dx","dy",!1)));return t.setContent(n.textContent.trim()||""),t}},ht=n.merge(n.each(ei,function(n){this[n.attribute]=function(t,i){t[n.set](p(i,n.type,n.fromSVG))}},{}),{id:function(n,t){l[t]=n,n.setName&&n.setName(t)},"clip-path":function(n,t){var i=ut(t);if(i)if(i=i.clone(),i.setClipMask(!0),n instanceof g)n.insertChild(0,i);else return new g(i,n)},gradientTransform:d,transform:d,"fill-opacity":tt,"stroke-opacity":tt,visibility:function(n,t){n.setVisible(t==="visible")},"stop-color":function(n,t){n.setColor&&n.setColor(t)},"stop-opacity":function(n,t){n._color&&n._color.setAlpha(parseFloat(t))},offset:function(n,t){var i=t.match(/(.*)%$/);n.setRampPoint(i?i[1]/100:parseFloat(t))},viewBox:function(n,t,i,r,e){var o=new f(p(t,"array")),h=u(r,"width","height",!0),a,v,s,l;n instanceof g?(a=h?o.getSize().divide(h):1,v=(new y).translate(o.getPoint()).scale(a),n.transform(v.inverted())):n instanceof nt&&(h&&o.setSize(h),s=it(r,"overflow",e)!="visible",l=n._definition,s&&!o.contains(l.getBounds())&&(s=new c.Rectangle(o).transform(l._matrix),s.setClipMask(!0),l.addChild(s)))}}),l={};k.inject({importSVG:function(n){return this.addChild(a(n,!0))}}),yt.inject({importSVG:function(n){return this.activate(),a(n,!0)}})},paper=new(it.inject(n.merge(n.exports,{enumerable:!0,Base:n,Numerical:s,DomElement:o,DomEvent:a,Key:ui}))),typeof define=="function"&&define.amd&&define(paper),paper};paper.PaperScope.prototype.PaperScript=function(){function compile(n){function r(n){for(var r,t=0,u=i.length;t<u;t++){if(r=i[t],r[0]>=n)break;n+=r[1]}return n}function t(t){return n.substring(r(t.range[0]),r(t.range[1]))}function u(t,u){for(var e=r(t.range[0]),o=r(t.range[1]),s=0,f=i.length-1;f>=0;f--)if(e>i[f][0]){s=f+1;break}i.splice(s,0,[e,u.length-o+e]),n=n.substring(0,e)+u+n.substring(o)}function f(n){var l,i,c,a,r,h,s;if(n&&(n.type!=="MemberExpression"||!n.computed)){for(l in n)if(l!=="range")if(i=n[l],Array.isArray(i))for(c=0,a=i.length;c<a;c++)f(i[c]);else i&&typeof i=="object"&&f(i);switch(n&&n.type){case"BinaryExpression":n.operator in e&&n.left.type!=="Literal"&&(r=t(n.left),h=t(n.right),u(n,"_$_("+r+', "'+n.operator+'", '+h+")"));break;case"AssignmentExpression":/^.=$/.test(n.operator)&&n.left.type!=="Literal"&&(r=t(n.left),h=t(n.right),u(n,r+" = _$_("+r+', "'+n.operator[0]+'", '+h+")"));break;case"UpdateExpression":n.prefix||(s=t(n.argument),u(n,s+" = _$_("+s+', "'+n.operator[0]+'", 1)'));break;case"UnaryExpression":n.operator in o&&n.argument.type!=="Literal"&&(s=t(n.argument),u(n,'$_("'+n.operator+'", '+s+")"))}}}var i=[];return f(s.acorn.parse(n,{ranges:!0})),n}function r(code,scope){paper=scope;var view=scope.project&&scope.project.view,res;with(scope)(function(){var onFrame,onResize;res=eval(compile(code)),/on(?:Key|Mouse)(?:Up|Down|Move|Drag)/.test(code)&&Base.each(paper.Tool.prototype._events,function(n){var value=eval(n);value&&(scope.getTool()[n]=value)}),view&&(view.setOnResize(onResize),view.fire("resize",{size:view.size,delta:new Point}),view.setOnFrame(onFrame),view.draw())}).call(scope);return res}function h(n,t){var i=new(window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP");return i.open("GET",n,!0),i.overrideMimeType&&i.overrideMimeType("text/plain"),i.onreadystatechange=function(){if(i.readyState===4)return r(i.responseText,t)},i.send(null)}function u(){for(var e=document.getElementsByTagName("script"),t,u,f,i=0,o=e.length;i<o;i++)t=e[i],/^text\/(?:x-|)paperscript$/.test(t.type)&&!t.getAttribute("data-paper-ignore")&&(u=n.getAttribute(t,"canvas"),f=n.get(u)||new n(t).setup(u),t.src?h(t.src,f):r(t.innerHTML,f),t.setAttribute("data-paper-ignore",!0))}var Base=paper.Base,n=paper.PaperScope,f,t,s=this;!function(n,i){return"object"==typeof f&&"object"==typeof module?i(f):"function"==typeof t&&t.amd?t(["exports"],i):(i(n.acorn||(n.acorn={})),void 0)}(this,function(n){"use strict";function eu(n){u=n||{};for(var t in hr)Object.prototype.hasOwnProperty.call(u,t)||(u[t]=hr[t]);sr=u.sourceFile||null}function e(n,r){var f=bu(i,n),u;r+=" ("+f.line+":"+f.column+")",u=new SyntaxError(r);throw u.pos=n,u.loc=f,u.raisedAt=t,u;}function dt(n){function e(n){if(1==n.length)return i+="return str === "+JSON.stringify(n[0])+";";i+="switch(str){";for(var t=0;t<n.length;++t)i+="case "+JSON.stringify(n[t])+":";i+="return true}return false;"}var i,r,u,t,f;n=n.split(" "),i="",r=[];n:for(t=0;t<n.length;++t){for(u=0;u<r.length;++u)if(r[u][0].length==n[t].length){r[u].push(n[t]);continue n}r.push([n[t]])}if(r.length>3){for(r.sort(function(n,t){return t.length-n.length}),i+="switch(str.length){",t=0;t<r.length;++t)f=r[t],i+="case "+f[0].length+":",e(f);i+="}"}else e(n);return new Function("str",i)}function st(){this.line=rt,this.column=t-k}function ou(){rt=1,t=k=0,ai=!0,ei()}function l(n,i){vt=t,u.locations&&(li=new st),f=n,ei(),it=i,ai=n.beforeExpr}function te(){var o=u.onComment&&u.locations&&new st,r=t,f=i.indexOf("*/",t+=2),n;if(-1===f&&e(t-2,"Unterminated comment"),t=f+2,u.locations)for(kt.lastIndex=r;(n=kt.exec(i))&&n.index<t;)++rt,k=n.index+n[0].length;u.onComment&&u.onComment(!0,i.slice(r+2,f),r,t,o,u.locations&&new st)}function ie(){for(var r=t,f=u.onComment&&u.locations&&new st,n=i.charCodeAt(t+=2);ct>t&&10!==n&&13!==n&&8232!==n&&8329!==n;)++t,n=i.charCodeAt(t);u.onComment&&u.onComment(!1,i.slice(r+2,t),r,t,f,u.locations&&new st)}function ei(){for(var n,r;ct>t;)if(n=i.charCodeAt(t),32===n)++t;else if(13===n)++t,r=i.charCodeAt(t),10===r&&++t,u.locations&&(++rt,k=t);else if(10===n)++t,++rt,k=t;else if(14>n&&n>8)++t;else if(47===n)if(r=i.charCodeAt(t+1),42===r)te();else{if(47!==r)break;ie()}else if(160===n)++t;else{if(!(n>=5760&&vo.test(String.fromCharCode(n))))break;++t}}function re(){var n=i.charCodeAt(t+1);return n>=48&&57>=n?hu(!0):(++t,l(gr))}function ue(){var n=i.charCodeAt(t+1);return ai?(++t,su()):61===n?a(wt,2):a(tu,1)}function fe(){var n=i.charCodeAt(t+1);return 61===n?a(wt,2):a(ho,1)}function ee(n){var r=i.charCodeAt(t+1);return r===n?a(124===n?to:io,2):61===r?a(wt,2):a(124===n?ro:fo,1)}function oe(){var n=i.charCodeAt(t+1);return 61===n?a(wt,2):a(uo,1)}function se(n){var r=i.charCodeAt(t+1);return r===n?a(no,2):61===r?a(wt,2):a(ge,1)}function he(n){var u=i.charCodeAt(t+1),r=1;return u===n?(r=62===n&&62===i.charCodeAt(t+2)?3:2,61===i.charCodeAt(t+r)?a(wt,r+1):a(so,r)):(61===u&&(r=61===i.charCodeAt(t+2)?3:2),a(oo,r))}function ce(n){var r=i.charCodeAt(t+1);return 61===r?a(eo,61===i.charCodeAt(t+2)?3:2):a(61===n?iu:bf,1)}function le(n){switch(n){case 46:return re();case 40:return++t,l(g);case 41:return++t,l(d);case 59:return++t,l(nt);case 44:return++t,l(ut);case 91:return++t,l(wi);case 93:return++t,l(bi);case 123:return++t,l(yt);case 125:return++t,l(at);case 58:return++t,l(pt);case 63:return++t,l(nu);case 48:var r=i.charCodeAt(t+1);if(120===r||88===r)return ae();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return hu(!1);case 34:case 39:return ve(n);case 47:return ue(n);case 37:case 42:return fe();case 124:case 38:return ee(n);case 94:return oe();case 43:case 45:return se(n);case 60:case 62:return he(n);case 61:case 33:return ce(n);case 126:return a(bf,1)}return!1}function gt(n){var r,o,f;if(n?t=v+1:v=t,u.locations&&(ci=new st),n)return su();if(t>=ct)return l(yi);if(r=i.charCodeAt(t),di(r)||92===r)return lu();if(o=le(r),o===!1){if(f=String.fromCharCode(r),"\\"===f||gf.test(f))return lu();e(t,"Unexpected character '"+f+"'")}return o}function a(n,r){var u=i.slice(t,t+r);t+=r,l(n,u)}function su(){for(var s,u,n,o,f="",r=t;;){if(t>=ct&&e(r,"Unterminated regular expression"),n=i.charAt(t),uu.test(n)&&e(r,"Unterminated regular expression"),s)s=!1;else{if("["===n)u=!0;else if("]"===n&&u)u=!1;else if("/"===n&&!u)break;s="\\"===n}++t}return f=i.slice(r,t),++t,o=cu(),o&&!/^[gmsiy]*$/.test(o)&&e(r,"Invalid regexp flag"),l(ar,new RegExp(f,o))}function ni(n,r){for(var e,u,o=t,f=0,s=0,h=null==r?1/0:r;h>s;++s){if(u=i.charCodeAt(t),e=u>=97?u-87:u>=65?u-55:u>=48&&57>=u?u-48:1/0,e>=n)break;++t,f=f*n+e}return t===o||null!=r&&t-o!==r?null:f}function ae(){t+=2;var n=ni(16);return null==n&&e(v+2,"Expected hexadecimal number"),di(i.charCodeAt(t))&&e(t,"Identifier directly after number"),l(fi,n)}function hu(n){var f=t,s=!1,h=48===i.charCodeAt(t),r,o,u;return n||null!==ni(10)||e(f,"Invalid number"),46===i.charCodeAt(t)&&(++t,ni(10),s=!0),r=i.charCodeAt(t),(69===r||101===r)&&(r=i.charCodeAt(++t),(43===r||45===r)&&++t,null===ni(10)&&e(f,"Invalid number"),s=!0),di(i.charCodeAt(t))&&e(t,"Identifier directly after number"),u=i.slice(f,t),s?o=parseFloat(u):h&&1!==u.length?/[89]/.test(u)||w?e(f,"Invalid number"):o=parseInt(u,8):o=parseInt(u,10),l(fi,o)}function ve(n){var r,o,f;for(t++,r="";;){if(t>=ct&&e(v,"Unterminated string constant"),o=i.charCodeAt(t),o===n)return++t,l(vi,r);if(92===o){for(o=i.charCodeAt(++t),f=/^[0-7]+/.exec(i.slice(t,t+3)),f&&(f=f[0]);f&&parseInt(f,8)>255;)f=f.slice(0,f.length-1);if("0"===f&&(f=null),++t,f)w&&e(t-2,"Octal literal in strict mode"),r+=String.fromCharCode(parseInt(f,8)),t+=f.length-1;else switch(o){case 110:r+="\n";break;case 114:r+="\r";break;case 120:r+=String.fromCharCode(oi(2));break;case 117:r+=String.fromCharCode(oi(4));break;case 85:r+=String.fromCharCode(oi(8));break;case 116:r+="\t";break;case 98:r+="\b";break;case 118:r+="\x0b";break;case 102:r+="\f";break;case 48:r+="\0";break;case 13:10===i.charCodeAt(t)&&++t;case 10:u.locations&&(k=t,++rt);break;default:r+=String.fromCharCode(o)}}else(13===o||10===o||8232===o||8329===o)&&e(v,"Unterminated string constant"),r+=String.fromCharCode(o),++t}}function oi(n){var t=ni(16,n);return null===t&&e(v,"Bad character escape sequence"),t}function cu(){var n,u,f,o,r,s;for(bt=!1,u=!0,f=t;;){if(o=i.charCodeAt(t),ne(o))bt&&(n+=i.charAt(t)),++t;else{if(92!==o)break;bt||(n=i.slice(f,t)),bt=!0,117!=i.charCodeAt(++t)&&e(t,"Expecting Unicode escape sequence \\uXXXX"),++t,r=oi(4),s=String.fromCharCode(r),s||e(t-1,"Invalid Unicode escape"),(u?di(r):ne(r))||e(t-4,"Invalid Unicode escape"),n+=s}u=!1}return bt?n:i.slice(f,t)}function lu(){var n=cu(),t=lt;return bt||(ao(n)?t=dr[n]:(u.forbidReserved&&(3===u.ecmaVersion?co:lo)(n)||w&&kf(n))&&e(v,"The keyword '"+n+"' is reserved")),l(t,n)}function o(){cr=v,ot=vt,lr=li,gt()}function gi(n){for(w=n,t=ot;k>t;)k=i.lastIndexOf("\n",k-2)+1,--rt;ei(),gt()}function au(){this.type=null,this.start=v,this.end=null}function vu(){this.start=ci,this.end=null,null!==sr&&(this.source=sr)}function y(){var n=new au;return u.locations&&(n.loc=new vu),u.ranges&&(n.range=[v,0]),n}function ft(n){var t=new au;return t.start=n.start,u.locations&&(t.loc=new vu,t.loc.start=n.loc.start),u.ranges&&(t.range=[n.range[0],0]),t}function r(n,t){return n.type=t,n.end=ot,u.locations&&(n.loc.end=lr),u.ranges&&(n.range[1]=ot),n}function nr(n){return u.ecmaVersion>=5&&"ExpressionStatement"===n.type&&"Literal"===n.expression.type&&"use strict"===n.expression.value}function s(n){if(f===n)return(o(),!0)}function si(){return!u.strictSemicolons&&(f===yi||f===at||uu.test(i.slice(ot,v)))}function ht(){s(nt)||si()||tt()}function h(n){f===n?o():tt()}function tt(){e(v,"Unexpected token")}function hi(n){"Identifier"!==n.type&&"MemberExpression"!==n.type&&e(n.start,"Assigning to rvalue"),w&&"Identifier"===n.type&&ki(n.name)&&e(n.start,"Assigning to "+n.name+" in strict mode")}function ye(n){var i,e,o;for(cr=ot=t,u.locations&&(lr=new st),ui=w=null,c=[],gt(),i=n||y(),e=!0,n||(i.body=[]);f!==yi;)o=b(),i.body.push(o),e&&nr(o)&&gi(!0),e=!1;return r(i,"Program")}function b(){var k,n,ut,ft,u,l,ct,vt,a,st,rt,t,wt;f===tu&&gt(!0),k=f,n=y();switch(k){case vr:case gu:for(o(),ut=k===vr,s(nt)||si()?n.label=null:f!==lt?tt():(n.label=et(),ht()),t=0;t<c.length;++t)if(ft=c[t],null==n.label||ft.name===n.label.name){if(null!=ft.kind&&(ut||"loop"===ft.kind))break;if(n.label&&ut)break}return t===c.length&&e(n.start,"Unsyntactic "+k.keyword),r(n,ut?"BreakStatement":"ContinueStatement");case nf:return o(),ht(),r(n,"DebuggerStatement");case rf:return o(),c.push(fu),n.body=b(),c.pop(),h(kr),n.test=ti(),ht(),r(n,"DoWhileStatement");case ef:return(o(),c.push(fu),h(g),f===nt)?tr(n,null):f===br?(u=y(),o(),pu(u,!0),1===u.declarations.length&&s(pi)?yu(n,u):tr(n,u)):(u=p(!1,!0),s(pi)?(hi(u),yu(n,u)):tr(n,u));case pr:return o(),er(n,!0);case of:return o(),n.test=ti(),n.consequent=b(),n.alternate=s(uf)?b():null,r(n,"IfStatement");case sf:return ui||e(v,"'return' outside of function"),o(),s(nt)||si()?n.argument=null:(n.argument=p(),ht()),r(n,"ReturnStatement");case wr:for(o(),n.discriminant=ti(),n.cases=[],h(yt),c.push(po);f!=at;)f===yr||f===tf?(vt=f===yr,l&&r(l,"SwitchCase"),n.cases.push(l=y()),l.consequent=[],o(),vt?l.test=p():(ct&&e(cr,"Multiple default clauses"),ct=!0,l.test=null),h(pt)):(l||tt(),l.consequent.push(b()));return l&&r(l,"SwitchCase"),o(),c.pop(),r(n,"SwitchStatement");case hf:return o(),uu.test(i.slice(ot,v))&&e(ot,"Illegal newline after throw"),n.argument=p(),ht(),r(n,"ThrowStatement");case cf:return(o(),n.block=ii(),n.handler=null,f===du)&&(a=y(),o(),h(g),a.param=et(),w&&ki(a.param.name)&&e(a.param.start,"Binding "+a.param.name+" in strict mode"),h(d),a.guard=null,a.body=ii(),n.handler=r(a,"CatchClause")),n.guardedHandlers=ku,n.finalizer=s(ff)?ii():null,n.handler||n.finalizer||e(n.start,"Missing catch or finally clause"),r(n,"TryStatement");case br:return o(),n=pu(n),ht(),n;case kr:return o(),n.test=ti(),c.push(fu),n.body=b(),c.pop(),r(n,"WhileStatement");case lf:return w&&e(v,"'with' in strict mode"),o(),n.object=ti(),n.body=b(),r(n,"WithStatement");case yt:return ii();case nt:return o(),r(n,"EmptyStatement");default:if(st=it,rt=p(),k===lt&&"Identifier"===rt.type&&s(pt)){for(t=0;t<c.length;++t)c[t].name===st&&e(rt.start,"Label '"+st+"' is already declared");return wt=f.isLoop?"loop":f===wr?"switch":null,c.push({name:st,kind:wt}),n.body=b(),c.pop(),n.label=rt,r(n,"LabeledStatement")}return n.expression=rt,ht(),r(n,"ExpressionStatement")}}function ti(){h(g);var n=p();return h(d),n}function ii(n){var f,t=y(),e=!0,i=!1,u;for(t.body=[],h(yt);!s(at);)u=b(),t.body.push(u),e&&n&&nr(u)&&(f=i,gi(i=!0)),e=!1;return i&&!f&&gi(!1),r(t,"BlockStatement")}function tr(n,t){return n.init=t,h(nt),n.test=f===nt?null:p(),h(nt),n.update=f===d?null:p(),h(d),n.body=b(),c.pop(),r(n,"ForStatement")}function yu(n,t){return n.left=t,n.right=p(),h(d),n.body=b(),c.pop(),r(n,"ForInStatement")}function pu(n,t){for(n.declarations=[],n.kind="var";;){var i=y();if(i.id=et(),w&&ki(i.id.name)&&e(i.id.start,"Binding "+i.id.name+" in strict mode"),i.init=s(iu)?p(!0,t):null,n.declarations.push(r(i,"VariableDeclarator")),!s(ut))break}return r(n,"VariableDeclaration")}function p(n,t){var u=ir(t),i;if(!n&&f===ut){for(i=ft(u),i.expressions=[u];s(ut);)i.expressions.push(ir(t));return r(i,"SequenceExpression")}return u}function ir(n){var i=pe(n),t;return f.isAssign?(t=ft(i),t.operator=it,t.left=i,o(),t.right=ir(n),hi(i),r(t,"AssignmentExpression")):i}function pe(n){var i=we(n),t;return s(nu)?(t=ft(i),t.test=i,t.consequent=p(!0),h(pt),t.alternate=p(!0,n),r(t,"ConditionalExpression")):i}function we(n){return rr(ur(),-1,n)}function rr(n,t,i){var e=f.binop,u;return null!=e&&(!i||f!==pi)&&e>t?(u=ft(n),u.left=n,u.operator=it,o(),u.right=rr(ur(),e,i),u=r(u,/&&|\|\|/.test(u.operator)?"LogicalExpression":"BinaryExpression"),rr(u,t,i)):n}function ur(){var i,t,n;if(f.prefix)return n=y(),i=f.isUpdate,n.operator=it,n.prefix=!0,o(),n.argument=ur(),i?hi(n.argument):w&&"delete"===n.operator&&"Identifier"===n.argument.type&&e(n.start,"Deleting local variable in strict mode"),r(n,i?"UpdateExpression":"UnaryExpression");for(t=be();f.postfix&&!si();)n=ft(t),n.operator=it,n.prefix=!1,n.argument=t,hi(t),o(),t=r(n,"UpdateExpression");return t}function be(){return ri(fr())}function ri(n,t){var i;return s(gr)?(i=ft(n),i.object=n,i.property=et(!0),i.computed=!1,ri(r(i,"MemberExpression"),t)):s(wi)?(i=ft(n),i.object=n,i.property=p(),i.computed=!0,h(bi),ri(r(i,"MemberExpression"),t)):!t&&s(g)?(i=ft(n),i.callee=n,i.arguments=or(d,!1),ri(r(i,"CallExpression"),t)):n}function fr(){var s,e,t,n;switch(f){case vf:return n=y(),o(),r(n,"ThisExpression");case lt:return et();case fi:case vi:case ar:return n=y(),n.value=it,n.raw=i.slice(v,vt),o(),r(n,"Literal");case yf:case pf:case wf:return n=y(),n.value=f.atomValue,n.raw=f.keyword,o(),r(n,"Literal");case g:return s=ci,e=v,o(),t=p(),t.start=e,t.end=vt,u.locations&&(t.loc.start=s,t.loc.end=li),u.ranges&&(t.range=[e,vt]),h(d),t;case wi:return n=y(),o(),n.elements=or(bi,!0,!0),r(n,"ArrayExpression");case yt:return de();case pr:return n=y(),o(),er(n,!1);case af:return ke();default:tt()}}function ke(){var n=y();return o(),n.callee=ri(fr(),!0),n.arguments=s(g)?or(d,!1):ku,r(n,"NewExpression")}function de(){var i=y(),b=!0,k=!1,c,n,v,l,t,a;for(i.properties=[],o();!s(at);){if(b)b=!1;else if(h(ut),u.allowTrailingCommas&&s(at))break;if(n={key:wu()},v=!1,s(pt)?(n.value=p(!0),c=n.kind="init"):u.ecmaVersion>=5&&"Identifier"===n.key.type&&("get"===n.key.name||"set"===n.key.name)?(v=k=!0,c=n.kind=n.key.name,n.key=wu(),f!==g&&tt(),n.value=er(y(),!1)):tt(),"Identifier"===n.key.type&&(w||k))for(l=0;l<i.properties.length;++l)t=i.properties[l],t.key.name===n.key.name&&(a=c==t.kind||v&&"init"===t.kind||"init"===c&&("get"===t.kind||"set"===t.kind),a&&!w&&"init"===c&&"init"===t.kind&&(a=!1),a&&e(n.key.start,"Redefinition of property"));i.properties.push(n)}return r(i,"ObjectExpression")}function wu(){return f===fi||f===vi?fr():et(!0)}function er(n,t){var l,a,v,i,u,o;for(f===lt?n.id=et():t?tt():n.id=null,n.params=[],l=!0,h(g);!s(d);)l?l=!1:h(ut),n.params.push(et());if(a=ui,v=c,ui=!0,c=[],n.body=ii(!0),ui=a,c=v,w||n.body.body.length&&nr(n.body.body[0]))for(i=n.id?-1:0;i<n.params.length;++i)if(u=0>i?n.id:n.params[i],(kf(u.name)||ki(u.name))&&e(u.start,"Defining '"+u.name+"' in strict mode"),i>=0)for(o=0;i>o;++o)u.name===n.params[o].name&&e(u.start,"Argument name clash in strict mode");return r(n,t?"FunctionDeclaration":"FunctionExpression")}function or(n,t,i){for(var r=[],e=!0;!s(n);){if(e)e=!1;else if(h(ut),t&&u.allowTrailingCommas&&s(n))break;i&&f===ut?r.push(null):r.push(p(!0))}return r}function et(n){var t=y();return t.name=f===lt?it:n&&!u.forbidReserved&&f.keyword||tt(),o(),r(t,"Identifier")}var u,i,ct,sr,hr,bu,ru;n.version="0.3.2",n.parse=function(n,t){return i=String(n),ct=i.length,eu(t),ou(),ye(u.program)},hr=n.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null},bu=n.getLineInfo=function(n,t){for(var i,u=1,r=0;;){if(kt.lastIndex=r,i=kt.exec(n),!(i&&i.index<t))break;++u,r=i.index+i[0].length}return{line:u,column:t-r}},n.tokenize=function(n,r){function o(n){return gt(n),e.start=v,e.end=vt,e.startLoc=ci,e.endLoc=li,e.type=f,e.value=it,e}i=String(n),ct=i.length,eu(r),ou();var e={};return o.jumpTo=function(n,r){if(t=n,u.locations){rt=1,k=kt.lastIndex=0;for(var f;(f=kt.exec(i))&&f.index<n;)++rt,k=f.index+f[0].length}ai=r,ei()},o};var t,v,vt,ci,li,f,it,ai,rt,k,cr,ot,lr,ui,c,w,ku=[],fi={type:"num"},ar={type:"regexp"},vi={type:"string"},lt={type:"name"},yi={type:"eof"},vr={keyword:"break"},yr={keyword:"case",beforeExpr:!0},du={keyword:"catch"},gu={keyword:"continue"},nf={keyword:"debugger"},tf={keyword:"default"},rf={keyword:"do",isLoop:!0},uf={keyword:"else",beforeExpr:!0},ff={keyword:"finally"},ef={keyword:"for",isLoop:!0},pr={keyword:"function"},of={keyword:"if"},sf={keyword:"return",beforeExpr:!0},wr={keyword:"switch"},hf={keyword:"throw",beforeExpr:!0},cf={keyword:"try"},br={keyword:"var"},kr={keyword:"while",isLoop:!0},lf={keyword:"with"},af={keyword:"new",beforeExpr:!0},vf={keyword:"this"},yf={keyword:"null",atomValue:null},pf={keyword:"true",atomValue:!0},wf={keyword:"false",atomValue:!1},pi={keyword:"in",binop:7,beforeExpr:!0},dr={"break":vr,"case":yr,"catch":du,"continue":gu,"debugger":nf,"default":tf,"do":rf,"else":uf,"finally":ff,"for":ef,"function":pr,"if":of,"return":sf,"switch":wr,"throw":hf,"try":cf,"var":br,"while":kr,"with":lf,"null":yf,"true":pf,"false":wf,"new":af,"in":pi,"instanceof":{keyword:"instanceof",binop:7,beforeExpr:!0},"this":vf,"typeof":{keyword:"typeof",prefix:!0,beforeExpr:!0},"void":{keyword:"void",prefix:!0,beforeExpr:!0},"delete":{keyword:"delete",prefix:!0,beforeExpr:!0}},wi={type:"[",beforeExpr:!0},bi={type:"]"},yt={type:"{",beforeExpr:!0},at={type:"}"},g={type:"(",beforeExpr:!0},d={type:")"},ut={type:",",beforeExpr:!0},nt={type:";",beforeExpr:!0},pt={type:":",beforeExpr:!0},gr={type:"."},nu={type:"?",beforeExpr:!0},tu={binop:10,beforeExpr:!0},iu={isAssign:!0,beforeExpr:!0},wt={isAssign:!0,beforeExpr:!0},ge={binop:9,prefix:!0,beforeExpr:!0},no={postfix:!0,prefix:!0,isUpdate:!0},bf={prefix:!0,beforeExpr:!0},to={binop:1,beforeExpr:!0},io={binop:2,beforeExpr:!0},ro={binop:3,beforeExpr:!0},uo={binop:4,beforeExpr:!0},fo={binop:5,beforeExpr:!0},eo={binop:6,beforeExpr:!0},oo={binop:7,beforeExpr:!0},so={binop:8,beforeExpr:!0},ho={binop:10,beforeExpr:!0};n.tokTypes={bracketL:wi,bracketR:bi,braceL:yt,braceR:at,parenL:g,parenR:d,comma:ut,semi:nt,colon:pt,dot:gr,question:nu,slash:tu,eq:iu,name:lt,eof:yi,num:fi,regexp:ar,string:vi};for(ru in dr)n.tokTypes["_"+ru]=dr[ru];var bt,co=dt("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),lo=dt("class enum extends super const export import"),kf=dt("implements interface let package private protected public static yield"),ki=dt("eval arguments"),ao=dt("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),vo=/[\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]/,df="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",gf=new RegExp("["+df+"]"),yo=new RegExp("["+df+"̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿]"),uu=/[\n\r\u2028\u2029]/,kt=/\r\n|[\n\r\u2028\u2029]/g,di=n.isIdentifierStart=function(n){return 65>n?36===n:91>n?!0:97>n?95===n:123>n?!0:n>=170&&gf.test(String.fromCharCode(n))},ne=n.isIdentifierChar=function(n){return 48>n?36===n:58>n?!0:65>n?!1:91>n?!0:97>n?95===n:123>n?!0:n>=170&&yo.test(String.fromCharCode(n))},fu={kind:"loop"},po={kind:"switch"}});var e={"+":"_add","-":"_subtract","*":"_multiply","/":"_divide","%":"_modulo","==":"equals","!=":"equals"},o={"-":"_negate","+":null},i=Base.each("add,subtract,multiply,divide,modulo,negate".split(","),function(n){this["_"+n]="#"+n},{});return paper.Point.inject(i),paper.Size.inject(i),paper.Color.inject(i),document.readyState==="complete"?setTimeout(u):paper.DomEvent.add(window,{load:u}),{compile:compile,evaluate:r,load:u}}(this);
//@ sourceMappingURL=paper-full.min.js.map